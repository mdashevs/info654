/*! For license information please see main.js.LICENSE.txt */
(()=>{var t,e,r,n={6714:function(t){t.exports=function(){function t(t,e){for(var r=0;r<e.length;r++){var n=e[r];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(t,n.key,n)}}function e(e,r,n){return r&&t(e.prototype,r),n&&t(e,n),e}function r(){return(r=Object.assign||function(t){for(var e=1;e<arguments.length;e++){var r=arguments[e];for(var n in r)Object.prototype.hasOwnProperty.call(r,n)&&(t[n]=r[n])}return t}).apply(this,arguments)}function n(t,e){t.prototype=Object.create(e.prototype),t.prototype.constructor=t,t.__proto__=e}function i(t){return(i=Object.setPrototypeOf?Object.getPrototypeOf:function(t){return t.__proto__||Object.getPrototypeOf(t)})(t)}function s(t,e){return(s=Object.setPrototypeOf||function(t,e){return t.__proto__=e,t})(t,e)}function o(t,e,r){return(o=function(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Date.prototype.toString.call(Reflect.construct(Date,[],(function(){}))),!0}catch(t){return!1}}()?Reflect.construct:function(t,e,r){var n=[null];n.push.apply(n,e);var i=new(Function.bind.apply(t,n));return r&&s(i,r.prototype),i}).apply(null,arguments)}function a(t){var e="function"==typeof Map?new Map:void 0;return(a=function(t){if(null===t||-1===Function.toString.call(t).indexOf("[native code]"))return t;if("function"!=typeof t)throw new TypeError("Super expression must either be null or a function");if(void 0!==e){if(e.has(t))return e.get(t);e.set(t,r)}function r(){return o(t,arguments,i(this).constructor)}return r.prototype=Object.create(t.prototype,{constructor:{value:r,enumerable:!1,writable:!0,configurable:!0}}),s(r,t)})(t)}function l(t,e){try{var r=t()}catch(t){return e(t)}return r&&r.then?r.then(void 0,e):r}"undefined"!=typeof Symbol&&(Symbol.iterator||(Symbol.iterator=Symbol("Symbol.iterator"))),"undefined"!=typeof Symbol&&(Symbol.asyncIterator||(Symbol.asyncIterator=Symbol("Symbol.asyncIterator")));var c,u="2.9.7",h=function(){};!function(t){t[t.off=0]="off",t[t.error=1]="error",t[t.warning=2]="warning",t[t.info=3]="info",t[t.debug=4]="debug"}(c||(c={}));var d=c.off,f=function(){function t(t){this.t=t}t.getLevel=function(){return d},t.setLevel=function(t){return d=c[t]};var e=t.prototype;return e.error=function(){for(var t=arguments.length,e=new Array(t),r=0;r<t;r++)e[r]=arguments[r];this.i(console.error,c.error,e)},e.warn=function(){for(var t=arguments.length,e=new Array(t),r=0;r<t;r++)e[r]=arguments[r];this.i(console.warn,c.warning,e)},e.info=function(){for(var t=arguments.length,e=new Array(t),r=0;r<t;r++)e[r]=arguments[r];this.i(console.info,c.info,e)},e.debug=function(){for(var t=arguments.length,e=new Array(t),r=0;r<t;r++)e[r]=arguments[r];this.i(console.log,c.debug,e)},e.i=function(e,r,n){r<=t.getLevel()&&e.apply(console,["["+this.t+"] "].concat(n))},t}(),p=k,g=w,m=A,y=T,v=x,b="/",E=new RegExp(["(\\\\.)","(?:\\:(\\w+)(?:\\(((?:\\\\.|[^\\\\()])+)\\))?|\\(((?:\\\\.|[^\\\\()])+)\\))([+*?])?"].join("|"),"g");function A(t,e){for(var r,n=[],i=0,s=0,o="",a=e&&e.delimiter||b,l=e&&e.whitelist||void 0,c=!1;null!==(r=E.exec(t));){var u=r[0],h=r[1],d=r.index;if(o+=t.slice(s,d),s=d+u.length,h)o+=h[1],c=!0;else{var f="",p=r[2],g=r[3],m=r[4],y=r[5];if(!c&&o.length){var v=o.length-1,A=o[v];(!l||l.indexOf(A)>-1)&&(f=A,o=o.slice(0,v))}o&&(n.push(o),o="",c=!1);var w=g||m,T=f||a;n.push({name:p||i++,prefix:f,delimiter:T,optional:"?"===y||"*"===y,repeat:"+"===y||"*"===y,pattern:w?L(w):"[^"+S(T===a?T:T+a)+"]+?"})}}return(o||s<t.length)&&n.push(o+t.substr(s)),n}function w(t,e){return function(r,n){var i=t.exec(r);if(!i)return!1;for(var s=i[0],o=i.index,a={},l=n&&n.decode||decodeURIComponent,c=1;c<i.length;c++)if(void 0!==i[c]){var u=e[c-1];a[u.name]=u.repeat?i[c].split(u.delimiter).map((function(t){return l(t,u)})):l(i[c],u)}return{path:s,index:o,params:a}}}function T(t,e){for(var r=new Array(t.length),n=0;n<t.length;n++)"object"==typeof t[n]&&(r[n]=new RegExp("^(?:"+t[n].pattern+")$",_(e)));return function(e,n){for(var i="",s=n&&n.encode||encodeURIComponent,o=!n||!1!==n.validate,a=0;a<t.length;a++){var l=t[a];if("string"!=typeof l){var c,u=e?e[l.name]:void 0;if(Array.isArray(u)){if(!l.repeat)throw new TypeError('Expected "'+l.name+'" to not repeat, but got array');if(0===u.length){if(l.optional)continue;throw new TypeError('Expected "'+l.name+'" to not be empty')}for(var h=0;h<u.length;h++){if(c=s(u[h],l),o&&!r[a].test(c))throw new TypeError('Expected all "'+l.name+'" to match "'+l.pattern+'"');i+=(0===h?l.prefix:l.delimiter)+c}}else if("string"!=typeof u&&"number"!=typeof u&&"boolean"!=typeof u){if(!l.optional)throw new TypeError('Expected "'+l.name+'" to be '+(l.repeat?"an array":"a string"))}else{if(c=s(String(u),l),o&&!r[a].test(c))throw new TypeError('Expected "'+l.name+'" to match "'+l.pattern+'", but got "'+c+'"');i+=l.prefix+c}}else i+=l}return i}}function S(t){return t.replace(/([.+*?=^!:${}()[\]|/\\])/g,"\\$1")}function L(t){return t.replace(/([=!:$/()])/g,"\\$1")}function _(t){return t&&t.sensitive?"":"i"}function x(t,e,r){for(var n=(r=r||{}).strict,i=!1!==r.start,s=!1!==r.end,o=r.delimiter||b,a=[].concat(r.endsWith||[]).map(S).concat("$").join("|"),l=i?"^":"",c=0;c<t.length;c++){var u=t[c];if("string"==typeof u)l+=S(u);else{var h=u.repeat?"(?:"+u.pattern+")(?:"+S(u.delimiter)+"(?:"+u.pattern+"))*":u.pattern;e&&e.push(u),l+=u.optional?u.prefix?"(?:"+S(u.prefix)+"("+h+"))?":"("+h+")?":S(u.prefix)+"("+h+")"}}if(s)n||(l+="(?:"+S(o)+")?"),l+="$"===a?"$":"(?="+a+")";else{var d=t[t.length-1],f="string"==typeof d?d[d.length-1]===o:void 0===d;n||(l+="(?:"+S(o)+"(?="+a+"))?"),f||(l+="(?="+S(o)+"|"+a+")")}return new RegExp(l,_(r))}function k(t,e,r){return t instanceof RegExp?function(t,e){if(!e)return t;var r=t.source.match(/\((?!\?)/g);if(r)for(var n=0;n<r.length;n++)e.push({name:n,prefix:null,delimiter:null,optional:!1,repeat:!1,pattern:null});return t}(t,e):Array.isArray(t)?function(t,e,r){for(var n=[],i=0;i<t.length;i++)n.push(k(t[i],e,r).source);return new RegExp("(?:"+n.join("|")+")",_(r))}(t,e,r):function(t,e,r){return x(A(t,r),e,r)}(t,e,r)}p.match=function(t,e){var r=[];return w(k(t,r,e),r)},p.regexpToFunction=g,p.parse=m,p.compile=function(t,e){return T(A(t,e),e)},p.tokensToFunction=y,p.tokensToRegExp=v;var P={container:"container",history:"history",namespace:"namespace",prefix:"data-barba",prevent:"prevent",wrapper:"wrapper"},I=new(function(){function t(){this.o=P,this.u=new DOMParser}var e=t.prototype;return e.toString=function(t){return t.outerHTML},e.toDocument=function(t){return this.u.parseFromString(t,"text/html")},e.toElement=function(t){var e=document.createElement("div");return e.innerHTML=t,e},e.getHtml=function(t){return void 0===t&&(t=document),this.toString(t.documentElement)},e.getWrapper=function(t){return void 0===t&&(t=document),t.querySelector("["+this.o.prefix+'="'+this.o.wrapper+'"]')},e.getContainer=function(t){return void 0===t&&(t=document),t.querySelector("["+this.o.prefix+'="'+this.o.container+'"]')},e.removeContainer=function(t){document.body.contains(t)&&t.parentNode.removeChild(t)},e.addContainer=function(t,e){var r=this.getContainer();r?this.s(t,r):e.appendChild(t)},e.getNamespace=function(t){void 0===t&&(t=document);var e=t.querySelector("["+this.o.prefix+"-"+this.o.namespace+"]");return e?e.getAttribute(this.o.prefix+"-"+this.o.namespace):null},e.getHref=function(t){if(t.tagName&&"a"===t.tagName.toLowerCase()){if("string"==typeof t.href)return t.href;var e=t.getAttribute("href")||t.getAttribute("xlink:href");if(e)return this.resolveUrl(e.baseVal||e)}return null},e.resolveUrl=function(){for(var t=arguments.length,e=new Array(t),r=0;r<t;r++)e[r]=arguments[r];var n=e.length;if(0===n)throw new Error("resolveUrl requires at least one argument; got none.");var i=document.createElement("base");if(i.href=arguments[0],1===n)return i.href;var s=document.getElementsByTagName("head")[0];s.insertBefore(i,s.firstChild);for(var o,a=document.createElement("a"),l=1;l<n;l++)a.href=arguments[l],i.href=o=a.href;return s.removeChild(i),o},e.s=function(t,e){e.parentNode.insertBefore(t,e.nextSibling)},t}()),R=new(function(){function t(){this.h=[],this.v=-1}var n=t.prototype;return n.init=function(t,e){this.l="barba";var r={ns:e,scroll:{x:window.scrollX,y:window.scrollY},url:t};this.h.push(r),this.v=0;var n={from:this.l,index:0,states:[].concat(this.h)};window.history&&window.history.replaceState(n,"",t)},n.change=function(t,e,r){if(r&&r.state){var n=r.state,i=n.index;e=this.m(this.v-i),this.replace(n.states),this.v=i}else this.add(t,e);return e},n.add=function(t,e){var r=this.size,n=this.p(e),i={ns:"tmp",scroll:{x:window.scrollX,y:window.scrollY},url:t};this.h.push(i),this.v=r;var s={from:this.l,index:r,states:[].concat(this.h)};switch(n){case"push":window.history&&window.history.pushState(s,"",t);break;case"replace":window.history&&window.history.replaceState(s,"",t)}},n.update=function(t,e){var n=e||this.v,i=r({},this.get(n),{},t);this.set(n,i)},n.remove=function(t){t?this.h.splice(t,1):this.h.pop(),this.v--},n.clear=function(){this.h=[],this.v=-1},n.replace=function(t){this.h=t},n.get=function(t){return this.h[t]},n.set=function(t,e){return this.h[t]=e},n.p=function(t){var e="push",r=t,n=P.prefix+"-"+P.history;return r.hasAttribute&&r.hasAttribute(n)&&(e=r.getAttribute(n)),e},n.m=function(t){return Math.abs(t)>1?t>0?"forward":"back":0===t?"popstate":t>0?"back":"forward"},e(t,[{key:"current",get:function(){return this.h[this.v]}},{key:"state",get:function(){return this.h[this.h.length-1]}},{key:"previous",get:function(){return this.v<1?null:this.h[this.v-1]}},{key:"size",get:function(){return this.h.length}}]),t}()),O=function(t,e){try{var r=function(){if(!e.next.html)return Promise.resolve(t).then((function(t){var r=e.next;if(t){var n=I.toElement(t);r.namespace=I.getNamespace(n),r.container=I.getContainer(n),r.html=t,R.update({ns:r.namespace});var i=I.toDocument(t);document.title=i.title}}))}();return Promise.resolve(r&&r.then?r.then((function(){})):void 0)}catch(t){return Promise.reject(t)}},D=p,C={__proto__:null,update:O,nextTick:function(){return new Promise((function(t){window.requestAnimationFrame(t)}))},pathToRegexp:D},M=function(){return window.location.origin},N=function(t){return void 0===t&&(t=window.location.href),F(t).port},F=function(t){var e,r=t.match(/:\d+/);if(null===r)/^http/.test(t)&&(e=80),/^https/.test(t)&&(e=443);else{var n=r[0].substring(1);e=parseInt(n,10)}var i,s=t.replace(M(),""),o={},a=s.indexOf("#");a>=0&&(i=s.slice(a+1),s=s.slice(0,a));var l=s.indexOf("?");return l>=0&&(o=U(s.slice(l+1)),s=s.slice(0,l)),{hash:i,path:s,port:e,query:o}},U=function(t){return t.split("&").reduce((function(t,e){var r=e.split("=");return t[r[0]]=r[1],t}),{})},B=function(t){return void 0===t&&(t=window.location.href),t.replace(/(\/#.*|\/|#.*)$/,"")},$={__proto__:null,getHref:function(){return window.location.href},getOrigin:M,getPort:N,getPath:function(t){return void 0===t&&(t=window.location.href),F(t).path},parse:F,parseQuery:U,clean:B};function j(t,e,r){return void 0===e&&(e=2e3),new Promise((function(n,i){var s=new XMLHttpRequest;s.onreadystatechange=function(){if(s.readyState===XMLHttpRequest.DONE)if(200===s.status)n(s.responseText);else if(s.status){var e={status:s.status,statusText:s.statusText};r(t,e),i(e)}},s.ontimeout=function(){var n=new Error("Timeout error ["+e+"]");r(t,n),i(n)},s.onerror=function(){var e=new Error("Fetch error");r(t,e),i(e)},s.open("GET",t),s.timeout=e,s.setRequestHeader("Accept","text/html,application/xhtml+xml,application/xml"),s.setRequestHeader("x-barba","yes"),s.send()}))}var G=function(t){return!!t&&("object"==typeof t||"function"==typeof t)&&"function"==typeof t.then};function H(t,e){return void 0===e&&(e={}),function(){for(var r=arguments.length,n=new Array(r),i=0;i<r;i++)n[i]=arguments[i];var s=!1,o=new Promise((function(r,i){e.async=function(){return s=!0,function(t,e){t?i(t):r(e)}};var o=t.apply(e,n);s||(G(o)?o.then(r,i):r(o))}));return o}}var V=new(function(t){function e(){var e;return(e=t.call(this)||this).logger=new f("@barba/core"),e.all=["ready","page","reset","currentAdded","currentRemoved","nextAdded","nextRemoved","beforeOnce","once","afterOnce","before","beforeLeave","leave","afterLeave","beforeEnter","enter","afterEnter","after"],e.registered=new Map,e.init(),e}n(e,t);var r=e.prototype;return r.init=function(){var t=this;this.registered.clear(),this.all.forEach((function(e){t[e]||(t[e]=function(r,n){t.registered.has(e)||t.registered.set(e,new Set),t.registered.get(e).add({ctx:n||{},fn:r})})}))},r.do=function(t){for(var e=this,r=arguments.length,n=new Array(r>1?r-1:0),i=1;i<r;i++)n[i-1]=arguments[i];if(this.registered.has(t)){var s=Promise.resolve();return this.registered.get(t).forEach((function(t){s=s.then((function(){return H(t.fn,t.ctx).apply(void 0,n)}))})),s.catch((function(r){e.logger.debug("Hook error ["+t+"]"),e.logger.error(r)}))}return Promise.resolve()},r.clear=function(){var t=this;this.all.forEach((function(e){delete t[e]})),this.init()},r.help=function(){this.logger.info("Available hooks: "+this.all.join(","));var t=[];this.registered.forEach((function(e,r){return t.push(r)})),this.logger.info("Registered hooks: "+t.join(","))},e}(h)),K=function(){function t(t){if(this.P=[],"boolean"==typeof t)this.g=t;else{var e=Array.isArray(t)?t:[t];this.P=e.map((function(t){return D(t)}))}}return t.prototype.checkHref=function(t){if("boolean"==typeof this.g)return this.g;var e=F(t).path;return this.P.some((function(t){return null!==t.exec(e)}))},t}(),Y=function(t){function e(e){var r;return(r=t.call(this,e)||this).k=new Map,r}n(e,t);var i=e.prototype;return i.set=function(t,e,r){return this.k.set(t,{action:r,request:e}),{action:r,request:e}},i.get=function(t){return this.k.get(t)},i.getRequest=function(t){return this.k.get(t).request},i.getAction=function(t){return this.k.get(t).action},i.has=function(t){return!this.checkHref(t)&&this.k.has(t)},i.delete=function(t){return this.k.delete(t)},i.update=function(t,e){var n=r({},this.k.get(t),{},e);return this.k.set(t,n),n},e}(K),q=function(){return!window.history.pushState},W=function(t){return!t.el||!t.href},z=function(t){var e=t.event;return e.which>1||e.metaKey||e.ctrlKey||e.shiftKey||e.altKey},X=function(t){var e=t.el;return e.hasAttribute("target")&&"_blank"===e.target},Q=function(t){var e=t.el;return void 0!==e.protocol&&window.location.protocol!==e.protocol||void 0!==e.hostname&&window.location.hostname!==e.hostname},J=function(t){var e=t.el;return void 0!==e.port&&N()!==N(e.href)},Z=function(t){var e=t.el;return e.getAttribute&&"string"==typeof e.getAttribute("download")},tt=function(t){return t.el.hasAttribute(P.prefix+"-"+P.prevent)},et=function(t){return Boolean(t.el.closest("["+P.prefix+"-"+P.prevent+'="all"]'))},rt=function(t){var e=t.href;return B(e)===B()&&N(e)===N()},nt=function(t){function e(e){var r;return(r=t.call(this,e)||this).suite=[],r.tests=new Map,r.init(),r}n(e,t);var r=e.prototype;return r.init=function(){this.add("pushState",q),this.add("exists",W),this.add("newTab",z),this.add("blank",X),this.add("corsDomain",Q),this.add("corsPort",J),this.add("download",Z),this.add("preventSelf",tt),this.add("preventAll",et),this.add("sameUrl",rt,!1)},r.add=function(t,e,r){void 0===r&&(r=!0),this.tests.set(t,e),r&&this.suite.push(t)},r.run=function(t,e,r,n){return this.tests.get(t)({el:e,event:r,href:n})},r.checkLink=function(t,e,r){var n=this;return this.suite.some((function(i){return n.run(i,t,e,r)}))},e}(K),it=function(t){function e(r,n){var i;void 0===n&&(n="Barba error");for(var s=arguments.length,o=new Array(s>2?s-2:0),a=2;a<s;a++)o[a-2]=arguments[a];return(i=t.call.apply(t,[this].concat(o))||this).error=r,i.label=n,Error.captureStackTrace&&Error.captureStackTrace(function(t){if(void 0===t)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return t}(i),e),i.name="BarbaError",i}return n(e,t),e}(a(Error)),st=function(){function t(t){void 0===t&&(t=[]),this.logger=new f("@barba/core"),this.all=[],this.page=[],this.once=[],this.A=[{name:"namespace",type:"strings"},{name:"custom",type:"function"}],t&&(this.all=this.all.concat(t)),this.update()}var e=t.prototype;return e.add=function(t,e){"rule"===t?this.A.splice(e.position||0,0,e.value):this.all.push(e),this.update()},e.resolve=function(t,e){var r=this;void 0===e&&(e={});var n=e.once?this.once:this.page;n=n.filter(e.self?function(t){return t.name&&"self"===t.name}:function(t){return!t.name||"self"!==t.name});var i=new Map,s=n.find((function(n){var s=!0,o={};return!(!e.self||"self"!==n.name)||(r.A.reverse().forEach((function(e){s&&(s=r.R(n,e,t,o),n.from&&n.to&&(s=r.R(n,e,t,o,"from")&&r.R(n,e,t,o,"to")),n.from&&!n.to&&(s=r.R(n,e,t,o,"from")),!n.from&&n.to&&(s=r.R(n,e,t,o,"to")))})),i.set(n,o),s)})),o=i.get(s),a=[];if(a.push(e.once?"once":"page"),e.self&&a.push("self"),o){var l,c=[s];Object.keys(o).length>0&&c.push(o),(l=this.logger).info.apply(l,["Transition found ["+a.join(",")+"]"].concat(c))}else this.logger.info("No transition found ["+a.join(",")+"]");return s},e.update=function(){var t=this;this.all=this.all.map((function(e){return t.T(e)})).sort((function(t,e){return t.priority-e.priority})).reverse().map((function(t){return delete t.priority,t})),this.page=this.all.filter((function(t){return void 0!==t.leave||void 0!==t.enter})),this.once=this.all.filter((function(t){return void 0!==t.once}))},e.R=function(t,e,r,n,i){var s=!0,o=!1,a=t,l=e.name,c=l,u=l,h=l,d=i?a[i]:a,f="to"===i?r.next:r.current;if(i?d&&d[l]:d[l]){switch(e.type){case"strings":default:var p=Array.isArray(d[c])?d[c]:[d[c]];f[c]&&-1!==p.indexOf(f[c])&&(o=!0),-1===p.indexOf(f[c])&&(s=!1);break;case"object":var g=Array.isArray(d[u])?d[u]:[d[u]];f[u]?(f[u].name&&-1!==g.indexOf(f[u].name)&&(o=!0),-1===g.indexOf(f[u].name)&&(s=!1)):s=!1;break;case"function":d[h](r)?o=!0:s=!1}o&&(i?(n[i]=n[i]||{},n[i][l]=a[i][l]):n[l]=a[l])}return s},e.O=function(t,e,r){var n=0;return(t[e]||t.from&&t.from[e]||t.to&&t.to[e])&&(n+=Math.pow(10,r),t.from&&t.from[e]&&(n+=1),t.to&&t.to[e]&&(n+=2)),n},e.T=function(t){var e=this;t.priority=0;var r=0;return this.A.forEach((function(n,i){r+=e.O(t,n.name,i+1)})),t.priority=r,t},t}(),ot=function(){function t(t){void 0===t&&(t=[]),this.logger=new f("@barba/core"),this.S=!1,this.store=new st(t)}var r=t.prototype;return r.get=function(t,e){return this.store.resolve(t,e)},r.doOnce=function(t){var e=t.data,r=t.transition;try{var n=function(){i.S=!1},i=this,s=r||{};i.S=!0;var o=l((function(){return Promise.resolve(i.j("beforeOnce",e,s)).then((function(){return Promise.resolve(i.once(e,s)).then((function(){return Promise.resolve(i.j("afterOnce",e,s)).then((function(){}))}))}))}),(function(t){i.S=!1,i.logger.debug("Transition error [before/after/once]"),i.logger.error(t)}));return Promise.resolve(o&&o.then?o.then(n):n())}catch(t){return Promise.reject(t)}},r.doPage=function(t){var e=t.data,r=t.transition,n=t.page,i=t.wrapper;try{var s=function(t){if(o)return t;a.S=!1},o=!1,a=this,c=r||{},u=!0===c.sync||!1;a.S=!0;var h=l((function(){function t(){return Promise.resolve(a.j("before",e,c)).then((function(){var t=!1;function r(r){return t?r:Promise.resolve(a.remove(e)).then((function(){return Promise.resolve(a.j("after",e,c)).then((function(){}))}))}var s=function(){if(u)return l((function(){return Promise.resolve(a.add(e,i)).then((function(){return Promise.resolve(a.j("beforeLeave",e,c)).then((function(){return Promise.resolve(a.j("beforeEnter",e,c)).then((function(){return Promise.resolve(Promise.all([a.leave(e,c),a.enter(e,c)])).then((function(){return Promise.resolve(a.j("afterLeave",e,c)).then((function(){return Promise.resolve(a.j("afterEnter",e,c)).then((function(){}))}))}))}))}))}))}),(function(t){if(a.M(t))throw new it(t,"Transition error [sync]")}));var r=function(r){return t?r:l((function(){var t=function(){if(!1!==s)return Promise.resolve(a.add(e,i)).then((function(){return Promise.resolve(a.j("beforeEnter",e,c)).then((function(){return Promise.resolve(a.enter(e,c,s)).then((function(){return Promise.resolve(a.j("afterEnter",e,c)).then((function(){}))}))}))}))}();if(t&&t.then)return t.then((function(){}))}),(function(t){if(a.M(t))throw new it(t,"Transition error [before/after/enter]")}))},s=!1,o=l((function(){return Promise.resolve(a.j("beforeLeave",e,c)).then((function(){return Promise.resolve(Promise.all([a.leave(e,c),O(n,e)]).then((function(t){return t[0]}))).then((function(t){return s=t,Promise.resolve(a.j("afterLeave",e,c)).then((function(){}))}))}))}),(function(t){if(a.M(t))throw new it(t,"Transition error [before/after/leave]")}));return o&&o.then?o.then(r):r(o)}();return s&&s.then?s.then(r):r(s)}))}var r=function(){if(u)return Promise.resolve(O(n,e)).then((function(){}))}();return r&&r.then?r.then(t):t()}),(function(t){if(a.S=!1,t.name&&"BarbaError"===t.name)throw a.logger.debug(t.label),a.logger.error(t.error),t;throw a.logger.debug("Transition error [page]"),a.logger.error(t),t}));return Promise.resolve(h&&h.then?h.then(s):s(h))}catch(t){return Promise.reject(t)}},r.once=function(t,e){try{return Promise.resolve(V.do("once",t,e)).then((function(){return e.once?H(e.once,e)(t):Promise.resolve()}))}catch(t){return Promise.reject(t)}},r.leave=function(t,e){try{return Promise.resolve(V.do("leave",t,e)).then((function(){return e.leave?H(e.leave,e)(t):Promise.resolve()}))}catch(t){return Promise.reject(t)}},r.enter=function(t,e,r){try{return Promise.resolve(V.do("enter",t,e)).then((function(){return e.enter?H(e.enter,e)(t,r):Promise.resolve()}))}catch(t){return Promise.reject(t)}},r.add=function(t,e){try{return I.addContainer(t.next.container,e),V.do("nextAdded",t),Promise.resolve()}catch(t){return Promise.reject(t)}},r.remove=function(t){try{return I.removeContainer(t.current.container),V.do("currentRemoved",t),Promise.resolve()}catch(t){return Promise.reject(t)}},r.M=function(t){return t.message?!/Timeout error|Fetch error/.test(t.message):!t.status},r.j=function(t,e,r){try{return Promise.resolve(V.do(t,e,r)).then((function(){return r[t]?H(r[t],r)(e):Promise.resolve()}))}catch(t){return Promise.reject(t)}},e(t,[{key:"isRunning",get:function(){return this.S},set:function(t){this.S=t}},{key:"hasOnce",get:function(){return this.store.once.length>0}},{key:"hasSelf",get:function(){return this.store.all.some((function(t){return"self"===t.name}))}},{key:"shouldWait",get:function(){return this.store.all.some((function(t){return t.to&&!t.to.route||t.sync}))}}]),t}(),at=function(){function t(t){var e=this;this.names=["beforeLeave","afterLeave","beforeEnter","afterEnter"],this.byNamespace=new Map,0!==t.length&&(t.forEach((function(t){e.byNamespace.set(t.namespace,t)})),this.names.forEach((function(t){V[t](e.L(t))})))}return t.prototype.L=function(t){var e=this;return function(r){var n=t.match(/enter/i)?r.next:r.current,i=e.byNamespace.get(n.namespace);return i&&i[t]?H(i[t],i)(r):Promise.resolve()}},t}();Element.prototype.matches||(Element.prototype.matches=Element.prototype.msMatchesSelector||Element.prototype.webkitMatchesSelector),Element.prototype.closest||(Element.prototype.closest=function(t){var e=this;do{if(e.matches(t))return e;e=e.parentElement||e.parentNode}while(null!==e&&1===e.nodeType);return null});var lt={container:null,html:"",namespace:"",url:{hash:"",href:"",path:"",port:null,query:{}}};return new(function(){function t(){this.version=u,this.schemaPage=lt,this.Logger=f,this.logger=new f("@barba/core"),this.plugins=[],this.hooks=V,this.dom=I,this.helpers=C,this.history=R,this.request=j,this.url=$}var n=t.prototype;return n.use=function(t,e){var r=this.plugins;r.indexOf(t)>-1?this.logger.warn("Plugin ["+t.name+"] already installed."):"function"==typeof t.install?(t.install(this,e),r.push(t)):this.logger.warn("Plugin ["+t.name+'] has no "install" method.')},n.init=function(t){var e=void 0===t?{}:t,n=e.transitions,i=void 0===n?[]:n,s=e.views,o=void 0===s?[]:s,a=e.schema,l=void 0===a?P:a,c=e.requestError,u=e.timeout,h=void 0===u?2e3:u,d=e.cacheIgnore,p=void 0!==d&&d,g=e.prefetchIgnore,m=void 0!==g&&g,y=e.preventRunning,v=void 0!==y&&y,b=e.prevent,E=void 0===b?null:b,A=e.debug,w=e.logLevel;if(f.setLevel(!0===(void 0!==A&&A)?"debug":void 0===w?"off":w),this.logger.info(this.version),Object.keys(l).forEach((function(t){P[t]&&(P[t]=l[t])})),this.$=c,this.timeout=h,this.cacheIgnore=p,this.prefetchIgnore=m,this.preventRunning=v,this._=this.dom.getWrapper(),!this._)throw new Error("[@barba/core] No Barba wrapper found");this._.setAttribute("aria-live","polite"),this.q();var T=this.data.current;if(!T.container)throw new Error("[@barba/core] No Barba container found");if(this.cache=new Y(p),this.prevent=new nt(m),this.transitions=new ot(i),this.views=new at(o),null!==E){if("function"!=typeof E)throw new Error("[@barba/core] Prevent should be a function");this.prevent.add("preventCustom",E)}this.history.init(T.url.href,T.namespace),this.B=this.B.bind(this),this.U=this.U.bind(this),this.D=this.D.bind(this),this.F(),this.plugins.forEach((function(t){return t.init()}));var S=this.data;S.trigger="barba",S.next=S.current,S.current=r({},this.schemaPage),this.hooks.do("ready",S),this.once(S),this.q()},n.destroy=function(){this.q(),this.H(),this.history.clear(),this.hooks.clear(),this.plugins=[]},n.force=function(t){window.location.assign(t)},n.go=function(t,e,r){var n;if(void 0===e&&(e="barba"),this.transitions.isRunning)this.force(t);else if(!(n="popstate"===e?this.history.current&&this.url.getPath(this.history.current.url)===this.url.getPath(t):this.prevent.run("sameUrl",null,null,t))||this.transitions.hasSelf)return e=this.history.change(t,e,r),r&&(r.stopPropagation(),r.preventDefault()),this.page(t,e,n)},n.once=function(t){try{var e=this;return Promise.resolve(e.hooks.do("beforeEnter",t)).then((function(){function r(){return Promise.resolve(e.hooks.do("afterEnter",t)).then((function(){}))}var n=function(){if(e.transitions.hasOnce){var r=e.transitions.get(t,{once:!0});return Promise.resolve(e.transitions.doOnce({transition:r,data:t})).then((function(){}))}}();return n&&n.then?n.then(r):r()}))}catch(t){return Promise.reject(t)}},n.page=function(t,e,n){try{var i=function(){var t=s.data;return Promise.resolve(s.hooks.do("page",t)).then((function(){var e=l((function(){var e=s.transitions.get(t,{once:!1,self:n});return Promise.resolve(s.transitions.doPage({data:t,page:o,transition:e,wrapper:s._})).then((function(){s.q()}))}),(function(){0===f.getLevel()&&s.force(t.current.url.href)}));if(e&&e.then)return e.then((function(){}))}))},s=this;s.data.next.url=r({href:t},s.url.parse(t)),s.data.trigger=e;var o=s.cache.has(t)?s.cache.update(t,{action:"click"}).request:s.cache.set(t,s.request(t,s.timeout,s.onRequestError.bind(s,e)),"click").request,a=function(){if(s.transitions.shouldWait)return Promise.resolve(O(o,s.data)).then((function(){}))}();return Promise.resolve(a&&a.then?a.then(i):i())}catch(t){return Promise.reject(t)}},n.onRequestError=function(t){this.transitions.isRunning=!1;for(var e=arguments.length,r=new Array(e>1?e-1:0),n=1;n<e;n++)r[n-1]=arguments[n];var i=r[0],s=r[1],o=this.cache.getAction(i);return this.cache.delete(i),!(this.$&&!1===this.$(t,o,i,s)||("click"===o&&this.force(i),1))},n.prefetch=function(t){var e=this;this.cache.has(t)||this.cache.set(t,this.request(t,this.timeout,this.onRequestError.bind(this,"barba")).catch((function(t){e.logger.error(t)})),"prefetch")},n.F=function(){!0!==this.prefetchIgnore&&(document.addEventListener("mouseover",this.B),document.addEventListener("touchstart",this.B)),document.addEventListener("click",this.U),window.addEventListener("popstate",this.D)},n.H=function(){!0!==this.prefetchIgnore&&(document.removeEventListener("mouseover",this.B),document.removeEventListener("touchstart",this.B)),document.removeEventListener("click",this.U),window.removeEventListener("popstate",this.D)},n.B=function(t){var e=this,r=this.I(t);if(r){var n=this.dom.getHref(r);this.prevent.checkHref(n)||this.cache.has(n)||this.cache.set(n,this.request(n,this.timeout,this.onRequestError.bind(this,r)).catch((function(t){e.logger.error(t)})),"enter")}},n.U=function(t){var e=this.I(t);if(e)return this.transitions.isRunning&&this.preventRunning?(t.preventDefault(),void t.stopPropagation()):void this.go(this.dom.getHref(e),e,t)},n.D=function(t){this.go(this.url.getHref(),"popstate",t)},n.I=function(t){for(var e=t.target;e&&!this.dom.getHref(e);)e=e.parentNode;if(e&&!this.prevent.checkLink(e,t,this.dom.getHref(e)))return e},n.q=function(){var t=this.url.getHref(),e={container:this.dom.getContainer(),html:this.dom.getHtml(),namespace:this.dom.getNamespace(),url:r({href:t},this.url.parse(t))};this.C={current:e,next:r({},this.schemaPage),trigger:void 0},this.hooks.do("reset",this.data)},e(t,[{key:"data",get:function(){return this.C}},{key:"wrapper",get:function(){return this._}}]),t}())}()},9989:(t,e,r)=>{"use strict";function n(t){return n="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(t){return typeof t}:function(t){return t&&"function"==typeof Symbol&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t},n(t)}function i(t,e){for(var r=0;r<e.length;r++){var i=e[r];i.enumerable=i.enumerable||!1,i.configurable=!0,"value"in i&&(i.writable=!0),Object.defineProperty(t,(s=i.key,o=void 0,o=function(t,e){if("object"!==n(t)||null===t)return t;var r=t[Symbol.toPrimitive];if(void 0!==r){var i=r.call(t,e||"default");if("object"!==n(i))return i;throw new TypeError("@@toPrimitive must return a primitive value.")}return("string"===e?String:Number)(t)}(s,"string"),"symbol"===n(o)?o:String(o)),i)}var s,o}r.d(e,{A:()=>s});var s=function(){return t=function t(e){var r=this;!function(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}(this,t),this.video=e,this.width=this.video.getBoundingClientRect().width*window.devicePixelRatio,this.handlePoster(),this.video.addEventListener("play-video",(function(){r.playVideo()})),this.video.addEventListener("pause-video",(function(){r.pauseVideo()})),this.pickSource()},(e=[{key:"handlePoster",value:function(){this.videoParent=this.video.closest(".c-img-video"),this.videoParent}},{key:"pickSource",value:function(){var t=this;this.matchedSource=null,this.prevDiff=999999,this.sourceCount=this.video.children.length,this.removedSources=0,new Promise((function(e,r){t.video.children&&Array.from(t.video.children).forEach((function(r){var n=r.dataset.sourcewidth-t.width;n<=0&&(n*=-1),n<=t.prevDiff&&(t.matchedSource=r),t.prevDiff=n,setTimeout((function(){r.remove(),t.removedSources++,t.removedSources>=t.sourceCount&&e("Removed All Sources")}),0)}))})).then((function(){t.video&&(t.video.src=t.matchedSource.src)}))}},{key:"playVideo",value:function(){var t=this;this.tryIntervalFunction(),this.tryInterval=setInterval((function(){t.tryIntervalFunction()}),1e3)}},{key:"tryIntervalFunction",value:function(){var t=this,e=this.video.play();void 0!==e&&e.then((function(){t.video.classList.add("has-played"),t.videoParent&&(t.videoParent.classList.add("c-img-video--playing"),t.videoParent.classList.remove("c-img-video--error"));var e=setInterval((function(){t.video.paused?(t.video.play(),t.video.classList.remove("is-paused")):(clearInterval(t.tryInterval),clearInterval(e))}),10)})).catch((function(e){t.videoParent&&(t.videoParent.classList.remove("c-img-video--playing"),t.videoParent.classList.add("c-img-video--error"))}))}},{key:"pauseVideo",value:function(){this.video.pause(),this.video.classList.add("is-paused")}}])&&i(t.prototype,e),r&&i(t,r),Object.defineProperty(t,"prototype",{writable:!1}),t;var t,e,r}()},2473:(t,e,r)=>{"use strict";r.d(e,{A:()=>c});var n=r(4330),i=r.n(n),s=r(4062),o=r(4945);function a(t){return a="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(t){return typeof t}:function(t){return t&&"function"==typeof Symbol&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t},a(t)}function l(t,e){for(var r=0;r<e.length;r++){var n=e[r];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(t,(i=n.key,s=void 0,s=function(t,e){if("object"!==a(t)||null===t)return t;var r=t[Symbol.toPrimitive];if(void 0!==r){var n=r.call(t,e||"default");if("object"!==a(n))return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return("string"===e?String:Number)(t)}(i,"string"),"symbol"===a(s)?s:String(s)),n)}var i,s}var c=function(){return t=function t(e){!function(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}(this,t),this.video=e,this.volumeTippies=[],this.element=null,this.player=null,this.videoHasPlayed=!1,this.posterHidden=!1,this.breakpoint=window.matchMedia("(max-width:991px)")},(e=[{key:"init",value:function(){var t=this;return new Promise((function(e){t.element=t.video.closest(".c-video-player"),t.poster=t.element.querySelector(".c-video-player__poster");var r=["play","current-time","progress","duration","captions","settings","mute","volume","fullscreen"],n=["captions","quality"],a=t.video.dataset.hlsSrc;o.Ay.isSupported()&&(t.hls=new o.Ay({capLevelToPlayerSize:!0}),t.hls.on(o.Ay.Events.MANIFEST_PARSED,(function(){var o=[2160,1440,1080,720,540,360],a=t.hls.levels.map((function(t){return t.height})).filter((function(t){return o.includes(t)})).sort((function(t,e){return e-t}));t.player=new(i())(t.video,{controls:r,seekTime:10,volume:1,settings:n,captions:{active:!0,update:!0},quality:{default:t.breakpoint.matches?540:720,options:a,forced:!0,onChange:function(e){t.hls.levels.forEach((function(r,n){r.height===e&&(t.hls.currentLevel=n)}))}},tooltips:{controls:!1,seek:!0},iconUrl:window.WPURLS.themeUrl+"/symbols.svg",loadSprite:!0,iconPrefix:"plyr",hideControls:!0,debug:!1}),t.element.addEventListener("click",(function(e){e.target.closest("[data-play]")&&t.togglePlay()})),t.player.on("pause",(function(e){t.element.classList.remove("is-playing")})),t.player.on("playing",(function(e){t.hidePoster(),t.videoHasPlayed||(t.videoHasPlayed=!0,t.element.classList.add("has-played"))})),t.player.on("ready",(function(){e(),t.volumeTippies&&t.volumeTippies.forEach((function(t){return t.destroy()})),t.volumeTippies=(0,s.Ay)(t.element.querySelectorAll('[data-plyr="mute"]'),{content:function(t){return t.nextElementSibling},allowHTML:!0,interactive:!0,placement:"top",theme:"volume-slider",arrow:!1,zIndex:-1,offset:[0,-34]})}))})),t.hls.loadSource(a),t.hls.attachMedia(t.video))}))}},{key:"checkPlayer",value:function(){this.player}},{key:"togglePlay",value:function(){this.checkPlayer(),this.player.togglePlay()}},{key:"play",value:function(){this.checkPlayer(),this.player.play()}},{key:"pause",value:function(){this.checkPlayer(),this.player.pause()}},{key:"hidePoster",value:function(){this.poster&&!this.posterHidden&&(this.poster.classList.remove("is-active"),this.posterHidden=!0)}}])&&l(t.prototype,e),r&&l(t,r),Object.defineProperty(t,"prototype",{writable:!1}),t;var t,e,r}()},3193:(t,e,r)=>{"use strict";r(6879),r(2552);var n=r(6714),i=r.n(n),s=r(8150);function o(t){return o="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(t){return typeof t}:function(t){return t&&"function"==typeof Symbol&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t},o(t)}function a(){a=function(){return t};var t={},e=Object.prototype,r=e.hasOwnProperty,n=Object.defineProperty||function(t,e,r){t[e]=r.value},i="function"==typeof Symbol?Symbol:{},s=i.iterator||"@@iterator",l=i.asyncIterator||"@@asyncIterator",c=i.toStringTag||"@@toStringTag";function u(t,e,r){return Object.defineProperty(t,e,{value:r,enumerable:!0,configurable:!0,writable:!0}),t[e]}try{u({},"")}catch(t){u=function(t,e,r){return t[e]=r}}function h(t,e,r,i){var s=e&&e.prototype instanceof p?e:p,o=Object.create(s.prototype),a=new x(i||[]);return n(o,"_invoke",{value:T(t,r,a)}),o}function d(t,e,r){try{return{type:"normal",arg:t.call(e,r)}}catch(t){return{type:"throw",arg:t}}}t.wrap=h;var f={};function p(){}function g(){}function m(){}var y={};u(y,s,(function(){return this}));var v=Object.getPrototypeOf,b=v&&v(v(k([])));b&&b!==e&&r.call(b,s)&&(y=b);var E=m.prototype=p.prototype=Object.create(y);function A(t){["next","throw","return"].forEach((function(e){u(t,e,(function(t){return this._invoke(e,t)}))}))}function w(t,e){function i(n,s,a,l){var c=d(t[n],t,s);if("throw"!==c.type){var u=c.arg,h=u.value;return h&&"object"==o(h)&&r.call(h,"__await")?e.resolve(h.__await).then((function(t){i("next",t,a,l)}),(function(t){i("throw",t,a,l)})):e.resolve(h).then((function(t){u.value=t,a(u)}),(function(t){return i("throw",t,a,l)}))}l(c.arg)}var s;n(this,"_invoke",{value:function(t,r){function n(){return new e((function(e,n){i(t,r,e,n)}))}return s=s?s.then(n,n):n()}})}function T(t,e,r){var n="suspendedStart";return function(i,s){if("executing"===n)throw new Error("Generator is already running");if("completed"===n){if("throw"===i)throw s;return P()}for(r.method=i,r.arg=s;;){var o=r.delegate;if(o){var a=S(o,r);if(a){if(a===f)continue;return a}}if("next"===r.method)r.sent=r._sent=r.arg;else if("throw"===r.method){if("suspendedStart"===n)throw n="completed",r.arg;r.dispatchException(r.arg)}else"return"===r.method&&r.abrupt("return",r.arg);n="executing";var l=d(t,e,r);if("normal"===l.type){if(n=r.done?"completed":"suspendedYield",l.arg===f)continue;return{value:l.arg,done:r.done}}"throw"===l.type&&(n="completed",r.method="throw",r.arg=l.arg)}}}function S(t,e){var r=e.method,n=t.iterator[r];if(void 0===n)return e.delegate=null,"throw"===r&&t.iterator.return&&(e.method="return",e.arg=void 0,S(t,e),"throw"===e.method)||"return"!==r&&(e.method="throw",e.arg=new TypeError("The iterator does not provide a '"+r+"' method")),f;var i=d(n,t.iterator,e.arg);if("throw"===i.type)return e.method="throw",e.arg=i.arg,e.delegate=null,f;var s=i.arg;return s?s.done?(e[t.resultName]=s.value,e.next=t.nextLoc,"return"!==e.method&&(e.method="next",e.arg=void 0),e.delegate=null,f):s:(e.method="throw",e.arg=new TypeError("iterator result is not an object"),e.delegate=null,f)}function L(t){var e={tryLoc:t[0]};1 in t&&(e.catchLoc=t[1]),2 in t&&(e.finallyLoc=t[2],e.afterLoc=t[3]),this.tryEntries.push(e)}function _(t){var e=t.completion||{};e.type="normal",delete e.arg,t.completion=e}function x(t){this.tryEntries=[{tryLoc:"root"}],t.forEach(L,this),this.reset(!0)}function k(t){if(t){var e=t[s];if(e)return e.call(t);if("function"==typeof t.next)return t;if(!isNaN(t.length)){var n=-1,i=function e(){for(;++n<t.length;)if(r.call(t,n))return e.value=t[n],e.done=!1,e;return e.value=void 0,e.done=!0,e};return i.next=i}}return{next:P}}function P(){return{value:void 0,done:!0}}return g.prototype=m,n(E,"constructor",{value:m,configurable:!0}),n(m,"constructor",{value:g,configurable:!0}),g.displayName=u(m,c,"GeneratorFunction"),t.isGeneratorFunction=function(t){var e="function"==typeof t&&t.constructor;return!!e&&(e===g||"GeneratorFunction"===(e.displayName||e.name))},t.mark=function(t){return Object.setPrototypeOf?Object.setPrototypeOf(t,m):(t.__proto__=m,u(t,c,"GeneratorFunction")),t.prototype=Object.create(E),t},t.awrap=function(t){return{__await:t}},A(w.prototype),u(w.prototype,l,(function(){return this})),t.AsyncIterator=w,t.async=function(e,r,n,i,s){void 0===s&&(s=Promise);var o=new w(h(e,r,n,i),s);return t.isGeneratorFunction(r)?o:o.next().then((function(t){return t.done?t.value:o.next()}))},A(E),u(E,c,"Generator"),u(E,s,(function(){return this})),u(E,"toString",(function(){return"[object Generator]"})),t.keys=function(t){var e=Object(t),r=[];for(var n in e)r.push(n);return r.reverse(),function t(){for(;r.length;){var n=r.pop();if(n in e)return t.value=n,t.done=!1,t}return t.done=!0,t}},t.values=k,x.prototype={constructor:x,reset:function(t){if(this.prev=0,this.next=0,this.sent=this._sent=void 0,this.done=!1,this.delegate=null,this.method="next",this.arg=void 0,this.tryEntries.forEach(_),!t)for(var e in this)"t"===e.charAt(0)&&r.call(this,e)&&!isNaN(+e.slice(1))&&(this[e]=void 0)},stop:function(){this.done=!0;var t=this.tryEntries[0].completion;if("throw"===t.type)throw t.arg;return this.rval},dispatchException:function(t){if(this.done)throw t;var e=this;function n(r,n){return o.type="throw",o.arg=t,e.next=r,n&&(e.method="next",e.arg=void 0),!!n}for(var i=this.tryEntries.length-1;i>=0;--i){var s=this.tryEntries[i],o=s.completion;if("root"===s.tryLoc)return n("end");if(s.tryLoc<=this.prev){var a=r.call(s,"catchLoc"),l=r.call(s,"finallyLoc");if(a&&l){if(this.prev<s.catchLoc)return n(s.catchLoc,!0);if(this.prev<s.finallyLoc)return n(s.finallyLoc)}else if(a){if(this.prev<s.catchLoc)return n(s.catchLoc,!0)}else{if(!l)throw new Error("try statement without catch or finally");if(this.prev<s.finallyLoc)return n(s.finallyLoc)}}}},abrupt:function(t,e){for(var n=this.tryEntries.length-1;n>=0;--n){var i=this.tryEntries[n];if(i.tryLoc<=this.prev&&r.call(i,"finallyLoc")&&this.prev<i.finallyLoc){var s=i;break}}s&&("break"===t||"continue"===t)&&s.tryLoc<=e&&e<=s.finallyLoc&&(s=null);var o=s?s.completion:{};return o.type=t,o.arg=e,s?(this.method="next",this.next=s.finallyLoc,f):this.complete(o)},complete:function(t,e){if("throw"===t.type)throw t.arg;return"break"===t.type||"continue"===t.type?this.next=t.arg:"return"===t.type?(this.rval=this.arg=t.arg,this.method="return",this.next="end"):"normal"===t.type&&e&&(this.next=e),f},finish:function(t){for(var e=this.tryEntries.length-1;e>=0;--e){var r=this.tryEntries[e];if(r.finallyLoc===t)return this.complete(r.completion,r.afterLoc),_(r),f}},catch:function(t){for(var e=this.tryEntries.length-1;e>=0;--e){var r=this.tryEntries[e];if(r.tryLoc===t){var n=r.completion;if("throw"===n.type){var i=n.arg;_(r)}return i}}throw new Error("illegal catch attempt")},delegateYield:function(t,e,r){return this.delegate={iterator:k(t),resultName:e,nextLoc:r},"next"===this.method&&(this.arg=void 0),f}},t}function l(t,e,r,n,i,s,o){try{var a=t[s](o),l=a.value}catch(t){return void r(t)}a.done?e(l):Promise.resolve(l).then(n,i)}var c=null;const u={namespace:"home-old",beforeEnter:(h=a().mark((function t(e){var n,i,o,l,u;return a().wrap((function(t){for(;;)switch(t.prev=t.next){case 0:return n=e.current,i=e.next,e.trigger,t.next=3,(0,s.y6)(WPURLS.themeUrl+"/dist/css/_home-old.css");case 3:return t.next=5,Promise.all([r.e(812),r.e(5927),r.e(9229),r.e(7962)]).then(r.bind(r,9173));case 5:o=t.sent,l=o.default,c=new l(i.container),null!=n.container&&((u=document.querySelector(".c-header--frontpage")).classList.add("c-header--frontpage--before-animation"),u.querySelector(".c-header-menu").classList.add("c-header-menu--visible"),i.container.classList.add("home--visible")),c.init();case 10:case"end":return t.stop()}}),t)})),d=function(){var t=this,e=arguments;return new Promise((function(r,n){var i=h.apply(t,e);function s(t){l(i,r,n,s,o,"next",t)}function o(t){l(i,r,n,s,o,"throw",t)}s(void 0)}))},function(t){return d.apply(this,arguments)}),afterEnter:function(t){t.current,t.next,t.trigger},afterLeave:function(t){t.current,t.next,t.trigger;c.destroy(),c=null}};var h,d,f=r(738);function p(t){return p="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(t){return typeof t}:function(t){return t&&"function"==typeof Symbol&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t},p(t)}function g(){g=function(){return t};var t={},e=Object.prototype,r=e.hasOwnProperty,n=Object.defineProperty||function(t,e,r){t[e]=r.value},i="function"==typeof Symbol?Symbol:{},s=i.iterator||"@@iterator",o=i.asyncIterator||"@@asyncIterator",a=i.toStringTag||"@@toStringTag";function l(t,e,r){return Object.defineProperty(t,e,{value:r,enumerable:!0,configurable:!0,writable:!0}),t[e]}try{l({},"")}catch(t){l=function(t,e,r){return t[e]=r}}function c(t,e,r,i){var s=e&&e.prototype instanceof d?e:d,o=Object.create(s.prototype),a=new x(i||[]);return n(o,"_invoke",{value:T(t,r,a)}),o}function u(t,e,r){try{return{type:"normal",arg:t.call(e,r)}}catch(t){return{type:"throw",arg:t}}}t.wrap=c;var h={};function d(){}function f(){}function m(){}var y={};l(y,s,(function(){return this}));var v=Object.getPrototypeOf,b=v&&v(v(k([])));b&&b!==e&&r.call(b,s)&&(y=b);var E=m.prototype=d.prototype=Object.create(y);function A(t){["next","throw","return"].forEach((function(e){l(t,e,(function(t){return this._invoke(e,t)}))}))}function w(t,e){function i(n,s,o,a){var l=u(t[n],t,s);if("throw"!==l.type){var c=l.arg,h=c.value;return h&&"object"==p(h)&&r.call(h,"__await")?e.resolve(h.__await).then((function(t){i("next",t,o,a)}),(function(t){i("throw",t,o,a)})):e.resolve(h).then((function(t){c.value=t,o(c)}),(function(t){return i("throw",t,o,a)}))}a(l.arg)}var s;n(this,"_invoke",{value:function(t,r){function n(){return new e((function(e,n){i(t,r,e,n)}))}return s=s?s.then(n,n):n()}})}function T(t,e,r){var n="suspendedStart";return function(i,s){if("executing"===n)throw new Error("Generator is already running");if("completed"===n){if("throw"===i)throw s;return P()}for(r.method=i,r.arg=s;;){var o=r.delegate;if(o){var a=S(o,r);if(a){if(a===h)continue;return a}}if("next"===r.method)r.sent=r._sent=r.arg;else if("throw"===r.method){if("suspendedStart"===n)throw n="completed",r.arg;r.dispatchException(r.arg)}else"return"===r.method&&r.abrupt("return",r.arg);n="executing";var l=u(t,e,r);if("normal"===l.type){if(n=r.done?"completed":"suspendedYield",l.arg===h)continue;return{value:l.arg,done:r.done}}"throw"===l.type&&(n="completed",r.method="throw",r.arg=l.arg)}}}function S(t,e){var r=e.method,n=t.iterator[r];if(void 0===n)return e.delegate=null,"throw"===r&&t.iterator.return&&(e.method="return",e.arg=void 0,S(t,e),"throw"===e.method)||"return"!==r&&(e.method="throw",e.arg=new TypeError("The iterator does not provide a '"+r+"' method")),h;var i=u(n,t.iterator,e.arg);if("throw"===i.type)return e.method="throw",e.arg=i.arg,e.delegate=null,h;var s=i.arg;return s?s.done?(e[t.resultName]=s.value,e.next=t.nextLoc,"return"!==e.method&&(e.method="next",e.arg=void 0),e.delegate=null,h):s:(e.method="throw",e.arg=new TypeError("iterator result is not an object"),e.delegate=null,h)}function L(t){var e={tryLoc:t[0]};1 in t&&(e.catchLoc=t[1]),2 in t&&(e.finallyLoc=t[2],e.afterLoc=t[3]),this.tryEntries.push(e)}function _(t){var e=t.completion||{};e.type="normal",delete e.arg,t.completion=e}function x(t){this.tryEntries=[{tryLoc:"root"}],t.forEach(L,this),this.reset(!0)}function k(t){if(t){var e=t[s];if(e)return e.call(t);if("function"==typeof t.next)return t;if(!isNaN(t.length)){var n=-1,i=function e(){for(;++n<t.length;)if(r.call(t,n))return e.value=t[n],e.done=!1,e;return e.value=void 0,e.done=!0,e};return i.next=i}}return{next:P}}function P(){return{value:void 0,done:!0}}return f.prototype=m,n(E,"constructor",{value:m,configurable:!0}),n(m,"constructor",{value:f,configurable:!0}),f.displayName=l(m,a,"GeneratorFunction"),t.isGeneratorFunction=function(t){var e="function"==typeof t&&t.constructor;return!!e&&(e===f||"GeneratorFunction"===(e.displayName||e.name))},t.mark=function(t){return Object.setPrototypeOf?Object.setPrototypeOf(t,m):(t.__proto__=m,l(t,a,"GeneratorFunction")),t.prototype=Object.create(E),t},t.awrap=function(t){return{__await:t}},A(w.prototype),l(w.prototype,o,(function(){return this})),t.AsyncIterator=w,t.async=function(e,r,n,i,s){void 0===s&&(s=Promise);var o=new w(c(e,r,n,i),s);return t.isGeneratorFunction(r)?o:o.next().then((function(t){return t.done?t.value:o.next()}))},A(E),l(E,a,"Generator"),l(E,s,(function(){return this})),l(E,"toString",(function(){return"[object Generator]"})),t.keys=function(t){var e=Object(t),r=[];for(var n in e)r.push(n);return r.reverse(),function t(){for(;r.length;){var n=r.pop();if(n in e)return t.value=n,t.done=!1,t}return t.done=!0,t}},t.values=k,x.prototype={constructor:x,reset:function(t){if(this.prev=0,this.next=0,this.sent=this._sent=void 0,this.done=!1,this.delegate=null,this.method="next",this.arg=void 0,this.tryEntries.forEach(_),!t)for(var e in this)"t"===e.charAt(0)&&r.call(this,e)&&!isNaN(+e.slice(1))&&(this[e]=void 0)},stop:function(){this.done=!0;var t=this.tryEntries[0].completion;if("throw"===t.type)throw t.arg;return this.rval},dispatchException:function(t){if(this.done)throw t;var e=this;function n(r,n){return o.type="throw",o.arg=t,e.next=r,n&&(e.method="next",e.arg=void 0),!!n}for(var i=this.tryEntries.length-1;i>=0;--i){var s=this.tryEntries[i],o=s.completion;if("root"===s.tryLoc)return n("end");if(s.tryLoc<=this.prev){var a=r.call(s,"catchLoc"),l=r.call(s,"finallyLoc");if(a&&l){if(this.prev<s.catchLoc)return n(s.catchLoc,!0);if(this.prev<s.finallyLoc)return n(s.finallyLoc)}else if(a){if(this.prev<s.catchLoc)return n(s.catchLoc,!0)}else{if(!l)throw new Error("try statement without catch or finally");if(this.prev<s.finallyLoc)return n(s.finallyLoc)}}}},abrupt:function(t,e){for(var n=this.tryEntries.length-1;n>=0;--n){var i=this.tryEntries[n];if(i.tryLoc<=this.prev&&r.call(i,"finallyLoc")&&this.prev<i.finallyLoc){var s=i;break}}s&&("break"===t||"continue"===t)&&s.tryLoc<=e&&e<=s.finallyLoc&&(s=null);var o=s?s.completion:{};return o.type=t,o.arg=e,s?(this.method="next",this.next=s.finallyLoc,h):this.complete(o)},complete:function(t,e){if("throw"===t.type)throw t.arg;return"break"===t.type||"continue"===t.type?this.next=t.arg:"return"===t.type?(this.rval=this.arg=t.arg,this.method="return",this.next="end"):"normal"===t.type&&e&&(this.next=e),h},finish:function(t){for(var e=this.tryEntries.length-1;e>=0;--e){var r=this.tryEntries[e];if(r.finallyLoc===t)return this.complete(r.completion,r.afterLoc),_(r),h}},catch:function(t){for(var e=this.tryEntries.length-1;e>=0;--e){var r=this.tryEntries[e];if(r.tryLoc===t){var n=r.completion;if("throw"===n.type){var i=n.arg;_(r)}return i}}throw new Error("illegal catch attempt")},delegateYield:function(t,e,r){return this.delegate={iterator:k(t),resultName:e,nextLoc:r},"next"===this.method&&(this.arg=void 0),h}},t}function m(t,e,r,n,i,s,o){try{var a=t[s](o),l=a.value}catch(t){return void r(t)}a.done?e(l):Promise.resolve(l).then(n,i)}var y=null;const v={namespace:"home",beforeEnter:function(){var t=function(t){return function(){var e=this,r=arguments;return new Promise((function(n,i){var s=t.apply(e,r);function o(t){m(s,n,i,o,a,"next",t)}function a(t){m(s,n,i,o,a,"throw",t)}o(void 0)}))}}(g().mark((function t(e){var n,i,o,a,l,c;return g().wrap((function(t){for(;;)switch(t.prev=t.next){case 0:return n=e.current,i=e.next,e.trigger,t.next=3,(0,s.y6)(WPURLS.themeUrl+"/dist/css/_home.css");case 3:return o=document.querySelector("[data-home-intro]"),null!=n.container?o.remove():(a=o.querySelectorAll("path, g"),f.os.to(a,{autoAlpha:1,duration:0,stagger:{each:.1},ease:"linear",onComplete:function(){f.os.to(o,{autoAlpha:0,duration:1,delay:.3,ease:"none",onComplete:function(){o.remove()}})}})),t.next=7,Promise.all([r.e(812),r.e(5927),r.e(9229),r.e(7962)]).then(r.bind(r,6579));case 7:l=t.sent,c=l.default,(y=new c(i.container)).init();case 11:case"end":return t.stop()}}),t)})));return function(e){return t.apply(this,arguments)}}(),afterLeave:function(t){t.current,t.next,t.trigger;y.destroy(),y=null}};function b(t){return b="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(t){return typeof t}:function(t){return t&&"function"==typeof Symbol&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t},b(t)}function E(){E=function(){return t};var t={},e=Object.prototype,r=e.hasOwnProperty,n=Object.defineProperty||function(t,e,r){t[e]=r.value},i="function"==typeof Symbol?Symbol:{},s=i.iterator||"@@iterator",o=i.asyncIterator||"@@asyncIterator",a=i.toStringTag||"@@toStringTag";function l(t,e,r){return Object.defineProperty(t,e,{value:r,enumerable:!0,configurable:!0,writable:!0}),t[e]}try{l({},"")}catch(t){l=function(t,e,r){return t[e]=r}}function c(t,e,r,i){var s=e&&e.prototype instanceof d?e:d,o=Object.create(s.prototype),a=new x(i||[]);return n(o,"_invoke",{value:T(t,r,a)}),o}function u(t,e,r){try{return{type:"normal",arg:t.call(e,r)}}catch(t){return{type:"throw",arg:t}}}t.wrap=c;var h={};function d(){}function f(){}function p(){}var g={};l(g,s,(function(){return this}));var m=Object.getPrototypeOf,y=m&&m(m(k([])));y&&y!==e&&r.call(y,s)&&(g=y);var v=p.prototype=d.prototype=Object.create(g);function A(t){["next","throw","return"].forEach((function(e){l(t,e,(function(t){return this._invoke(e,t)}))}))}function w(t,e){function i(n,s,o,a){var l=u(t[n],t,s);if("throw"!==l.type){var c=l.arg,h=c.value;return h&&"object"==b(h)&&r.call(h,"__await")?e.resolve(h.__await).then((function(t){i("next",t,o,a)}),(function(t){i("throw",t,o,a)})):e.resolve(h).then((function(t){c.value=t,o(c)}),(function(t){return i("throw",t,o,a)}))}a(l.arg)}var s;n(this,"_invoke",{value:function(t,r){function n(){return new e((function(e,n){i(t,r,e,n)}))}return s=s?s.then(n,n):n()}})}function T(t,e,r){var n="suspendedStart";return function(i,s){if("executing"===n)throw new Error("Generator is already running");if("completed"===n){if("throw"===i)throw s;return P()}for(r.method=i,r.arg=s;;){var o=r.delegate;if(o){var a=S(o,r);if(a){if(a===h)continue;return a}}if("next"===r.method)r.sent=r._sent=r.arg;else if("throw"===r.method){if("suspendedStart"===n)throw n="completed",r.arg;r.dispatchException(r.arg)}else"return"===r.method&&r.abrupt("return",r.arg);n="executing";var l=u(t,e,r);if("normal"===l.type){if(n=r.done?"completed":"suspendedYield",l.arg===h)continue;return{value:l.arg,done:r.done}}"throw"===l.type&&(n="completed",r.method="throw",r.arg=l.arg)}}}function S(t,e){var r=e.method,n=t.iterator[r];if(void 0===n)return e.delegate=null,"throw"===r&&t.iterator.return&&(e.method="return",e.arg=void 0,S(t,e),"throw"===e.method)||"return"!==r&&(e.method="throw",e.arg=new TypeError("The iterator does not provide a '"+r+"' method")),h;var i=u(n,t.iterator,e.arg);if("throw"===i.type)return e.method="throw",e.arg=i.arg,e.delegate=null,h;var s=i.arg;return s?s.done?(e[t.resultName]=s.value,e.next=t.nextLoc,"return"!==e.method&&(e.method="next",e.arg=void 0),e.delegate=null,h):s:(e.method="throw",e.arg=new TypeError("iterator result is not an object"),e.delegate=null,h)}function L(t){var e={tryLoc:t[0]};1 in t&&(e.catchLoc=t[1]),2 in t&&(e.finallyLoc=t[2],e.afterLoc=t[3]),this.tryEntries.push(e)}function _(t){var e=t.completion||{};e.type="normal",delete e.arg,t.completion=e}function x(t){this.tryEntries=[{tryLoc:"root"}],t.forEach(L,this),this.reset(!0)}function k(t){if(t){var e=t[s];if(e)return e.call(t);if("function"==typeof t.next)return t;if(!isNaN(t.length)){var n=-1,i=function e(){for(;++n<t.length;)if(r.call(t,n))return e.value=t[n],e.done=!1,e;return e.value=void 0,e.done=!0,e};return i.next=i}}return{next:P}}function P(){return{value:void 0,done:!0}}return f.prototype=p,n(v,"constructor",{value:p,configurable:!0}),n(p,"constructor",{value:f,configurable:!0}),f.displayName=l(p,a,"GeneratorFunction"),t.isGeneratorFunction=function(t){var e="function"==typeof t&&t.constructor;return!!e&&(e===f||"GeneratorFunction"===(e.displayName||e.name))},t.mark=function(t){return Object.setPrototypeOf?Object.setPrototypeOf(t,p):(t.__proto__=p,l(t,a,"GeneratorFunction")),t.prototype=Object.create(v),t},t.awrap=function(t){return{__await:t}},A(w.prototype),l(w.prototype,o,(function(){return this})),t.AsyncIterator=w,t.async=function(e,r,n,i,s){void 0===s&&(s=Promise);var o=new w(c(e,r,n,i),s);return t.isGeneratorFunction(r)?o:o.next().then((function(t){return t.done?t.value:o.next()}))},A(v),l(v,a,"Generator"),l(v,s,(function(){return this})),l(v,"toString",(function(){return"[object Generator]"})),t.keys=function(t){var e=Object(t),r=[];for(var n in e)r.push(n);return r.reverse(),function t(){for(;r.length;){var n=r.pop();if(n in e)return t.value=n,t.done=!1,t}return t.done=!0,t}},t.values=k,x.prototype={constructor:x,reset:function(t){if(this.prev=0,this.next=0,this.sent=this._sent=void 0,this.done=!1,this.delegate=null,this.method="next",this.arg=void 0,this.tryEntries.forEach(_),!t)for(var e in this)"t"===e.charAt(0)&&r.call(this,e)&&!isNaN(+e.slice(1))&&(this[e]=void 0)},stop:function(){this.done=!0;var t=this.tryEntries[0].completion;if("throw"===t.type)throw t.arg;return this.rval},dispatchException:function(t){if(this.done)throw t;var e=this;function n(r,n){return o.type="throw",o.arg=t,e.next=r,n&&(e.method="next",e.arg=void 0),!!n}for(var i=this.tryEntries.length-1;i>=0;--i){var s=this.tryEntries[i],o=s.completion;if("root"===s.tryLoc)return n("end");if(s.tryLoc<=this.prev){var a=r.call(s,"catchLoc"),l=r.call(s,"finallyLoc");if(a&&l){if(this.prev<s.catchLoc)return n(s.catchLoc,!0);if(this.prev<s.finallyLoc)return n(s.finallyLoc)}else if(a){if(this.prev<s.catchLoc)return n(s.catchLoc,!0)}else{if(!l)throw new Error("try statement without catch or finally");if(this.prev<s.finallyLoc)return n(s.finallyLoc)}}}},abrupt:function(t,e){for(var n=this.tryEntries.length-1;n>=0;--n){var i=this.tryEntries[n];if(i.tryLoc<=this.prev&&r.call(i,"finallyLoc")&&this.prev<i.finallyLoc){var s=i;break}}s&&("break"===t||"continue"===t)&&s.tryLoc<=e&&e<=s.finallyLoc&&(s=null);var o=s?s.completion:{};return o.type=t,o.arg=e,s?(this.method="next",this.next=s.finallyLoc,h):this.complete(o)},complete:function(t,e){if("throw"===t.type)throw t.arg;return"break"===t.type||"continue"===t.type?this.next=t.arg:"return"===t.type?(this.rval=this.arg=t.arg,this.method="return",this.next="end"):"normal"===t.type&&e&&(this.next=e),h},finish:function(t){for(var e=this.tryEntries.length-1;e>=0;--e){var r=this.tryEntries[e];if(r.finallyLoc===t)return this.complete(r.completion,r.afterLoc),_(r),h}},catch:function(t){for(var e=this.tryEntries.length-1;e>=0;--e){var r=this.tryEntries[e];if(r.tryLoc===t){var n=r.completion;if("throw"===n.type){var i=n.arg;_(r)}return i}}throw new Error("illegal catch attempt")},delegateYield:function(t,e,r){return this.delegate={iterator:k(t),resultName:e,nextLoc:r},"next"===this.method&&(this.arg=void 0),h}},t}function A(t,e,r,n,i,s,o){try{var a=t[s](o),l=a.value}catch(t){return void r(t)}a.done?e(l):Promise.resolve(l).then(n,i)}var w=null;const T={namespace:"single-interview",beforeEnter:function(){var t=function(t){return function(){var e=this,r=arguments;return new Promise((function(n,i){var s=t.apply(e,r);function o(t){A(s,n,i,o,a,"next",t)}function a(t){A(s,n,i,o,a,"throw",t)}o(void 0)}))}}(E().mark((function t(e){var n,i,o;return E().wrap((function(t){for(;;)switch(t.prev=t.next){case 0:return e.current,n=e.next,e.trigger,t.next=3,(0,s.y6)(WPURLS.themeUrl+"/dist/css/_interview.css");case 3:return t.next=5,Promise.all([r.e(812),r.e(5927),r.e(9229),r.e(1196)]).then(r.bind(r,388));case 5:i=t.sent,o=i.default,(w=new o(n.container)).init();case 9:case"end":return t.stop()}}),t)})));return function(e){return t.apply(this,arguments)}}(),afterLeave:function(t){t.current,t.next,t.trigger;w.destroy(),w=null,null}};function S(t){return S="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(t){return typeof t}:function(t){return t&&"function"==typeof Symbol&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t},S(t)}function L(){L=function(){return t};var t={},e=Object.prototype,r=e.hasOwnProperty,n=Object.defineProperty||function(t,e,r){t[e]=r.value},i="function"==typeof Symbol?Symbol:{},s=i.iterator||"@@iterator",o=i.asyncIterator||"@@asyncIterator",a=i.toStringTag||"@@toStringTag";function l(t,e,r){return Object.defineProperty(t,e,{value:r,enumerable:!0,configurable:!0,writable:!0}),t[e]}try{l({},"")}catch(t){l=function(t,e,r){return t[e]=r}}function c(t,e,r,i){var s=e&&e.prototype instanceof d?e:d,o=Object.create(s.prototype),a=new x(i||[]);return n(o,"_invoke",{value:A(t,r,a)}),o}function u(t,e,r){try{return{type:"normal",arg:t.call(e,r)}}catch(t){return{type:"throw",arg:t}}}t.wrap=c;var h={};function d(){}function f(){}function p(){}var g={};l(g,s,(function(){return this}));var m=Object.getPrototypeOf,y=m&&m(m(k([])));y&&y!==e&&r.call(y,s)&&(g=y);var v=p.prototype=d.prototype=Object.create(g);function b(t){["next","throw","return"].forEach((function(e){l(t,e,(function(t){return this._invoke(e,t)}))}))}function E(t,e){function i(n,s,o,a){var l=u(t[n],t,s);if("throw"!==l.type){var c=l.arg,h=c.value;return h&&"object"==S(h)&&r.call(h,"__await")?e.resolve(h.__await).then((function(t){i("next",t,o,a)}),(function(t){i("throw",t,o,a)})):e.resolve(h).then((function(t){c.value=t,o(c)}),(function(t){return i("throw",t,o,a)}))}a(l.arg)}var s;n(this,"_invoke",{value:function(t,r){function n(){return new e((function(e,n){i(t,r,e,n)}))}return s=s?s.then(n,n):n()}})}function A(t,e,r){var n="suspendedStart";return function(i,s){if("executing"===n)throw new Error("Generator is already running");if("completed"===n){if("throw"===i)throw s;return P()}for(r.method=i,r.arg=s;;){var o=r.delegate;if(o){var a=w(o,r);if(a){if(a===h)continue;return a}}if("next"===r.method)r.sent=r._sent=r.arg;else if("throw"===r.method){if("suspendedStart"===n)throw n="completed",r.arg;r.dispatchException(r.arg)}else"return"===r.method&&r.abrupt("return",r.arg);n="executing";var l=u(t,e,r);if("normal"===l.type){if(n=r.done?"completed":"suspendedYield",l.arg===h)continue;return{value:l.arg,done:r.done}}"throw"===l.type&&(n="completed",r.method="throw",r.arg=l.arg)}}}function w(t,e){var r=e.method,n=t.iterator[r];if(void 0===n)return e.delegate=null,"throw"===r&&t.iterator.return&&(e.method="return",e.arg=void 0,w(t,e),"throw"===e.method)||"return"!==r&&(e.method="throw",e.arg=new TypeError("The iterator does not provide a '"+r+"' method")),h;var i=u(n,t.iterator,e.arg);if("throw"===i.type)return e.method="throw",e.arg=i.arg,e.delegate=null,h;var s=i.arg;return s?s.done?(e[t.resultName]=s.value,e.next=t.nextLoc,"return"!==e.method&&(e.method="next",e.arg=void 0),e.delegate=null,h):s:(e.method="throw",e.arg=new TypeError("iterator result is not an object"),e.delegate=null,h)}function T(t){var e={tryLoc:t[0]};1 in t&&(e.catchLoc=t[1]),2 in t&&(e.finallyLoc=t[2],e.afterLoc=t[3]),this.tryEntries.push(e)}function _(t){var e=t.completion||{};e.type="normal",delete e.arg,t.completion=e}function x(t){this.tryEntries=[{tryLoc:"root"}],t.forEach(T,this),this.reset(!0)}function k(t){if(t){var e=t[s];if(e)return e.call(t);if("function"==typeof t.next)return t;if(!isNaN(t.length)){var n=-1,i=function e(){for(;++n<t.length;)if(r.call(t,n))return e.value=t[n],e.done=!1,e;return e.value=void 0,e.done=!0,e};return i.next=i}}return{next:P}}function P(){return{value:void 0,done:!0}}return f.prototype=p,n(v,"constructor",{value:p,configurable:!0}),n(p,"constructor",{value:f,configurable:!0}),f.displayName=l(p,a,"GeneratorFunction"),t.isGeneratorFunction=function(t){var e="function"==typeof t&&t.constructor;return!!e&&(e===f||"GeneratorFunction"===(e.displayName||e.name))},t.mark=function(t){return Object.setPrototypeOf?Object.setPrototypeOf(t,p):(t.__proto__=p,l(t,a,"GeneratorFunction")),t.prototype=Object.create(v),t},t.awrap=function(t){return{__await:t}},b(E.prototype),l(E.prototype,o,(function(){return this})),t.AsyncIterator=E,t.async=function(e,r,n,i,s){void 0===s&&(s=Promise);var o=new E(c(e,r,n,i),s);return t.isGeneratorFunction(r)?o:o.next().then((function(t){return t.done?t.value:o.next()}))},b(v),l(v,a,"Generator"),l(v,s,(function(){return this})),l(v,"toString",(function(){return"[object Generator]"})),t.keys=function(t){var e=Object(t),r=[];for(var n in e)r.push(n);return r.reverse(),function t(){for(;r.length;){var n=r.pop();if(n in e)return t.value=n,t.done=!1,t}return t.done=!0,t}},t.values=k,x.prototype={constructor:x,reset:function(t){if(this.prev=0,this.next=0,this.sent=this._sent=void 0,this.done=!1,this.delegate=null,this.method="next",this.arg=void 0,this.tryEntries.forEach(_),!t)for(var e in this)"t"===e.charAt(0)&&r.call(this,e)&&!isNaN(+e.slice(1))&&(this[e]=void 0)},stop:function(){this.done=!0;var t=this.tryEntries[0].completion;if("throw"===t.type)throw t.arg;return this.rval},dispatchException:function(t){if(this.done)throw t;var e=this;function n(r,n){return o.type="throw",o.arg=t,e.next=r,n&&(e.method="next",e.arg=void 0),!!n}for(var i=this.tryEntries.length-1;i>=0;--i){var s=this.tryEntries[i],o=s.completion;if("root"===s.tryLoc)return n("end");if(s.tryLoc<=this.prev){var a=r.call(s,"catchLoc"),l=r.call(s,"finallyLoc");if(a&&l){if(this.prev<s.catchLoc)return n(s.catchLoc,!0);if(this.prev<s.finallyLoc)return n(s.finallyLoc)}else if(a){if(this.prev<s.catchLoc)return n(s.catchLoc,!0)}else{if(!l)throw new Error("try statement without catch or finally");if(this.prev<s.finallyLoc)return n(s.finallyLoc)}}}},abrupt:function(t,e){for(var n=this.tryEntries.length-1;n>=0;--n){var i=this.tryEntries[n];if(i.tryLoc<=this.prev&&r.call(i,"finallyLoc")&&this.prev<i.finallyLoc){var s=i;break}}s&&("break"===t||"continue"===t)&&s.tryLoc<=e&&e<=s.finallyLoc&&(s=null);var o=s?s.completion:{};return o.type=t,o.arg=e,s?(this.method="next",this.next=s.finallyLoc,h):this.complete(o)},complete:function(t,e){if("throw"===t.type)throw t.arg;return"break"===t.type||"continue"===t.type?this.next=t.arg:"return"===t.type?(this.rval=this.arg=t.arg,this.method="return",this.next="end"):"normal"===t.type&&e&&(this.next=e),h},finish:function(t){for(var e=this.tryEntries.length-1;e>=0;--e){var r=this.tryEntries[e];if(r.finallyLoc===t)return this.complete(r.completion,r.afterLoc),_(r),h}},catch:function(t){for(var e=this.tryEntries.length-1;e>=0;--e){var r=this.tryEntries[e];if(r.tryLoc===t){var n=r.completion;if("throw"===n.type){var i=n.arg;_(r)}return i}}throw new Error("illegal catch attempt")},delegateYield:function(t,e,r){return this.delegate={iterator:k(t),resultName:e,nextLoc:r},"next"===this.method&&(this.arg=void 0),h}},t}function _(t,e,r,n,i,s,o){try{var a=t[s](o),l=a.value}catch(t){return void r(t)}a.done?e(l):Promise.resolve(l).then(n,i)}var x=null;const k={namespace:"single-film",beforeEnter:function(){var t=function(t){return function(){var e=this,r=arguments;return new Promise((function(n,i){var s=t.apply(e,r);function o(t){_(s,n,i,o,a,"next",t)}function a(t){_(s,n,i,o,a,"throw",t)}o(void 0)}))}}(L().mark((function t(e){var n,i,o;return L().wrap((function(t){for(;;)switch(t.prev=t.next){case 0:return e.current,n=e.next,e.trigger,t.next=3,(0,s.y6)(WPURLS.themeUrl+"/dist/css/_film.css");case 3:return t.next=5,Promise.all([r.e(812),r.e(5927),r.e(1393)]).then(r.bind(r,3726));case 5:i=t.sent,o=i.default,(x=new o(n.container)).init();case 9:case"end":return t.stop()}}),t)})));return function(e){return t.apply(this,arguments)}}(),afterEnter:function(t){t.current,t.next,t.trigger;x.removeIntroAnimationClasses()},beforeLeave:function(t){t.current,t.next,t.trigger;x.pause(),x.videoObserver.disconnect()},afterLeave:function(t){t.current,t.next,t.trigger;x.destroy(),x=null}};function P(t){return P="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(t){return typeof t}:function(t){return t&&"function"==typeof Symbol&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t},P(t)}function I(){I=function(){return t};var t={},e=Object.prototype,r=e.hasOwnProperty,n=Object.defineProperty||function(t,e,r){t[e]=r.value},i="function"==typeof Symbol?Symbol:{},s=i.iterator||"@@iterator",o=i.asyncIterator||"@@asyncIterator",a=i.toStringTag||"@@toStringTag";function l(t,e,r){return Object.defineProperty(t,e,{value:r,enumerable:!0,configurable:!0,writable:!0}),t[e]}try{l({},"")}catch(t){l=function(t,e,r){return t[e]=r}}function c(t,e,r,i){var s=e&&e.prototype instanceof d?e:d,o=Object.create(s.prototype),a=new L(i||[]);return n(o,"_invoke",{value:A(t,r,a)}),o}function u(t,e,r){try{return{type:"normal",arg:t.call(e,r)}}catch(t){return{type:"throw",arg:t}}}t.wrap=c;var h={};function d(){}function f(){}function p(){}var g={};l(g,s,(function(){return this}));var m=Object.getPrototypeOf,y=m&&m(m(_([])));y&&y!==e&&r.call(y,s)&&(g=y);var v=p.prototype=d.prototype=Object.create(g);function b(t){["next","throw","return"].forEach((function(e){l(t,e,(function(t){return this._invoke(e,t)}))}))}function E(t,e){function i(n,s,o,a){var l=u(t[n],t,s);if("throw"!==l.type){var c=l.arg,h=c.value;return h&&"object"==P(h)&&r.call(h,"__await")?e.resolve(h.__await).then((function(t){i("next",t,o,a)}),(function(t){i("throw",t,o,a)})):e.resolve(h).then((function(t){c.value=t,o(c)}),(function(t){return i("throw",t,o,a)}))}a(l.arg)}var s;n(this,"_invoke",{value:function(t,r){function n(){return new e((function(e,n){i(t,r,e,n)}))}return s=s?s.then(n,n):n()}})}function A(t,e,r){var n="suspendedStart";return function(i,s){if("executing"===n)throw new Error("Generator is already running");if("completed"===n){if("throw"===i)throw s;return x()}for(r.method=i,r.arg=s;;){var o=r.delegate;if(o){var a=w(o,r);if(a){if(a===h)continue;return a}}if("next"===r.method)r.sent=r._sent=r.arg;else if("throw"===r.method){if("suspendedStart"===n)throw n="completed",r.arg;r.dispatchException(r.arg)}else"return"===r.method&&r.abrupt("return",r.arg);n="executing";var l=u(t,e,r);if("normal"===l.type){if(n=r.done?"completed":"suspendedYield",l.arg===h)continue;return{value:l.arg,done:r.done}}"throw"===l.type&&(n="completed",r.method="throw",r.arg=l.arg)}}}function w(t,e){var r=e.method,n=t.iterator[r];if(void 0===n)return e.delegate=null,"throw"===r&&t.iterator.return&&(e.method="return",e.arg=void 0,w(t,e),"throw"===e.method)||"return"!==r&&(e.method="throw",e.arg=new TypeError("The iterator does not provide a '"+r+"' method")),h;var i=u(n,t.iterator,e.arg);if("throw"===i.type)return e.method="throw",e.arg=i.arg,e.delegate=null,h;var s=i.arg;return s?s.done?(e[t.resultName]=s.value,e.next=t.nextLoc,"return"!==e.method&&(e.method="next",e.arg=void 0),e.delegate=null,h):s:(e.method="throw",e.arg=new TypeError("iterator result is not an object"),e.delegate=null,h)}function T(t){var e={tryLoc:t[0]};1 in t&&(e.catchLoc=t[1]),2 in t&&(e.finallyLoc=t[2],e.afterLoc=t[3]),this.tryEntries.push(e)}function S(t){var e=t.completion||{};e.type="normal",delete e.arg,t.completion=e}function L(t){this.tryEntries=[{tryLoc:"root"}],t.forEach(T,this),this.reset(!0)}function _(t){if(t){var e=t[s];if(e)return e.call(t);if("function"==typeof t.next)return t;if(!isNaN(t.length)){var n=-1,i=function e(){for(;++n<t.length;)if(r.call(t,n))return e.value=t[n],e.done=!1,e;return e.value=void 0,e.done=!0,e};return i.next=i}}return{next:x}}function x(){return{value:void 0,done:!0}}return f.prototype=p,n(v,"constructor",{value:p,configurable:!0}),n(p,"constructor",{value:f,configurable:!0}),f.displayName=l(p,a,"GeneratorFunction"),t.isGeneratorFunction=function(t){var e="function"==typeof t&&t.constructor;return!!e&&(e===f||"GeneratorFunction"===(e.displayName||e.name))},t.mark=function(t){return Object.setPrototypeOf?Object.setPrototypeOf(t,p):(t.__proto__=p,l(t,a,"GeneratorFunction")),t.prototype=Object.create(v),t},t.awrap=function(t){return{__await:t}},b(E.prototype),l(E.prototype,o,(function(){return this})),t.AsyncIterator=E,t.async=function(e,r,n,i,s){void 0===s&&(s=Promise);var o=new E(c(e,r,n,i),s);return t.isGeneratorFunction(r)?o:o.next().then((function(t){return t.done?t.value:o.next()}))},b(v),l(v,a,"Generator"),l(v,s,(function(){return this})),l(v,"toString",(function(){return"[object Generator]"})),t.keys=function(t){var e=Object(t),r=[];for(var n in e)r.push(n);return r.reverse(),function t(){for(;r.length;){var n=r.pop();if(n in e)return t.value=n,t.done=!1,t}return t.done=!0,t}},t.values=_,L.prototype={constructor:L,reset:function(t){if(this.prev=0,this.next=0,this.sent=this._sent=void 0,this.done=!1,this.delegate=null,this.method="next",this.arg=void 0,this.tryEntries.forEach(S),!t)for(var e in this)"t"===e.charAt(0)&&r.call(this,e)&&!isNaN(+e.slice(1))&&(this[e]=void 0)},stop:function(){this.done=!0;var t=this.tryEntries[0].completion;if("throw"===t.type)throw t.arg;return this.rval},dispatchException:function(t){if(this.done)throw t;var e=this;function n(r,n){return o.type="throw",o.arg=t,e.next=r,n&&(e.method="next",e.arg=void 0),!!n}for(var i=this.tryEntries.length-1;i>=0;--i){var s=this.tryEntries[i],o=s.completion;if("root"===s.tryLoc)return n("end");if(s.tryLoc<=this.prev){var a=r.call(s,"catchLoc"),l=r.call(s,"finallyLoc");if(a&&l){if(this.prev<s.catchLoc)return n(s.catchLoc,!0);if(this.prev<s.finallyLoc)return n(s.finallyLoc)}else if(a){if(this.prev<s.catchLoc)return n(s.catchLoc,!0)}else{if(!l)throw new Error("try statement without catch or finally");if(this.prev<s.finallyLoc)return n(s.finallyLoc)}}}},abrupt:function(t,e){for(var n=this.tryEntries.length-1;n>=0;--n){var i=this.tryEntries[n];if(i.tryLoc<=this.prev&&r.call(i,"finallyLoc")&&this.prev<i.finallyLoc){var s=i;break}}s&&("break"===t||"continue"===t)&&s.tryLoc<=e&&e<=s.finallyLoc&&(s=null);var o=s?s.completion:{};return o.type=t,o.arg=e,s?(this.method="next",this.next=s.finallyLoc,h):this.complete(o)},complete:function(t,e){if("throw"===t.type)throw t.arg;return"break"===t.type||"continue"===t.type?this.next=t.arg:"return"===t.type?(this.rval=this.arg=t.arg,this.method="return",this.next="end"):"normal"===t.type&&e&&(this.next=e),h},finish:function(t){for(var e=this.tryEntries.length-1;e>=0;--e){var r=this.tryEntries[e];if(r.finallyLoc===t)return this.complete(r.completion,r.afterLoc),S(r),h}},catch:function(t){for(var e=this.tryEntries.length-1;e>=0;--e){var r=this.tryEntries[e];if(r.tryLoc===t){var n=r.completion;if("throw"===n.type){var i=n.arg;S(r)}return i}}throw new Error("illegal catch attempt")},delegateYield:function(t,e,r){return this.delegate={iterator:_(t),resultName:e,nextLoc:r},"next"===this.method&&(this.arg=void 0),h}},t}function R(t,e,r,n,i,s,o){try{var a=t[s](o),l=a.value}catch(t){return void r(t)}a.done?e(l):Promise.resolve(l).then(n,i)}var O=null;const D={namespace:"single-audio-story",beforeEnter:function(){var t=function(t){return function(){var e=this,r=arguments;return new Promise((function(n,i){var s=t.apply(e,r);function o(t){R(s,n,i,o,a,"next",t)}function a(t){R(s,n,i,o,a,"throw",t)}o(void 0)}))}}(I().mark((function t(e){var n,i,o;return I().wrap((function(t){for(;;)switch(t.prev=t.next){case 0:return e.current,n=e.next,e.trigger,t.next=3,(0,s.y6)(WPURLS.themeUrl+"/dist/css/_audio-story.css");case 3:return t.next=5,Promise.all([r.e(812),r.e(5927),r.e(6059)]).then(r.bind(r,2591));case 5:i=t.sent,o=i.default,(O=new o(n.container)).init();case 9:case"end":return t.stop()}}),t)})));return function(e){return t.apply(this,arguments)}}(),afterLeave:function(t){t.current,t.next,t.trigger;O.destroy(),O=null}};function C(t){return C="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(t){return typeof t}:function(t){return t&&"function"==typeof Symbol&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t},C(t)}function M(){M=function(){return t};var t={},e=Object.prototype,r=e.hasOwnProperty,n=Object.defineProperty||function(t,e,r){t[e]=r.value},i="function"==typeof Symbol?Symbol:{},s=i.iterator||"@@iterator",o=i.asyncIterator||"@@asyncIterator",a=i.toStringTag||"@@toStringTag";function l(t,e,r){return Object.defineProperty(t,e,{value:r,enumerable:!0,configurable:!0,writable:!0}),t[e]}try{l({},"")}catch(t){l=function(t,e,r){return t[e]=r}}function c(t,e,r,i){var s=e&&e.prototype instanceof d?e:d,o=Object.create(s.prototype),a=new L(i||[]);return n(o,"_invoke",{value:A(t,r,a)}),o}function u(t,e,r){try{return{type:"normal",arg:t.call(e,r)}}catch(t){return{type:"throw",arg:t}}}t.wrap=c;var h={};function d(){}function f(){}function p(){}var g={};l(g,s,(function(){return this}));var m=Object.getPrototypeOf,y=m&&m(m(_([])));y&&y!==e&&r.call(y,s)&&(g=y);var v=p.prototype=d.prototype=Object.create(g);function b(t){["next","throw","return"].forEach((function(e){l(t,e,(function(t){return this._invoke(e,t)}))}))}function E(t,e){function i(n,s,o,a){var l=u(t[n],t,s);if("throw"!==l.type){var c=l.arg,h=c.value;return h&&"object"==C(h)&&r.call(h,"__await")?e.resolve(h.__await).then((function(t){i("next",t,o,a)}),(function(t){i("throw",t,o,a)})):e.resolve(h).then((function(t){c.value=t,o(c)}),(function(t){return i("throw",t,o,a)}))}a(l.arg)}var s;n(this,"_invoke",{value:function(t,r){function n(){return new e((function(e,n){i(t,r,e,n)}))}return s=s?s.then(n,n):n()}})}function A(t,e,r){var n="suspendedStart";return function(i,s){if("executing"===n)throw new Error("Generator is already running");if("completed"===n){if("throw"===i)throw s;return x()}for(r.method=i,r.arg=s;;){var o=r.delegate;if(o){var a=w(o,r);if(a){if(a===h)continue;return a}}if("next"===r.method)r.sent=r._sent=r.arg;else if("throw"===r.method){if("suspendedStart"===n)throw n="completed",r.arg;r.dispatchException(r.arg)}else"return"===r.method&&r.abrupt("return",r.arg);n="executing";var l=u(t,e,r);if("normal"===l.type){if(n=r.done?"completed":"suspendedYield",l.arg===h)continue;return{value:l.arg,done:r.done}}"throw"===l.type&&(n="completed",r.method="throw",r.arg=l.arg)}}}function w(t,e){var r=e.method,n=t.iterator[r];if(void 0===n)return e.delegate=null,"throw"===r&&t.iterator.return&&(e.method="return",e.arg=void 0,w(t,e),"throw"===e.method)||"return"!==r&&(e.method="throw",e.arg=new TypeError("The iterator does not provide a '"+r+"' method")),h;var i=u(n,t.iterator,e.arg);if("throw"===i.type)return e.method="throw",e.arg=i.arg,e.delegate=null,h;var s=i.arg;return s?s.done?(e[t.resultName]=s.value,e.next=t.nextLoc,"return"!==e.method&&(e.method="next",e.arg=void 0),e.delegate=null,h):s:(e.method="throw",e.arg=new TypeError("iterator result is not an object"),e.delegate=null,h)}function T(t){var e={tryLoc:t[0]};1 in t&&(e.catchLoc=t[1]),2 in t&&(e.finallyLoc=t[2],e.afterLoc=t[3]),this.tryEntries.push(e)}function S(t){var e=t.completion||{};e.type="normal",delete e.arg,t.completion=e}function L(t){this.tryEntries=[{tryLoc:"root"}],t.forEach(T,this),this.reset(!0)}function _(t){if(t){var e=t[s];if(e)return e.call(t);if("function"==typeof t.next)return t;if(!isNaN(t.length)){var n=-1,i=function e(){for(;++n<t.length;)if(r.call(t,n))return e.value=t[n],e.done=!1,e;return e.value=void 0,e.done=!0,e};return i.next=i}}return{next:x}}function x(){return{value:void 0,done:!0}}return f.prototype=p,n(v,"constructor",{value:p,configurable:!0}),n(p,"constructor",{value:f,configurable:!0}),f.displayName=l(p,a,"GeneratorFunction"),t.isGeneratorFunction=function(t){var e="function"==typeof t&&t.constructor;return!!e&&(e===f||"GeneratorFunction"===(e.displayName||e.name))},t.mark=function(t){return Object.setPrototypeOf?Object.setPrototypeOf(t,p):(t.__proto__=p,l(t,a,"GeneratorFunction")),t.prototype=Object.create(v),t},t.awrap=function(t){return{__await:t}},b(E.prototype),l(E.prototype,o,(function(){return this})),t.AsyncIterator=E,t.async=function(e,r,n,i,s){void 0===s&&(s=Promise);var o=new E(c(e,r,n,i),s);return t.isGeneratorFunction(r)?o:o.next().then((function(t){return t.done?t.value:o.next()}))},b(v),l(v,a,"Generator"),l(v,s,(function(){return this})),l(v,"toString",(function(){return"[object Generator]"})),t.keys=function(t){var e=Object(t),r=[];for(var n in e)r.push(n);return r.reverse(),function t(){for(;r.length;){var n=r.pop();if(n in e)return t.value=n,t.done=!1,t}return t.done=!0,t}},t.values=_,L.prototype={constructor:L,reset:function(t){if(this.prev=0,this.next=0,this.sent=this._sent=void 0,this.done=!1,this.delegate=null,this.method="next",this.arg=void 0,this.tryEntries.forEach(S),!t)for(var e in this)"t"===e.charAt(0)&&r.call(this,e)&&!isNaN(+e.slice(1))&&(this[e]=void 0)},stop:function(){this.done=!0;var t=this.tryEntries[0].completion;if("throw"===t.type)throw t.arg;return this.rval},dispatchException:function(t){if(this.done)throw t;var e=this;function n(r,n){return o.type="throw",o.arg=t,e.next=r,n&&(e.method="next",e.arg=void 0),!!n}for(var i=this.tryEntries.length-1;i>=0;--i){var s=this.tryEntries[i],o=s.completion;if("root"===s.tryLoc)return n("end");if(s.tryLoc<=this.prev){var a=r.call(s,"catchLoc"),l=r.call(s,"finallyLoc");if(a&&l){if(this.prev<s.catchLoc)return n(s.catchLoc,!0);if(this.prev<s.finallyLoc)return n(s.finallyLoc)}else if(a){if(this.prev<s.catchLoc)return n(s.catchLoc,!0)}else{if(!l)throw new Error("try statement without catch or finally");if(this.prev<s.finallyLoc)return n(s.finallyLoc)}}}},abrupt:function(t,e){for(var n=this.tryEntries.length-1;n>=0;--n){var i=this.tryEntries[n];if(i.tryLoc<=this.prev&&r.call(i,"finallyLoc")&&this.prev<i.finallyLoc){var s=i;break}}s&&("break"===t||"continue"===t)&&s.tryLoc<=e&&e<=s.finallyLoc&&(s=null);var o=s?s.completion:{};return o.type=t,o.arg=e,s?(this.method="next",this.next=s.finallyLoc,h):this.complete(o)},complete:function(t,e){if("throw"===t.type)throw t.arg;return"break"===t.type||"continue"===t.type?this.next=t.arg:"return"===t.type?(this.rval=this.arg=t.arg,this.method="return",this.next="end"):"normal"===t.type&&e&&(this.next=e),h},finish:function(t){for(var e=this.tryEntries.length-1;e>=0;--e){var r=this.tryEntries[e];if(r.finallyLoc===t)return this.complete(r.completion,r.afterLoc),S(r),h}},catch:function(t){for(var e=this.tryEntries.length-1;e>=0;--e){var r=this.tryEntries[e];if(r.tryLoc===t){var n=r.completion;if("throw"===n.type){var i=n.arg;S(r)}return i}}throw new Error("illegal catch attempt")},delegateYield:function(t,e,r){return this.delegate={iterator:_(t),resultName:e,nextLoc:r},"next"===this.method&&(this.arg=void 0),h}},t}function N(t,e,r,n,i,s,o){try{var a=t[s](o),l=a.value}catch(t){return void r(t)}a.done?e(l):Promise.resolve(l).then(n,i)}var F=null;const U={namespace:"single-gallery",beforeEnter:function(){var t=function(t){return function(){var e=this,r=arguments;return new Promise((function(n,i){var s=t.apply(e,r);function o(t){N(s,n,i,o,a,"next",t)}function a(t){N(s,n,i,o,a,"throw",t)}o(void 0)}))}}(M().mark((function t(e){var n,i,o;return M().wrap((function(t){for(;;)switch(t.prev=t.next){case 0:return e.current,n=e.next,e.trigger,t.next=3,(0,s.y6)(WPURLS.themeUrl+"/dist/css/_gallery.css");case 3:return t.next=5,Promise.all([r.e(812),r.e(5927),r.e(3543)]).then(r.bind(r,8711));case 5:i=t.sent,o=i.default,(F=new o(n.container)).init();case 9:case"end":return t.stop()}}),t)})));return function(e){return t.apply(this,arguments)}}(),afterLeave:function(t){t.current,t.next,t.trigger;F.destroy(),F=null}};function B(t){return B="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(t){return typeof t}:function(t){return t&&"function"==typeof Symbol&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t},B(t)}function $(){$=function(){return t};var t={},e=Object.prototype,r=e.hasOwnProperty,n=Object.defineProperty||function(t,e,r){t[e]=r.value},i="function"==typeof Symbol?Symbol:{},s=i.iterator||"@@iterator",o=i.asyncIterator||"@@asyncIterator",a=i.toStringTag||"@@toStringTag";function l(t,e,r){return Object.defineProperty(t,e,{value:r,enumerable:!0,configurable:!0,writable:!0}),t[e]}try{l({},"")}catch(t){l=function(t,e,r){return t[e]=r}}function c(t,e,r,i){var s=e&&e.prototype instanceof d?e:d,o=Object.create(s.prototype),a=new L(i||[]);return n(o,"_invoke",{value:A(t,r,a)}),o}function u(t,e,r){try{return{type:"normal",arg:t.call(e,r)}}catch(t){return{type:"throw",arg:t}}}t.wrap=c;var h={};function d(){}function f(){}function p(){}var g={};l(g,s,(function(){return this}));var m=Object.getPrototypeOf,y=m&&m(m(_([])));y&&y!==e&&r.call(y,s)&&(g=y);var v=p.prototype=d.prototype=Object.create(g);function b(t){["next","throw","return"].forEach((function(e){l(t,e,(function(t){return this._invoke(e,t)}))}))}function E(t,e){function i(n,s,o,a){var l=u(t[n],t,s);if("throw"!==l.type){var c=l.arg,h=c.value;return h&&"object"==B(h)&&r.call(h,"__await")?e.resolve(h.__await).then((function(t){i("next",t,o,a)}),(function(t){i("throw",t,o,a)})):e.resolve(h).then((function(t){c.value=t,o(c)}),(function(t){return i("throw",t,o,a)}))}a(l.arg)}var s;n(this,"_invoke",{value:function(t,r){function n(){return new e((function(e,n){i(t,r,e,n)}))}return s=s?s.then(n,n):n()}})}function A(t,e,r){var n="suspendedStart";return function(i,s){if("executing"===n)throw new Error("Generator is already running");if("completed"===n){if("throw"===i)throw s;return x()}for(r.method=i,r.arg=s;;){var o=r.delegate;if(o){var a=w(o,r);if(a){if(a===h)continue;return a}}if("next"===r.method)r.sent=r._sent=r.arg;else if("throw"===r.method){if("suspendedStart"===n)throw n="completed",r.arg;r.dispatchException(r.arg)}else"return"===r.method&&r.abrupt("return",r.arg);n="executing";var l=u(t,e,r);if("normal"===l.type){if(n=r.done?"completed":"suspendedYield",l.arg===h)continue;return{value:l.arg,done:r.done}}"throw"===l.type&&(n="completed",r.method="throw",r.arg=l.arg)}}}function w(t,e){var r=e.method,n=t.iterator[r];if(void 0===n)return e.delegate=null,"throw"===r&&t.iterator.return&&(e.method="return",e.arg=void 0,w(t,e),"throw"===e.method)||"return"!==r&&(e.method="throw",e.arg=new TypeError("The iterator does not provide a '"+r+"' method")),h;var i=u(n,t.iterator,e.arg);if("throw"===i.type)return e.method="throw",e.arg=i.arg,e.delegate=null,h;var s=i.arg;return s?s.done?(e[t.resultName]=s.value,e.next=t.nextLoc,"return"!==e.method&&(e.method="next",e.arg=void 0),e.delegate=null,h):s:(e.method="throw",e.arg=new TypeError("iterator result is not an object"),e.delegate=null,h)}function T(t){var e={tryLoc:t[0]};1 in t&&(e.catchLoc=t[1]),2 in t&&(e.finallyLoc=t[2],e.afterLoc=t[3]),this.tryEntries.push(e)}function S(t){var e=t.completion||{};e.type="normal",delete e.arg,t.completion=e}function L(t){this.tryEntries=[{tryLoc:"root"}],t.forEach(T,this),this.reset(!0)}function _(t){if(t){var e=t[s];if(e)return e.call(t);if("function"==typeof t.next)return t;if(!isNaN(t.length)){var n=-1,i=function e(){for(;++n<t.length;)if(r.call(t,n))return e.value=t[n],e.done=!1,e;return e.value=void 0,e.done=!0,e};return i.next=i}}return{next:x}}function x(){return{value:void 0,done:!0}}return f.prototype=p,n(v,"constructor",{value:p,configurable:!0}),n(p,"constructor",{value:f,configurable:!0}),f.displayName=l(p,a,"GeneratorFunction"),t.isGeneratorFunction=function(t){var e="function"==typeof t&&t.constructor;return!!e&&(e===f||"GeneratorFunction"===(e.displayName||e.name))},t.mark=function(t){return Object.setPrototypeOf?Object.setPrototypeOf(t,p):(t.__proto__=p,l(t,a,"GeneratorFunction")),t.prototype=Object.create(v),t},t.awrap=function(t){return{__await:t}},b(E.prototype),l(E.prototype,o,(function(){return this})),t.AsyncIterator=E,t.async=function(e,r,n,i,s){void 0===s&&(s=Promise);var o=new E(c(e,r,n,i),s);return t.isGeneratorFunction(r)?o:o.next().then((function(t){return t.done?t.value:o.next()}))},b(v),l(v,a,"Generator"),l(v,s,(function(){return this})),l(v,"toString",(function(){return"[object Generator]"})),t.keys=function(t){var e=Object(t),r=[];for(var n in e)r.push(n);return r.reverse(),function t(){for(;r.length;){var n=r.pop();if(n in e)return t.value=n,t.done=!1,t}return t.done=!0,t}},t.values=_,L.prototype={constructor:L,reset:function(t){if(this.prev=0,this.next=0,this.sent=this._sent=void 0,this.done=!1,this.delegate=null,this.method="next",this.arg=void 0,this.tryEntries.forEach(S),!t)for(var e in this)"t"===e.charAt(0)&&r.call(this,e)&&!isNaN(+e.slice(1))&&(this[e]=void 0)},stop:function(){this.done=!0;var t=this.tryEntries[0].completion;if("throw"===t.type)throw t.arg;return this.rval},dispatchException:function(t){if(this.done)throw t;var e=this;function n(r,n){return o.type="throw",o.arg=t,e.next=r,n&&(e.method="next",e.arg=void 0),!!n}for(var i=this.tryEntries.length-1;i>=0;--i){var s=this.tryEntries[i],o=s.completion;if("root"===s.tryLoc)return n("end");if(s.tryLoc<=this.prev){var a=r.call(s,"catchLoc"),l=r.call(s,"finallyLoc");if(a&&l){if(this.prev<s.catchLoc)return n(s.catchLoc,!0);if(this.prev<s.finallyLoc)return n(s.finallyLoc)}else if(a){if(this.prev<s.catchLoc)return n(s.catchLoc,!0)}else{if(!l)throw new Error("try statement without catch or finally");if(this.prev<s.finallyLoc)return n(s.finallyLoc)}}}},abrupt:function(t,e){for(var n=this.tryEntries.length-1;n>=0;--n){var i=this.tryEntries[n];if(i.tryLoc<=this.prev&&r.call(i,"finallyLoc")&&this.prev<i.finallyLoc){var s=i;break}}s&&("break"===t||"continue"===t)&&s.tryLoc<=e&&e<=s.finallyLoc&&(s=null);var o=s?s.completion:{};return o.type=t,o.arg=e,s?(this.method="next",this.next=s.finallyLoc,h):this.complete(o)},complete:function(t,e){if("throw"===t.type)throw t.arg;return"break"===t.type||"continue"===t.type?this.next=t.arg:"return"===t.type?(this.rval=this.arg=t.arg,this.method="return",this.next="end"):"normal"===t.type&&e&&(this.next=e),h},finish:function(t){for(var e=this.tryEntries.length-1;e>=0;--e){var r=this.tryEntries[e];if(r.finallyLoc===t)return this.complete(r.completion,r.afterLoc),S(r),h}},catch:function(t){for(var e=this.tryEntries.length-1;e>=0;--e){var r=this.tryEntries[e];if(r.tryLoc===t){var n=r.completion;if("throw"===n.type){var i=n.arg;S(r)}return i}}throw new Error("illegal catch attempt")},delegateYield:function(t,e,r){return this.delegate={iterator:_(t),resultName:e,nextLoc:r},"next"===this.method&&(this.arg=void 0),h}},t}function j(t,e,r,n,i,s,o){try{var a=t[s](o),l=a.value}catch(t){return void r(t)}a.done?e(l):Promise.resolve(l).then(n,i)}var G=null;const H={namespace:"single-op_ed",beforeEnter:function(){var t=function(t){return function(){var e=this,r=arguments;return new Promise((function(n,i){var s=t.apply(e,r);function o(t){j(s,n,i,o,a,"next",t)}function a(t){j(s,n,i,o,a,"throw",t)}o(void 0)}))}}($().mark((function t(e){var n,i,o;return $().wrap((function(t){for(;;)switch(t.prev=t.next){case 0:return e.current,n=e.next,e.trigger,t.next=3,(0,s.y6)(WPURLS.themeUrl+"/dist/css/_op-ed.css");case 3:return t.next=5,Promise.all([r.e(812),r.e(5927),r.e(8772)]).then(r.bind(r,9833));case 5:i=t.sent,o=i.default,(G=new o(n.container)).init();case 9:case"end":return t.stop()}}),t)})));return function(e){return t.apply(this,arguments)}}(),afterEnter:function(t){t.current,t.next,t.trigger},afterLeave:function(t){t.current,t.next,t.trigger;G.destroy(),G=null}};function V(t){return V="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(t){return typeof t}:function(t){return t&&"function"==typeof Symbol&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t},V(t)}function K(){K=function(){return t};var t={},e=Object.prototype,r=e.hasOwnProperty,n=Object.defineProperty||function(t,e,r){t[e]=r.value},i="function"==typeof Symbol?Symbol:{},s=i.iterator||"@@iterator",o=i.asyncIterator||"@@asyncIterator",a=i.toStringTag||"@@toStringTag";function l(t,e,r){return Object.defineProperty(t,e,{value:r,enumerable:!0,configurable:!0,writable:!0}),t[e]}try{l({},"")}catch(t){l=function(t,e,r){return t[e]=r}}function c(t,e,r,i){var s=e&&e.prototype instanceof d?e:d,o=Object.create(s.prototype),a=new L(i||[]);return n(o,"_invoke",{value:A(t,r,a)}),o}function u(t,e,r){try{return{type:"normal",arg:t.call(e,r)}}catch(t){return{type:"throw",arg:t}}}t.wrap=c;var h={};function d(){}function f(){}function p(){}var g={};l(g,s,(function(){return this}));var m=Object.getPrototypeOf,y=m&&m(m(_([])));y&&y!==e&&r.call(y,s)&&(g=y);var v=p.prototype=d.prototype=Object.create(g);function b(t){["next","throw","return"].forEach((function(e){l(t,e,(function(t){return this._invoke(e,t)}))}))}function E(t,e){function i(n,s,o,a){var l=u(t[n],t,s);if("throw"!==l.type){var c=l.arg,h=c.value;return h&&"object"==V(h)&&r.call(h,"__await")?e.resolve(h.__await).then((function(t){i("next",t,o,a)}),(function(t){i("throw",t,o,a)})):e.resolve(h).then((function(t){c.value=t,o(c)}),(function(t){return i("throw",t,o,a)}))}a(l.arg)}var s;n(this,"_invoke",{value:function(t,r){function n(){return new e((function(e,n){i(t,r,e,n)}))}return s=s?s.then(n,n):n()}})}function A(t,e,r){var n="suspendedStart";return function(i,s){if("executing"===n)throw new Error("Generator is already running");if("completed"===n){if("throw"===i)throw s;return x()}for(r.method=i,r.arg=s;;){var o=r.delegate;if(o){var a=w(o,r);if(a){if(a===h)continue;return a}}if("next"===r.method)r.sent=r._sent=r.arg;else if("throw"===r.method){if("suspendedStart"===n)throw n="completed",r.arg;r.dispatchException(r.arg)}else"return"===r.method&&r.abrupt("return",r.arg);n="executing";var l=u(t,e,r);if("normal"===l.type){if(n=r.done?"completed":"suspendedYield",l.arg===h)continue;return{value:l.arg,done:r.done}}"throw"===l.type&&(n="completed",r.method="throw",r.arg=l.arg)}}}function w(t,e){var r=e.method,n=t.iterator[r];if(void 0===n)return e.delegate=null,"throw"===r&&t.iterator.return&&(e.method="return",e.arg=void 0,w(t,e),"throw"===e.method)||"return"!==r&&(e.method="throw",e.arg=new TypeError("The iterator does not provide a '"+r+"' method")),h;var i=u(n,t.iterator,e.arg);if("throw"===i.type)return e.method="throw",e.arg=i.arg,e.delegate=null,h;var s=i.arg;return s?s.done?(e[t.resultName]=s.value,e.next=t.nextLoc,"return"!==e.method&&(e.method="next",e.arg=void 0),e.delegate=null,h):s:(e.method="throw",e.arg=new TypeError("iterator result is not an object"),e.delegate=null,h)}function T(t){var e={tryLoc:t[0]};1 in t&&(e.catchLoc=t[1]),2 in t&&(e.finallyLoc=t[2],e.afterLoc=t[3]),this.tryEntries.push(e)}function S(t){var e=t.completion||{};e.type="normal",delete e.arg,t.completion=e}function L(t){this.tryEntries=[{tryLoc:"root"}],t.forEach(T,this),this.reset(!0)}function _(t){if(t){var e=t[s];if(e)return e.call(t);if("function"==typeof t.next)return t;if(!isNaN(t.length)){var n=-1,i=function e(){for(;++n<t.length;)if(r.call(t,n))return e.value=t[n],e.done=!1,e;return e.value=void 0,e.done=!0,e};return i.next=i}}return{next:x}}function x(){return{value:void 0,done:!0}}return f.prototype=p,n(v,"constructor",{value:p,configurable:!0}),n(p,"constructor",{value:f,configurable:!0}),f.displayName=l(p,a,"GeneratorFunction"),t.isGeneratorFunction=function(t){var e="function"==typeof t&&t.constructor;return!!e&&(e===f||"GeneratorFunction"===(e.displayName||e.name))},t.mark=function(t){return Object.setPrototypeOf?Object.setPrototypeOf(t,p):(t.__proto__=p,l(t,a,"GeneratorFunction")),t.prototype=Object.create(v),t},t.awrap=function(t){return{__await:t}},b(E.prototype),l(E.prototype,o,(function(){return this})),t.AsyncIterator=E,t.async=function(e,r,n,i,s){void 0===s&&(s=Promise);var o=new E(c(e,r,n,i),s);return t.isGeneratorFunction(r)?o:o.next().then((function(t){return t.done?t.value:o.next()}))},b(v),l(v,a,"Generator"),l(v,s,(function(){return this})),l(v,"toString",(function(){return"[object Generator]"})),t.keys=function(t){var e=Object(t),r=[];for(var n in e)r.push(n);return r.reverse(),function t(){for(;r.length;){var n=r.pop();if(n in e)return t.value=n,t.done=!1,t}return t.done=!0,t}},t.values=_,L.prototype={constructor:L,reset:function(t){if(this.prev=0,this.next=0,this.sent=this._sent=void 0,this.done=!1,this.delegate=null,this.method="next",this.arg=void 0,this.tryEntries.forEach(S),!t)for(var e in this)"t"===e.charAt(0)&&r.call(this,e)&&!isNaN(+e.slice(1))&&(this[e]=void 0)},stop:function(){this.done=!0;var t=this.tryEntries[0].completion;if("throw"===t.type)throw t.arg;return this.rval},dispatchException:function(t){if(this.done)throw t;var e=this;function n(r,n){return o.type="throw",o.arg=t,e.next=r,n&&(e.method="next",e.arg=void 0),!!n}for(var i=this.tryEntries.length-1;i>=0;--i){var s=this.tryEntries[i],o=s.completion;if("root"===s.tryLoc)return n("end");if(s.tryLoc<=this.prev){var a=r.call(s,"catchLoc"),l=r.call(s,"finallyLoc");if(a&&l){if(this.prev<s.catchLoc)return n(s.catchLoc,!0);if(this.prev<s.finallyLoc)return n(s.finallyLoc)}else if(a){if(this.prev<s.catchLoc)return n(s.catchLoc,!0)}else{if(!l)throw new Error("try statement without catch or finally");if(this.prev<s.finallyLoc)return n(s.finallyLoc)}}}},abrupt:function(t,e){for(var n=this.tryEntries.length-1;n>=0;--n){var i=this.tryEntries[n];if(i.tryLoc<=this.prev&&r.call(i,"finallyLoc")&&this.prev<i.finallyLoc){var s=i;break}}s&&("break"===t||"continue"===t)&&s.tryLoc<=e&&e<=s.finallyLoc&&(s=null);var o=s?s.completion:{};return o.type=t,o.arg=e,s?(this.method="next",this.next=s.finallyLoc,h):this.complete(o)},complete:function(t,e){if("throw"===t.type)throw t.arg;return"break"===t.type||"continue"===t.type?this.next=t.arg:"return"===t.type?(this.rval=this.arg=t.arg,this.method="return",this.next="end"):"normal"===t.type&&e&&(this.next=e),h},finish:function(t){for(var e=this.tryEntries.length-1;e>=0;--e){var r=this.tryEntries[e];if(r.finallyLoc===t)return this.complete(r.completion,r.afterLoc),S(r),h}},catch:function(t){for(var e=this.tryEntries.length-1;e>=0;--e){var r=this.tryEntries[e];if(r.tryLoc===t){var n=r.completion;if("throw"===n.type){var i=n.arg;S(r)}return i}}throw new Error("illegal catch attempt")},delegateYield:function(t,e,r){return this.delegate={iterator:_(t),resultName:e,nextLoc:r},"next"===this.method&&(this.arg=void 0),h}},t}function Y(t,e,r,n,i,s,o){try{var a=t[s](o),l=a.value}catch(t){return void r(t)}a.done?e(l):Promise.resolve(l).then(n,i)}var q=null;const W={namespace:"single-essay",beforeEnter:function(){var t=function(t){return function(){var e=this,r=arguments;return new Promise((function(n,i){var s=t.apply(e,r);function o(t){Y(s,n,i,o,a,"next",t)}function a(t){Y(s,n,i,o,a,"throw",t)}o(void 0)}))}}(K().mark((function t(e){var n,i,o;return K().wrap((function(t){for(;;)switch(t.prev=t.next){case 0:return e.current,n=e.next,e.trigger,t.next=3,(0,s.y6)(WPURLS.themeUrl+"/dist/css/_essay.css");case 3:return t.next=5,Promise.all([r.e(812),r.e(5927),r.e(4041),r.e(4371)]).then(r.bind(r,9007));case 5:i=t.sent,o=i.default,(q=new o(n.container)).init();case 9:case"end":return t.stop()}}),t)})));return function(e){return t.apply(this,arguments)}}(),afterEnter:function(t){t.current;var e=t.next;t.trigger;e.container.querySelector(".essay-header").classList.remove("essay-header--animating"),e.container.querySelector(".essay-content").classList.remove("essay-content--animating")},afterLeave:function(t){t.current,t.next,t.trigger;q.destroy(),q=null}};function z(t){return z="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(t){return typeof t}:function(t){return t&&"function"==typeof Symbol&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t},z(t)}function X(){X=function(){return t};var t={},e=Object.prototype,r=e.hasOwnProperty,n=Object.defineProperty||function(t,e,r){t[e]=r.value},i="function"==typeof Symbol?Symbol:{},s=i.iterator||"@@iterator",o=i.asyncIterator||"@@asyncIterator",a=i.toStringTag||"@@toStringTag";function l(t,e,r){return Object.defineProperty(t,e,{value:r,enumerable:!0,configurable:!0,writable:!0}),t[e]}try{l({},"")}catch(t){l=function(t,e,r){return t[e]=r}}function c(t,e,r,i){var s=e&&e.prototype instanceof d?e:d,o=Object.create(s.prototype),a=new L(i||[]);return n(o,"_invoke",{value:A(t,r,a)}),o}function u(t,e,r){try{return{type:"normal",arg:t.call(e,r)}}catch(t){return{type:"throw",arg:t}}}t.wrap=c;var h={};function d(){}function f(){}function p(){}var g={};l(g,s,(function(){return this}));var m=Object.getPrototypeOf,y=m&&m(m(_([])));y&&y!==e&&r.call(y,s)&&(g=y);var v=p.prototype=d.prototype=Object.create(g);function b(t){["next","throw","return"].forEach((function(e){l(t,e,(function(t){return this._invoke(e,t)}))}))}function E(t,e){function i(n,s,o,a){var l=u(t[n],t,s);if("throw"!==l.type){var c=l.arg,h=c.value;return h&&"object"==z(h)&&r.call(h,"__await")?e.resolve(h.__await).then((function(t){i("next",t,o,a)}),(function(t){i("throw",t,o,a)})):e.resolve(h).then((function(t){c.value=t,o(c)}),(function(t){return i("throw",t,o,a)}))}a(l.arg)}var s;n(this,"_invoke",{value:function(t,r){function n(){return new e((function(e,n){i(t,r,e,n)}))}return s=s?s.then(n,n):n()}})}function A(t,e,r){var n="suspendedStart";return function(i,s){if("executing"===n)throw new Error("Generator is already running");if("completed"===n){if("throw"===i)throw s;return x()}for(r.method=i,r.arg=s;;){var o=r.delegate;if(o){var a=w(o,r);if(a){if(a===h)continue;return a}}if("next"===r.method)r.sent=r._sent=r.arg;else if("throw"===r.method){if("suspendedStart"===n)throw n="completed",r.arg;r.dispatchException(r.arg)}else"return"===r.method&&r.abrupt("return",r.arg);n="executing";var l=u(t,e,r);if("normal"===l.type){if(n=r.done?"completed":"suspendedYield",l.arg===h)continue;return{value:l.arg,done:r.done}}"throw"===l.type&&(n="completed",r.method="throw",r.arg=l.arg)}}}function w(t,e){var r=e.method,n=t.iterator[r];if(void 0===n)return e.delegate=null,"throw"===r&&t.iterator.return&&(e.method="return",e.arg=void 0,w(t,e),"throw"===e.method)||"return"!==r&&(e.method="throw",e.arg=new TypeError("The iterator does not provide a '"+r+"' method")),h;var i=u(n,t.iterator,e.arg);if("throw"===i.type)return e.method="throw",e.arg=i.arg,e.delegate=null,h;var s=i.arg;return s?s.done?(e[t.resultName]=s.value,e.next=t.nextLoc,"return"!==e.method&&(e.method="next",e.arg=void 0),e.delegate=null,h):s:(e.method="throw",e.arg=new TypeError("iterator result is not an object"),e.delegate=null,h)}function T(t){var e={tryLoc:t[0]};1 in t&&(e.catchLoc=t[1]),2 in t&&(e.finallyLoc=t[2],e.afterLoc=t[3]),this.tryEntries.push(e)}function S(t){var e=t.completion||{};e.type="normal",delete e.arg,t.completion=e}function L(t){this.tryEntries=[{tryLoc:"root"}],t.forEach(T,this),this.reset(!0)}function _(t){if(t){var e=t[s];if(e)return e.call(t);if("function"==typeof t.next)return t;if(!isNaN(t.length)){var n=-1,i=function e(){for(;++n<t.length;)if(r.call(t,n))return e.value=t[n],e.done=!1,e;return e.value=void 0,e.done=!0,e};return i.next=i}}return{next:x}}function x(){return{value:void 0,done:!0}}return f.prototype=p,n(v,"constructor",{value:p,configurable:!0}),n(p,"constructor",{value:f,configurable:!0}),f.displayName=l(p,a,"GeneratorFunction"),t.isGeneratorFunction=function(t){var e="function"==typeof t&&t.constructor;return!!e&&(e===f||"GeneratorFunction"===(e.displayName||e.name))},t.mark=function(t){return Object.setPrototypeOf?Object.setPrototypeOf(t,p):(t.__proto__=p,l(t,a,"GeneratorFunction")),t.prototype=Object.create(v),t},t.awrap=function(t){return{__await:t}},b(E.prototype),l(E.prototype,o,(function(){return this})),t.AsyncIterator=E,t.async=function(e,r,n,i,s){void 0===s&&(s=Promise);var o=new E(c(e,r,n,i),s);return t.isGeneratorFunction(r)?o:o.next().then((function(t){return t.done?t.value:o.next()}))},b(v),l(v,a,"Generator"),l(v,s,(function(){return this})),l(v,"toString",(function(){return"[object Generator]"})),t.keys=function(t){var e=Object(t),r=[];for(var n in e)r.push(n);return r.reverse(),function t(){for(;r.length;){var n=r.pop();if(n in e)return t.value=n,t.done=!1,t}return t.done=!0,t}},t.values=_,L.prototype={constructor:L,reset:function(t){if(this.prev=0,this.next=0,this.sent=this._sent=void 0,this.done=!1,this.delegate=null,this.method="next",this.arg=void 0,this.tryEntries.forEach(S),!t)for(var e in this)"t"===e.charAt(0)&&r.call(this,e)&&!isNaN(+e.slice(1))&&(this[e]=void 0)},stop:function(){this.done=!0;var t=this.tryEntries[0].completion;if("throw"===t.type)throw t.arg;return this.rval},dispatchException:function(t){if(this.done)throw t;var e=this;function n(r,n){return o.type="throw",o.arg=t,e.next=r,n&&(e.method="next",e.arg=void 0),!!n}for(var i=this.tryEntries.length-1;i>=0;--i){var s=this.tryEntries[i],o=s.completion;if("root"===s.tryLoc)return n("end");if(s.tryLoc<=this.prev){var a=r.call(s,"catchLoc"),l=r.call(s,"finallyLoc");if(a&&l){if(this.prev<s.catchLoc)return n(s.catchLoc,!0);if(this.prev<s.finallyLoc)return n(s.finallyLoc)}else if(a){if(this.prev<s.catchLoc)return n(s.catchLoc,!0)}else{if(!l)throw new Error("try statement without catch or finally");if(this.prev<s.finallyLoc)return n(s.finallyLoc)}}}},abrupt:function(t,e){for(var n=this.tryEntries.length-1;n>=0;--n){var i=this.tryEntries[n];if(i.tryLoc<=this.prev&&r.call(i,"finallyLoc")&&this.prev<i.finallyLoc){var s=i;break}}s&&("break"===t||"continue"===t)&&s.tryLoc<=e&&e<=s.finallyLoc&&(s=null);var o=s?s.completion:{};return o.type=t,o.arg=e,s?(this.method="next",this.next=s.finallyLoc,h):this.complete(o)},complete:function(t,e){if("throw"===t.type)throw t.arg;return"break"===t.type||"continue"===t.type?this.next=t.arg:"return"===t.type?(this.rval=this.arg=t.arg,this.method="return",this.next="end"):"normal"===t.type&&e&&(this.next=e),h},finish:function(t){for(var e=this.tryEntries.length-1;e>=0;--e){var r=this.tryEntries[e];if(r.finallyLoc===t)return this.complete(r.completion,r.afterLoc),S(r),h}},catch:function(t){for(var e=this.tryEntries.length-1;e>=0;--e){var r=this.tryEntries[e];if(r.tryLoc===t){var n=r.completion;if("throw"===n.type){var i=n.arg;S(r)}return i}}throw new Error("illegal catch attempt")},delegateYield:function(t,e,r){return this.delegate={iterator:_(t),resultName:e,nextLoc:r},"next"===this.method&&(this.arg=void 0),h}},t}function Q(t,e,r,n,i,s,o){try{var a=t[s](o),l=a.value}catch(t){return void r(t)}a.done?e(l):Promise.resolve(l).then(n,i)}var J=null;const Z={namespace:"single-fiction",beforeEnter:function(){var t=function(t){return function(){var e=this,r=arguments;return new Promise((function(n,i){var s=t.apply(e,r);function o(t){Q(s,n,i,o,a,"next",t)}function a(t){Q(s,n,i,o,a,"throw",t)}o(void 0)}))}}(X().mark((function t(e){var n,i,o;return X().wrap((function(t){for(;;)switch(t.prev=t.next){case 0:return e.current,n=e.next,e.trigger,t.next=3,(0,s.y6)(WPURLS.themeUrl+"/dist/css/_essay.css");case 3:return t.next=5,Promise.all([r.e(812),r.e(5927),r.e(4041),r.e(4371)]).then(r.bind(r,9007));case 5:i=t.sent,o=i.default,(J=new o(n.container)).init();case 9:case"end":return t.stop()}}),t)})));return function(e){return t.apply(this,arguments)}}(),afterEnter:function(t){t.current;var e=t.next;t.trigger;e.container.querySelector(".essay-header").classList.remove("essay-header--animating"),e.container.querySelector(".essay-content").classList.remove("essay-content--animating")},afterLeave:function(t){t.current,t.next,t.trigger;J.destroy(),J=null}};function tt(t){return tt="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(t){return typeof t}:function(t){return t&&"function"==typeof Symbol&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t},tt(t)}function et(){et=function(){return t};var t={},e=Object.prototype,r=e.hasOwnProperty,n=Object.defineProperty||function(t,e,r){t[e]=r.value},i="function"==typeof Symbol?Symbol:{},s=i.iterator||"@@iterator",o=i.asyncIterator||"@@asyncIterator",a=i.toStringTag||"@@toStringTag";function l(t,e,r){return Object.defineProperty(t,e,{value:r,enumerable:!0,configurable:!0,writable:!0}),t[e]}try{l({},"")}catch(t){l=function(t,e,r){return t[e]=r}}function c(t,e,r,i){var s=e&&e.prototype instanceof d?e:d,o=Object.create(s.prototype),a=new L(i||[]);return n(o,"_invoke",{value:A(t,r,a)}),o}function u(t,e,r){try{return{type:"normal",arg:t.call(e,r)}}catch(t){return{type:"throw",arg:t}}}t.wrap=c;var h={};function d(){}function f(){}function p(){}var g={};l(g,s,(function(){return this}));var m=Object.getPrototypeOf,y=m&&m(m(_([])));y&&y!==e&&r.call(y,s)&&(g=y);var v=p.prototype=d.prototype=Object.create(g);function b(t){["next","throw","return"].forEach((function(e){l(t,e,(function(t){return this._invoke(e,t)}))}))}function E(t,e){function i(n,s,o,a){var l=u(t[n],t,s);if("throw"!==l.type){var c=l.arg,h=c.value;return h&&"object"==tt(h)&&r.call(h,"__await")?e.resolve(h.__await).then((function(t){i("next",t,o,a)}),(function(t){i("throw",t,o,a)})):e.resolve(h).then((function(t){c.value=t,o(c)}),(function(t){return i("throw",t,o,a)}))}a(l.arg)}var s;n(this,"_invoke",{value:function(t,r){function n(){return new e((function(e,n){i(t,r,e,n)}))}return s=s?s.then(n,n):n()}})}function A(t,e,r){var n="suspendedStart";return function(i,s){if("executing"===n)throw new Error("Generator is already running");if("completed"===n){if("throw"===i)throw s;return x()}for(r.method=i,r.arg=s;;){var o=r.delegate;if(o){var a=w(o,r);if(a){if(a===h)continue;return a}}if("next"===r.method)r.sent=r._sent=r.arg;else if("throw"===r.method){if("suspendedStart"===n)throw n="completed",r.arg;r.dispatchException(r.arg)}else"return"===r.method&&r.abrupt("return",r.arg);n="executing";var l=u(t,e,r);if("normal"===l.type){if(n=r.done?"completed":"suspendedYield",l.arg===h)continue;return{value:l.arg,done:r.done}}"throw"===l.type&&(n="completed",r.method="throw",r.arg=l.arg)}}}function w(t,e){var r=e.method,n=t.iterator[r];if(void 0===n)return e.delegate=null,"throw"===r&&t.iterator.return&&(e.method="return",e.arg=void 0,w(t,e),"throw"===e.method)||"return"!==r&&(e.method="throw",e.arg=new TypeError("The iterator does not provide a '"+r+"' method")),h;var i=u(n,t.iterator,e.arg);if("throw"===i.type)return e.method="throw",e.arg=i.arg,e.delegate=null,h;var s=i.arg;return s?s.done?(e[t.resultName]=s.value,e.next=t.nextLoc,"return"!==e.method&&(e.method="next",e.arg=void 0),e.delegate=null,h):s:(e.method="throw",e.arg=new TypeError("iterator result is not an object"),e.delegate=null,h)}function T(t){var e={tryLoc:t[0]};1 in t&&(e.catchLoc=t[1]),2 in t&&(e.finallyLoc=t[2],e.afterLoc=t[3]),this.tryEntries.push(e)}function S(t){var e=t.completion||{};e.type="normal",delete e.arg,t.completion=e}function L(t){this.tryEntries=[{tryLoc:"root"}],t.forEach(T,this),this.reset(!0)}function _(t){if(t){var e=t[s];if(e)return e.call(t);if("function"==typeof t.next)return t;if(!isNaN(t.length)){var n=-1,i=function e(){for(;++n<t.length;)if(r.call(t,n))return e.value=t[n],e.done=!1,e;return e.value=void 0,e.done=!0,e};return i.next=i}}return{next:x}}function x(){return{value:void 0,done:!0}}return f.prototype=p,n(v,"constructor",{value:p,configurable:!0}),n(p,"constructor",{value:f,configurable:!0}),f.displayName=l(p,a,"GeneratorFunction"),t.isGeneratorFunction=function(t){var e="function"==typeof t&&t.constructor;return!!e&&(e===f||"GeneratorFunction"===(e.displayName||e.name))},t.mark=function(t){return Object.setPrototypeOf?Object.setPrototypeOf(t,p):(t.__proto__=p,l(t,a,"GeneratorFunction")),t.prototype=Object.create(v),t},t.awrap=function(t){return{__await:t}},b(E.prototype),l(E.prototype,o,(function(){return this})),t.AsyncIterator=E,t.async=function(e,r,n,i,s){void 0===s&&(s=Promise);var o=new E(c(e,r,n,i),s);return t.isGeneratorFunction(r)?o:o.next().then((function(t){return t.done?t.value:o.next()}))},b(v),l(v,a,"Generator"),l(v,s,(function(){return this})),l(v,"toString",(function(){return"[object Generator]"})),t.keys=function(t){var e=Object(t),r=[];for(var n in e)r.push(n);return r.reverse(),function t(){for(;r.length;){var n=r.pop();if(n in e)return t.value=n,t.done=!1,t}return t.done=!0,t}},t.values=_,L.prototype={constructor:L,reset:function(t){if(this.prev=0,this.next=0,this.sent=this._sent=void 0,this.done=!1,this.delegate=null,this.method="next",this.arg=void 0,this.tryEntries.forEach(S),!t)for(var e in this)"t"===e.charAt(0)&&r.call(this,e)&&!isNaN(+e.slice(1))&&(this[e]=void 0)},stop:function(){this.done=!0;var t=this.tryEntries[0].completion;if("throw"===t.type)throw t.arg;return this.rval},dispatchException:function(t){if(this.done)throw t;var e=this;function n(r,n){return o.type="throw",o.arg=t,e.next=r,n&&(e.method="next",e.arg=void 0),!!n}for(var i=this.tryEntries.length-1;i>=0;--i){var s=this.tryEntries[i],o=s.completion;if("root"===s.tryLoc)return n("end");if(s.tryLoc<=this.prev){var a=r.call(s,"catchLoc"),l=r.call(s,"finallyLoc");if(a&&l){if(this.prev<s.catchLoc)return n(s.catchLoc,!0);if(this.prev<s.finallyLoc)return n(s.finallyLoc)}else if(a){if(this.prev<s.catchLoc)return n(s.catchLoc,!0)}else{if(!l)throw new Error("try statement without catch or finally");if(this.prev<s.finallyLoc)return n(s.finallyLoc)}}}},abrupt:function(t,e){for(var n=this.tryEntries.length-1;n>=0;--n){var i=this.tryEntries[n];if(i.tryLoc<=this.prev&&r.call(i,"finallyLoc")&&this.prev<i.finallyLoc){var s=i;break}}s&&("break"===t||"continue"===t)&&s.tryLoc<=e&&e<=s.finallyLoc&&(s=null);var o=s?s.completion:{};return o.type=t,o.arg=e,s?(this.method="next",this.next=s.finallyLoc,h):this.complete(o)},complete:function(t,e){if("throw"===t.type)throw t.arg;return"break"===t.type||"continue"===t.type?this.next=t.arg:"return"===t.type?(this.rval=this.arg=t.arg,this.method="return",this.next="end"):"normal"===t.type&&e&&(this.next=e),h},finish:function(t){for(var e=this.tryEntries.length-1;e>=0;--e){var r=this.tryEntries[e];if(r.finallyLoc===t)return this.complete(r.completion,r.afterLoc),S(r),h}},catch:function(t){for(var e=this.tryEntries.length-1;e>=0;--e){var r=this.tryEntries[e];if(r.tryLoc===t){var n=r.completion;if("throw"===n.type){var i=n.arg;S(r)}return i}}throw new Error("illegal catch attempt")},delegateYield:function(t,e,r){return this.delegate={iterator:_(t),resultName:e,nextLoc:r},"next"===this.method&&(this.arg=void 0),h}},t}function rt(t,e,r,n,i,s,o){try{var a=t[s](o),l=a.value}catch(t){return void r(t)}a.done?e(l):Promise.resolve(l).then(n,i)}var nt=null;const it={namespace:"single-feature",beforeEnter:function(){var t=function(t){return function(){var e=this,r=arguments;return new Promise((function(n,i){var s=t.apply(e,r);function o(t){rt(s,n,i,o,a,"next",t)}function a(t){rt(s,n,i,o,a,"throw",t)}o(void 0)}))}}(et().mark((function t(e){var n,i,o;return et().wrap((function(t){for(;;)switch(t.prev=t.next){case 0:return e.current,n=e.next,e.trigger,t.next=3,(0,s.y6)(WPURLS.themeUrl+"/dist/css/_essay.css");case 3:return t.next=5,Promise.all([r.e(812),r.e(5927),r.e(4041),r.e(4371)]).then(r.bind(r,9007));case 5:i=t.sent,o=i.default,(nt=new o(n.container)).init();case 9:case"end":return t.stop()}}),t)})));return function(e){return t.apply(this,arguments)}}(),afterEnter:function(t){t.current;var e=t.next;t.trigger;e.container.querySelector(".essay-header").classList.remove("essay-header--animating"),e.container.querySelector(".essay-content").classList.remove("essay-content--animating")},afterLeave:function(t){t.current,t.next,t.trigger;nt.destroy(),nt=null}};function st(t){return st="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(t){return typeof t}:function(t){return t&&"function"==typeof Symbol&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t},st(t)}function ot(){ot=function(){return t};var t={},e=Object.prototype,r=e.hasOwnProperty,n=Object.defineProperty||function(t,e,r){t[e]=r.value},i="function"==typeof Symbol?Symbol:{},s=i.iterator||"@@iterator",o=i.asyncIterator||"@@asyncIterator",a=i.toStringTag||"@@toStringTag";function l(t,e,r){return Object.defineProperty(t,e,{value:r,enumerable:!0,configurable:!0,writable:!0}),t[e]}try{l({},"")}catch(t){l=function(t,e,r){return t[e]=r}}function c(t,e,r,i){var s=e&&e.prototype instanceof d?e:d,o=Object.create(s.prototype),a=new L(i||[]);return n(o,"_invoke",{value:A(t,r,a)}),o}function u(t,e,r){try{return{type:"normal",arg:t.call(e,r)}}catch(t){return{type:"throw",arg:t}}}t.wrap=c;var h={};function d(){}function f(){}function p(){}var g={};l(g,s,(function(){return this}));var m=Object.getPrototypeOf,y=m&&m(m(_([])));y&&y!==e&&r.call(y,s)&&(g=y);var v=p.prototype=d.prototype=Object.create(g);function b(t){["next","throw","return"].forEach((function(e){l(t,e,(function(t){return this._invoke(e,t)}))}))}function E(t,e){function i(n,s,o,a){var l=u(t[n],t,s);if("throw"!==l.type){var c=l.arg,h=c.value;return h&&"object"==st(h)&&r.call(h,"__await")?e.resolve(h.__await).then((function(t){i("next",t,o,a)}),(function(t){i("throw",t,o,a)})):e.resolve(h).then((function(t){c.value=t,o(c)}),(function(t){return i("throw",t,o,a)}))}a(l.arg)}var s;n(this,"_invoke",{value:function(t,r){function n(){return new e((function(e,n){i(t,r,e,n)}))}return s=s?s.then(n,n):n()}})}function A(t,e,r){var n="suspendedStart";return function(i,s){if("executing"===n)throw new Error("Generator is already running");if("completed"===n){if("throw"===i)throw s;return x()}for(r.method=i,r.arg=s;;){var o=r.delegate;if(o){var a=w(o,r);if(a){if(a===h)continue;return a}}if("next"===r.method)r.sent=r._sent=r.arg;else if("throw"===r.method){if("suspendedStart"===n)throw n="completed",r.arg;r.dispatchException(r.arg)}else"return"===r.method&&r.abrupt("return",r.arg);n="executing";var l=u(t,e,r);if("normal"===l.type){if(n=r.done?"completed":"suspendedYield",l.arg===h)continue;return{value:l.arg,done:r.done}}"throw"===l.type&&(n="completed",r.method="throw",r.arg=l.arg)}}}function w(t,e){var r=e.method,n=t.iterator[r];if(void 0===n)return e.delegate=null,"throw"===r&&t.iterator.return&&(e.method="return",e.arg=void 0,w(t,e),"throw"===e.method)||"return"!==r&&(e.method="throw",e.arg=new TypeError("The iterator does not provide a '"+r+"' method")),h;var i=u(n,t.iterator,e.arg);if("throw"===i.type)return e.method="throw",e.arg=i.arg,e.delegate=null,h;var s=i.arg;return s?s.done?(e[t.resultName]=s.value,e.next=t.nextLoc,"return"!==e.method&&(e.method="next",e.arg=void 0),e.delegate=null,h):s:(e.method="throw",e.arg=new TypeError("iterator result is not an object"),e.delegate=null,h)}function T(t){var e={tryLoc:t[0]};1 in t&&(e.catchLoc=t[1]),2 in t&&(e.finallyLoc=t[2],e.afterLoc=t[3]),this.tryEntries.push(e)}function S(t){var e=t.completion||{};e.type="normal",delete e.arg,t.completion=e}function L(t){this.tryEntries=[{tryLoc:"root"}],t.forEach(T,this),this.reset(!0)}function _(t){if(t){var e=t[s];if(e)return e.call(t);if("function"==typeof t.next)return t;if(!isNaN(t.length)){var n=-1,i=function e(){for(;++n<t.length;)if(r.call(t,n))return e.value=t[n],e.done=!1,e;return e.value=void 0,e.done=!0,e};return i.next=i}}return{next:x}}function x(){return{value:void 0,done:!0}}return f.prototype=p,n(v,"constructor",{value:p,configurable:!0}),n(p,"constructor",{value:f,configurable:!0}),f.displayName=l(p,a,"GeneratorFunction"),t.isGeneratorFunction=function(t){var e="function"==typeof t&&t.constructor;return!!e&&(e===f||"GeneratorFunction"===(e.displayName||e.name))},t.mark=function(t){return Object.setPrototypeOf?Object.setPrototypeOf(t,p):(t.__proto__=p,l(t,a,"GeneratorFunction")),t.prototype=Object.create(v),t},t.awrap=function(t){return{__await:t}},b(E.prototype),l(E.prototype,o,(function(){return this})),t.AsyncIterator=E,t.async=function(e,r,n,i,s){void 0===s&&(s=Promise);var o=new E(c(e,r,n,i),s);return t.isGeneratorFunction(r)?o:o.next().then((function(t){return t.done?t.value:o.next()}))},b(v),l(v,a,"Generator"),l(v,s,(function(){return this})),l(v,"toString",(function(){return"[object Generator]"})),t.keys=function(t){var e=Object(t),r=[];for(var n in e)r.push(n);return r.reverse(),function t(){for(;r.length;){var n=r.pop();if(n in e)return t.value=n,t.done=!1,t}return t.done=!0,t}},t.values=_,L.prototype={constructor:L,reset:function(t){if(this.prev=0,this.next=0,this.sent=this._sent=void 0,this.done=!1,this.delegate=null,this.method="next",this.arg=void 0,this.tryEntries.forEach(S),!t)for(var e in this)"t"===e.charAt(0)&&r.call(this,e)&&!isNaN(+e.slice(1))&&(this[e]=void 0)},stop:function(){this.done=!0;var t=this.tryEntries[0].completion;if("throw"===t.type)throw t.arg;return this.rval},dispatchException:function(t){if(this.done)throw t;var e=this;function n(r,n){return o.type="throw",o.arg=t,e.next=r,n&&(e.method="next",e.arg=void 0),!!n}for(var i=this.tryEntries.length-1;i>=0;--i){var s=this.tryEntries[i],o=s.completion;if("root"===s.tryLoc)return n("end");if(s.tryLoc<=this.prev){var a=r.call(s,"catchLoc"),l=r.call(s,"finallyLoc");if(a&&l){if(this.prev<s.catchLoc)return n(s.catchLoc,!0);if(this.prev<s.finallyLoc)return n(s.finallyLoc)}else if(a){if(this.prev<s.catchLoc)return n(s.catchLoc,!0)}else{if(!l)throw new Error("try statement without catch or finally");if(this.prev<s.finallyLoc)return n(s.finallyLoc)}}}},abrupt:function(t,e){for(var n=this.tryEntries.length-1;n>=0;--n){var i=this.tryEntries[n];if(i.tryLoc<=this.prev&&r.call(i,"finallyLoc")&&this.prev<i.finallyLoc){var s=i;break}}s&&("break"===t||"continue"===t)&&s.tryLoc<=e&&e<=s.finallyLoc&&(s=null);var o=s?s.completion:{};return o.type=t,o.arg=e,s?(this.method="next",this.next=s.finallyLoc,h):this.complete(o)},complete:function(t,e){if("throw"===t.type)throw t.arg;return"break"===t.type||"continue"===t.type?this.next=t.arg:"return"===t.type?(this.rval=this.arg=t.arg,this.method="return",this.next="end"):"normal"===t.type&&e&&(this.next=e),h},finish:function(t){for(var e=this.tryEntries.length-1;e>=0;--e){var r=this.tryEntries[e];if(r.finallyLoc===t)return this.complete(r.completion,r.afterLoc),S(r),h}},catch:function(t){for(var e=this.tryEntries.length-1;e>=0;--e){var r=this.tryEntries[e];if(r.tryLoc===t){var n=r.completion;if("throw"===n.type){var i=n.arg;S(r)}return i}}throw new Error("illegal catch attempt")},delegateYield:function(t,e,r){return this.delegate={iterator:_(t),resultName:e,nextLoc:r},"next"===this.method&&(this.arg=void 0),h}},t}function at(t,e,r,n,i,s,o){try{var a=t[s](o),l=a.value}catch(t){return void r(t)}a.done?e(l):Promise.resolve(l).then(n,i)}var lt=null;const ct={namespace:"single-poem",beforeEnter:function(){var t=function(t){return function(){var e=this,r=arguments;return new Promise((function(n,i){var s=t.apply(e,r);function o(t){at(s,n,i,o,a,"next",t)}function a(t){at(s,n,i,o,a,"throw",t)}o(void 0)}))}}(ot().mark((function t(e){var n,i,o;return ot().wrap((function(t){for(;;)switch(t.prev=t.next){case 0:return e.current,n=e.next,e.trigger,t.next=3,(0,s.y6)(WPURLS.themeUrl+"/dist/css/_essay.css");case 3:return t.next=5,Promise.all([r.e(812),r.e(5927),r.e(4041),r.e(4371)]).then(r.bind(r,9007));case 5:i=t.sent,o=i.default,(lt=new o(n.container)).init();case 9:case"end":return t.stop()}}),t)})));return function(e){return t.apply(this,arguments)}}(),afterEnter:function(t){t.current;var e=t.next;t.trigger;e.container.querySelector(".essay-header").classList.remove("essay-header--animating"),e.container.querySelector(".essay-content").classList.remove("essay-content--animating")},afterLeave:function(t){t.current,t.next,t.trigger;lt.destroy(),lt=null}};function ut(t){return ut="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(t){return typeof t}:function(t){return t&&"function"==typeof Symbol&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t},ut(t)}function ht(){ht=function(){return t};var t={},e=Object.prototype,r=e.hasOwnProperty,n=Object.defineProperty||function(t,e,r){t[e]=r.value},i="function"==typeof Symbol?Symbol:{},s=i.iterator||"@@iterator",o=i.asyncIterator||"@@asyncIterator",a=i.toStringTag||"@@toStringTag";function l(t,e,r){return Object.defineProperty(t,e,{value:r,enumerable:!0,configurable:!0,writable:!0}),t[e]}try{l({},"")}catch(t){l=function(t,e,r){return t[e]=r}}function c(t,e,r,i){var s=e&&e.prototype instanceof d?e:d,o=Object.create(s.prototype),a=new L(i||[]);return n(o,"_invoke",{value:A(t,r,a)}),o}function u(t,e,r){try{return{type:"normal",arg:t.call(e,r)}}catch(t){return{type:"throw",arg:t}}}t.wrap=c;var h={};function d(){}function f(){}function p(){}var g={};l(g,s,(function(){return this}));var m=Object.getPrototypeOf,y=m&&m(m(_([])));y&&y!==e&&r.call(y,s)&&(g=y);var v=p.prototype=d.prototype=Object.create(g);function b(t){["next","throw","return"].forEach((function(e){l(t,e,(function(t){return this._invoke(e,t)}))}))}function E(t,e){function i(n,s,o,a){var l=u(t[n],t,s);if("throw"!==l.type){var c=l.arg,h=c.value;return h&&"object"==ut(h)&&r.call(h,"__await")?e.resolve(h.__await).then((function(t){i("next",t,o,a)}),(function(t){i("throw",t,o,a)})):e.resolve(h).then((function(t){c.value=t,o(c)}),(function(t){return i("throw",t,o,a)}))}a(l.arg)}var s;n(this,"_invoke",{value:function(t,r){function n(){return new e((function(e,n){i(t,r,e,n)}))}return s=s?s.then(n,n):n()}})}function A(t,e,r){var n="suspendedStart";return function(i,s){if("executing"===n)throw new Error("Generator is already running");if("completed"===n){if("throw"===i)throw s;return x()}for(r.method=i,r.arg=s;;){var o=r.delegate;if(o){var a=w(o,r);if(a){if(a===h)continue;return a}}if("next"===r.method)r.sent=r._sent=r.arg;else if("throw"===r.method){if("suspendedStart"===n)throw n="completed",r.arg;r.dispatchException(r.arg)}else"return"===r.method&&r.abrupt("return",r.arg);n="executing";var l=u(t,e,r);if("normal"===l.type){if(n=r.done?"completed":"suspendedYield",l.arg===h)continue;return{value:l.arg,done:r.done}}"throw"===l.type&&(n="completed",r.method="throw",r.arg=l.arg)}}}function w(t,e){var r=e.method,n=t.iterator[r];if(void 0===n)return e.delegate=null,"throw"===r&&t.iterator.return&&(e.method="return",e.arg=void 0,w(t,e),"throw"===e.method)||"return"!==r&&(e.method="throw",e.arg=new TypeError("The iterator does not provide a '"+r+"' method")),h;var i=u(n,t.iterator,e.arg);if("throw"===i.type)return e.method="throw",e.arg=i.arg,e.delegate=null,h;var s=i.arg;return s?s.done?(e[t.resultName]=s.value,e.next=t.nextLoc,"return"!==e.method&&(e.method="next",e.arg=void 0),e.delegate=null,h):s:(e.method="throw",e.arg=new TypeError("iterator result is not an object"),e.delegate=null,h)}function T(t){var e={tryLoc:t[0]};1 in t&&(e.catchLoc=t[1]),2 in t&&(e.finallyLoc=t[2],e.afterLoc=t[3]),this.tryEntries.push(e)}function S(t){var e=t.completion||{};e.type="normal",delete e.arg,t.completion=e}function L(t){this.tryEntries=[{tryLoc:"root"}],t.forEach(T,this),this.reset(!0)}function _(t){if(t){var e=t[s];if(e)return e.call(t);if("function"==typeof t.next)return t;if(!isNaN(t.length)){var n=-1,i=function e(){for(;++n<t.length;)if(r.call(t,n))return e.value=t[n],e.done=!1,e;return e.value=void 0,e.done=!0,e};return i.next=i}}return{next:x}}function x(){return{value:void 0,done:!0}}return f.prototype=p,n(v,"constructor",{value:p,configurable:!0}),n(p,"constructor",{value:f,configurable:!0}),f.displayName=l(p,a,"GeneratorFunction"),t.isGeneratorFunction=function(t){var e="function"==typeof t&&t.constructor;return!!e&&(e===f||"GeneratorFunction"===(e.displayName||e.name))},t.mark=function(t){return Object.setPrototypeOf?Object.setPrototypeOf(t,p):(t.__proto__=p,l(t,a,"GeneratorFunction")),t.prototype=Object.create(v),t},t.awrap=function(t){return{__await:t}},b(E.prototype),l(E.prototype,o,(function(){return this})),t.AsyncIterator=E,t.async=function(e,r,n,i,s){void 0===s&&(s=Promise);var o=new E(c(e,r,n,i),s);return t.isGeneratorFunction(r)?o:o.next().then((function(t){return t.done?t.value:o.next()}))},b(v),l(v,a,"Generator"),l(v,s,(function(){return this})),l(v,"toString",(function(){return"[object Generator]"})),t.keys=function(t){var e=Object(t),r=[];for(var n in e)r.push(n);return r.reverse(),function t(){for(;r.length;){var n=r.pop();if(n in e)return t.value=n,t.done=!1,t}return t.done=!0,t}},t.values=_,L.prototype={constructor:L,reset:function(t){if(this.prev=0,this.next=0,this.sent=this._sent=void 0,this.done=!1,this.delegate=null,this.method="next",this.arg=void 0,this.tryEntries.forEach(S),!t)for(var e in this)"t"===e.charAt(0)&&r.call(this,e)&&!isNaN(+e.slice(1))&&(this[e]=void 0)},stop:function(){this.done=!0;var t=this.tryEntries[0].completion;if("throw"===t.type)throw t.arg;return this.rval},dispatchException:function(t){if(this.done)throw t;var e=this;function n(r,n){return o.type="throw",o.arg=t,e.next=r,n&&(e.method="next",e.arg=void 0),!!n}for(var i=this.tryEntries.length-1;i>=0;--i){var s=this.tryEntries[i],o=s.completion;if("root"===s.tryLoc)return n("end");if(s.tryLoc<=this.prev){var a=r.call(s,"catchLoc"),l=r.call(s,"finallyLoc");if(a&&l){if(this.prev<s.catchLoc)return n(s.catchLoc,!0);if(this.prev<s.finallyLoc)return n(s.finallyLoc)}else if(a){if(this.prev<s.catchLoc)return n(s.catchLoc,!0)}else{if(!l)throw new Error("try statement without catch or finally");if(this.prev<s.finallyLoc)return n(s.finallyLoc)}}}},abrupt:function(t,e){for(var n=this.tryEntries.length-1;n>=0;--n){var i=this.tryEntries[n];if(i.tryLoc<=this.prev&&r.call(i,"finallyLoc")&&this.prev<i.finallyLoc){var s=i;break}}s&&("break"===t||"continue"===t)&&s.tryLoc<=e&&e<=s.finallyLoc&&(s=null);var o=s?s.completion:{};return o.type=t,o.arg=e,s?(this.method="next",this.next=s.finallyLoc,h):this.complete(o)},complete:function(t,e){if("throw"===t.type)throw t.arg;return"break"===t.type||"continue"===t.type?this.next=t.arg:"return"===t.type?(this.rval=this.arg=t.arg,this.method="return",this.next="end"):"normal"===t.type&&e&&(this.next=e),h},finish:function(t){for(var e=this.tryEntries.length-1;e>=0;--e){var r=this.tryEntries[e];if(r.finallyLoc===t)return this.complete(r.completion,r.afterLoc),S(r),h}},catch:function(t){for(var e=this.tryEntries.length-1;e>=0;--e){var r=this.tryEntries[e];if(r.tryLoc===t){var n=r.completion;if("throw"===n.type){var i=n.arg;S(r)}return i}}throw new Error("illegal catch attempt")},delegateYield:function(t,e,r){return this.delegate={iterator:_(t),resultName:e,nextLoc:r},"next"===this.method&&(this.arg=void 0),h}},t}function dt(t,e,r,n,i,s,o){try{var a=t[s](o),l=a.value}catch(t){return void r(t)}a.done?e(l):Promise.resolve(l).then(n,i)}var ft=null;const pt={namespace:"template-events",beforeEnter:function(){var t=function(t){return function(){var e=this,r=arguments;return new Promise((function(n,i){var s=t.apply(e,r);function o(t){dt(s,n,i,o,a,"next",t)}function a(t){dt(s,n,i,o,a,"throw",t)}o(void 0)}))}}(ht().mark((function t(e){var n,i,o;return ht().wrap((function(t){for(;;)switch(t.prev=t.next){case 0:return e.current,n=e.next,e.trigger,t.next=3,(0,s.y6)(WPURLS.themeUrl+"/dist/css/_events.css");case 3:return t.next=5,Promise.all([r.e(812),r.e(5927),r.e(4268)]).then(r.bind(r,5303));case 5:i=t.sent,o=i.default,(ft=new o(n.container)).init();case 9:case"end":return t.stop()}}),t)})));return function(e){return t.apply(this,arguments)}}(),afterLeave:function(t){t.current,t.next,t.trigger;ft.destroy(),ft=null}};function gt(t){return gt="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(t){return typeof t}:function(t){return t&&"function"==typeof Symbol&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t},gt(t)}function mt(){mt=function(){return t};var t={},e=Object.prototype,r=e.hasOwnProperty,n=Object.defineProperty||function(t,e,r){t[e]=r.value},i="function"==typeof Symbol?Symbol:{},s=i.iterator||"@@iterator",o=i.asyncIterator||"@@asyncIterator",a=i.toStringTag||"@@toStringTag";function l(t,e,r){return Object.defineProperty(t,e,{value:r,enumerable:!0,configurable:!0,writable:!0}),t[e]}try{l({},"")}catch(t){l=function(t,e,r){return t[e]=r}}function c(t,e,r,i){var s=e&&e.prototype instanceof d?e:d,o=Object.create(s.prototype),a=new L(i||[]);return n(o,"_invoke",{value:A(t,r,a)}),o}function u(t,e,r){try{return{type:"normal",arg:t.call(e,r)}}catch(t){return{type:"throw",arg:t}}}t.wrap=c;var h={};function d(){}function f(){}function p(){}var g={};l(g,s,(function(){return this}));var m=Object.getPrototypeOf,y=m&&m(m(_([])));y&&y!==e&&r.call(y,s)&&(g=y);var v=p.prototype=d.prototype=Object.create(g);function b(t){["next","throw","return"].forEach((function(e){l(t,e,(function(t){return this._invoke(e,t)}))}))}function E(t,e){function i(n,s,o,a){var l=u(t[n],t,s);if("throw"!==l.type){var c=l.arg,h=c.value;return h&&"object"==gt(h)&&r.call(h,"__await")?e.resolve(h.__await).then((function(t){i("next",t,o,a)}),(function(t){i("throw",t,o,a)})):e.resolve(h).then((function(t){c.value=t,o(c)}),(function(t){return i("throw",t,o,a)}))}a(l.arg)}var s;n(this,"_invoke",{value:function(t,r){function n(){return new e((function(e,n){i(t,r,e,n)}))}return s=s?s.then(n,n):n()}})}function A(t,e,r){var n="suspendedStart";return function(i,s){if("executing"===n)throw new Error("Generator is already running");if("completed"===n){if("throw"===i)throw s;return x()}for(r.method=i,r.arg=s;;){var o=r.delegate;if(o){var a=w(o,r);if(a){if(a===h)continue;return a}}if("next"===r.method)r.sent=r._sent=r.arg;else if("throw"===r.method){if("suspendedStart"===n)throw n="completed",r.arg;r.dispatchException(r.arg)}else"return"===r.method&&r.abrupt("return",r.arg);n="executing";var l=u(t,e,r);if("normal"===l.type){if(n=r.done?"completed":"suspendedYield",l.arg===h)continue;return{value:l.arg,done:r.done}}"throw"===l.type&&(n="completed",r.method="throw",r.arg=l.arg)}}}function w(t,e){var r=e.method,n=t.iterator[r];if(void 0===n)return e.delegate=null,"throw"===r&&t.iterator.return&&(e.method="return",e.arg=void 0,w(t,e),"throw"===e.method)||"return"!==r&&(e.method="throw",e.arg=new TypeError("The iterator does not provide a '"+r+"' method")),h;var i=u(n,t.iterator,e.arg);if("throw"===i.type)return e.method="throw",e.arg=i.arg,e.delegate=null,h;var s=i.arg;return s?s.done?(e[t.resultName]=s.value,e.next=t.nextLoc,"return"!==e.method&&(e.method="next",e.arg=void 0),e.delegate=null,h):s:(e.method="throw",e.arg=new TypeError("iterator result is not an object"),e.delegate=null,h)}function T(t){var e={tryLoc:t[0]};1 in t&&(e.catchLoc=t[1]),2 in t&&(e.finallyLoc=t[2],e.afterLoc=t[3]),this.tryEntries.push(e)}function S(t){var e=t.completion||{};e.type="normal",delete e.arg,t.completion=e}function L(t){this.tryEntries=[{tryLoc:"root"}],t.forEach(T,this),this.reset(!0)}function _(t){if(t){var e=t[s];if(e)return e.call(t);if("function"==typeof t.next)return t;if(!isNaN(t.length)){var n=-1,i=function e(){for(;++n<t.length;)if(r.call(t,n))return e.value=t[n],e.done=!1,e;return e.value=void 0,e.done=!0,e};return i.next=i}}return{next:x}}function x(){return{value:void 0,done:!0}}return f.prototype=p,n(v,"constructor",{value:p,configurable:!0}),n(p,"constructor",{value:f,configurable:!0}),f.displayName=l(p,a,"GeneratorFunction"),t.isGeneratorFunction=function(t){var e="function"==typeof t&&t.constructor;return!!e&&(e===f||"GeneratorFunction"===(e.displayName||e.name))},t.mark=function(t){return Object.setPrototypeOf?Object.setPrototypeOf(t,p):(t.__proto__=p,l(t,a,"GeneratorFunction")),t.prototype=Object.create(v),t},t.awrap=function(t){return{__await:t}},b(E.prototype),l(E.prototype,o,(function(){return this})),t.AsyncIterator=E,t.async=function(e,r,n,i,s){void 0===s&&(s=Promise);var o=new E(c(e,r,n,i),s);return t.isGeneratorFunction(r)?o:o.next().then((function(t){return t.done?t.value:o.next()}))},b(v),l(v,a,"Generator"),l(v,s,(function(){return this})),l(v,"toString",(function(){return"[object Generator]"})),t.keys=function(t){var e=Object(t),r=[];for(var n in e)r.push(n);return r.reverse(),function t(){for(;r.length;){var n=r.pop();if(n in e)return t.value=n,t.done=!1,t}return t.done=!0,t}},t.values=_,L.prototype={constructor:L,reset:function(t){if(this.prev=0,this.next=0,this.sent=this._sent=void 0,this.done=!1,this.delegate=null,this.method="next",this.arg=void 0,this.tryEntries.forEach(S),!t)for(var e in this)"t"===e.charAt(0)&&r.call(this,e)&&!isNaN(+e.slice(1))&&(this[e]=void 0)},stop:function(){this.done=!0;var t=this.tryEntries[0].completion;if("throw"===t.type)throw t.arg;return this.rval},dispatchException:function(t){if(this.done)throw t;var e=this;function n(r,n){return o.type="throw",o.arg=t,e.next=r,n&&(e.method="next",e.arg=void 0),!!n}for(var i=this.tryEntries.length-1;i>=0;--i){var s=this.tryEntries[i],o=s.completion;if("root"===s.tryLoc)return n("end");if(s.tryLoc<=this.prev){var a=r.call(s,"catchLoc"),l=r.call(s,"finallyLoc");if(a&&l){if(this.prev<s.catchLoc)return n(s.catchLoc,!0);if(this.prev<s.finallyLoc)return n(s.finallyLoc)}else if(a){if(this.prev<s.catchLoc)return n(s.catchLoc,!0)}else{if(!l)throw new Error("try statement without catch or finally");if(this.prev<s.finallyLoc)return n(s.finallyLoc)}}}},abrupt:function(t,e){for(var n=this.tryEntries.length-1;n>=0;--n){var i=this.tryEntries[n];if(i.tryLoc<=this.prev&&r.call(i,"finallyLoc")&&this.prev<i.finallyLoc){var s=i;break}}s&&("break"===t||"continue"===t)&&s.tryLoc<=e&&e<=s.finallyLoc&&(s=null);var o=s?s.completion:{};return o.type=t,o.arg=e,s?(this.method="next",this.next=s.finallyLoc,h):this.complete(o)},complete:function(t,e){if("throw"===t.type)throw t.arg;return"break"===t.type||"continue"===t.type?this.next=t.arg:"return"===t.type?(this.rval=this.arg=t.arg,this.method="return",this.next="end"):"normal"===t.type&&e&&(this.next=e),h},finish:function(t){for(var e=this.tryEntries.length-1;e>=0;--e){var r=this.tryEntries[e];if(r.finallyLoc===t)return this.complete(r.completion,r.afterLoc),S(r),h}},catch:function(t){for(var e=this.tryEntries.length-1;e>=0;--e){var r=this.tryEntries[e];if(r.tryLoc===t){var n=r.completion;if("throw"===n.type){var i=n.arg;S(r)}return i}}throw new Error("illegal catch attempt")},delegateYield:function(t,e,r){return this.delegate={iterator:_(t),resultName:e,nextLoc:r},"next"===this.method&&(this.arg=void 0),h}},t}function yt(t,e,r,n,i,s,o){try{var a=t[s](o),l=a.value}catch(t){return void r(t)}a.done?e(l):Promise.resolve(l).then(n,i)}var vt=null;const bt={namespace:"single-event",beforeEnter:function(){var t=function(t){return function(){var e=this,r=arguments;return new Promise((function(n,i){var s=t.apply(e,r);function o(t){yt(s,n,i,o,a,"next",t)}function a(t){yt(s,n,i,o,a,"throw",t)}o(void 0)}))}}(mt().mark((function t(e){var n,i,o;return mt().wrap((function(t){for(;;)switch(t.prev=t.next){case 0:return e.current,n=e.next,e.trigger,t.next=3,(0,s.y6)(WPURLS.themeUrl+"/dist/css/_event.css");case 3:return t.next=5,r.e(2797).then(r.bind(r,9028));case 5:i=t.sent,o=i.default,(vt=new o(n.container)).init();case 9:case"end":return t.stop()}}),t)})));return function(e){return t.apply(this,arguments)}}(),afterLeave:function(t){t.current,t.next,t.trigger;vt.destroy(),vt=null}};function Et(t){return Et="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(t){return typeof t}:function(t){return t&&"function"==typeof Symbol&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t},Et(t)}function At(){At=function(){return t};var t={},e=Object.prototype,r=e.hasOwnProperty,n=Object.defineProperty||function(t,e,r){t[e]=r.value},i="function"==typeof Symbol?Symbol:{},s=i.iterator||"@@iterator",o=i.asyncIterator||"@@asyncIterator",a=i.toStringTag||"@@toStringTag";function l(t,e,r){return Object.defineProperty(t,e,{value:r,enumerable:!0,configurable:!0,writable:!0}),t[e]}try{l({},"")}catch(t){l=function(t,e,r){return t[e]=r}}function c(t,e,r,i){var s=e&&e.prototype instanceof d?e:d,o=Object.create(s.prototype),a=new L(i||[]);return n(o,"_invoke",{value:A(t,r,a)}),o}function u(t,e,r){try{return{type:"normal",arg:t.call(e,r)}}catch(t){return{type:"throw",arg:t}}}t.wrap=c;var h={};function d(){}function f(){}function p(){}var g={};l(g,s,(function(){return this}));var m=Object.getPrototypeOf,y=m&&m(m(_([])));y&&y!==e&&r.call(y,s)&&(g=y);var v=p.prototype=d.prototype=Object.create(g);function b(t){["next","throw","return"].forEach((function(e){l(t,e,(function(t){return this._invoke(e,t)}))}))}function E(t,e){function i(n,s,o,a){var l=u(t[n],t,s);if("throw"!==l.type){var c=l.arg,h=c.value;return h&&"object"==Et(h)&&r.call(h,"__await")?e.resolve(h.__await).then((function(t){i("next",t,o,a)}),(function(t){i("throw",t,o,a)})):e.resolve(h).then((function(t){c.value=t,o(c)}),(function(t){return i("throw",t,o,a)}))}a(l.arg)}var s;n(this,"_invoke",{value:function(t,r){function n(){return new e((function(e,n){i(t,r,e,n)}))}return s=s?s.then(n,n):n()}})}function A(t,e,r){var n="suspendedStart";return function(i,s){if("executing"===n)throw new Error("Generator is already running");if("completed"===n){if("throw"===i)throw s;return x()}for(r.method=i,r.arg=s;;){var o=r.delegate;if(o){var a=w(o,r);if(a){if(a===h)continue;return a}}if("next"===r.method)r.sent=r._sent=r.arg;else if("throw"===r.method){if("suspendedStart"===n)throw n="completed",r.arg;r.dispatchException(r.arg)}else"return"===r.method&&r.abrupt("return",r.arg);n="executing";var l=u(t,e,r);if("normal"===l.type){if(n=r.done?"completed":"suspendedYield",l.arg===h)continue;return{value:l.arg,done:r.done}}"throw"===l.type&&(n="completed",r.method="throw",r.arg=l.arg)}}}function w(t,e){var r=e.method,n=t.iterator[r];if(void 0===n)return e.delegate=null,"throw"===r&&t.iterator.return&&(e.method="return",e.arg=void 0,w(t,e),"throw"===e.method)||"return"!==r&&(e.method="throw",e.arg=new TypeError("The iterator does not provide a '"+r+"' method")),h;var i=u(n,t.iterator,e.arg);if("throw"===i.type)return e.method="throw",e.arg=i.arg,e.delegate=null,h;var s=i.arg;return s?s.done?(e[t.resultName]=s.value,e.next=t.nextLoc,"return"!==e.method&&(e.method="next",e.arg=void 0),e.delegate=null,h):s:(e.method="throw",e.arg=new TypeError("iterator result is not an object"),e.delegate=null,h)}function T(t){var e={tryLoc:t[0]};1 in t&&(e.catchLoc=t[1]),2 in t&&(e.finallyLoc=t[2],e.afterLoc=t[3]),this.tryEntries.push(e)}function S(t){var e=t.completion||{};e.type="normal",delete e.arg,t.completion=e}function L(t){this.tryEntries=[{tryLoc:"root"}],t.forEach(T,this),this.reset(!0)}function _(t){if(t){var e=t[s];if(e)return e.call(t);if("function"==typeof t.next)return t;if(!isNaN(t.length)){var n=-1,i=function e(){for(;++n<t.length;)if(r.call(t,n))return e.value=t[n],e.done=!1,e;return e.value=void 0,e.done=!0,e};return i.next=i}}return{next:x}}function x(){return{value:void 0,done:!0}}return f.prototype=p,n(v,"constructor",{value:p,configurable:!0}),n(p,"constructor",{value:f,configurable:!0}),f.displayName=l(p,a,"GeneratorFunction"),t.isGeneratorFunction=function(t){var e="function"==typeof t&&t.constructor;return!!e&&(e===f||"GeneratorFunction"===(e.displayName||e.name))},t.mark=function(t){return Object.setPrototypeOf?Object.setPrototypeOf(t,p):(t.__proto__=p,l(t,a,"GeneratorFunction")),t.prototype=Object.create(v),t},t.awrap=function(t){return{__await:t}},b(E.prototype),l(E.prototype,o,(function(){return this})),t.AsyncIterator=E,t.async=function(e,r,n,i,s){void 0===s&&(s=Promise);var o=new E(c(e,r,n,i),s);return t.isGeneratorFunction(r)?o:o.next().then((function(t){return t.done?t.value:o.next()}))},b(v),l(v,a,"Generator"),l(v,s,(function(){return this})),l(v,"toString",(function(){return"[object Generator]"})),t.keys=function(t){var e=Object(t),r=[];for(var n in e)r.push(n);return r.reverse(),function t(){for(;r.length;){var n=r.pop();if(n in e)return t.value=n,t.done=!1,t}return t.done=!0,t}},t.values=_,L.prototype={constructor:L,reset:function(t){if(this.prev=0,this.next=0,this.sent=this._sent=void 0,this.done=!1,this.delegate=null,this.method="next",this.arg=void 0,this.tryEntries.forEach(S),!t)for(var e in this)"t"===e.charAt(0)&&r.call(this,e)&&!isNaN(+e.slice(1))&&(this[e]=void 0)},stop:function(){this.done=!0;var t=this.tryEntries[0].completion;if("throw"===t.type)throw t.arg;return this.rval},dispatchException:function(t){if(this.done)throw t;var e=this;function n(r,n){return o.type="throw",o.arg=t,e.next=r,n&&(e.method="next",e.arg=void 0),!!n}for(var i=this.tryEntries.length-1;i>=0;--i){var s=this.tryEntries[i],o=s.completion;if("root"===s.tryLoc)return n("end");if(s.tryLoc<=this.prev){var a=r.call(s,"catchLoc"),l=r.call(s,"finallyLoc");if(a&&l){if(this.prev<s.catchLoc)return n(s.catchLoc,!0);if(this.prev<s.finallyLoc)return n(s.finallyLoc)}else if(a){if(this.prev<s.catchLoc)return n(s.catchLoc,!0)}else{if(!l)throw new Error("try statement without catch or finally");if(this.prev<s.finallyLoc)return n(s.finallyLoc)}}}},abrupt:function(t,e){for(var n=this.tryEntries.length-1;n>=0;--n){var i=this.tryEntries[n];if(i.tryLoc<=this.prev&&r.call(i,"finallyLoc")&&this.prev<i.finallyLoc){var s=i;break}}s&&("break"===t||"continue"===t)&&s.tryLoc<=e&&e<=s.finallyLoc&&(s=null);var o=s?s.completion:{};return o.type=t,o.arg=e,s?(this.method="next",this.next=s.finallyLoc,h):this.complete(o)},complete:function(t,e){if("throw"===t.type)throw t.arg;return"break"===t.type||"continue"===t.type?this.next=t.arg:"return"===t.type?(this.rval=this.arg=t.arg,this.method="return",this.next="end"):"normal"===t.type&&e&&(this.next=e),h},finish:function(t){for(var e=this.tryEntries.length-1;e>=0;--e){var r=this.tryEntries[e];if(r.finallyLoc===t)return this.complete(r.completion,r.afterLoc),S(r),h}},catch:function(t){for(var e=this.tryEntries.length-1;e>=0;--e){var r=this.tryEntries[e];if(r.tryLoc===t){var n=r.completion;if("throw"===n.type){var i=n.arg;S(r)}return i}}throw new Error("illegal catch attempt")},delegateYield:function(t,e,r){return this.delegate={iterator:_(t),resultName:e,nextLoc:r},"next"===this.method&&(this.arg=void 0),h}},t}function wt(t,e,r,n,i,s,o){try{var a=t[s](o),l=a.value}catch(t){return void r(t)}a.done?e(l):Promise.resolve(l).then(n,i)}var Tt=null;const St={namespace:"template-print",beforeEnter:function(){var t=function(t){return function(){var e=this,r=arguments;return new Promise((function(n,i){var s=t.apply(e,r);function o(t){wt(s,n,i,o,a,"next",t)}function a(t){wt(s,n,i,o,a,"throw",t)}o(void 0)}))}}(At().mark((function t(e){var n,i,o;return At().wrap((function(t){for(;;)switch(t.prev=t.next){case 0:return e.current,n=e.next,e.trigger,t.next=3,(0,s.y6)(WPURLS.themeUrl+"/dist/css/_print.css");case 3:return t.next=5,r.e(2568).then(r.bind(r,9049));case 5:i=t.sent,o=i.default,(Tt=new o(n.container)).init();case 9:case"end":return t.stop()}}),t)})));return function(e){return t.apply(this,arguments)}}(),afterLeave:function(t){t.current,t.next,t.trigger;Tt.destroy(),Tt=null}};function Lt(t){return Lt="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(t){return typeof t}:function(t){return t&&"function"==typeof Symbol&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t},Lt(t)}function _t(){_t=function(){return t};var t={},e=Object.prototype,r=e.hasOwnProperty,n=Object.defineProperty||function(t,e,r){t[e]=r.value},i="function"==typeof Symbol?Symbol:{},s=i.iterator||"@@iterator",o=i.asyncIterator||"@@asyncIterator",a=i.toStringTag||"@@toStringTag";function l(t,e,r){return Object.defineProperty(t,e,{value:r,enumerable:!0,configurable:!0,writable:!0}),t[e]}try{l({},"")}catch(t){l=function(t,e,r){return t[e]=r}}function c(t,e,r,i){var s=e&&e.prototype instanceof d?e:d,o=Object.create(s.prototype),a=new L(i||[]);return n(o,"_invoke",{value:A(t,r,a)}),o}function u(t,e,r){try{return{type:"normal",arg:t.call(e,r)}}catch(t){return{type:"throw",arg:t}}}t.wrap=c;var h={};function d(){}function f(){}function p(){}var g={};l(g,s,(function(){return this}));var m=Object.getPrototypeOf,y=m&&m(m(_([])));y&&y!==e&&r.call(y,s)&&(g=y);var v=p.prototype=d.prototype=Object.create(g);function b(t){["next","throw","return"].forEach((function(e){l(t,e,(function(t){return this._invoke(e,t)}))}))}function E(t,e){function i(n,s,o,a){var l=u(t[n],t,s);if("throw"!==l.type){var c=l.arg,h=c.value;return h&&"object"==Lt(h)&&r.call(h,"__await")?e.resolve(h.__await).then((function(t){i("next",t,o,a)}),(function(t){i("throw",t,o,a)})):e.resolve(h).then((function(t){c.value=t,o(c)}),(function(t){return i("throw",t,o,a)}))}a(l.arg)}var s;n(this,"_invoke",{value:function(t,r){function n(){return new e((function(e,n){i(t,r,e,n)}))}return s=s?s.then(n,n):n()}})}function A(t,e,r){var n="suspendedStart";return function(i,s){if("executing"===n)throw new Error("Generator is already running");if("completed"===n){if("throw"===i)throw s;return x()}for(r.method=i,r.arg=s;;){var o=r.delegate;if(o){var a=w(o,r);if(a){if(a===h)continue;return a}}if("next"===r.method)r.sent=r._sent=r.arg;else if("throw"===r.method){if("suspendedStart"===n)throw n="completed",r.arg;r.dispatchException(r.arg)}else"return"===r.method&&r.abrupt("return",r.arg);n="executing";var l=u(t,e,r);if("normal"===l.type){if(n=r.done?"completed":"suspendedYield",l.arg===h)continue;return{value:l.arg,done:r.done}}"throw"===l.type&&(n="completed",r.method="throw",r.arg=l.arg)}}}function w(t,e){var r=e.method,n=t.iterator[r];if(void 0===n)return e.delegate=null,"throw"===r&&t.iterator.return&&(e.method="return",e.arg=void 0,w(t,e),"throw"===e.method)||"return"!==r&&(e.method="throw",e.arg=new TypeError("The iterator does not provide a '"+r+"' method")),h;var i=u(n,t.iterator,e.arg);if("throw"===i.type)return e.method="throw",e.arg=i.arg,e.delegate=null,h;var s=i.arg;return s?s.done?(e[t.resultName]=s.value,e.next=t.nextLoc,"return"!==e.method&&(e.method="next",e.arg=void 0),e.delegate=null,h):s:(e.method="throw",e.arg=new TypeError("iterator result is not an object"),e.delegate=null,h)}function T(t){var e={tryLoc:t[0]};1 in t&&(e.catchLoc=t[1]),2 in t&&(e.finallyLoc=t[2],e.afterLoc=t[3]),this.tryEntries.push(e)}function S(t){var e=t.completion||{};e.type="normal",delete e.arg,t.completion=e}function L(t){this.tryEntries=[{tryLoc:"root"}],t.forEach(T,this),this.reset(!0)}function _(t){if(t){var e=t[s];if(e)return e.call(t);if("function"==typeof t.next)return t;if(!isNaN(t.length)){var n=-1,i=function e(){for(;++n<t.length;)if(r.call(t,n))return e.value=t[n],e.done=!1,e;return e.value=void 0,e.done=!0,e};return i.next=i}}return{next:x}}function x(){return{value:void 0,done:!0}}return f.prototype=p,n(v,"constructor",{value:p,configurable:!0}),n(p,"constructor",{value:f,configurable:!0}),f.displayName=l(p,a,"GeneratorFunction"),t.isGeneratorFunction=function(t){var e="function"==typeof t&&t.constructor;return!!e&&(e===f||"GeneratorFunction"===(e.displayName||e.name))},t.mark=function(t){return Object.setPrototypeOf?Object.setPrototypeOf(t,p):(t.__proto__=p,l(t,a,"GeneratorFunction")),t.prototype=Object.create(v),t},t.awrap=function(t){return{__await:t}},b(E.prototype),l(E.prototype,o,(function(){return this})),t.AsyncIterator=E,t.async=function(e,r,n,i,s){void 0===s&&(s=Promise);var o=new E(c(e,r,n,i),s);return t.isGeneratorFunction(r)?o:o.next().then((function(t){return t.done?t.value:o.next()}))},b(v),l(v,a,"Generator"),l(v,s,(function(){return this})),l(v,"toString",(function(){return"[object Generator]"})),t.keys=function(t){var e=Object(t),r=[];for(var n in e)r.push(n);return r.reverse(),function t(){for(;r.length;){var n=r.pop();if(n in e)return t.value=n,t.done=!1,t}return t.done=!0,t}},t.values=_,L.prototype={constructor:L,reset:function(t){if(this.prev=0,this.next=0,this.sent=this._sent=void 0,this.done=!1,this.delegate=null,this.method="next",this.arg=void 0,this.tryEntries.forEach(S),!t)for(var e in this)"t"===e.charAt(0)&&r.call(this,e)&&!isNaN(+e.slice(1))&&(this[e]=void 0)},stop:function(){this.done=!0;var t=this.tryEntries[0].completion;if("throw"===t.type)throw t.arg;return this.rval},dispatchException:function(t){if(this.done)throw t;var e=this;function n(r,n){return o.type="throw",o.arg=t,e.next=r,n&&(e.method="next",e.arg=void 0),!!n}for(var i=this.tryEntries.length-1;i>=0;--i){var s=this.tryEntries[i],o=s.completion;if("root"===s.tryLoc)return n("end");if(s.tryLoc<=this.prev){var a=r.call(s,"catchLoc"),l=r.call(s,"finallyLoc");if(a&&l){if(this.prev<s.catchLoc)return n(s.catchLoc,!0);if(this.prev<s.finallyLoc)return n(s.finallyLoc)}else if(a){if(this.prev<s.catchLoc)return n(s.catchLoc,!0)}else{if(!l)throw new Error("try statement without catch or finally");if(this.prev<s.finallyLoc)return n(s.finallyLoc)}}}},abrupt:function(t,e){for(var n=this.tryEntries.length-1;n>=0;--n){var i=this.tryEntries[n];if(i.tryLoc<=this.prev&&r.call(i,"finallyLoc")&&this.prev<i.finallyLoc){var s=i;break}}s&&("break"===t||"continue"===t)&&s.tryLoc<=e&&e<=s.finallyLoc&&(s=null);var o=s?s.completion:{};return o.type=t,o.arg=e,s?(this.method="next",this.next=s.finallyLoc,h):this.complete(o)},complete:function(t,e){if("throw"===t.type)throw t.arg;return"break"===t.type||"continue"===t.type?this.next=t.arg:"return"===t.type?(this.rval=this.arg=t.arg,this.method="return",this.next="end"):"normal"===t.type&&e&&(this.next=e),h},finish:function(t){for(var e=this.tryEntries.length-1;e>=0;--e){var r=this.tryEntries[e];if(r.finallyLoc===t)return this.complete(r.completion,r.afterLoc),S(r),h}},catch:function(t){for(var e=this.tryEntries.length-1;e>=0;--e){var r=this.tryEntries[e];if(r.tryLoc===t){var n=r.completion;if("throw"===n.type){var i=n.arg;S(r)}return i}}throw new Error("illegal catch attempt")},delegateYield:function(t,e,r){return this.delegate={iterator:_(t),resultName:e,nextLoc:r},"next"===this.method&&(this.arg=void 0),h}},t}function xt(t,e,r,n,i,s,o){try{var a=t[s](o),l=a.value}catch(t){return void r(t)}a.done?e(l):Promise.resolve(l).then(n,i)}var kt=null;const Pt={namespace:"single-print",beforeEnter:function(){var t=function(t){return function(){var e=this,r=arguments;return new Promise((function(n,i){var s=t.apply(e,r);function o(t){xt(s,n,i,o,a,"next",t)}function a(t){xt(s,n,i,o,a,"throw",t)}o(void 0)}))}}(_t().mark((function t(e){var n,i,o;return _t().wrap((function(t){for(;;)switch(t.prev=t.next){case 0:return e.current,n=e.next,e.trigger,t.next=3,(0,s.y6)(WPURLS.themeUrl+"/dist/css/_single-print.css");case 3:return t.next=5,Promise.all([r.e(812),r.e(5927),r.e(65)]).then(r.bind(r,9988));case 5:i=t.sent,o=i.default,(kt=new o(n.container)).init();case 9:case"end":return t.stop()}}),t)})));return function(e){return t.apply(this,arguments)}}(),afterLeave:function(t){t.current,t.next,t.trigger;kt.destroy(),kt=null}};function It(t){return It="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(t){return typeof t}:function(t){return t&&"function"==typeof Symbol&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t},It(t)}function Rt(){Rt=function(){return t};var t={},e=Object.prototype,r=e.hasOwnProperty,n=Object.defineProperty||function(t,e,r){t[e]=r.value},i="function"==typeof Symbol?Symbol:{},s=i.iterator||"@@iterator",o=i.asyncIterator||"@@asyncIterator",a=i.toStringTag||"@@toStringTag";function l(t,e,r){return Object.defineProperty(t,e,{value:r,enumerable:!0,configurable:!0,writable:!0}),t[e]}try{l({},"")}catch(t){l=function(t,e,r){return t[e]=r}}function c(t,e,r,i){var s=e&&e.prototype instanceof d?e:d,o=Object.create(s.prototype),a=new L(i||[]);return n(o,"_invoke",{value:A(t,r,a)}),o}function u(t,e,r){try{return{type:"normal",arg:t.call(e,r)}}catch(t){return{type:"throw",arg:t}}}t.wrap=c;var h={};function d(){}function f(){}function p(){}var g={};l(g,s,(function(){return this}));var m=Object.getPrototypeOf,y=m&&m(m(_([])));y&&y!==e&&r.call(y,s)&&(g=y);var v=p.prototype=d.prototype=Object.create(g);function b(t){["next","throw","return"].forEach((function(e){l(t,e,(function(t){return this._invoke(e,t)}))}))}function E(t,e){function i(n,s,o,a){var l=u(t[n],t,s);if("throw"!==l.type){var c=l.arg,h=c.value;return h&&"object"==It(h)&&r.call(h,"__await")?e.resolve(h.__await).then((function(t){i("next",t,o,a)}),(function(t){i("throw",t,o,a)})):e.resolve(h).then((function(t){c.value=t,o(c)}),(function(t){return i("throw",t,o,a)}))}a(l.arg)}var s;n(this,"_invoke",{value:function(t,r){function n(){return new e((function(e,n){i(t,r,e,n)}))}return s=s?s.then(n,n):n()}})}function A(t,e,r){var n="suspendedStart";return function(i,s){if("executing"===n)throw new Error("Generator is already running");if("completed"===n){if("throw"===i)throw s;return x()}for(r.method=i,r.arg=s;;){var o=r.delegate;if(o){var a=w(o,r);if(a){if(a===h)continue;return a}}if("next"===r.method)r.sent=r._sent=r.arg;else if("throw"===r.method){if("suspendedStart"===n)throw n="completed",r.arg;r.dispatchException(r.arg)}else"return"===r.method&&r.abrupt("return",r.arg);n="executing";var l=u(t,e,r);if("normal"===l.type){if(n=r.done?"completed":"suspendedYield",l.arg===h)continue;return{value:l.arg,done:r.done}}"throw"===l.type&&(n="completed",r.method="throw",r.arg=l.arg)}}}function w(t,e){var r=e.method,n=t.iterator[r];if(void 0===n)return e.delegate=null,"throw"===r&&t.iterator.return&&(e.method="return",e.arg=void 0,w(t,e),"throw"===e.method)||"return"!==r&&(e.method="throw",e.arg=new TypeError("The iterator does not provide a '"+r+"' method")),h;var i=u(n,t.iterator,e.arg);if("throw"===i.type)return e.method="throw",e.arg=i.arg,e.delegate=null,h;var s=i.arg;return s?s.done?(e[t.resultName]=s.value,e.next=t.nextLoc,"return"!==e.method&&(e.method="next",e.arg=void 0),e.delegate=null,h):s:(e.method="throw",e.arg=new TypeError("iterator result is not an object"),e.delegate=null,h)}function T(t){var e={tryLoc:t[0]};1 in t&&(e.catchLoc=t[1]),2 in t&&(e.finallyLoc=t[2],e.afterLoc=t[3]),this.tryEntries.push(e)}function S(t){var e=t.completion||{};e.type="normal",delete e.arg,t.completion=e}function L(t){this.tryEntries=[{tryLoc:"root"}],t.forEach(T,this),this.reset(!0)}function _(t){if(t){var e=t[s];if(e)return e.call(t);if("function"==typeof t.next)return t;if(!isNaN(t.length)){var n=-1,i=function e(){for(;++n<t.length;)if(r.call(t,n))return e.value=t[n],e.done=!1,e;return e.value=void 0,e.done=!0,e};return i.next=i}}return{next:x}}function x(){return{value:void 0,done:!0}}return f.prototype=p,n(v,"constructor",{value:p,configurable:!0}),n(p,"constructor",{value:f,configurable:!0}),f.displayName=l(p,a,"GeneratorFunction"),t.isGeneratorFunction=function(t){var e="function"==typeof t&&t.constructor;return!!e&&(e===f||"GeneratorFunction"===(e.displayName||e.name))},t.mark=function(t){return Object.setPrototypeOf?Object.setPrototypeOf(t,p):(t.__proto__=p,l(t,a,"GeneratorFunction")),t.prototype=Object.create(v),t},t.awrap=function(t){return{__await:t}},b(E.prototype),l(E.prototype,o,(function(){return this})),t.AsyncIterator=E,t.async=function(e,r,n,i,s){void 0===s&&(s=Promise);var o=new E(c(e,r,n,i),s);return t.isGeneratorFunction(r)?o:o.next().then((function(t){return t.done?t.value:o.next()}))},b(v),l(v,a,"Generator"),l(v,s,(function(){return this})),l(v,"toString",(function(){return"[object Generator]"})),t.keys=function(t){var e=Object(t),r=[];for(var n in e)r.push(n);return r.reverse(),function t(){for(;r.length;){var n=r.pop();if(n in e)return t.value=n,t.done=!1,t}return t.done=!0,t}},t.values=_,L.prototype={constructor:L,reset:function(t){if(this.prev=0,this.next=0,this.sent=this._sent=void 0,this.done=!1,this.delegate=null,this.method="next",this.arg=void 0,this.tryEntries.forEach(S),!t)for(var e in this)"t"===e.charAt(0)&&r.call(this,e)&&!isNaN(+e.slice(1))&&(this[e]=void 0)},stop:function(){this.done=!0;var t=this.tryEntries[0].completion;if("throw"===t.type)throw t.arg;return this.rval},dispatchException:function(t){if(this.done)throw t;var e=this;function n(r,n){return o.type="throw",o.arg=t,e.next=r,n&&(e.method="next",e.arg=void 0),!!n}for(var i=this.tryEntries.length-1;i>=0;--i){var s=this.tryEntries[i],o=s.completion;if("root"===s.tryLoc)return n("end");if(s.tryLoc<=this.prev){var a=r.call(s,"catchLoc"),l=r.call(s,"finallyLoc");if(a&&l){if(this.prev<s.catchLoc)return n(s.catchLoc,!0);if(this.prev<s.finallyLoc)return n(s.finallyLoc)}else if(a){if(this.prev<s.catchLoc)return n(s.catchLoc,!0)}else{if(!l)throw new Error("try statement without catch or finally");if(this.prev<s.finallyLoc)return n(s.finallyLoc)}}}},abrupt:function(t,e){for(var n=this.tryEntries.length-1;n>=0;--n){var i=this.tryEntries[n];if(i.tryLoc<=this.prev&&r.call(i,"finallyLoc")&&this.prev<i.finallyLoc){var s=i;break}}s&&("break"===t||"continue"===t)&&s.tryLoc<=e&&e<=s.finallyLoc&&(s=null);var o=s?s.completion:{};return o.type=t,o.arg=e,s?(this.method="next",this.next=s.finallyLoc,h):this.complete(o)},complete:function(t,e){if("throw"===t.type)throw t.arg;return"break"===t.type||"continue"===t.type?this.next=t.arg:"return"===t.type?(this.rval=this.arg=t.arg,this.method="return",this.next="end"):"normal"===t.type&&e&&(this.next=e),h},finish:function(t){for(var e=this.tryEntries.length-1;e>=0;--e){var r=this.tryEntries[e];if(r.finallyLoc===t)return this.complete(r.completion,r.afterLoc),S(r),h}},catch:function(t){for(var e=this.tryEntries.length-1;e>=0;--e){var r=this.tryEntries[e];if(r.tryLoc===t){var n=r.completion;if("throw"===n.type){var i=n.arg;S(r)}return i}}throw new Error("illegal catch attempt")},delegateYield:function(t,e,r){return this.delegate={iterator:_(t),resultName:e,nextLoc:r},"next"===this.method&&(this.arg=void 0),h}},t}function Ot(t,e,r,n,i,s,o){try{var a=t[s](o),l=a.value}catch(t){return void r(t)}a.done?e(l):Promise.resolve(l).then(n,i)}var Dt=null;const Ct={namespace:"single-practice",beforeEnter:function(){var t=function(t){return function(){var e=this,r=arguments;return new Promise((function(n,i){var s=t.apply(e,r);function o(t){Ot(s,n,i,o,a,"next",t)}function a(t){Ot(s,n,i,o,a,"throw",t)}o(void 0)}))}}(Rt().mark((function t(e){var n,i,o;return Rt().wrap((function(t){for(;;)switch(t.prev=t.next){case 0:return e.current,n=e.next,e.trigger,t.next=3,(0,s.y6)(WPURLS.themeUrl+"/dist/css/_practice.css");case 3:return t.next=5,Promise.all([r.e(812),r.e(5927),r.e(9344)]).then(r.bind(r,708));case 5:i=t.sent,o=i.default,(Dt=new o(n.container)).init();case 9:case"end":return t.stop()}}),t)})));return function(e){return t.apply(this,arguments)}}(),afterLeave:function(t){t.current,t.next,t.trigger;Dt.destroy(),Dt=null}};function Mt(t){return Mt="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(t){return typeof t}:function(t){return t&&"function"==typeof Symbol&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t},Mt(t)}function Nt(){Nt=function(){return t};var t={},e=Object.prototype,r=e.hasOwnProperty,n=Object.defineProperty||function(t,e,r){t[e]=r.value},i="function"==typeof Symbol?Symbol:{},s=i.iterator||"@@iterator",o=i.asyncIterator||"@@asyncIterator",a=i.toStringTag||"@@toStringTag";function l(t,e,r){return Object.defineProperty(t,e,{value:r,enumerable:!0,configurable:!0,writable:!0}),t[e]}try{l({},"")}catch(t){l=function(t,e,r){return t[e]=r}}function c(t,e,r,i){var s=e&&e.prototype instanceof d?e:d,o=Object.create(s.prototype),a=new L(i||[]);return n(o,"_invoke",{value:A(t,r,a)}),o}function u(t,e,r){try{return{type:"normal",arg:t.call(e,r)}}catch(t){return{type:"throw",arg:t}}}t.wrap=c;var h={};function d(){}function f(){}function p(){}var g={};l(g,s,(function(){return this}));var m=Object.getPrototypeOf,y=m&&m(m(_([])));y&&y!==e&&r.call(y,s)&&(g=y);var v=p.prototype=d.prototype=Object.create(g);function b(t){["next","throw","return"].forEach((function(e){l(t,e,(function(t){return this._invoke(e,t)}))}))}function E(t,e){function i(n,s,o,a){var l=u(t[n],t,s);if("throw"!==l.type){var c=l.arg,h=c.value;return h&&"object"==Mt(h)&&r.call(h,"__await")?e.resolve(h.__await).then((function(t){i("next",t,o,a)}),(function(t){i("throw",t,o,a)})):e.resolve(h).then((function(t){c.value=t,o(c)}),(function(t){return i("throw",t,o,a)}))}a(l.arg)}var s;n(this,"_invoke",{value:function(t,r){function n(){return new e((function(e,n){i(t,r,e,n)}))}return s=s?s.then(n,n):n()}})}function A(t,e,r){var n="suspendedStart";return function(i,s){if("executing"===n)throw new Error("Generator is already running");if("completed"===n){if("throw"===i)throw s;return x()}for(r.method=i,r.arg=s;;){var o=r.delegate;if(o){var a=w(o,r);if(a){if(a===h)continue;return a}}if("next"===r.method)r.sent=r._sent=r.arg;else if("throw"===r.method){if("suspendedStart"===n)throw n="completed",r.arg;r.dispatchException(r.arg)}else"return"===r.method&&r.abrupt("return",r.arg);n="executing";var l=u(t,e,r);if("normal"===l.type){if(n=r.done?"completed":"suspendedYield",l.arg===h)continue;return{value:l.arg,done:r.done}}"throw"===l.type&&(n="completed",r.method="throw",r.arg=l.arg)}}}function w(t,e){var r=e.method,n=t.iterator[r];if(void 0===n)return e.delegate=null,"throw"===r&&t.iterator.return&&(e.method="return",e.arg=void 0,w(t,e),"throw"===e.method)||"return"!==r&&(e.method="throw",e.arg=new TypeError("The iterator does not provide a '"+r+"' method")),h;var i=u(n,t.iterator,e.arg);if("throw"===i.type)return e.method="throw",e.arg=i.arg,e.delegate=null,h;var s=i.arg;return s?s.done?(e[t.resultName]=s.value,e.next=t.nextLoc,"return"!==e.method&&(e.method="next",e.arg=void 0),e.delegate=null,h):s:(e.method="throw",e.arg=new TypeError("iterator result is not an object"),e.delegate=null,h)}function T(t){var e={tryLoc:t[0]};1 in t&&(e.catchLoc=t[1]),2 in t&&(e.finallyLoc=t[2],e.afterLoc=t[3]),this.tryEntries.push(e)}function S(t){var e=t.completion||{};e.type="normal",delete e.arg,t.completion=e}function L(t){this.tryEntries=[{tryLoc:"root"}],t.forEach(T,this),this.reset(!0)}function _(t){if(t){var e=t[s];if(e)return e.call(t);if("function"==typeof t.next)return t;if(!isNaN(t.length)){var n=-1,i=function e(){for(;++n<t.length;)if(r.call(t,n))return e.value=t[n],e.done=!1,e;return e.value=void 0,e.done=!0,e};return i.next=i}}return{next:x}}function x(){return{value:void 0,done:!0}}return f.prototype=p,n(v,"constructor",{value:p,configurable:!0}),n(p,"constructor",{value:f,configurable:!0}),f.displayName=l(p,a,"GeneratorFunction"),t.isGeneratorFunction=function(t){var e="function"==typeof t&&t.constructor;return!!e&&(e===f||"GeneratorFunction"===(e.displayName||e.name))},t.mark=function(t){return Object.setPrototypeOf?Object.setPrototypeOf(t,p):(t.__proto__=p,l(t,a,"GeneratorFunction")),t.prototype=Object.create(v),t},t.awrap=function(t){return{__await:t}},b(E.prototype),l(E.prototype,o,(function(){return this})),t.AsyncIterator=E,t.async=function(e,r,n,i,s){void 0===s&&(s=Promise);var o=new E(c(e,r,n,i),s);return t.isGeneratorFunction(r)?o:o.next().then((function(t){return t.done?t.value:o.next()}))},b(v),l(v,a,"Generator"),l(v,s,(function(){return this})),l(v,"toString",(function(){return"[object Generator]"})),t.keys=function(t){var e=Object(t),r=[];for(var n in e)r.push(n);return r.reverse(),function t(){for(;r.length;){var n=r.pop();if(n in e)return t.value=n,t.done=!1,t}return t.done=!0,t}},t.values=_,L.prototype={constructor:L,reset:function(t){if(this.prev=0,this.next=0,this.sent=this._sent=void 0,this.done=!1,this.delegate=null,this.method="next",this.arg=void 0,this.tryEntries.forEach(S),!t)for(var e in this)"t"===e.charAt(0)&&r.call(this,e)&&!isNaN(+e.slice(1))&&(this[e]=void 0)},stop:function(){this.done=!0;var t=this.tryEntries[0].completion;if("throw"===t.type)throw t.arg;return this.rval},dispatchException:function(t){if(this.done)throw t;var e=this;function n(r,n){return o.type="throw",o.arg=t,e.next=r,n&&(e.method="next",e.arg=void 0),!!n}for(var i=this.tryEntries.length-1;i>=0;--i){var s=this.tryEntries[i],o=s.completion;if("root"===s.tryLoc)return n("end");if(s.tryLoc<=this.prev){var a=r.call(s,"catchLoc"),l=r.call(s,"finallyLoc");if(a&&l){if(this.prev<s.catchLoc)return n(s.catchLoc,!0);if(this.prev<s.finallyLoc)return n(s.finallyLoc)}else if(a){if(this.prev<s.catchLoc)return n(s.catchLoc,!0)}else{if(!l)throw new Error("try statement without catch or finally");if(this.prev<s.finallyLoc)return n(s.finallyLoc)}}}},abrupt:function(t,e){for(var n=this.tryEntries.length-1;n>=0;--n){var i=this.tryEntries[n];if(i.tryLoc<=this.prev&&r.call(i,"finallyLoc")&&this.prev<i.finallyLoc){var s=i;break}}s&&("break"===t||"continue"===t)&&s.tryLoc<=e&&e<=s.finallyLoc&&(s=null);var o=s?s.completion:{};return o.type=t,o.arg=e,s?(this.method="next",this.next=s.finallyLoc,h):this.complete(o)},complete:function(t,e){if("throw"===t.type)throw t.arg;return"break"===t.type||"continue"===t.type?this.next=t.arg:"return"===t.type?(this.rval=this.arg=t.arg,this.method="return",this.next="end"):"normal"===t.type&&e&&(this.next=e),h},finish:function(t){for(var e=this.tryEntries.length-1;e>=0;--e){var r=this.tryEntries[e];if(r.finallyLoc===t)return this.complete(r.completion,r.afterLoc),S(r),h}},catch:function(t){for(var e=this.tryEntries.length-1;e>=0;--e){var r=this.tryEntries[e];if(r.tryLoc===t){var n=r.completion;if("throw"===n.type){var i=n.arg;S(r)}return i}}throw new Error("illegal catch attempt")},delegateYield:function(t,e,r){return this.delegate={iterator:_(t),resultName:e,nextLoc:r},"next"===this.method&&(this.arg=void 0),h}},t}function Ft(t,e,r,n,i,s,o){try{var a=t[s](o),l=a.value}catch(t){return void r(t)}a.done?e(l):Promise.resolve(l).then(n,i)}var Ut=null;const Bt={namespace:"template-podcasts",beforeEnter:function(){var t=function(t){return function(){var e=this,r=arguments;return new Promise((function(n,i){var s=t.apply(e,r);function o(t){Ft(s,n,i,o,a,"next",t)}function a(t){Ft(s,n,i,o,a,"throw",t)}o(void 0)}))}}(Nt().mark((function t(e){var n,i,o;return Nt().wrap((function(t){for(;;)switch(t.prev=t.next){case 0:return e.current,n=e.next,e.trigger,t.next=3,(0,s.y6)(WPURLS.themeUrl+"/dist/css/_podcasts.css");case 3:return t.next=5,Promise.all([r.e(812),r.e(5927),r.e(9952)]).then(r.bind(r,7887));case 5:i=t.sent,o=i.default,(Ut=new o(n.container)).init();case 9:case"end":return t.stop()}}),t)})));return function(e){return t.apply(this,arguments)}}(),afterLeave:function(t){t.current,t.next,t.trigger;Ut.destroy(),Ut=null}};function $t(t){return $t="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(t){return typeof t}:function(t){return t&&"function"==typeof Symbol&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t},$t(t)}function jt(){jt=function(){return t};var t={},e=Object.prototype,r=e.hasOwnProperty,n=Object.defineProperty||function(t,e,r){t[e]=r.value},i="function"==typeof Symbol?Symbol:{},s=i.iterator||"@@iterator",o=i.asyncIterator||"@@asyncIterator",a=i.toStringTag||"@@toStringTag";function l(t,e,r){return Object.defineProperty(t,e,{value:r,enumerable:!0,configurable:!0,writable:!0}),t[e]}try{l({},"")}catch(t){l=function(t,e,r){return t[e]=r}}function c(t,e,r,i){var s=e&&e.prototype instanceof d?e:d,o=Object.create(s.prototype),a=new L(i||[]);return n(o,"_invoke",{value:A(t,r,a)}),o}function u(t,e,r){try{return{type:"normal",arg:t.call(e,r)}}catch(t){return{type:"throw",arg:t}}}t.wrap=c;var h={};function d(){}function f(){}function p(){}var g={};l(g,s,(function(){return this}));var m=Object.getPrototypeOf,y=m&&m(m(_([])));y&&y!==e&&r.call(y,s)&&(g=y);var v=p.prototype=d.prototype=Object.create(g);function b(t){["next","throw","return"].forEach((function(e){l(t,e,(function(t){return this._invoke(e,t)}))}))}function E(t,e){function i(n,s,o,a){var l=u(t[n],t,s);if("throw"!==l.type){var c=l.arg,h=c.value;return h&&"object"==$t(h)&&r.call(h,"__await")?e.resolve(h.__await).then((function(t){i("next",t,o,a)}),(function(t){i("throw",t,o,a)})):e.resolve(h).then((function(t){c.value=t,o(c)}),(function(t){return i("throw",t,o,a)}))}a(l.arg)}var s;n(this,"_invoke",{value:function(t,r){function n(){return new e((function(e,n){i(t,r,e,n)}))}return s=s?s.then(n,n):n()}})}function A(t,e,r){var n="suspendedStart";return function(i,s){if("executing"===n)throw new Error("Generator is already running");if("completed"===n){if("throw"===i)throw s;return x()}for(r.method=i,r.arg=s;;){var o=r.delegate;if(o){var a=w(o,r);if(a){if(a===h)continue;return a}}if("next"===r.method)r.sent=r._sent=r.arg;else if("throw"===r.method){if("suspendedStart"===n)throw n="completed",r.arg;r.dispatchException(r.arg)}else"return"===r.method&&r.abrupt("return",r.arg);n="executing";var l=u(t,e,r);if("normal"===l.type){if(n=r.done?"completed":"suspendedYield",l.arg===h)continue;return{value:l.arg,done:r.done}}"throw"===l.type&&(n="completed",r.method="throw",r.arg=l.arg)}}}function w(t,e){var r=e.method,n=t.iterator[r];if(void 0===n)return e.delegate=null,"throw"===r&&t.iterator.return&&(e.method="return",e.arg=void 0,w(t,e),"throw"===e.method)||"return"!==r&&(e.method="throw",e.arg=new TypeError("The iterator does not provide a '"+r+"' method")),h;var i=u(n,t.iterator,e.arg);if("throw"===i.type)return e.method="throw",e.arg=i.arg,e.delegate=null,h;var s=i.arg;return s?s.done?(e[t.resultName]=s.value,e.next=t.nextLoc,"return"!==e.method&&(e.method="next",e.arg=void 0),e.delegate=null,h):s:(e.method="throw",e.arg=new TypeError("iterator result is not an object"),e.delegate=null,h)}function T(t){var e={tryLoc:t[0]};1 in t&&(e.catchLoc=t[1]),2 in t&&(e.finallyLoc=t[2],e.afterLoc=t[3]),this.tryEntries.push(e)}function S(t){var e=t.completion||{};e.type="normal",delete e.arg,t.completion=e}function L(t){this.tryEntries=[{tryLoc:"root"}],t.forEach(T,this),this.reset(!0)}function _(t){if(t){var e=t[s];if(e)return e.call(t);if("function"==typeof t.next)return t;if(!isNaN(t.length)){var n=-1,i=function e(){for(;++n<t.length;)if(r.call(t,n))return e.value=t[n],e.done=!1,e;return e.value=void 0,e.done=!0,e};return i.next=i}}return{next:x}}function x(){return{value:void 0,done:!0}}return f.prototype=p,n(v,"constructor",{value:p,configurable:!0}),n(p,"constructor",{value:f,configurable:!0}),f.displayName=l(p,a,"GeneratorFunction"),t.isGeneratorFunction=function(t){var e="function"==typeof t&&t.constructor;return!!e&&(e===f||"GeneratorFunction"===(e.displayName||e.name))},t.mark=function(t){return Object.setPrototypeOf?Object.setPrototypeOf(t,p):(t.__proto__=p,l(t,a,"GeneratorFunction")),t.prototype=Object.create(v),t},t.awrap=function(t){return{__await:t}},b(E.prototype),l(E.prototype,o,(function(){return this})),t.AsyncIterator=E,t.async=function(e,r,n,i,s){void 0===s&&(s=Promise);var o=new E(c(e,r,n,i),s);return t.isGeneratorFunction(r)?o:o.next().then((function(t){return t.done?t.value:o.next()}))},b(v),l(v,a,"Generator"),l(v,s,(function(){return this})),l(v,"toString",(function(){return"[object Generator]"})),t.keys=function(t){var e=Object(t),r=[];for(var n in e)r.push(n);return r.reverse(),function t(){for(;r.length;){var n=r.pop();if(n in e)return t.value=n,t.done=!1,t}return t.done=!0,t}},t.values=_,L.prototype={constructor:L,reset:function(t){if(this.prev=0,this.next=0,this.sent=this._sent=void 0,this.done=!1,this.delegate=null,this.method="next",this.arg=void 0,this.tryEntries.forEach(S),!t)for(var e in this)"t"===e.charAt(0)&&r.call(this,e)&&!isNaN(+e.slice(1))&&(this[e]=void 0)},stop:function(){this.done=!0;var t=this.tryEntries[0].completion;if("throw"===t.type)throw t.arg;return this.rval},dispatchException:function(t){if(this.done)throw t;var e=this;function n(r,n){return o.type="throw",o.arg=t,e.next=r,n&&(e.method="next",e.arg=void 0),!!n}for(var i=this.tryEntries.length-1;i>=0;--i){var s=this.tryEntries[i],o=s.completion;if("root"===s.tryLoc)return n("end");if(s.tryLoc<=this.prev){var a=r.call(s,"catchLoc"),l=r.call(s,"finallyLoc");if(a&&l){if(this.prev<s.catchLoc)return n(s.catchLoc,!0);if(this.prev<s.finallyLoc)return n(s.finallyLoc)}else if(a){if(this.prev<s.catchLoc)return n(s.catchLoc,!0)}else{if(!l)throw new Error("try statement without catch or finally");if(this.prev<s.finallyLoc)return n(s.finallyLoc)}}}},abrupt:function(t,e){for(var n=this.tryEntries.length-1;n>=0;--n){var i=this.tryEntries[n];if(i.tryLoc<=this.prev&&r.call(i,"finallyLoc")&&this.prev<i.finallyLoc){var s=i;break}}s&&("break"===t||"continue"===t)&&s.tryLoc<=e&&e<=s.finallyLoc&&(s=null);var o=s?s.completion:{};return o.type=t,o.arg=e,s?(this.method="next",this.next=s.finallyLoc,h):this.complete(o)},complete:function(t,e){if("throw"===t.type)throw t.arg;return"break"===t.type||"continue"===t.type?this.next=t.arg:"return"===t.type?(this.rval=this.arg=t.arg,this.method="return",this.next="end"):"normal"===t.type&&e&&(this.next=e),h},finish:function(t){for(var e=this.tryEntries.length-1;e>=0;--e){var r=this.tryEntries[e];if(r.finallyLoc===t)return this.complete(r.completion,r.afterLoc),S(r),h}},catch:function(t){for(var e=this.tryEntries.length-1;e>=0;--e){var r=this.tryEntries[e];if(r.tryLoc===t){var n=r.completion;if("throw"===n.type){var i=n.arg;S(r)}return i}}throw new Error("illegal catch attempt")},delegateYield:function(t,e,r){return this.delegate={iterator:_(t),resultName:e,nextLoc:r},"next"===this.method&&(this.arg=void 0),h}},t}function Gt(t,e,r,n,i,s,o){try{var a=t[s](o),l=a.value}catch(t){return void r(t)}a.done?e(l):Promise.resolve(l).then(n,i)}var Ht=null;const Vt={namespace:"template-tree-migration",beforeEnter:function(){var t=function(t){return function(){var e=this,r=arguments;return new Promise((function(n,i){var s=t.apply(e,r);function o(t){Gt(s,n,i,o,a,"next",t)}function a(t){Gt(s,n,i,o,a,"throw",t)}o(void 0)}))}}(jt().mark((function t(e){var n,i,o;return jt().wrap((function(t){for(;;)switch(t.prev=t.next){case 0:return e.current,n=e.next,e.trigger,t.next=3,(0,s.y6)(WPURLS.themeUrl+"/dist/css/_tree-migration.css");case 3:return t.next=5,Promise.all([r.e(4041),r.e(894),r.e(3252)]).then(r.bind(r,6664));case 5:i=t.sent,o=i.default,(Ht=new o(n.container)).init();case 9:case"end":return t.stop()}}),t)})));return function(e){return t.apply(this,arguments)}}(),afterLeave:function(t){t.current,t.next,t.trigger;Ht.destroy(),Ht=null}};function Kt(t){return Kt="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(t){return typeof t}:function(t){return t&&"function"==typeof Symbol&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t},Kt(t)}function Yt(){Yt=function(){return t};var t={},e=Object.prototype,r=e.hasOwnProperty,n=Object.defineProperty||function(t,e,r){t[e]=r.value},i="function"==typeof Symbol?Symbol:{},s=i.iterator||"@@iterator",o=i.asyncIterator||"@@asyncIterator",a=i.toStringTag||"@@toStringTag";function l(t,e,r){return Object.defineProperty(t,e,{value:r,enumerable:!0,configurable:!0,writable:!0}),t[e]}try{l({},"")}catch(t){l=function(t,e,r){return t[e]=r}}function c(t,e,r,i){var s=e&&e.prototype instanceof d?e:d,o=Object.create(s.prototype),a=new L(i||[]);return n(o,"_invoke",{value:A(t,r,a)}),o}function u(t,e,r){try{return{type:"normal",arg:t.call(e,r)}}catch(t){return{type:"throw",arg:t}}}t.wrap=c;var h={};function d(){}function f(){}function p(){}var g={};l(g,s,(function(){return this}));var m=Object.getPrototypeOf,y=m&&m(m(_([])));y&&y!==e&&r.call(y,s)&&(g=y);var v=p.prototype=d.prototype=Object.create(g);function b(t){["next","throw","return"].forEach((function(e){l(t,e,(function(t){return this._invoke(e,t)}))}))}function E(t,e){function i(n,s,o,a){var l=u(t[n],t,s);if("throw"!==l.type){var c=l.arg,h=c.value;return h&&"object"==Kt(h)&&r.call(h,"__await")?e.resolve(h.__await).then((function(t){i("next",t,o,a)}),(function(t){i("throw",t,o,a)})):e.resolve(h).then((function(t){c.value=t,o(c)}),(function(t){return i("throw",t,o,a)}))}a(l.arg)}var s;n(this,"_invoke",{value:function(t,r){function n(){return new e((function(e,n){i(t,r,e,n)}))}return s=s?s.then(n,n):n()}})}function A(t,e,r){var n="suspendedStart";return function(i,s){if("executing"===n)throw new Error("Generator is already running");if("completed"===n){if("throw"===i)throw s;return x()}for(r.method=i,r.arg=s;;){var o=r.delegate;if(o){var a=w(o,r);if(a){if(a===h)continue;return a}}if("next"===r.method)r.sent=r._sent=r.arg;else if("throw"===r.method){if("suspendedStart"===n)throw n="completed",r.arg;r.dispatchException(r.arg)}else"return"===r.method&&r.abrupt("return",r.arg);n="executing";var l=u(t,e,r);if("normal"===l.type){if(n=r.done?"completed":"suspendedYield",l.arg===h)continue;return{value:l.arg,done:r.done}}"throw"===l.type&&(n="completed",r.method="throw",r.arg=l.arg)}}}function w(t,e){var r=e.method,n=t.iterator[r];if(void 0===n)return e.delegate=null,"throw"===r&&t.iterator.return&&(e.method="return",e.arg=void 0,w(t,e),"throw"===e.method)||"return"!==r&&(e.method="throw",e.arg=new TypeError("The iterator does not provide a '"+r+"' method")),h;var i=u(n,t.iterator,e.arg);if("throw"===i.type)return e.method="throw",e.arg=i.arg,e.delegate=null,h;var s=i.arg;return s?s.done?(e[t.resultName]=s.value,e.next=t.nextLoc,"return"!==e.method&&(e.method="next",e.arg=void 0),e.delegate=null,h):s:(e.method="throw",e.arg=new TypeError("iterator result is not an object"),e.delegate=null,h)}function T(t){var e={tryLoc:t[0]};1 in t&&(e.catchLoc=t[1]),2 in t&&(e.finallyLoc=t[2],e.afterLoc=t[3]),this.tryEntries.push(e)}function S(t){var e=t.completion||{};e.type="normal",delete e.arg,t.completion=e}function L(t){this.tryEntries=[{tryLoc:"root"}],t.forEach(T,this),this.reset(!0)}function _(t){if(t){var e=t[s];if(e)return e.call(t);if("function"==typeof t.next)return t;if(!isNaN(t.length)){var n=-1,i=function e(){for(;++n<t.length;)if(r.call(t,n))return e.value=t[n],e.done=!1,e;return e.value=void 0,e.done=!0,e};return i.next=i}}return{next:x}}function x(){return{value:void 0,done:!0}}return f.prototype=p,n(v,"constructor",{value:p,configurable:!0}),n(p,"constructor",{value:f,configurable:!0}),f.displayName=l(p,a,"GeneratorFunction"),t.isGeneratorFunction=function(t){var e="function"==typeof t&&t.constructor;return!!e&&(e===f||"GeneratorFunction"===(e.displayName||e.name))},t.mark=function(t){return Object.setPrototypeOf?Object.setPrototypeOf(t,p):(t.__proto__=p,l(t,a,"GeneratorFunction")),t.prototype=Object.create(v),t},t.awrap=function(t){return{__await:t}},b(E.prototype),l(E.prototype,o,(function(){return this})),t.AsyncIterator=E,t.async=function(e,r,n,i,s){void 0===s&&(s=Promise);var o=new E(c(e,r,n,i),s);return t.isGeneratorFunction(r)?o:o.next().then((function(t){return t.done?t.value:o.next()}))},b(v),l(v,a,"Generator"),l(v,s,(function(){return this})),l(v,"toString",(function(){return"[object Generator]"})),t.keys=function(t){var e=Object(t),r=[];for(var n in e)r.push(n);return r.reverse(),function t(){for(;r.length;){var n=r.pop();if(n in e)return t.value=n,t.done=!1,t}return t.done=!0,t}},t.values=_,L.prototype={constructor:L,reset:function(t){if(this.prev=0,this.next=0,this.sent=this._sent=void 0,this.done=!1,this.delegate=null,this.method="next",this.arg=void 0,this.tryEntries.forEach(S),!t)for(var e in this)"t"===e.charAt(0)&&r.call(this,e)&&!isNaN(+e.slice(1))&&(this[e]=void 0)},stop:function(){this.done=!0;var t=this.tryEntries[0].completion;if("throw"===t.type)throw t.arg;return this.rval},dispatchException:function(t){if(this.done)throw t;var e=this;function n(r,n){return o.type="throw",o.arg=t,e.next=r,n&&(e.method="next",e.arg=void 0),!!n}for(var i=this.tryEntries.length-1;i>=0;--i){var s=this.tryEntries[i],o=s.completion;if("root"===s.tryLoc)return n("end");if(s.tryLoc<=this.prev){var a=r.call(s,"catchLoc"),l=r.call(s,"finallyLoc");if(a&&l){if(this.prev<s.catchLoc)return n(s.catchLoc,!0);if(this.prev<s.finallyLoc)return n(s.finallyLoc)}else if(a){if(this.prev<s.catchLoc)return n(s.catchLoc,!0)}else{if(!l)throw new Error("try statement without catch or finally");if(this.prev<s.finallyLoc)return n(s.finallyLoc)}}}},abrupt:function(t,e){for(var n=this.tryEntries.length-1;n>=0;--n){var i=this.tryEntries[n];if(i.tryLoc<=this.prev&&r.call(i,"finallyLoc")&&this.prev<i.finallyLoc){var s=i;break}}s&&("break"===t||"continue"===t)&&s.tryLoc<=e&&e<=s.finallyLoc&&(s=null);var o=s?s.completion:{};return o.type=t,o.arg=e,s?(this.method="next",this.next=s.finallyLoc,h):this.complete(o)},complete:function(t,e){if("throw"===t.type)throw t.arg;return"break"===t.type||"continue"===t.type?this.next=t.arg:"return"===t.type?(this.rval=this.arg=t.arg,this.method="return",this.next="end"):"normal"===t.type&&e&&(this.next=e),h},finish:function(t){for(var e=this.tryEntries.length-1;e>=0;--e){var r=this.tryEntries[e];if(r.finallyLoc===t)return this.complete(r.completion,r.afterLoc),S(r),h}},catch:function(t){for(var e=this.tryEntries.length-1;e>=0;--e){var r=this.tryEntries[e];if(r.tryLoc===t){var n=r.completion;if("throw"===n.type){var i=n.arg;S(r)}return i}}throw new Error("illegal catch attempt")},delegateYield:function(t,e,r){return this.delegate={iterator:_(t),resultName:e,nextLoc:r},"next"===this.method&&(this.arg=void 0),h}},t}function qt(t,e,r,n,i,s,o){try{var a=t[s](o),l=a.value}catch(t){return void r(t)}a.done?e(l):Promise.resolve(l).then(n,i)}var Wt=null;const zt={namespace:"template-soundtrack",beforeEnter:function(){var t=function(t){return function(){var e=this,r=arguments;return new Promise((function(n,i){var s=t.apply(e,r);function o(t){qt(s,n,i,o,a,"next",t)}function a(t){qt(s,n,i,o,a,"throw",t)}o(void 0)}))}}(Yt().mark((function t(e){var n,i,o;return Yt().wrap((function(t){for(;;)switch(t.prev=t.next){case 0:return e.current,n=e.next,e.trigger,t.next=3,(0,s.y6)(WPURLS.themeUrl+"/dist/css/_soundtrack-page.css");case 3:return t.next=5,r.e(6721).then(r.bind(r,8630));case 5:i=t.sent,o=i.default,(Wt=new o(n.container)).init();case 9:case"end":return t.stop()}}),t)})));return function(e){return t.apply(this,arguments)}}(),afterLeave:function(t){t.current,t.next,t.trigger;Wt.destroy(),Wt=null}};function Xt(t){return Xt="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(t){return typeof t}:function(t){return t&&"function"==typeof Symbol&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t},Xt(t)}function Qt(){Qt=function(){return t};var t={},e=Object.prototype,r=e.hasOwnProperty,n=Object.defineProperty||function(t,e,r){t[e]=r.value},i="function"==typeof Symbol?Symbol:{},s=i.iterator||"@@iterator",o=i.asyncIterator||"@@asyncIterator",a=i.toStringTag||"@@toStringTag";function l(t,e,r){return Object.defineProperty(t,e,{value:r,enumerable:!0,configurable:!0,writable:!0}),t[e]}try{l({},"")}catch(t){l=function(t,e,r){return t[e]=r}}function c(t,e,r,i){var s=e&&e.prototype instanceof d?e:d,o=Object.create(s.prototype),a=new L(i||[]);return n(o,"_invoke",{value:A(t,r,a)}),o}function u(t,e,r){try{return{type:"normal",arg:t.call(e,r)}}catch(t){return{type:"throw",arg:t}}}t.wrap=c;var h={};function d(){}function f(){}function p(){}var g={};l(g,s,(function(){return this}));var m=Object.getPrototypeOf,y=m&&m(m(_([])));y&&y!==e&&r.call(y,s)&&(g=y);var v=p.prototype=d.prototype=Object.create(g);function b(t){["next","throw","return"].forEach((function(e){l(t,e,(function(t){return this._invoke(e,t)}))}))}function E(t,e){function i(n,s,o,a){var l=u(t[n],t,s);if("throw"!==l.type){var c=l.arg,h=c.value;return h&&"object"==Xt(h)&&r.call(h,"__await")?e.resolve(h.__await).then((function(t){i("next",t,o,a)}),(function(t){i("throw",t,o,a)})):e.resolve(h).then((function(t){c.value=t,o(c)}),(function(t){return i("throw",t,o,a)}))}a(l.arg)}var s;n(this,"_invoke",{value:function(t,r){function n(){return new e((function(e,n){i(t,r,e,n)}))}return s=s?s.then(n,n):n()}})}function A(t,e,r){var n="suspendedStart";return function(i,s){if("executing"===n)throw new Error("Generator is already running");if("completed"===n){if("throw"===i)throw s;return x()}for(r.method=i,r.arg=s;;){var o=r.delegate;if(o){var a=w(o,r);if(a){if(a===h)continue;return a}}if("next"===r.method)r.sent=r._sent=r.arg;else if("throw"===r.method){if("suspendedStart"===n)throw n="completed",r.arg;r.dispatchException(r.arg)}else"return"===r.method&&r.abrupt("return",r.arg);n="executing";var l=u(t,e,r);if("normal"===l.type){if(n=r.done?"completed":"suspendedYield",l.arg===h)continue;return{value:l.arg,done:r.done}}"throw"===l.type&&(n="completed",r.method="throw",r.arg=l.arg)}}}function w(t,e){var r=e.method,n=t.iterator[r];if(void 0===n)return e.delegate=null,"throw"===r&&t.iterator.return&&(e.method="return",e.arg=void 0,w(t,e),"throw"===e.method)||"return"!==r&&(e.method="throw",e.arg=new TypeError("The iterator does not provide a '"+r+"' method")),h;var i=u(n,t.iterator,e.arg);if("throw"===i.type)return e.method="throw",e.arg=i.arg,e.delegate=null,h;var s=i.arg;return s?s.done?(e[t.resultName]=s.value,e.next=t.nextLoc,"return"!==e.method&&(e.method="next",e.arg=void 0),e.delegate=null,h):s:(e.method="throw",e.arg=new TypeError("iterator result is not an object"),e.delegate=null,h)}function T(t){var e={tryLoc:t[0]};1 in t&&(e.catchLoc=t[1]),2 in t&&(e.finallyLoc=t[2],e.afterLoc=t[3]),this.tryEntries.push(e)}function S(t){var e=t.completion||{};e.type="normal",delete e.arg,t.completion=e}function L(t){this.tryEntries=[{tryLoc:"root"}],t.forEach(T,this),this.reset(!0)}function _(t){if(t){var e=t[s];if(e)return e.call(t);if("function"==typeof t.next)return t;if(!isNaN(t.length)){var n=-1,i=function e(){for(;++n<t.length;)if(r.call(t,n))return e.value=t[n],e.done=!1,e;return e.value=void 0,e.done=!0,e};return i.next=i}}return{next:x}}function x(){return{value:void 0,done:!0}}return f.prototype=p,n(v,"constructor",{value:p,configurable:!0}),n(p,"constructor",{value:f,configurable:!0}),f.displayName=l(p,a,"GeneratorFunction"),t.isGeneratorFunction=function(t){var e="function"==typeof t&&t.constructor;return!!e&&(e===f||"GeneratorFunction"===(e.displayName||e.name))},t.mark=function(t){return Object.setPrototypeOf?Object.setPrototypeOf(t,p):(t.__proto__=p,l(t,a,"GeneratorFunction")),t.prototype=Object.create(v),t},t.awrap=function(t){return{__await:t}},b(E.prototype),l(E.prototype,o,(function(){return this})),t.AsyncIterator=E,t.async=function(e,r,n,i,s){void 0===s&&(s=Promise);var o=new E(c(e,r,n,i),s);return t.isGeneratorFunction(r)?o:o.next().then((function(t){return t.done?t.value:o.next()}))},b(v),l(v,a,"Generator"),l(v,s,(function(){return this})),l(v,"toString",(function(){return"[object Generator]"})),t.keys=function(t){var e=Object(t),r=[];for(var n in e)r.push(n);return r.reverse(),function t(){for(;r.length;){var n=r.pop();if(n in e)return t.value=n,t.done=!1,t}return t.done=!0,t}},t.values=_,L.prototype={constructor:L,reset:function(t){if(this.prev=0,this.next=0,this.sent=this._sent=void 0,this.done=!1,this.delegate=null,this.method="next",this.arg=void 0,this.tryEntries.forEach(S),!t)for(var e in this)"t"===e.charAt(0)&&r.call(this,e)&&!isNaN(+e.slice(1))&&(this[e]=void 0)},stop:function(){this.done=!0;var t=this.tryEntries[0].completion;if("throw"===t.type)throw t.arg;return this.rval},dispatchException:function(t){if(this.done)throw t;var e=this;function n(r,n){return o.type="throw",o.arg=t,e.next=r,n&&(e.method="next",e.arg=void 0),!!n}for(var i=this.tryEntries.length-1;i>=0;--i){var s=this.tryEntries[i],o=s.completion;if("root"===s.tryLoc)return n("end");if(s.tryLoc<=this.prev){var a=r.call(s,"catchLoc"),l=r.call(s,"finallyLoc");if(a&&l){if(this.prev<s.catchLoc)return n(s.catchLoc,!0);if(this.prev<s.finallyLoc)return n(s.finallyLoc)}else if(a){if(this.prev<s.catchLoc)return n(s.catchLoc,!0)}else{if(!l)throw new Error("try statement without catch or finally");if(this.prev<s.finallyLoc)return n(s.finallyLoc)}}}},abrupt:function(t,e){for(var n=this.tryEntries.length-1;n>=0;--n){var i=this.tryEntries[n];if(i.tryLoc<=this.prev&&r.call(i,"finallyLoc")&&this.prev<i.finallyLoc){var s=i;break}}s&&("break"===t||"continue"===t)&&s.tryLoc<=e&&e<=s.finallyLoc&&(s=null);var o=s?s.completion:{};return o.type=t,o.arg=e,s?(this.method="next",this.next=s.finallyLoc,h):this.complete(o)},complete:function(t,e){if("throw"===t.type)throw t.arg;return"break"===t.type||"continue"===t.type?this.next=t.arg:"return"===t.type?(this.rval=this.arg=t.arg,this.method="return",this.next="end"):"normal"===t.type&&e&&(this.next=e),h},finish:function(t){for(var e=this.tryEntries.length-1;e>=0;--e){var r=this.tryEntries[e];if(r.finallyLoc===t)return this.complete(r.completion,r.afterLoc),S(r),h}},catch:function(t){for(var e=this.tryEntries.length-1;e>=0;--e){var r=this.tryEntries[e];if(r.tryLoc===t){var n=r.completion;if("throw"===n.type){var i=n.arg;S(r)}return i}}throw new Error("illegal catch attempt")},delegateYield:function(t,e,r){return this.delegate={iterator:_(t),resultName:e,nextLoc:r},"next"===this.method&&(this.arg=void 0),h}},t}function Jt(t,e,r,n,i,s,o){try{var a=t[s](o),l=a.value}catch(t){return void r(t)}a.done?e(l):Promise.resolve(l).then(n,i)}var Zt=null;const te={namespace:"template-vol-3-opening",beforeEnter:function(){var t=function(t){return function(){var e=this,r=arguments;return new Promise((function(n,i){var s=t.apply(e,r);function o(t){Jt(s,n,i,o,a,"next",t)}function a(t){Jt(s,n,i,o,a,"throw",t)}o(void 0)}))}}(Qt().mark((function t(e){var n,i,o;return Qt().wrap((function(t){for(;;)switch(t.prev=t.next){case 0:return e.current,n=e.next,e.trigger,t.next=3,(0,s.y6)(WPURLS.themeUrl+"/dist/css/_vol3.css");case 3:return t.next=5,Promise.all([r.e(4041),r.e(2693)]).then(r.bind(r,4250));case 5:i=t.sent,o=i.default,(Zt=new o(n.container)).init();case 9:case"end":return t.stop()}}),t)})));return function(e){return t.apply(this,arguments)}}(),afterLeave:function(t){t.current,t.next,t.trigger;Zt.destroy(),Zt=null}};function ee(t){return ee="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(t){return typeof t}:function(t){return t&&"function"==typeof Symbol&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t},ee(t)}function re(){re=function(){return t};var t={},e=Object.prototype,r=e.hasOwnProperty,n=Object.defineProperty||function(t,e,r){t[e]=r.value},i="function"==typeof Symbol?Symbol:{},s=i.iterator||"@@iterator",o=i.asyncIterator||"@@asyncIterator",a=i.toStringTag||"@@toStringTag";function l(t,e,r){return Object.defineProperty(t,e,{value:r,enumerable:!0,configurable:!0,writable:!0}),t[e]}try{l({},"")}catch(t){l=function(t,e,r){return t[e]=r}}function c(t,e,r,i){var s=e&&e.prototype instanceof d?e:d,o=Object.create(s.prototype),a=new L(i||[]);return n(o,"_invoke",{value:A(t,r,a)}),o}function u(t,e,r){try{return{type:"normal",arg:t.call(e,r)}}catch(t){return{type:"throw",arg:t}}}t.wrap=c;var h={};function d(){}function f(){}function p(){}var g={};l(g,s,(function(){return this}));var m=Object.getPrototypeOf,y=m&&m(m(_([])));y&&y!==e&&r.call(y,s)&&(g=y);var v=p.prototype=d.prototype=Object.create(g);function b(t){["next","throw","return"].forEach((function(e){l(t,e,(function(t){return this._invoke(e,t)}))}))}function E(t,e){function i(n,s,o,a){var l=u(t[n],t,s);if("throw"!==l.type){var c=l.arg,h=c.value;return h&&"object"==ee(h)&&r.call(h,"__await")?e.resolve(h.__await).then((function(t){i("next",t,o,a)}),(function(t){i("throw",t,o,a)})):e.resolve(h).then((function(t){c.value=t,o(c)}),(function(t){return i("throw",t,o,a)}))}a(l.arg)}var s;n(this,"_invoke",{value:function(t,r){function n(){return new e((function(e,n){i(t,r,e,n)}))}return s=s?s.then(n,n):n()}})}function A(t,e,r){var n="suspendedStart";return function(i,s){if("executing"===n)throw new Error("Generator is already running");if("completed"===n){if("throw"===i)throw s;return x()}for(r.method=i,r.arg=s;;){var o=r.delegate;if(o){var a=w(o,r);if(a){if(a===h)continue;return a}}if("next"===r.method)r.sent=r._sent=r.arg;else if("throw"===r.method){if("suspendedStart"===n)throw n="completed",r.arg;r.dispatchException(r.arg)}else"return"===r.method&&r.abrupt("return",r.arg);n="executing";var l=u(t,e,r);if("normal"===l.type){if(n=r.done?"completed":"suspendedYield",l.arg===h)continue;return{value:l.arg,done:r.done}}"throw"===l.type&&(n="completed",r.method="throw",r.arg=l.arg)}}}function w(t,e){var r=e.method,n=t.iterator[r];if(void 0===n)return e.delegate=null,"throw"===r&&t.iterator.return&&(e.method="return",e.arg=void 0,w(t,e),"throw"===e.method)||"return"!==r&&(e.method="throw",e.arg=new TypeError("The iterator does not provide a '"+r+"' method")),h;var i=u(n,t.iterator,e.arg);if("throw"===i.type)return e.method="throw",e.arg=i.arg,e.delegate=null,h;var s=i.arg;return s?s.done?(e[t.resultName]=s.value,e.next=t.nextLoc,"return"!==e.method&&(e.method="next",e.arg=void 0),e.delegate=null,h):s:(e.method="throw",e.arg=new TypeError("iterator result is not an object"),e.delegate=null,h)}function T(t){var e={tryLoc:t[0]};1 in t&&(e.catchLoc=t[1]),2 in t&&(e.finallyLoc=t[2],e.afterLoc=t[3]),this.tryEntries.push(e)}function S(t){var e=t.completion||{};e.type="normal",delete e.arg,t.completion=e}function L(t){this.tryEntries=[{tryLoc:"root"}],t.forEach(T,this),this.reset(!0)}function _(t){if(t){var e=t[s];if(e)return e.call(t);if("function"==typeof t.next)return t;if(!isNaN(t.length)){var n=-1,i=function e(){for(;++n<t.length;)if(r.call(t,n))return e.value=t[n],e.done=!1,e;return e.value=void 0,e.done=!0,e};return i.next=i}}return{next:x}}function x(){return{value:void 0,done:!0}}return f.prototype=p,n(v,"constructor",{value:p,configurable:!0}),n(p,"constructor",{value:f,configurable:!0}),f.displayName=l(p,a,"GeneratorFunction"),t.isGeneratorFunction=function(t){var e="function"==typeof t&&t.constructor;return!!e&&(e===f||"GeneratorFunction"===(e.displayName||e.name))},t.mark=function(t){return Object.setPrototypeOf?Object.setPrototypeOf(t,p):(t.__proto__=p,l(t,a,"GeneratorFunction")),t.prototype=Object.create(v),t},t.awrap=function(t){return{__await:t}},b(E.prototype),l(E.prototype,o,(function(){return this})),t.AsyncIterator=E,t.async=function(e,r,n,i,s){void 0===s&&(s=Promise);var o=new E(c(e,r,n,i),s);return t.isGeneratorFunction(r)?o:o.next().then((function(t){return t.done?t.value:o.next()}))},b(v),l(v,a,"Generator"),l(v,s,(function(){return this})),l(v,"toString",(function(){return"[object Generator]"})),t.keys=function(t){var e=Object(t),r=[];for(var n in e)r.push(n);return r.reverse(),function t(){for(;r.length;){var n=r.pop();if(n in e)return t.value=n,t.done=!1,t}return t.done=!0,t}},t.values=_,L.prototype={constructor:L,reset:function(t){if(this.prev=0,this.next=0,this.sent=this._sent=void 0,this.done=!1,this.delegate=null,this.method="next",this.arg=void 0,this.tryEntries.forEach(S),!t)for(var e in this)"t"===e.charAt(0)&&r.call(this,e)&&!isNaN(+e.slice(1))&&(this[e]=void 0)},stop:function(){this.done=!0;var t=this.tryEntries[0].completion;if("throw"===t.type)throw t.arg;return this.rval},dispatchException:function(t){if(this.done)throw t;var e=this;function n(r,n){return o.type="throw",o.arg=t,e.next=r,n&&(e.method="next",e.arg=void 0),!!n}for(var i=this.tryEntries.length-1;i>=0;--i){var s=this.tryEntries[i],o=s.completion;if("root"===s.tryLoc)return n("end");if(s.tryLoc<=this.prev){var a=r.call(s,"catchLoc"),l=r.call(s,"finallyLoc");if(a&&l){if(this.prev<s.catchLoc)return n(s.catchLoc,!0);if(this.prev<s.finallyLoc)return n(s.finallyLoc)}else if(a){if(this.prev<s.catchLoc)return n(s.catchLoc,!0)}else{if(!l)throw new Error("try statement without catch or finally");if(this.prev<s.finallyLoc)return n(s.finallyLoc)}}}},abrupt:function(t,e){for(var n=this.tryEntries.length-1;n>=0;--n){var i=this.tryEntries[n];if(i.tryLoc<=this.prev&&r.call(i,"finallyLoc")&&this.prev<i.finallyLoc){var s=i;break}}s&&("break"===t||"continue"===t)&&s.tryLoc<=e&&e<=s.finallyLoc&&(s=null);var o=s?s.completion:{};return o.type=t,o.arg=e,s?(this.method="next",this.next=s.finallyLoc,h):this.complete(o)},complete:function(t,e){if("throw"===t.type)throw t.arg;return"break"===t.type||"continue"===t.type?this.next=t.arg:"return"===t.type?(this.rval=this.arg=t.arg,this.method="return",this.next="end"):"normal"===t.type&&e&&(this.next=e),h},finish:function(t){for(var e=this.tryEntries.length-1;e>=0;--e){var r=this.tryEntries[e];if(r.finallyLoc===t)return this.complete(r.completion,r.afterLoc),S(r),h}},catch:function(t){for(var e=this.tryEntries.length-1;e>=0;--e){var r=this.tryEntries[e];if(r.tryLoc===t){var n=r.completion;if("throw"===n.type){var i=n.arg;S(r)}return i}}throw new Error("illegal catch attempt")},delegateYield:function(t,e,r){return this.delegate={iterator:_(t),resultName:e,nextLoc:r},"next"===this.method&&(this.arg=void 0),h}},t}function ne(t,e,r,n,i,s,o){try{var a=t[s](o),l=a.value}catch(t){return void r(t)}a.done?e(l):Promise.resolve(l).then(n,i)}var ie=null;const se={namespace:"template-vol-3-chapter",beforeEnter:function(){var t=function(t){return function(){var e=this,r=arguments;return new Promise((function(n,i){var s=t.apply(e,r);function o(t){ne(s,n,i,o,a,"next",t)}function a(t){ne(s,n,i,o,a,"throw",t)}o(void 0)}))}}(re().mark((function t(e){var n,i,o;return re().wrap((function(t){for(;;)switch(t.prev=t.next){case 0:return e.current,n=e.next,e.trigger,t.next=3,(0,s.y6)(WPURLS.themeUrl+"/dist/css/_vol3.css");case 3:return t.next=5,Promise.all([r.e(812),r.e(5927),r.e(4041),r.e(5724),r.e(8911),r.e(4484),r.e(9200),r.e(6022)]).then(r.bind(r,7634));case 5:i=t.sent,o=i.default,(ie=new o(n.container)).init();case 9:case"end":return t.stop()}}),t)})));return function(e){return t.apply(this,arguments)}}(),afterEnter:function(t){t.current,t.next,t.trigger;ie.show()},afterLeave:function(t){t.current,t.next,t.trigger;ie.destroy(),ie=null}};function oe(t){return oe="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(t){return typeof t}:function(t){return t&&"function"==typeof Symbol&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t},oe(t)}function ae(){ae=function(){return t};var t={},e=Object.prototype,r=e.hasOwnProperty,n=Object.defineProperty||function(t,e,r){t[e]=r.value},i="function"==typeof Symbol?Symbol:{},s=i.iterator||"@@iterator",o=i.asyncIterator||"@@asyncIterator",a=i.toStringTag||"@@toStringTag";function l(t,e,r){return Object.defineProperty(t,e,{value:r,enumerable:!0,configurable:!0,writable:!0}),t[e]}try{l({},"")}catch(t){l=function(t,e,r){return t[e]=r}}function c(t,e,r,i){var s=e&&e.prototype instanceof d?e:d,o=Object.create(s.prototype),a=new L(i||[]);return n(o,"_invoke",{value:A(t,r,a)}),o}function u(t,e,r){try{return{type:"normal",arg:t.call(e,r)}}catch(t){return{type:"throw",arg:t}}}t.wrap=c;var h={};function d(){}function f(){}function p(){}var g={};l(g,s,(function(){return this}));var m=Object.getPrototypeOf,y=m&&m(m(_([])));y&&y!==e&&r.call(y,s)&&(g=y);var v=p.prototype=d.prototype=Object.create(g);function b(t){["next","throw","return"].forEach((function(e){l(t,e,(function(t){return this._invoke(e,t)}))}))}function E(t,e){function i(n,s,o,a){var l=u(t[n],t,s);if("throw"!==l.type){var c=l.arg,h=c.value;return h&&"object"==oe(h)&&r.call(h,"__await")?e.resolve(h.__await).then((function(t){i("next",t,o,a)}),(function(t){i("throw",t,o,a)})):e.resolve(h).then((function(t){c.value=t,o(c)}),(function(t){return i("throw",t,o,a)}))}a(l.arg)}var s;n(this,"_invoke",{value:function(t,r){function n(){return new e((function(e,n){i(t,r,e,n)}))}return s=s?s.then(n,n):n()}})}function A(t,e,r){var n="suspendedStart";return function(i,s){if("executing"===n)throw new Error("Generator is already running");if("completed"===n){if("throw"===i)throw s;return x()}for(r.method=i,r.arg=s;;){var o=r.delegate;if(o){var a=w(o,r);if(a){if(a===h)continue;return a}}if("next"===r.method)r.sent=r._sent=r.arg;else if("throw"===r.method){if("suspendedStart"===n)throw n="completed",r.arg;r.dispatchException(r.arg)}else"return"===r.method&&r.abrupt("return",r.arg);n="executing";var l=u(t,e,r);if("normal"===l.type){if(n=r.done?"completed":"suspendedYield",l.arg===h)continue;return{value:l.arg,done:r.done}}"throw"===l.type&&(n="completed",r.method="throw",r.arg=l.arg)}}}function w(t,e){var r=e.method,n=t.iterator[r];if(void 0===n)return e.delegate=null,"throw"===r&&t.iterator.return&&(e.method="return",e.arg=void 0,w(t,e),"throw"===e.method)||"return"!==r&&(e.method="throw",e.arg=new TypeError("The iterator does not provide a '"+r+"' method")),h;var i=u(n,t.iterator,e.arg);if("throw"===i.type)return e.method="throw",e.arg=i.arg,e.delegate=null,h;var s=i.arg;return s?s.done?(e[t.resultName]=s.value,e.next=t.nextLoc,"return"!==e.method&&(e.method="next",e.arg=void 0),e.delegate=null,h):s:(e.method="throw",e.arg=new TypeError("iterator result is not an object"),e.delegate=null,h)}function T(t){var e={tryLoc:t[0]};1 in t&&(e.catchLoc=t[1]),2 in t&&(e.finallyLoc=t[2],e.afterLoc=t[3]),this.tryEntries.push(e)}function S(t){var e=t.completion||{};e.type="normal",delete e.arg,t.completion=e}function L(t){this.tryEntries=[{tryLoc:"root"}],t.forEach(T,this),this.reset(!0)}function _(t){if(t){var e=t[s];if(e)return e.call(t);if("function"==typeof t.next)return t;if(!isNaN(t.length)){var n=-1,i=function e(){for(;++n<t.length;)if(r.call(t,n))return e.value=t[n],e.done=!1,e;return e.value=void 0,e.done=!0,e};return i.next=i}}return{next:x}}function x(){return{value:void 0,done:!0}}return f.prototype=p,n(v,"constructor",{value:p,configurable:!0}),n(p,"constructor",{value:f,configurable:!0}),f.displayName=l(p,a,"GeneratorFunction"),t.isGeneratorFunction=function(t){var e="function"==typeof t&&t.constructor;return!!e&&(e===f||"GeneratorFunction"===(e.displayName||e.name))},t.mark=function(t){return Object.setPrototypeOf?Object.setPrototypeOf(t,p):(t.__proto__=p,l(t,a,"GeneratorFunction")),t.prototype=Object.create(v),t},t.awrap=function(t){return{__await:t}},b(E.prototype),l(E.prototype,o,(function(){return this})),t.AsyncIterator=E,t.async=function(e,r,n,i,s){void 0===s&&(s=Promise);var o=new E(c(e,r,n,i),s);return t.isGeneratorFunction(r)?o:o.next().then((function(t){return t.done?t.value:o.next()}))},b(v),l(v,a,"Generator"),l(v,s,(function(){return this})),l(v,"toString",(function(){return"[object Generator]"})),t.keys=function(t){var e=Object(t),r=[];for(var n in e)r.push(n);return r.reverse(),function t(){for(;r.length;){var n=r.pop();if(n in e)return t.value=n,t.done=!1,t}return t.done=!0,t}},t.values=_,L.prototype={constructor:L,reset:function(t){if(this.prev=0,this.next=0,this.sent=this._sent=void 0,this.done=!1,this.delegate=null,this.method="next",this.arg=void 0,this.tryEntries.forEach(S),!t)for(var e in this)"t"===e.charAt(0)&&r.call(this,e)&&!isNaN(+e.slice(1))&&(this[e]=void 0)},stop:function(){this.done=!0;var t=this.tryEntries[0].completion;if("throw"===t.type)throw t.arg;return this.rval},dispatchException:function(t){if(this.done)throw t;var e=this;function n(r,n){return o.type="throw",o.arg=t,e.next=r,n&&(e.method="next",e.arg=void 0),!!n}for(var i=this.tryEntries.length-1;i>=0;--i){var s=this.tryEntries[i],o=s.completion;if("root"===s.tryLoc)return n("end");if(s.tryLoc<=this.prev){var a=r.call(s,"catchLoc"),l=r.call(s,"finallyLoc");if(a&&l){if(this.prev<s.catchLoc)return n(s.catchLoc,!0);if(this.prev<s.finallyLoc)return n(s.finallyLoc)}else if(a){if(this.prev<s.catchLoc)return n(s.catchLoc,!0)}else{if(!l)throw new Error("try statement without catch or finally");if(this.prev<s.finallyLoc)return n(s.finallyLoc)}}}},abrupt:function(t,e){for(var n=this.tryEntries.length-1;n>=0;--n){var i=this.tryEntries[n];if(i.tryLoc<=this.prev&&r.call(i,"finallyLoc")&&this.prev<i.finallyLoc){var s=i;break}}s&&("break"===t||"continue"===t)&&s.tryLoc<=e&&e<=s.finallyLoc&&(s=null);var o=s?s.completion:{};return o.type=t,o.arg=e,s?(this.method="next",this.next=s.finallyLoc,h):this.complete(o)},complete:function(t,e){if("throw"===t.type)throw t.arg;return"break"===t.type||"continue"===t.type?this.next=t.arg:"return"===t.type?(this.rval=this.arg=t.arg,this.method="return",this.next="end"):"normal"===t.type&&e&&(this.next=e),h},finish:function(t){for(var e=this.tryEntries.length-1;e>=0;--e){var r=this.tryEntries[e];if(r.finallyLoc===t)return this.complete(r.completion,r.afterLoc),S(r),h}},catch:function(t){for(var e=this.tryEntries.length-1;e>=0;--e){var r=this.tryEntries[e];if(r.tryLoc===t){var n=r.completion;if("throw"===n.type){var i=n.arg;S(r)}return i}}throw new Error("illegal catch attempt")},delegateYield:function(t,e,r){return this.delegate={iterator:_(t),resultName:e,nextLoc:r},"next"===this.method&&(this.arg=void 0),h}},t}function le(t,e,r,n,i,s,o){try{var a=t[s](o),l=a.value}catch(t){return void r(t)}a.done?e(l):Promise.resolve(l).then(n,i)}var ce=null;const ue={namespace:"template-vol-3-prelude",beforeEnter:function(){var t=function(t){return function(){var e=this,r=arguments;return new Promise((function(n,i){var s=t.apply(e,r);function o(t){le(s,n,i,o,a,"next",t)}function a(t){le(s,n,i,o,a,"throw",t)}o(void 0)}))}}(ae().mark((function t(e){var n,i,o;return ae().wrap((function(t){for(;;)switch(t.prev=t.next){case 0:return e.current,n=e.next,e.trigger,t.next=3,(0,s.y6)(WPURLS.themeUrl+"/dist/css/_fallen.css");case 3:return t.next=5,Promise.all([r.e(4041),r.e(5146)]).then(r.bind(r,5963));case 5:i=t.sent,o=i.default,(ce=new o(n.container)).init();case 9:case"end":return t.stop()}}),t)})));return function(e){return t.apply(this,arguments)}}(),afterLeave:function(t){t.current,t.next,t.trigger;ce.destroy(),ce=null}};function he(t){return he="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(t){return typeof t}:function(t){return t&&"function"==typeof Symbol&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t},he(t)}function de(){de=function(){return t};var t={},e=Object.prototype,r=e.hasOwnProperty,n=Object.defineProperty||function(t,e,r){t[e]=r.value},i="function"==typeof Symbol?Symbol:{},s=i.iterator||"@@iterator",o=i.asyncIterator||"@@asyncIterator",a=i.toStringTag||"@@toStringTag";function l(t,e,r){return Object.defineProperty(t,e,{value:r,enumerable:!0,configurable:!0,writable:!0}),t[e]}try{l({},"")}catch(t){l=function(t,e,r){return t[e]=r}}function c(t,e,r,i){var s=e&&e.prototype instanceof d?e:d,o=Object.create(s.prototype),a=new L(i||[]);return n(o,"_invoke",{value:A(t,r,a)}),o}function u(t,e,r){try{return{type:"normal",arg:t.call(e,r)}}catch(t){return{type:"throw",arg:t}}}t.wrap=c;var h={};function d(){}function f(){}function p(){}var g={};l(g,s,(function(){return this}));var m=Object.getPrototypeOf,y=m&&m(m(_([])));y&&y!==e&&r.call(y,s)&&(g=y);var v=p.prototype=d.prototype=Object.create(g);function b(t){["next","throw","return"].forEach((function(e){l(t,e,(function(t){return this._invoke(e,t)}))}))}function E(t,e){function i(n,s,o,a){var l=u(t[n],t,s);if("throw"!==l.type){var c=l.arg,h=c.value;return h&&"object"==he(h)&&r.call(h,"__await")?e.resolve(h.__await).then((function(t){i("next",t,o,a)}),(function(t){i("throw",t,o,a)})):e.resolve(h).then((function(t){c.value=t,o(c)}),(function(t){return i("throw",t,o,a)}))}a(l.arg)}var s;n(this,"_invoke",{value:function(t,r){function n(){return new e((function(e,n){i(t,r,e,n)}))}return s=s?s.then(n,n):n()}})}function A(t,e,r){var n="suspendedStart";return function(i,s){if("executing"===n)throw new Error("Generator is already running");if("completed"===n){if("throw"===i)throw s;return x()}for(r.method=i,r.arg=s;;){var o=r.delegate;if(o){var a=w(o,r);if(a){if(a===h)continue;return a}}if("next"===r.method)r.sent=r._sent=r.arg;else if("throw"===r.method){if("suspendedStart"===n)throw n="completed",r.arg;r.dispatchException(r.arg)}else"return"===r.method&&r.abrupt("return",r.arg);n="executing";var l=u(t,e,r);if("normal"===l.type){if(n=r.done?"completed":"suspendedYield",l.arg===h)continue;return{value:l.arg,done:r.done}}"throw"===l.type&&(n="completed",r.method="throw",r.arg=l.arg)}}}function w(t,e){var r=e.method,n=t.iterator[r];if(void 0===n)return e.delegate=null,"throw"===r&&t.iterator.return&&(e.method="return",e.arg=void 0,w(t,e),"throw"===e.method)||"return"!==r&&(e.method="throw",e.arg=new TypeError("The iterator does not provide a '"+r+"' method")),h;var i=u(n,t.iterator,e.arg);if("throw"===i.type)return e.method="throw",e.arg=i.arg,e.delegate=null,h;var s=i.arg;return s?s.done?(e[t.resultName]=s.value,e.next=t.nextLoc,"return"!==e.method&&(e.method="next",e.arg=void 0),e.delegate=null,h):s:(e.method="throw",e.arg=new TypeError("iterator result is not an object"),e.delegate=null,h)}function T(t){var e={tryLoc:t[0]};1 in t&&(e.catchLoc=t[1]),2 in t&&(e.finallyLoc=t[2],e.afterLoc=t[3]),this.tryEntries.push(e)}function S(t){var e=t.completion||{};e.type="normal",delete e.arg,t.completion=e}function L(t){this.tryEntries=[{tryLoc:"root"}],t.forEach(T,this),this.reset(!0)}function _(t){if(t){var e=t[s];if(e)return e.call(t);if("function"==typeof t.next)return t;if(!isNaN(t.length)){var n=-1,i=function e(){for(;++n<t.length;)if(r.call(t,n))return e.value=t[n],e.done=!1,e;return e.value=void 0,e.done=!0,e};return i.next=i}}return{next:x}}function x(){return{value:void 0,done:!0}}return f.prototype=p,n(v,"constructor",{value:p,configurable:!0}),n(p,"constructor",{value:f,configurable:!0}),f.displayName=l(p,a,"GeneratorFunction"),t.isGeneratorFunction=function(t){var e="function"==typeof t&&t.constructor;return!!e&&(e===f||"GeneratorFunction"===(e.displayName||e.name))},t.mark=function(t){return Object.setPrototypeOf?Object.setPrototypeOf(t,p):(t.__proto__=p,l(t,a,"GeneratorFunction")),t.prototype=Object.create(v),t},t.awrap=function(t){return{__await:t}},b(E.prototype),l(E.prototype,o,(function(){return this})),t.AsyncIterator=E,t.async=function(e,r,n,i,s){void 0===s&&(s=Promise);var o=new E(c(e,r,n,i),s);return t.isGeneratorFunction(r)?o:o.next().then((function(t){return t.done?t.value:o.next()}))},b(v),l(v,a,"Generator"),l(v,s,(function(){return this})),l(v,"toString",(function(){return"[object Generator]"})),t.keys=function(t){var e=Object(t),r=[];for(var n in e)r.push(n);return r.reverse(),function t(){for(;r.length;){var n=r.pop();if(n in e)return t.value=n,t.done=!1,t}return t.done=!0,t}},t.values=_,L.prototype={constructor:L,reset:function(t){if(this.prev=0,this.next=0,this.sent=this._sent=void 0,this.done=!1,this.delegate=null,this.method="next",this.arg=void 0,this.tryEntries.forEach(S),!t)for(var e in this)"t"===e.charAt(0)&&r.call(this,e)&&!isNaN(+e.slice(1))&&(this[e]=void 0)},stop:function(){this.done=!0;var t=this.tryEntries[0].completion;if("throw"===t.type)throw t.arg;return this.rval},dispatchException:function(t){if(this.done)throw t;var e=this;function n(r,n){return o.type="throw",o.arg=t,e.next=r,n&&(e.method="next",e.arg=void 0),!!n}for(var i=this.tryEntries.length-1;i>=0;--i){var s=this.tryEntries[i],o=s.completion;if("root"===s.tryLoc)return n("end");if(s.tryLoc<=this.prev){var a=r.call(s,"catchLoc"),l=r.call(s,"finallyLoc");if(a&&l){if(this.prev<s.catchLoc)return n(s.catchLoc,!0);if(this.prev<s.finallyLoc)return n(s.finallyLoc)}else if(a){if(this.prev<s.catchLoc)return n(s.catchLoc,!0)}else{if(!l)throw new Error("try statement without catch or finally");if(this.prev<s.finallyLoc)return n(s.finallyLoc)}}}},abrupt:function(t,e){for(var n=this.tryEntries.length-1;n>=0;--n){var i=this.tryEntries[n];if(i.tryLoc<=this.prev&&r.call(i,"finallyLoc")&&this.prev<i.finallyLoc){var s=i;break}}s&&("break"===t||"continue"===t)&&s.tryLoc<=e&&e<=s.finallyLoc&&(s=null);var o=s?s.completion:{};return o.type=t,o.arg=e,s?(this.method="next",this.next=s.finallyLoc,h):this.complete(o)},complete:function(t,e){if("throw"===t.type)throw t.arg;return"break"===t.type||"continue"===t.type?this.next=t.arg:"return"===t.type?(this.rval=this.arg=t.arg,this.method="return",this.next="end"):"normal"===t.type&&e&&(this.next=e),h},finish:function(t){for(var e=this.tryEntries.length-1;e>=0;--e){var r=this.tryEntries[e];if(r.finallyLoc===t)return this.complete(r.completion,r.afterLoc),S(r),h}},catch:function(t){for(var e=this.tryEntries.length-1;e>=0;--e){var r=this.tryEntries[e];if(r.tryLoc===t){var n=r.completion;if("throw"===n.type){var i=n.arg;S(r)}return i}}throw new Error("illegal catch attempt")},delegateYield:function(t,e,r){return this.delegate={iterator:_(t),resultName:e,nextLoc:r},"next"===this.method&&(this.arg=void 0),h}},t}function fe(t,e,r,n,i,s,o){try{var a=t[s](o),l=a.value}catch(t){return void r(t)}a.done?e(l):Promise.resolve(l).then(n,i)}const pe={namespace:"template-pollinators",beforeEnter:function(){var t=function(t){return function(){var e=this,r=arguments;return new Promise((function(n,i){var s=t.apply(e,r);function o(t){fe(s,n,i,o,a,"next",t)}function a(t){fe(s,n,i,o,a,"throw",t)}o(void 0)}))}}(de().mark((function t(e){var n,i,o;return de().wrap((function(t){for(;;)switch(t.prev=t.next){case 0:return e.current,n=e.next,e.trigger,t.next=3,(0,s.y6)(WPURLS.themeUrl+"/dist/css/_pollinators.css");case 3:return t.next=5,Promise.all([r.e(4041),r.e(873)]).then(r.bind(r,4348));case 5:i=t.sent,o=i.default,o.create(n.container);case 8:case"end":return t.stop()}}),t)})));return function(e){return t.apply(this,arguments)}}(),afterEnter:function(){document.body.classList.add("body--black")}};function ge(t){return ge="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(t){return typeof t}:function(t){return t&&"function"==typeof Symbol&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t},ge(t)}function me(){me=function(){return t};var t={},e=Object.prototype,r=e.hasOwnProperty,n=Object.defineProperty||function(t,e,r){t[e]=r.value},i="function"==typeof Symbol?Symbol:{},s=i.iterator||"@@iterator",o=i.asyncIterator||"@@asyncIterator",a=i.toStringTag||"@@toStringTag";function l(t,e,r){return Object.defineProperty(t,e,{value:r,enumerable:!0,configurable:!0,writable:!0}),t[e]}try{l({},"")}catch(t){l=function(t,e,r){return t[e]=r}}function c(t,e,r,i){var s=e&&e.prototype instanceof d?e:d,o=Object.create(s.prototype),a=new L(i||[]);return n(o,"_invoke",{value:A(t,r,a)}),o}function u(t,e,r){try{return{type:"normal",arg:t.call(e,r)}}catch(t){return{type:"throw",arg:t}}}t.wrap=c;var h={};function d(){}function f(){}function p(){}var g={};l(g,s,(function(){return this}));var m=Object.getPrototypeOf,y=m&&m(m(_([])));y&&y!==e&&r.call(y,s)&&(g=y);var v=p.prototype=d.prototype=Object.create(g);function b(t){["next","throw","return"].forEach((function(e){l(t,e,(function(t){return this._invoke(e,t)}))}))}function E(t,e){function i(n,s,o,a){var l=u(t[n],t,s);if("throw"!==l.type){var c=l.arg,h=c.value;return h&&"object"==ge(h)&&r.call(h,"__await")?e.resolve(h.__await).then((function(t){i("next",t,o,a)}),(function(t){i("throw",t,o,a)})):e.resolve(h).then((function(t){c.value=t,o(c)}),(function(t){return i("throw",t,o,a)}))}a(l.arg)}var s;n(this,"_invoke",{value:function(t,r){function n(){return new e((function(e,n){i(t,r,e,n)}))}return s=s?s.then(n,n):n()}})}function A(t,e,r){var n="suspendedStart";return function(i,s){if("executing"===n)throw new Error("Generator is already running");if("completed"===n){if("throw"===i)throw s;return x()}for(r.method=i,r.arg=s;;){var o=r.delegate;if(o){var a=w(o,r);if(a){if(a===h)continue;return a}}if("next"===r.method)r.sent=r._sent=r.arg;else if("throw"===r.method){if("suspendedStart"===n)throw n="completed",r.arg;r.dispatchException(r.arg)}else"return"===r.method&&r.abrupt("return",r.arg);n="executing";var l=u(t,e,r);if("normal"===l.type){if(n=r.done?"completed":"suspendedYield",l.arg===h)continue;return{value:l.arg,done:r.done}}"throw"===l.type&&(n="completed",r.method="throw",r.arg=l.arg)}}}function w(t,e){var r=e.method,n=t.iterator[r];if(void 0===n)return e.delegate=null,"throw"===r&&t.iterator.return&&(e.method="return",e.arg=void 0,w(t,e),"throw"===e.method)||"return"!==r&&(e.method="throw",e.arg=new TypeError("The iterator does not provide a '"+r+"' method")),h;var i=u(n,t.iterator,e.arg);if("throw"===i.type)return e.method="throw",e.arg=i.arg,e.delegate=null,h;var s=i.arg;return s?s.done?(e[t.resultName]=s.value,e.next=t.nextLoc,"return"!==e.method&&(e.method="next",e.arg=void 0),e.delegate=null,h):s:(e.method="throw",e.arg=new TypeError("iterator result is not an object"),e.delegate=null,h)}function T(t){var e={tryLoc:t[0]};1 in t&&(e.catchLoc=t[1]),2 in t&&(e.finallyLoc=t[2],e.afterLoc=t[3]),this.tryEntries.push(e)}function S(t){var e=t.completion||{};e.type="normal",delete e.arg,t.completion=e}function L(t){this.tryEntries=[{tryLoc:"root"}],t.forEach(T,this),this.reset(!0)}function _(t){if(t){var e=t[s];if(e)return e.call(t);if("function"==typeof t.next)return t;if(!isNaN(t.length)){var n=-1,i=function e(){for(;++n<t.length;)if(r.call(t,n))return e.value=t[n],e.done=!1,e;return e.value=void 0,e.done=!0,e};return i.next=i}}return{next:x}}function x(){return{value:void 0,done:!0}}return f.prototype=p,n(v,"constructor",{value:p,configurable:!0}),n(p,"constructor",{value:f,configurable:!0}),f.displayName=l(p,a,"GeneratorFunction"),t.isGeneratorFunction=function(t){var e="function"==typeof t&&t.constructor;return!!e&&(e===f||"GeneratorFunction"===(e.displayName||e.name))},t.mark=function(t){return Object.setPrototypeOf?Object.setPrototypeOf(t,p):(t.__proto__=p,l(t,a,"GeneratorFunction")),t.prototype=Object.create(v),t},t.awrap=function(t){return{__await:t}},b(E.prototype),l(E.prototype,o,(function(){return this})),t.AsyncIterator=E,t.async=function(e,r,n,i,s){void 0===s&&(s=Promise);var o=new E(c(e,r,n,i),s);return t.isGeneratorFunction(r)?o:o.next().then((function(t){return t.done?t.value:o.next()}))},b(v),l(v,a,"Generator"),l(v,s,(function(){return this})),l(v,"toString",(function(){return"[object Generator]"})),t.keys=function(t){var e=Object(t),r=[];for(var n in e)r.push(n);return r.reverse(),function t(){for(;r.length;){var n=r.pop();if(n in e)return t.value=n,t.done=!1,t}return t.done=!0,t}},t.values=_,L.prototype={constructor:L,reset:function(t){if(this.prev=0,this.next=0,this.sent=this._sent=void 0,this.done=!1,this.delegate=null,this.method="next",this.arg=void 0,this.tryEntries.forEach(S),!t)for(var e in this)"t"===e.charAt(0)&&r.call(this,e)&&!isNaN(+e.slice(1))&&(this[e]=void 0)},stop:function(){this.done=!0;var t=this.tryEntries[0].completion;if("throw"===t.type)throw t.arg;return this.rval},dispatchException:function(t){if(this.done)throw t;var e=this;function n(r,n){return o.type="throw",o.arg=t,e.next=r,n&&(e.method="next",e.arg=void 0),!!n}for(var i=this.tryEntries.length-1;i>=0;--i){var s=this.tryEntries[i],o=s.completion;if("root"===s.tryLoc)return n("end");if(s.tryLoc<=this.prev){var a=r.call(s,"catchLoc"),l=r.call(s,"finallyLoc");if(a&&l){if(this.prev<s.catchLoc)return n(s.catchLoc,!0);if(this.prev<s.finallyLoc)return n(s.finallyLoc)}else if(a){if(this.prev<s.catchLoc)return n(s.catchLoc,!0)}else{if(!l)throw new Error("try statement without catch or finally");if(this.prev<s.finallyLoc)return n(s.finallyLoc)}}}},abrupt:function(t,e){for(var n=this.tryEntries.length-1;n>=0;--n){var i=this.tryEntries[n];if(i.tryLoc<=this.prev&&r.call(i,"finallyLoc")&&this.prev<i.finallyLoc){var s=i;break}}s&&("break"===t||"continue"===t)&&s.tryLoc<=e&&e<=s.finallyLoc&&(s=null);var o=s?s.completion:{};return o.type=t,o.arg=e,s?(this.method="next",this.next=s.finallyLoc,h):this.complete(o)},complete:function(t,e){if("throw"===t.type)throw t.arg;return"break"===t.type||"continue"===t.type?this.next=t.arg:"return"===t.type?(this.rval=this.arg=t.arg,this.method="return",this.next="end"):"normal"===t.type&&e&&(this.next=e),h},finish:function(t){for(var e=this.tryEntries.length-1;e>=0;--e){var r=this.tryEntries[e];if(r.finallyLoc===t)return this.complete(r.completion,r.afterLoc),S(r),h}},catch:function(t){for(var e=this.tryEntries.length-1;e>=0;--e){var r=this.tryEntries[e];if(r.tryLoc===t){var n=r.completion;if("throw"===n.type){var i=n.arg;S(r)}return i}}throw new Error("illegal catch attempt")},delegateYield:function(t,e,r){return this.delegate={iterator:_(t),resultName:e,nextLoc:r},"next"===this.method&&(this.arg=void 0),h}},t}function ye(t,e,r,n,i,s,o){try{var a=t[s](o),l=a.value}catch(t){return void r(t)}a.done?e(l):Promise.resolve(l).then(n,i)}function ve(t){return function(){var e=this,r=arguments;return new Promise((function(n,i){var s=t.apply(e,r);function o(t){ye(s,n,i,o,a,"next",t)}function a(t){ye(s,n,i,o,a,"throw",t)}o(void 0)}))}}var be=null;const Ee={namespace:"template-pollinators-chapter",beforeEnter:function(){var t=ve(me().mark((function t(e){return me().wrap((function(t){for(;;)switch(t.prev=t.next){case 0:return e.current,e.next,e.trigger,t.next=3,(0,s.y6)(WPURLS.themeUrl+"/dist/css/_pollinators.css");case 3:case"end":return t.stop()}}),t)})));return function(e){return t.apply(this,arguments)}}(),afterEnter:(Ae=ve(me().mark((function t(e){var n,i,s;return me().wrap((function(t){for(;;)switch(t.prev=t.next){case 0:return e.current,n=e.next,e.trigger,document.body.classList.add("body--black"),t.next=4,Promise.all([r.e(812),r.e(5927),r.e(4041),r.e(5724),r.e(8911),r.e(4484),r.e(9200),r.e(6022)]).then(r.bind(r,9265));case 4:i=t.sent,s=i.default,(be=new s(n.container)).init();case 8:case"end":return t.stop()}}),t)}))),function(t){return Ae.apply(this,arguments)}),afterLeave:function(t){t.current,t.next,t.trigger;be.destroy(),be=null}};var Ae;function we(t){return we="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(t){return typeof t}:function(t){return t&&"function"==typeof Symbol&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t},we(t)}function Te(){Te=function(){return t};var t={},e=Object.prototype,r=e.hasOwnProperty,n=Object.defineProperty||function(t,e,r){t[e]=r.value},i="function"==typeof Symbol?Symbol:{},s=i.iterator||"@@iterator",o=i.asyncIterator||"@@asyncIterator",a=i.toStringTag||"@@toStringTag";function l(t,e,r){return Object.defineProperty(t,e,{value:r,enumerable:!0,configurable:!0,writable:!0}),t[e]}try{l({},"")}catch(t){l=function(t,e,r){return t[e]=r}}function c(t,e,r,i){var s=e&&e.prototype instanceof d?e:d,o=Object.create(s.prototype),a=new L(i||[]);return n(o,"_invoke",{value:A(t,r,a)}),o}function u(t,e,r){try{return{type:"normal",arg:t.call(e,r)}}catch(t){return{type:"throw",arg:t}}}t.wrap=c;var h={};function d(){}function f(){}function p(){}var g={};l(g,s,(function(){return this}));var m=Object.getPrototypeOf,y=m&&m(m(_([])));y&&y!==e&&r.call(y,s)&&(g=y);var v=p.prototype=d.prototype=Object.create(g);function b(t){["next","throw","return"].forEach((function(e){l(t,e,(function(t){return this._invoke(e,t)}))}))}function E(t,e){function i(n,s,o,a){var l=u(t[n],t,s);if("throw"!==l.type){var c=l.arg,h=c.value;return h&&"object"==we(h)&&r.call(h,"__await")?e.resolve(h.__await).then((function(t){i("next",t,o,a)}),(function(t){i("throw",t,o,a)})):e.resolve(h).then((function(t){c.value=t,o(c)}),(function(t){return i("throw",t,o,a)}))}a(l.arg)}var s;n(this,"_invoke",{value:function(t,r){function n(){return new e((function(e,n){i(t,r,e,n)}))}return s=s?s.then(n,n):n()}})}function A(t,e,r){var n="suspendedStart";return function(i,s){if("executing"===n)throw new Error("Generator is already running");if("completed"===n){if("throw"===i)throw s;return x()}for(r.method=i,r.arg=s;;){var o=r.delegate;if(o){var a=w(o,r);if(a){if(a===h)continue;return a}}if("next"===r.method)r.sent=r._sent=r.arg;else if("throw"===r.method){if("suspendedStart"===n)throw n="completed",r.arg;r.dispatchException(r.arg)}else"return"===r.method&&r.abrupt("return",r.arg);n="executing";var l=u(t,e,r);if("normal"===l.type){if(n=r.done?"completed":"suspendedYield",l.arg===h)continue;return{value:l.arg,done:r.done}}"throw"===l.type&&(n="completed",r.method="throw",r.arg=l.arg)}}}function w(t,e){var r=e.method,n=t.iterator[r];if(void 0===n)return e.delegate=null,"throw"===r&&t.iterator.return&&(e.method="return",e.arg=void 0,w(t,e),"throw"===e.method)||"return"!==r&&(e.method="throw",e.arg=new TypeError("The iterator does not provide a '"+r+"' method")),h;var i=u(n,t.iterator,e.arg);if("throw"===i.type)return e.method="throw",e.arg=i.arg,e.delegate=null,h;var s=i.arg;return s?s.done?(e[t.resultName]=s.value,e.next=t.nextLoc,"return"!==e.method&&(e.method="next",e.arg=void 0),e.delegate=null,h):s:(e.method="throw",e.arg=new TypeError("iterator result is not an object"),e.delegate=null,h)}function T(t){var e={tryLoc:t[0]};1 in t&&(e.catchLoc=t[1]),2 in t&&(e.finallyLoc=t[2],e.afterLoc=t[3]),this.tryEntries.push(e)}function S(t){var e=t.completion||{};e.type="normal",delete e.arg,t.completion=e}function L(t){this.tryEntries=[{tryLoc:"root"}],t.forEach(T,this),this.reset(!0)}function _(t){if(t){var e=t[s];if(e)return e.call(t);if("function"==typeof t.next)return t;if(!isNaN(t.length)){var n=-1,i=function e(){for(;++n<t.length;)if(r.call(t,n))return e.value=t[n],e.done=!1,e;return e.value=void 0,e.done=!0,e};return i.next=i}}return{next:x}}function x(){return{value:void 0,done:!0}}return f.prototype=p,n(v,"constructor",{value:p,configurable:!0}),n(p,"constructor",{value:f,configurable:!0}),f.displayName=l(p,a,"GeneratorFunction"),t.isGeneratorFunction=function(t){var e="function"==typeof t&&t.constructor;return!!e&&(e===f||"GeneratorFunction"===(e.displayName||e.name))},t.mark=function(t){return Object.setPrototypeOf?Object.setPrototypeOf(t,p):(t.__proto__=p,l(t,a,"GeneratorFunction")),t.prototype=Object.create(v),t},t.awrap=function(t){return{__await:t}},b(E.prototype),l(E.prototype,o,(function(){return this})),t.AsyncIterator=E,t.async=function(e,r,n,i,s){void 0===s&&(s=Promise);var o=new E(c(e,r,n,i),s);return t.isGeneratorFunction(r)?o:o.next().then((function(t){return t.done?t.value:o.next()}))},b(v),l(v,a,"Generator"),l(v,s,(function(){return this})),l(v,"toString",(function(){return"[object Generator]"})),t.keys=function(t){var e=Object(t),r=[];for(var n in e)r.push(n);return r.reverse(),function t(){for(;r.length;){var n=r.pop();if(n in e)return t.value=n,t.done=!1,t}return t.done=!0,t}},t.values=_,L.prototype={constructor:L,reset:function(t){if(this.prev=0,this.next=0,this.sent=this._sent=void 0,this.done=!1,this.delegate=null,this.method="next",this.arg=void 0,this.tryEntries.forEach(S),!t)for(var e in this)"t"===e.charAt(0)&&r.call(this,e)&&!isNaN(+e.slice(1))&&(this[e]=void 0)},stop:function(){this.done=!0;var t=this.tryEntries[0].completion;if("throw"===t.type)throw t.arg;return this.rval},dispatchException:function(t){if(this.done)throw t;var e=this;function n(r,n){return o.type="throw",o.arg=t,e.next=r,n&&(e.method="next",e.arg=void 0),!!n}for(var i=this.tryEntries.length-1;i>=0;--i){var s=this.tryEntries[i],o=s.completion;if("root"===s.tryLoc)return n("end");if(s.tryLoc<=this.prev){var a=r.call(s,"catchLoc"),l=r.call(s,"finallyLoc");if(a&&l){if(this.prev<s.catchLoc)return n(s.catchLoc,!0);if(this.prev<s.finallyLoc)return n(s.finallyLoc)}else if(a){if(this.prev<s.catchLoc)return n(s.catchLoc,!0)}else{if(!l)throw new Error("try statement without catch or finally");if(this.prev<s.finallyLoc)return n(s.finallyLoc)}}}},abrupt:function(t,e){for(var n=this.tryEntries.length-1;n>=0;--n){var i=this.tryEntries[n];if(i.tryLoc<=this.prev&&r.call(i,"finallyLoc")&&this.prev<i.finallyLoc){var s=i;break}}s&&("break"===t||"continue"===t)&&s.tryLoc<=e&&e<=s.finallyLoc&&(s=null);var o=s?s.completion:{};return o.type=t,o.arg=e,s?(this.method="next",this.next=s.finallyLoc,h):this.complete(o)},complete:function(t,e){if("throw"===t.type)throw t.arg;return"break"===t.type||"continue"===t.type?this.next=t.arg:"return"===t.type?(this.rval=this.arg=t.arg,this.method="return",this.next="end"):"normal"===t.type&&e&&(this.next=e),h},finish:function(t){for(var e=this.tryEntries.length-1;e>=0;--e){var r=this.tryEntries[e];if(r.finallyLoc===t)return this.complete(r.completion,r.afterLoc),S(r),h}},catch:function(t){for(var e=this.tryEntries.length-1;e>=0;--e){var r=this.tryEntries[e];if(r.tryLoc===t){var n=r.completion;if("throw"===n.type){var i=n.arg;S(r)}return i}}throw new Error("illegal catch attempt")},delegateYield:function(t,e,r){return this.delegate={iterator:_(t),resultName:e,nextLoc:r},"next"===this.method&&(this.arg=void 0),h}},t}function Se(t,e,r,n,i,s,o){try{var a=t[s](o),l=a.value}catch(t){return void r(t)}a.done?e(l):Promise.resolve(l).then(n,i)}var Le=null;const _e={namespace:"template-valemon-the-bear",beforeEnter:function(){var t=function(t){return function(){var e=this,r=arguments;return new Promise((function(n,i){var s=t.apply(e,r);function o(t){Se(s,n,i,o,a,"next",t)}function a(t){Se(s,n,i,o,a,"throw",t)}o(void 0)}))}}(Te().mark((function t(e){var n,i,o;return Te().wrap((function(t){for(;;)switch(t.prev=t.next){case 0:return e.current,n=e.next,e.trigger,t.next=3,(0,s.y6)(WPURLS.themeUrl+"/dist/css/_valemon-the-bear.css");case 3:return t.next=5,Promise.all([r.e(812),r.e(5927),r.e(4094)]).then(r.bind(r,9812));case 5:i=t.sent,o=i.default,Le=new o(n.container),window.scrollTo(0,0),Le.init();case 10:case"end":return t.stop()}}),t)})));return function(e){return t.apply(this,arguments)}}(),afterEnter:function(t){t.current,t.next,t.trigger;Le.initialReveal()},afterLeave:function(t){t.current,t.next,t.trigger;Le.destroy(),Le=null}};function xe(t){return xe="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(t){return typeof t}:function(t){return t&&"function"==typeof Symbol&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t},xe(t)}function ke(){ke=function(){return t};var t={},e=Object.prototype,r=e.hasOwnProperty,n=Object.defineProperty||function(t,e,r){t[e]=r.value},i="function"==typeof Symbol?Symbol:{},s=i.iterator||"@@iterator",o=i.asyncIterator||"@@asyncIterator",a=i.toStringTag||"@@toStringTag";function l(t,e,r){return Object.defineProperty(t,e,{value:r,enumerable:!0,configurable:!0,writable:!0}),t[e]}try{l({},"")}catch(t){l=function(t,e,r){return t[e]=r}}function c(t,e,r,i){var s=e&&e.prototype instanceof d?e:d,o=Object.create(s.prototype),a=new L(i||[]);return n(o,"_invoke",{value:A(t,r,a)}),o}function u(t,e,r){try{return{type:"normal",arg:t.call(e,r)}}catch(t){return{type:"throw",arg:t}}}t.wrap=c;var h={};function d(){}function f(){}function p(){}var g={};l(g,s,(function(){return this}));var m=Object.getPrototypeOf,y=m&&m(m(_([])));y&&y!==e&&r.call(y,s)&&(g=y);var v=p.prototype=d.prototype=Object.create(g);function b(t){["next","throw","return"].forEach((function(e){l(t,e,(function(t){return this._invoke(e,t)}))}))}function E(t,e){function i(n,s,o,a){var l=u(t[n],t,s);if("throw"!==l.type){var c=l.arg,h=c.value;return h&&"object"==xe(h)&&r.call(h,"__await")?e.resolve(h.__await).then((function(t){i("next",t,o,a)}),(function(t){i("throw",t,o,a)})):e.resolve(h).then((function(t){c.value=t,o(c)}),(function(t){return i("throw",t,o,a)}))}a(l.arg)}var s;n(this,"_invoke",{value:function(t,r){function n(){return new e((function(e,n){i(t,r,e,n)}))}return s=s?s.then(n,n):n()}})}function A(t,e,r){var n="suspendedStart";return function(i,s){if("executing"===n)throw new Error("Generator is already running");if("completed"===n){if("throw"===i)throw s;return x()}for(r.method=i,r.arg=s;;){var o=r.delegate;if(o){var a=w(o,r);if(a){if(a===h)continue;return a}}if("next"===r.method)r.sent=r._sent=r.arg;else if("throw"===r.method){if("suspendedStart"===n)throw n="completed",r.arg;r.dispatchException(r.arg)}else"return"===r.method&&r.abrupt("return",r.arg);n="executing";var l=u(t,e,r);if("normal"===l.type){if(n=r.done?"completed":"suspendedYield",l.arg===h)continue;return{value:l.arg,done:r.done}}"throw"===l.type&&(n="completed",r.method="throw",r.arg=l.arg)}}}function w(t,e){var r=e.method,n=t.iterator[r];if(void 0===n)return e.delegate=null,"throw"===r&&t.iterator.return&&(e.method="return",e.arg=void 0,w(t,e),"throw"===e.method)||"return"!==r&&(e.method="throw",e.arg=new TypeError("The iterator does not provide a '"+r+"' method")),h;var i=u(n,t.iterator,e.arg);if("throw"===i.type)return e.method="throw",e.arg=i.arg,e.delegate=null,h;var s=i.arg;return s?s.done?(e[t.resultName]=s.value,e.next=t.nextLoc,"return"!==e.method&&(e.method="next",e.arg=void 0),e.delegate=null,h):s:(e.method="throw",e.arg=new TypeError("iterator result is not an object"),e.delegate=null,h)}function T(t){var e={tryLoc:t[0]};1 in t&&(e.catchLoc=t[1]),2 in t&&(e.finallyLoc=t[2],e.afterLoc=t[3]),this.tryEntries.push(e)}function S(t){var e=t.completion||{};e.type="normal",delete e.arg,t.completion=e}function L(t){this.tryEntries=[{tryLoc:"root"}],t.forEach(T,this),this.reset(!0)}function _(t){if(t){var e=t[s];if(e)return e.call(t);if("function"==typeof t.next)return t;if(!isNaN(t.length)){var n=-1,i=function e(){for(;++n<t.length;)if(r.call(t,n))return e.value=t[n],e.done=!1,e;return e.value=void 0,e.done=!0,e};return i.next=i}}return{next:x}}function x(){return{value:void 0,done:!0}}return f.prototype=p,n(v,"constructor",{value:p,configurable:!0}),n(p,"constructor",{value:f,configurable:!0}),f.displayName=l(p,a,"GeneratorFunction"),t.isGeneratorFunction=function(t){var e="function"==typeof t&&t.constructor;return!!e&&(e===f||"GeneratorFunction"===(e.displayName||e.name))},t.mark=function(t){return Object.setPrototypeOf?Object.setPrototypeOf(t,p):(t.__proto__=p,l(t,a,"GeneratorFunction")),t.prototype=Object.create(v),t},t.awrap=function(t){return{__await:t}},b(E.prototype),l(E.prototype,o,(function(){return this})),t.AsyncIterator=E,t.async=function(e,r,n,i,s){void 0===s&&(s=Promise);var o=new E(c(e,r,n,i),s);return t.isGeneratorFunction(r)?o:o.next().then((function(t){return t.done?t.value:o.next()}))},b(v),l(v,a,"Generator"),l(v,s,(function(){return this})),l(v,"toString",(function(){return"[object Generator]"})),t.keys=function(t){var e=Object(t),r=[];for(var n in e)r.push(n);return r.reverse(),function t(){for(;r.length;){var n=r.pop();if(n in e)return t.value=n,t.done=!1,t}return t.done=!0,t}},t.values=_,L.prototype={constructor:L,reset:function(t){if(this.prev=0,this.next=0,this.sent=this._sent=void 0,this.done=!1,this.delegate=null,this.method="next",this.arg=void 0,this.tryEntries.forEach(S),!t)for(var e in this)"t"===e.charAt(0)&&r.call(this,e)&&!isNaN(+e.slice(1))&&(this[e]=void 0)},stop:function(){this.done=!0;var t=this.tryEntries[0].completion;if("throw"===t.type)throw t.arg;return this.rval},dispatchException:function(t){if(this.done)throw t;var e=this;function n(r,n){return o.type="throw",o.arg=t,e.next=r,n&&(e.method="next",e.arg=void 0),!!n}for(var i=this.tryEntries.length-1;i>=0;--i){var s=this.tryEntries[i],o=s.completion;if("root"===s.tryLoc)return n("end");if(s.tryLoc<=this.prev){var a=r.call(s,"catchLoc"),l=r.call(s,"finallyLoc");if(a&&l){if(this.prev<s.catchLoc)return n(s.catchLoc,!0);if(this.prev<s.finallyLoc)return n(s.finallyLoc)}else if(a){if(this.prev<s.catchLoc)return n(s.catchLoc,!0)}else{if(!l)throw new Error("try statement without catch or finally");if(this.prev<s.finallyLoc)return n(s.finallyLoc)}}}},abrupt:function(t,e){for(var n=this.tryEntries.length-1;n>=0;--n){var i=this.tryEntries[n];if(i.tryLoc<=this.prev&&r.call(i,"finallyLoc")&&this.prev<i.finallyLoc){var s=i;break}}s&&("break"===t||"continue"===t)&&s.tryLoc<=e&&e<=s.finallyLoc&&(s=null);var o=s?s.completion:{};return o.type=t,o.arg=e,s?(this.method="next",this.next=s.finallyLoc,h):this.complete(o)},complete:function(t,e){if("throw"===t.type)throw t.arg;return"break"===t.type||"continue"===t.type?this.next=t.arg:"return"===t.type?(this.rval=this.arg=t.arg,this.method="return",this.next="end"):"normal"===t.type&&e&&(this.next=e),h},finish:function(t){for(var e=this.tryEntries.length-1;e>=0;--e){var r=this.tryEntries[e];if(r.finallyLoc===t)return this.complete(r.completion,r.afterLoc),S(r),h}},catch:function(t){for(var e=this.tryEntries.length-1;e>=0;--e){var r=this.tryEntries[e];if(r.tryLoc===t){var n=r.completion;if("throw"===n.type){var i=n.arg;S(r)}return i}}throw new Error("illegal catch attempt")},delegateYield:function(t,e,r){return this.delegate={iterator:_(t),resultName:e,nextLoc:r},"next"===this.method&&(this.arg=void 0),h}},t}function Pe(t,e,r,n,i,s,o){try{var a=t[s](o),l=a.value}catch(t){return void r(t)}a.done?e(l):Promise.resolve(l).then(n,i)}var Ie=null;const Re={namespace:"template-london-exhibition",beforeEnter:function(){var t=function(t){return function(){var e=this,r=arguments;return new Promise((function(n,i){var s=t.apply(e,r);function o(t){Pe(s,n,i,o,a,"next",t)}function a(t){Pe(s,n,i,o,a,"throw",t)}o(void 0)}))}}(ke().mark((function t(e){var n,i,o;return ke().wrap((function(t){for(;;)switch(t.prev=t.next){case 0:return e.current,n=e.next,e.trigger,t.next=3,(0,s.y6)(WPURLS.themeUrl+"/dist/css/_london-exhibition.css");case 3:return t.next=5,r.e(5237).then(r.bind(r,2205));case 5:i=t.sent,o=i.default,(Ie=new o(n.container)).init();case 9:case"end":return t.stop()}}),t)})));return function(e){return t.apply(this,arguments)}}(),afterLeave:function(t){t.current,t.next,t.trigger;Ie.destroy(),Ie=null}};function Oe(t){return Oe="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(t){return typeof t}:function(t){return t&&"function"==typeof Symbol&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t},Oe(t)}function De(){De=function(){return t};var t={},e=Object.prototype,r=e.hasOwnProperty,n=Object.defineProperty||function(t,e,r){t[e]=r.value},i="function"==typeof Symbol?Symbol:{},s=i.iterator||"@@iterator",o=i.asyncIterator||"@@asyncIterator",a=i.toStringTag||"@@toStringTag";function l(t,e,r){return Object.defineProperty(t,e,{value:r,enumerable:!0,configurable:!0,writable:!0}),t[e]}try{l({},"")}catch(t){l=function(t,e,r){return t[e]=r}}function c(t,e,r,i){var s=e&&e.prototype instanceof d?e:d,o=Object.create(s.prototype),a=new L(i||[]);return n(o,"_invoke",{value:A(t,r,a)}),o}function u(t,e,r){try{return{type:"normal",arg:t.call(e,r)}}catch(t){return{type:"throw",arg:t}}}t.wrap=c;var h={};function d(){}function f(){}function p(){}var g={};l(g,s,(function(){return this}));var m=Object.getPrototypeOf,y=m&&m(m(_([])));y&&y!==e&&r.call(y,s)&&(g=y);var v=p.prototype=d.prototype=Object.create(g);function b(t){["next","throw","return"].forEach((function(e){l(t,e,(function(t){return this._invoke(e,t)}))}))}function E(t,e){function i(n,s,o,a){var l=u(t[n],t,s);if("throw"!==l.type){var c=l.arg,h=c.value;return h&&"object"==Oe(h)&&r.call(h,"__await")?e.resolve(h.__await).then((function(t){i("next",t,o,a)}),(function(t){i("throw",t,o,a)})):e.resolve(h).then((function(t){c.value=t,o(c)}),(function(t){return i("throw",t,o,a)}))}a(l.arg)}var s;n(this,"_invoke",{value:function(t,r){function n(){return new e((function(e,n){i(t,r,e,n)}))}return s=s?s.then(n,n):n()}})}function A(t,e,r){var n="suspendedStart";return function(i,s){if("executing"===n)throw new Error("Generator is already running");if("completed"===n){if("throw"===i)throw s;return x()}for(r.method=i,r.arg=s;;){var o=r.delegate;if(o){var a=w(o,r);if(a){if(a===h)continue;return a}}if("next"===r.method)r.sent=r._sent=r.arg;else if("throw"===r.method){if("suspendedStart"===n)throw n="completed",r.arg;r.dispatchException(r.arg)}else"return"===r.method&&r.abrupt("return",r.arg);n="executing";var l=u(t,e,r);if("normal"===l.type){if(n=r.done?"completed":"suspendedYield",l.arg===h)continue;return{value:l.arg,done:r.done}}"throw"===l.type&&(n="completed",r.method="throw",r.arg=l.arg)}}}function w(t,e){var r=e.method,n=t.iterator[r];if(void 0===n)return e.delegate=null,"throw"===r&&t.iterator.return&&(e.method="return",e.arg=void 0,w(t,e),"throw"===e.method)||"return"!==r&&(e.method="throw",e.arg=new TypeError("The iterator does not provide a '"+r+"' method")),h;var i=u(n,t.iterator,e.arg);if("throw"===i.type)return e.method="throw",e.arg=i.arg,e.delegate=null,h;var s=i.arg;return s?s.done?(e[t.resultName]=s.value,e.next=t.nextLoc,"return"!==e.method&&(e.method="next",e.arg=void 0),e.delegate=null,h):s:(e.method="throw",e.arg=new TypeError("iterator result is not an object"),e.delegate=null,h)}function T(t){var e={tryLoc:t[0]};1 in t&&(e.catchLoc=t[1]),2 in t&&(e.finallyLoc=t[2],e.afterLoc=t[3]),this.tryEntries.push(e)}function S(t){var e=t.completion||{};e.type="normal",delete e.arg,t.completion=e}function L(t){this.tryEntries=[{tryLoc:"root"}],t.forEach(T,this),this.reset(!0)}function _(t){if(t){var e=t[s];if(e)return e.call(t);if("function"==typeof t.next)return t;if(!isNaN(t.length)){var n=-1,i=function e(){for(;++n<t.length;)if(r.call(t,n))return e.value=t[n],e.done=!1,e;return e.value=void 0,e.done=!0,e};return i.next=i}}return{next:x}}function x(){return{value:void 0,done:!0}}return f.prototype=p,n(v,"constructor",{value:p,configurable:!0}),n(p,"constructor",{value:f,configurable:!0}),f.displayName=l(p,a,"GeneratorFunction"),t.isGeneratorFunction=function(t){var e="function"==typeof t&&t.constructor;return!!e&&(e===f||"GeneratorFunction"===(e.displayName||e.name))},t.mark=function(t){return Object.setPrototypeOf?Object.setPrototypeOf(t,p):(t.__proto__=p,l(t,a,"GeneratorFunction")),t.prototype=Object.create(v),t},t.awrap=function(t){return{__await:t}},b(E.prototype),l(E.prototype,o,(function(){return this})),t.AsyncIterator=E,t.async=function(e,r,n,i,s){void 0===s&&(s=Promise);var o=new E(c(e,r,n,i),s);return t.isGeneratorFunction(r)?o:o.next().then((function(t){return t.done?t.value:o.next()}))},b(v),l(v,a,"Generator"),l(v,s,(function(){return this})),l(v,"toString",(function(){return"[object Generator]"})),t.keys=function(t){var e=Object(t),r=[];for(var n in e)r.push(n);return r.reverse(),function t(){for(;r.length;){var n=r.pop();if(n in e)return t.value=n,t.done=!1,t}return t.done=!0,t}},t.values=_,L.prototype={constructor:L,reset:function(t){if(this.prev=0,this.next=0,this.sent=this._sent=void 0,this.done=!1,this.delegate=null,this.method="next",this.arg=void 0,this.tryEntries.forEach(S),!t)for(var e in this)"t"===e.charAt(0)&&r.call(this,e)&&!isNaN(+e.slice(1))&&(this[e]=void 0)},stop:function(){this.done=!0;var t=this.tryEntries[0].completion;if("throw"===t.type)throw t.arg;return this.rval},dispatchException:function(t){if(this.done)throw t;var e=this;function n(r,n){return o.type="throw",o.arg=t,e.next=r,n&&(e.method="next",e.arg=void 0),!!n}for(var i=this.tryEntries.length-1;i>=0;--i){var s=this.tryEntries[i],o=s.completion;if("root"===s.tryLoc)return n("end");if(s.tryLoc<=this.prev){var a=r.call(s,"catchLoc"),l=r.call(s,"finallyLoc");if(a&&l){if(this.prev<s.catchLoc)return n(s.catchLoc,!0);if(this.prev<s.finallyLoc)return n(s.finallyLoc)}else if(a){if(this.prev<s.catchLoc)return n(s.catchLoc,!0)}else{if(!l)throw new Error("try statement without catch or finally");if(this.prev<s.finallyLoc)return n(s.finallyLoc)}}}},abrupt:function(t,e){for(var n=this.tryEntries.length-1;n>=0;--n){var i=this.tryEntries[n];if(i.tryLoc<=this.prev&&r.call(i,"finallyLoc")&&this.prev<i.finallyLoc){var s=i;break}}s&&("break"===t||"continue"===t)&&s.tryLoc<=e&&e<=s.finallyLoc&&(s=null);var o=s?s.completion:{};return o.type=t,o.arg=e,s?(this.method="next",this.next=s.finallyLoc,h):this.complete(o)},complete:function(t,e){if("throw"===t.type)throw t.arg;return"break"===t.type||"continue"===t.type?this.next=t.arg:"return"===t.type?(this.rval=this.arg=t.arg,this.method="return",this.next="end"):"normal"===t.type&&e&&(this.next=e),h},finish:function(t){for(var e=this.tryEntries.length-1;e>=0;--e){var r=this.tryEntries[e];if(r.finallyLoc===t)return this.complete(r.completion,r.afterLoc),S(r),h}},catch:function(t){for(var e=this.tryEntries.length-1;e>=0;--e){var r=this.tryEntries[e];if(r.tryLoc===t){var n=r.completion;if("throw"===n.type){var i=n.arg;S(r)}return i}}throw new Error("illegal catch attempt")},delegateYield:function(t,e,r){return this.delegate={iterator:_(t),resultName:e,nextLoc:r},"next"===this.method&&(this.arg=void 0),h}},t}function Ce(t,e,r,n,i,s,o){try{var a=t[s](o),l=a.value}catch(t){return void r(t)}a.done?e(l):Promise.resolve(l).then(n,i)}var Me=null;const Ne={namespace:"template-breathing-with-the-forest",beforeEnter:function(){var t=function(t){return function(){var e=this,r=arguments;return new Promise((function(n,i){var s=t.apply(e,r);function o(t){Ce(s,n,i,o,a,"next",t)}function a(t){Ce(s,n,i,o,a,"throw",t)}o(void 0)}))}}(De().mark((function t(e){var n,i,o;return De().wrap((function(t){for(;;)switch(t.prev=t.next){case 0:return e.current,n=e.next,e.trigger,t.next=3,(0,s.y6)(WPURLS.themeUrl+"/dist/css/_breathing-with-the-forest.css");case 3:return t.next=5,Promise.all([r.e(812),r.e(5927),r.e(9229),r.e(6628)]).then(r.bind(r,2973));case 5:return i=t.sent,o=i.default,t.abrupt("return",new Promise((function(t){(Me=new o(n.container)).runVideoTest().finally((function(){Me.introduction.init(),t()}))})));case 8:case"end":return t.stop()}}),t)})));return function(e){return t.apply(this,arguments)}}(),afterEnter:function(){document.body.classList.add("body--black"),Me.introduction.start()},afterLeave:function(t){t.current,t.next,t.trigger;Me.destroy(),Me=null}};function Fe(t){return Fe="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(t){return typeof t}:function(t){return t&&"function"==typeof Symbol&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t},Fe(t)}function Ue(){Ue=function(){return t};var t={},e=Object.prototype,r=e.hasOwnProperty,n=Object.defineProperty||function(t,e,r){t[e]=r.value},i="function"==typeof Symbol?Symbol:{},s=i.iterator||"@@iterator",o=i.asyncIterator||"@@asyncIterator",a=i.toStringTag||"@@toStringTag";function l(t,e,r){return Object.defineProperty(t,e,{value:r,enumerable:!0,configurable:!0,writable:!0}),t[e]}try{l({},"")}catch(t){l=function(t,e,r){return t[e]=r}}function c(t,e,r,i){var s=e&&e.prototype instanceof d?e:d,o=Object.create(s.prototype),a=new L(i||[]);return n(o,"_invoke",{value:A(t,r,a)}),o}function u(t,e,r){try{return{type:"normal",arg:t.call(e,r)}}catch(t){return{type:"throw",arg:t}}}t.wrap=c;var h={};function d(){}function f(){}function p(){}var g={};l(g,s,(function(){return this}));var m=Object.getPrototypeOf,y=m&&m(m(_([])));y&&y!==e&&r.call(y,s)&&(g=y);var v=p.prototype=d.prototype=Object.create(g);function b(t){["next","throw","return"].forEach((function(e){l(t,e,(function(t){return this._invoke(e,t)}))}))}function E(t,e){function i(n,s,o,a){var l=u(t[n],t,s);if("throw"!==l.type){var c=l.arg,h=c.value;return h&&"object"==Fe(h)&&r.call(h,"__await")?e.resolve(h.__await).then((function(t){i("next",t,o,a)}),(function(t){i("throw",t,o,a)})):e.resolve(h).then((function(t){c.value=t,o(c)}),(function(t){return i("throw",t,o,a)}))}a(l.arg)}var s;n(this,"_invoke",{value:function(t,r){function n(){return new e((function(e,n){i(t,r,e,n)}))}return s=s?s.then(n,n):n()}})}function A(t,e,r){var n="suspendedStart";return function(i,s){if("executing"===n)throw new Error("Generator is already running");if("completed"===n){if("throw"===i)throw s;return x()}for(r.method=i,r.arg=s;;){var o=r.delegate;if(o){var a=w(o,r);if(a){if(a===h)continue;return a}}if("next"===r.method)r.sent=r._sent=r.arg;else if("throw"===r.method){if("suspendedStart"===n)throw n="completed",r.arg;r.dispatchException(r.arg)}else"return"===r.method&&r.abrupt("return",r.arg);n="executing";var l=u(t,e,r);if("normal"===l.type){if(n=r.done?"completed":"suspendedYield",l.arg===h)continue;return{value:l.arg,done:r.done}}"throw"===l.type&&(n="completed",r.method="throw",r.arg=l.arg)}}}function w(t,e){var r=e.method,n=t.iterator[r];if(void 0===n)return e.delegate=null,"throw"===r&&t.iterator.return&&(e.method="return",e.arg=void 0,w(t,e),"throw"===e.method)||"return"!==r&&(e.method="throw",e.arg=new TypeError("The iterator does not provide a '"+r+"' method")),h;var i=u(n,t.iterator,e.arg);if("throw"===i.type)return e.method="throw",e.arg=i.arg,e.delegate=null,h;var s=i.arg;return s?s.done?(e[t.resultName]=s.value,e.next=t.nextLoc,"return"!==e.method&&(e.method="next",e.arg=void 0),e.delegate=null,h):s:(e.method="throw",e.arg=new TypeError("iterator result is not an object"),e.delegate=null,h)}function T(t){var e={tryLoc:t[0]};1 in t&&(e.catchLoc=t[1]),2 in t&&(e.finallyLoc=t[2],e.afterLoc=t[3]),this.tryEntries.push(e)}function S(t){var e=t.completion||{};e.type="normal",delete e.arg,t.completion=e}function L(t){this.tryEntries=[{tryLoc:"root"}],t.forEach(T,this),this.reset(!0)}function _(t){if(t){var e=t[s];if(e)return e.call(t);if("function"==typeof t.next)return t;if(!isNaN(t.length)){var n=-1,i=function e(){for(;++n<t.length;)if(r.call(t,n))return e.value=t[n],e.done=!1,e;return e.value=void 0,e.done=!0,e};return i.next=i}}return{next:x}}function x(){return{value:void 0,done:!0}}return f.prototype=p,n(v,"constructor",{value:p,configurable:!0}),n(p,"constructor",{value:f,configurable:!0}),f.displayName=l(p,a,"GeneratorFunction"),t.isGeneratorFunction=function(t){var e="function"==typeof t&&t.constructor;return!!e&&(e===f||"GeneratorFunction"===(e.displayName||e.name))},t.mark=function(t){return Object.setPrototypeOf?Object.setPrototypeOf(t,p):(t.__proto__=p,l(t,a,"GeneratorFunction")),t.prototype=Object.create(v),t},t.awrap=function(t){return{__await:t}},b(E.prototype),l(E.prototype,o,(function(){return this})),t.AsyncIterator=E,t.async=function(e,r,n,i,s){void 0===s&&(s=Promise);var o=new E(c(e,r,n,i),s);return t.isGeneratorFunction(r)?o:o.next().then((function(t){return t.done?t.value:o.next()}))},b(v),l(v,a,"Generator"),l(v,s,(function(){return this})),l(v,"toString",(function(){return"[object Generator]"})),t.keys=function(t){var e=Object(t),r=[];for(var n in e)r.push(n);return r.reverse(),function t(){for(;r.length;){var n=r.pop();if(n in e)return t.value=n,t.done=!1,t}return t.done=!0,t}},t.values=_,L.prototype={constructor:L,reset:function(t){if(this.prev=0,this.next=0,this.sent=this._sent=void 0,this.done=!1,this.delegate=null,this.method="next",this.arg=void 0,this.tryEntries.forEach(S),!t)for(var e in this)"t"===e.charAt(0)&&r.call(this,e)&&!isNaN(+e.slice(1))&&(this[e]=void 0)},stop:function(){this.done=!0;var t=this.tryEntries[0].completion;if("throw"===t.type)throw t.arg;return this.rval},dispatchException:function(t){if(this.done)throw t;var e=this;function n(r,n){return o.type="throw",o.arg=t,e.next=r,n&&(e.method="next",e.arg=void 0),!!n}for(var i=this.tryEntries.length-1;i>=0;--i){var s=this.tryEntries[i],o=s.completion;if("root"===s.tryLoc)return n("end");if(s.tryLoc<=this.prev){var a=r.call(s,"catchLoc"),l=r.call(s,"finallyLoc");if(a&&l){if(this.prev<s.catchLoc)return n(s.catchLoc,!0);if(this.prev<s.finallyLoc)return n(s.finallyLoc)}else if(a){if(this.prev<s.catchLoc)return n(s.catchLoc,!0)}else{if(!l)throw new Error("try statement without catch or finally");if(this.prev<s.finallyLoc)return n(s.finallyLoc)}}}},abrupt:function(t,e){for(var n=this.tryEntries.length-1;n>=0;--n){var i=this.tryEntries[n];if(i.tryLoc<=this.prev&&r.call(i,"finallyLoc")&&this.prev<i.finallyLoc){var s=i;break}}s&&("break"===t||"continue"===t)&&s.tryLoc<=e&&e<=s.finallyLoc&&(s=null);var o=s?s.completion:{};return o.type=t,o.arg=e,s?(this.method="next",this.next=s.finallyLoc,h):this.complete(o)},complete:function(t,e){if("throw"===t.type)throw t.arg;return"break"===t.type||"continue"===t.type?this.next=t.arg:"return"===t.type?(this.rval=this.arg=t.arg,this.method="return",this.next="end"):"normal"===t.type&&e&&(this.next=e),h},finish:function(t){for(var e=this.tryEntries.length-1;e>=0;--e){var r=this.tryEntries[e];if(r.finallyLoc===t)return this.complete(r.completion,r.afterLoc),S(r),h}},catch:function(t){for(var e=this.tryEntries.length-1;e>=0;--e){var r=this.tryEntries[e];if(r.tryLoc===t){var n=r.completion;if("throw"===n.type){var i=n.arg;S(r)}return i}}throw new Error("illegal catch attempt")},delegateYield:function(t,e,r){return this.delegate={iterator:_(t),resultName:e,nextLoc:r},"next"===this.method&&(this.arg=void 0),h}},t}function Be(t,e,r,n,i,s,o){try{var a=t[s](o),l=a.value}catch(t){return void r(t)}a.done?e(l):Promise.resolve(l).then(n,i)}var $e=null;const je={namespace:"template-film-series-single",beforeEnter:function(){var t=function(t){return function(){var e=this,r=arguments;return new Promise((function(n,i){var s=t.apply(e,r);function o(t){Be(s,n,i,o,a,"next",t)}function a(t){Be(s,n,i,o,a,"throw",t)}o(void 0)}))}}(Ue().mark((function t(e){var n,i,o;return Ue().wrap((function(t){for(;;)switch(t.prev=t.next){case 0:return e.current,n=e.next,e.trigger,t.next=3,(0,s.y6)(WPURLS.themeUrl+"/dist/css/_film-series-single.css");case 3:return t.next=5,r.e(3774).then(r.bind(r,8009));case 5:i=t.sent,o=i.default,($e=new o(n.container)).init();case 9:case"end":return t.stop()}}),t)})));return function(e){return t.apply(this,arguments)}}(),afterEnter:function(){document.body.classList.add("body--black")},afterLeave:function(t){t.current,t.next,t.trigger;$e.destroy(),$e=null}};function Ge(t){return Ge="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(t){return typeof t}:function(t){return t&&"function"==typeof Symbol&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t},Ge(t)}function He(){He=function(){return t};var t={},e=Object.prototype,r=e.hasOwnProperty,n=Object.defineProperty||function(t,e,r){t[e]=r.value},i="function"==typeof Symbol?Symbol:{},s=i.iterator||"@@iterator",o=i.asyncIterator||"@@asyncIterator",a=i.toStringTag||"@@toStringTag";function l(t,e,r){return Object.defineProperty(t,e,{value:r,enumerable:!0,configurable:!0,writable:!0}),t[e]}try{l({},"")}catch(t){l=function(t,e,r){return t[e]=r}}function c(t,e,r,i){var s=e&&e.prototype instanceof d?e:d,o=Object.create(s.prototype),a=new L(i||[]);return n(o,"_invoke",{value:A(t,r,a)}),o}function u(t,e,r){try{return{type:"normal",arg:t.call(e,r)}}catch(t){return{type:"throw",arg:t}}}t.wrap=c;var h={};function d(){}function f(){}function p(){}var g={};l(g,s,(function(){return this}));var m=Object.getPrototypeOf,y=m&&m(m(_([])));y&&y!==e&&r.call(y,s)&&(g=y);var v=p.prototype=d.prototype=Object.create(g);function b(t){["next","throw","return"].forEach((function(e){l(t,e,(function(t){return this._invoke(e,t)}))}))}function E(t,e){function i(n,s,o,a){var l=u(t[n],t,s);if("throw"!==l.type){var c=l.arg,h=c.value;return h&&"object"==Ge(h)&&r.call(h,"__await")?e.resolve(h.__await).then((function(t){i("next",t,o,a)}),(function(t){i("throw",t,o,a)})):e.resolve(h).then((function(t){c.value=t,o(c)}),(function(t){return i("throw",t,o,a)}))}a(l.arg)}var s;n(this,"_invoke",{value:function(t,r){function n(){return new e((function(e,n){i(t,r,e,n)}))}return s=s?s.then(n,n):n()}})}function A(t,e,r){var n="suspendedStart";return function(i,s){if("executing"===n)throw new Error("Generator is already running");if("completed"===n){if("throw"===i)throw s;return x()}for(r.method=i,r.arg=s;;){var o=r.delegate;if(o){var a=w(o,r);if(a){if(a===h)continue;return a}}if("next"===r.method)r.sent=r._sent=r.arg;else if("throw"===r.method){if("suspendedStart"===n)throw n="completed",r.arg;r.dispatchException(r.arg)}else"return"===r.method&&r.abrupt("return",r.arg);n="executing";var l=u(t,e,r);if("normal"===l.type){if(n=r.done?"completed":"suspendedYield",l.arg===h)continue;return{value:l.arg,done:r.done}}"throw"===l.type&&(n="completed",r.method="throw",r.arg=l.arg)}}}function w(t,e){var r=e.method,n=t.iterator[r];if(void 0===n)return e.delegate=null,"throw"===r&&t.iterator.return&&(e.method="return",e.arg=void 0,w(t,e),"throw"===e.method)||"return"!==r&&(e.method="throw",e.arg=new TypeError("The iterator does not provide a '"+r+"' method")),h;var i=u(n,t.iterator,e.arg);if("throw"===i.type)return e.method="throw",e.arg=i.arg,e.delegate=null,h;var s=i.arg;return s?s.done?(e[t.resultName]=s.value,e.next=t.nextLoc,"return"!==e.method&&(e.method="next",e.arg=void 0),e.delegate=null,h):s:(e.method="throw",e.arg=new TypeError("iterator result is not an object"),e.delegate=null,h)}function T(t){var e={tryLoc:t[0]};1 in t&&(e.catchLoc=t[1]),2 in t&&(e.finallyLoc=t[2],e.afterLoc=t[3]),this.tryEntries.push(e)}function S(t){var e=t.completion||{};e.type="normal",delete e.arg,t.completion=e}function L(t){this.tryEntries=[{tryLoc:"root"}],t.forEach(T,this),this.reset(!0)}function _(t){if(t){var e=t[s];if(e)return e.call(t);if("function"==typeof t.next)return t;if(!isNaN(t.length)){var n=-1,i=function e(){for(;++n<t.length;)if(r.call(t,n))return e.value=t[n],e.done=!1,e;return e.value=void 0,e.done=!0,e};return i.next=i}}return{next:x}}function x(){return{value:void 0,done:!0}}return f.prototype=p,n(v,"constructor",{value:p,configurable:!0}),n(p,"constructor",{value:f,configurable:!0}),f.displayName=l(p,a,"GeneratorFunction"),t.isGeneratorFunction=function(t){var e="function"==typeof t&&t.constructor;return!!e&&(e===f||"GeneratorFunction"===(e.displayName||e.name))},t.mark=function(t){return Object.setPrototypeOf?Object.setPrototypeOf(t,p):(t.__proto__=p,l(t,a,"GeneratorFunction")),t.prototype=Object.create(v),t},t.awrap=function(t){return{__await:t}},b(E.prototype),l(E.prototype,o,(function(){return this})),t.AsyncIterator=E,t.async=function(e,r,n,i,s){void 0===s&&(s=Promise);var o=new E(c(e,r,n,i),s);return t.isGeneratorFunction(r)?o:o.next().then((function(t){return t.done?t.value:o.next()}))},b(v),l(v,a,"Generator"),l(v,s,(function(){return this})),l(v,"toString",(function(){return"[object Generator]"})),t.keys=function(t){var e=Object(t),r=[];for(var n in e)r.push(n);return r.reverse(),function t(){for(;r.length;){var n=r.pop();if(n in e)return t.value=n,t.done=!1,t}return t.done=!0,t}},t.values=_,L.prototype={constructor:L,reset:function(t){if(this.prev=0,this.next=0,this.sent=this._sent=void 0,this.done=!1,this.delegate=null,this.method="next",this.arg=void 0,this.tryEntries.forEach(S),!t)for(var e in this)"t"===e.charAt(0)&&r.call(this,e)&&!isNaN(+e.slice(1))&&(this[e]=void 0)},stop:function(){this.done=!0;var t=this.tryEntries[0].completion;if("throw"===t.type)throw t.arg;return this.rval},dispatchException:function(t){if(this.done)throw t;var e=this;function n(r,n){return o.type="throw",o.arg=t,e.next=r,n&&(e.method="next",e.arg=void 0),!!n}for(var i=this.tryEntries.length-1;i>=0;--i){var s=this.tryEntries[i],o=s.completion;if("root"===s.tryLoc)return n("end");if(s.tryLoc<=this.prev){var a=r.call(s,"catchLoc"),l=r.call(s,"finallyLoc");if(a&&l){if(this.prev<s.catchLoc)return n(s.catchLoc,!0);if(this.prev<s.finallyLoc)return n(s.finallyLoc)}else if(a){if(this.prev<s.catchLoc)return n(s.catchLoc,!0)}else{if(!l)throw new Error("try statement without catch or finally");if(this.prev<s.finallyLoc)return n(s.finallyLoc)}}}},abrupt:function(t,e){for(var n=this.tryEntries.length-1;n>=0;--n){var i=this.tryEntries[n];if(i.tryLoc<=this.prev&&r.call(i,"finallyLoc")&&this.prev<i.finallyLoc){var s=i;break}}s&&("break"===t||"continue"===t)&&s.tryLoc<=e&&e<=s.finallyLoc&&(s=null);var o=s?s.completion:{};return o.type=t,o.arg=e,s?(this.method="next",this.next=s.finallyLoc,h):this.complete(o)},complete:function(t,e){if("throw"===t.type)throw t.arg;return"break"===t.type||"continue"===t.type?this.next=t.arg:"return"===t.type?(this.rval=this.arg=t.arg,this.method="return",this.next="end"):"normal"===t.type&&e&&(this.next=e),h},finish:function(t){for(var e=this.tryEntries.length-1;e>=0;--e){var r=this.tryEntries[e];if(r.finallyLoc===t)return this.complete(r.completion,r.afterLoc),S(r),h}},catch:function(t){for(var e=this.tryEntries.length-1;e>=0;--e){var r=this.tryEntries[e];if(r.tryLoc===t){var n=r.completion;if("throw"===n.type){var i=n.arg;S(r)}return i}}throw new Error("illegal catch attempt")},delegateYield:function(t,e,r){return this.delegate={iterator:_(t),resultName:e,nextLoc:r},"next"===this.method&&(this.arg=void 0),h}},t}function Ve(t,e,r,n,i,s,o){try{var a=t[s](o),l=a.value}catch(t){return void r(t)}a.done?e(l):Promise.resolve(l).then(n,i)}var Ke=null;const Ye={namespace:"template-film-series-landing",beforeEnter:function(){var t=function(t){return function(){var e=this,r=arguments;return new Promise((function(n,i){var s=t.apply(e,r);function o(t){Ve(s,n,i,o,a,"next",t)}function a(t){Ve(s,n,i,o,a,"throw",t)}o(void 0)}))}}(He().mark((function t(e){var n,i,o;return He().wrap((function(t){for(;;)switch(t.prev=t.next){case 0:return e.current,n=e.next,e.trigger,t.next=3,(0,s.y6)(WPURLS.themeUrl+"/dist/css/_film-series-landing.css");case 3:return t.next=5,Promise.all([r.e(812),r.e(5927),r.e(6343)]).then(r.bind(r,5346));case 5:i=t.sent,o=i.default,(Ke=new o(n.container)).init();case 9:case"end":return t.stop()}}),t)})));return function(e){return t.apply(this,arguments)}}(),afterEnter:function(){document.body.classList.add("body--black")},afterLeave:function(t){t.current,t.next,t.trigger;Ke.destroy(),Ke=null}};function qe(t){return qe="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(t){return typeof t}:function(t){return t&&"function"==typeof Symbol&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t},qe(t)}function We(){We=function(){return t};var t={},e=Object.prototype,r=e.hasOwnProperty,n=Object.defineProperty||function(t,e,r){t[e]=r.value},i="function"==typeof Symbol?Symbol:{},s=i.iterator||"@@iterator",o=i.asyncIterator||"@@asyncIterator",a=i.toStringTag||"@@toStringTag";function l(t,e,r){return Object.defineProperty(t,e,{value:r,enumerable:!0,configurable:!0,writable:!0}),t[e]}try{l({},"")}catch(t){l=function(t,e,r){return t[e]=r}}function c(t,e,r,i){var s=e&&e.prototype instanceof d?e:d,o=Object.create(s.prototype),a=new L(i||[]);return n(o,"_invoke",{value:A(t,r,a)}),o}function u(t,e,r){try{return{type:"normal",arg:t.call(e,r)}}catch(t){return{type:"throw",arg:t}}}t.wrap=c;var h={};function d(){}function f(){}function p(){}var g={};l(g,s,(function(){return this}));var m=Object.getPrototypeOf,y=m&&m(m(_([])));y&&y!==e&&r.call(y,s)&&(g=y);var v=p.prototype=d.prototype=Object.create(g);function b(t){["next","throw","return"].forEach((function(e){l(t,e,(function(t){return this._invoke(e,t)}))}))}function E(t,e){function i(n,s,o,a){var l=u(t[n],t,s);if("throw"!==l.type){var c=l.arg,h=c.value;return h&&"object"==qe(h)&&r.call(h,"__await")?e.resolve(h.__await).then((function(t){i("next",t,o,a)}),(function(t){i("throw",t,o,a)})):e.resolve(h).then((function(t){c.value=t,o(c)}),(function(t){return i("throw",t,o,a)}))}a(l.arg)}var s;n(this,"_invoke",{value:function(t,r){function n(){return new e((function(e,n){i(t,r,e,n)}))}return s=s?s.then(n,n):n()}})}function A(t,e,r){var n="suspendedStart";return function(i,s){if("executing"===n)throw new Error("Generator is already running");if("completed"===n){if("throw"===i)throw s;return x()}for(r.method=i,r.arg=s;;){var o=r.delegate;if(o){var a=w(o,r);if(a){if(a===h)continue;return a}}if("next"===r.method)r.sent=r._sent=r.arg;else if("throw"===r.method){if("suspendedStart"===n)throw n="completed",r.arg;r.dispatchException(r.arg)}else"return"===r.method&&r.abrupt("return",r.arg);n="executing";var l=u(t,e,r);if("normal"===l.type){if(n=r.done?"completed":"suspendedYield",l.arg===h)continue;return{value:l.arg,done:r.done}}"throw"===l.type&&(n="completed",r.method="throw",r.arg=l.arg)}}}function w(t,e){var r=e.method,n=t.iterator[r];if(void 0===n)return e.delegate=null,"throw"===r&&t.iterator.return&&(e.method="return",e.arg=void 0,w(t,e),"throw"===e.method)||"return"!==r&&(e.method="throw",e.arg=new TypeError("The iterator does not provide a '"+r+"' method")),h;var i=u(n,t.iterator,e.arg);if("throw"===i.type)return e.method="throw",e.arg=i.arg,e.delegate=null,h;var s=i.arg;return s?s.done?(e[t.resultName]=s.value,e.next=t.nextLoc,"return"!==e.method&&(e.method="next",e.arg=void 0),e.delegate=null,h):s:(e.method="throw",e.arg=new TypeError("iterator result is not an object"),e.delegate=null,h)}function T(t){var e={tryLoc:t[0]};1 in t&&(e.catchLoc=t[1]),2 in t&&(e.finallyLoc=t[2],e.afterLoc=t[3]),this.tryEntries.push(e)}function S(t){var e=t.completion||{};e.type="normal",delete e.arg,t.completion=e}function L(t){this.tryEntries=[{tryLoc:"root"}],t.forEach(T,this),this.reset(!0)}function _(t){if(t){var e=t[s];if(e)return e.call(t);if("function"==typeof t.next)return t;if(!isNaN(t.length)){var n=-1,i=function e(){for(;++n<t.length;)if(r.call(t,n))return e.value=t[n],e.done=!1,e;return e.value=void 0,e.done=!0,e};return i.next=i}}return{next:x}}function x(){return{value:void 0,done:!0}}return f.prototype=p,n(v,"constructor",{value:p,configurable:!0}),n(p,"constructor",{value:f,configurable:!0}),f.displayName=l(p,a,"GeneratorFunction"),t.isGeneratorFunction=function(t){var e="function"==typeof t&&t.constructor;return!!e&&(e===f||"GeneratorFunction"===(e.displayName||e.name))},t.mark=function(t){return Object.setPrototypeOf?Object.setPrototypeOf(t,p):(t.__proto__=p,l(t,a,"GeneratorFunction")),t.prototype=Object.create(v),t},t.awrap=function(t){return{__await:t}},b(E.prototype),l(E.prototype,o,(function(){return this})),t.AsyncIterator=E,t.async=function(e,r,n,i,s){void 0===s&&(s=Promise);var o=new E(c(e,r,n,i),s);return t.isGeneratorFunction(r)?o:o.next().then((function(t){return t.done?t.value:o.next()}))},b(v),l(v,a,"Generator"),l(v,s,(function(){return this})),l(v,"toString",(function(){return"[object Generator]"})),t.keys=function(t){var e=Object(t),r=[];for(var n in e)r.push(n);return r.reverse(),function t(){for(;r.length;){var n=r.pop();if(n in e)return t.value=n,t.done=!1,t}return t.done=!0,t}},t.values=_,L.prototype={constructor:L,reset:function(t){if(this.prev=0,this.next=0,this.sent=this._sent=void 0,this.done=!1,this.delegate=null,this.method="next",this.arg=void 0,this.tryEntries.forEach(S),!t)for(var e in this)"t"===e.charAt(0)&&r.call(this,e)&&!isNaN(+e.slice(1))&&(this[e]=void 0)},stop:function(){this.done=!0;var t=this.tryEntries[0].completion;if("throw"===t.type)throw t.arg;return this.rval},dispatchException:function(t){if(this.done)throw t;var e=this;function n(r,n){return o.type="throw",o.arg=t,e.next=r,n&&(e.method="next",e.arg=void 0),!!n}for(var i=this.tryEntries.length-1;i>=0;--i){var s=this.tryEntries[i],o=s.completion;if("root"===s.tryLoc)return n("end");if(s.tryLoc<=this.prev){var a=r.call(s,"catchLoc"),l=r.call(s,"finallyLoc");if(a&&l){if(this.prev<s.catchLoc)return n(s.catchLoc,!0);if(this.prev<s.finallyLoc)return n(s.finallyLoc)}else if(a){if(this.prev<s.catchLoc)return n(s.catchLoc,!0)}else{if(!l)throw new Error("try statement without catch or finally");if(this.prev<s.finallyLoc)return n(s.finallyLoc)}}}},abrupt:function(t,e){for(var n=this.tryEntries.length-1;n>=0;--n){var i=this.tryEntries[n];if(i.tryLoc<=this.prev&&r.call(i,"finallyLoc")&&this.prev<i.finallyLoc){var s=i;break}}s&&("break"===t||"continue"===t)&&s.tryLoc<=e&&e<=s.finallyLoc&&(s=null);var o=s?s.completion:{};return o.type=t,o.arg=e,s?(this.method="next",this.next=s.finallyLoc,h):this.complete(o)},complete:function(t,e){if("throw"===t.type)throw t.arg;return"break"===t.type||"continue"===t.type?this.next=t.arg:"return"===t.type?(this.rval=this.arg=t.arg,this.method="return",this.next="end"):"normal"===t.type&&e&&(this.next=e),h},finish:function(t){for(var e=this.tryEntries.length-1;e>=0;--e){var r=this.tryEntries[e];if(r.finallyLoc===t)return this.complete(r.completion,r.afterLoc),S(r),h}},catch:function(t){for(var e=this.tryEntries.length-1;e>=0;--e){var r=this.tryEntries[e];if(r.tryLoc===t){var n=r.completion;if("throw"===n.type){var i=n.arg;S(r)}return i}}throw new Error("illegal catch attempt")},delegateYield:function(t,e,r){return this.delegate={iterator:_(t),resultName:e,nextLoc:r},"next"===this.method&&(this.arg=void 0),h}},t}function ze(t,e,r,n,i,s,o){try{var a=t[s](o),l=a.value}catch(t){return void r(t)}a.done?e(l):Promise.resolve(l).then(n,i)}var Xe=null;const Qe={namespace:"template-film-series-engage",beforeEnter:function(){var t=function(t){return function(){var e=this,r=arguments;return new Promise((function(n,i){var s=t.apply(e,r);function o(t){ze(s,n,i,o,a,"next",t)}function a(t){ze(s,n,i,o,a,"throw",t)}o(void 0)}))}}(We().mark((function t(e){var n,i,o;return We().wrap((function(t){for(;;)switch(t.prev=t.next){case 0:return e.current,n=e.next,e.trigger,t.next=3,(0,s.y6)(WPURLS.themeUrl+"/dist/css/_film-series-engage.css");case 3:return t.next=5,r.e(7575).then(r.bind(r,6850));case 5:i=t.sent,o=i.default,(Xe=new o(n.container)).init();case 9:case"end":return t.stop()}}),t)})));return function(e){return t.apply(this,arguments)}}(),afterEnter:function(){},afterLeave:function(t){t.current,t.next,t.trigger;Xe.destroy(),Xe=null}};function Je(t){return Je="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(t){return typeof t}:function(t){return t&&"function"==typeof Symbol&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t},Je(t)}function Ze(){Ze=function(){return t};var t={},e=Object.prototype,r=e.hasOwnProperty,n=Object.defineProperty||function(t,e,r){t[e]=r.value},i="function"==typeof Symbol?Symbol:{},s=i.iterator||"@@iterator",o=i.asyncIterator||"@@asyncIterator",a=i.toStringTag||"@@toStringTag";function l(t,e,r){return Object.defineProperty(t,e,{value:r,enumerable:!0,configurable:!0,writable:!0}),t[e]}try{l({},"")}catch(t){l=function(t,e,r){return t[e]=r}}function c(t,e,r,i){var s=e&&e.prototype instanceof d?e:d,o=Object.create(s.prototype),a=new L(i||[]);return n(o,"_invoke",{value:A(t,r,a)}),o}function u(t,e,r){try{return{type:"normal",arg:t.call(e,r)}}catch(t){return{type:"throw",arg:t}}}t.wrap=c;var h={};function d(){}function f(){}function p(){}var g={};l(g,s,(function(){return this}));var m=Object.getPrototypeOf,y=m&&m(m(_([])));y&&y!==e&&r.call(y,s)&&(g=y);var v=p.prototype=d.prototype=Object.create(g);function b(t){["next","throw","return"].forEach((function(e){l(t,e,(function(t){return this._invoke(e,t)}))}))}function E(t,e){function i(n,s,o,a){var l=u(t[n],t,s);if("throw"!==l.type){var c=l.arg,h=c.value;return h&&"object"==Je(h)&&r.call(h,"__await")?e.resolve(h.__await).then((function(t){i("next",t,o,a)}),(function(t){i("throw",t,o,a)})):e.resolve(h).then((function(t){c.value=t,o(c)}),(function(t){return i("throw",t,o,a)}))}a(l.arg)}var s;n(this,"_invoke",{value:function(t,r){function n(){return new e((function(e,n){i(t,r,e,n)}))}return s=s?s.then(n,n):n()}})}function A(t,e,r){var n="suspendedStart";return function(i,s){if("executing"===n)throw new Error("Generator is already running");if("completed"===n){if("throw"===i)throw s;return x()}for(r.method=i,r.arg=s;;){var o=r.delegate;if(o){var a=w(o,r);if(a){if(a===h)continue;return a}}if("next"===r.method)r.sent=r._sent=r.arg;else if("throw"===r.method){if("suspendedStart"===n)throw n="completed",r.arg;r.dispatchException(r.arg)}else"return"===r.method&&r.abrupt("return",r.arg);n="executing";var l=u(t,e,r);if("normal"===l.type){if(n=r.done?"completed":"suspendedYield",l.arg===h)continue;return{value:l.arg,done:r.done}}"throw"===l.type&&(n="completed",r.method="throw",r.arg=l.arg)}}}function w(t,e){var r=e.method,n=t.iterator[r];if(void 0===n)return e.delegate=null,"throw"===r&&t.iterator.return&&(e.method="return",e.arg=void 0,w(t,e),"throw"===e.method)||"return"!==r&&(e.method="throw",e.arg=new TypeError("The iterator does not provide a '"+r+"' method")),h;var i=u(n,t.iterator,e.arg);if("throw"===i.type)return e.method="throw",e.arg=i.arg,e.delegate=null,h;var s=i.arg;return s?s.done?(e[t.resultName]=s.value,e.next=t.nextLoc,"return"!==e.method&&(e.method="next",e.arg=void 0),e.delegate=null,h):s:(e.method="throw",e.arg=new TypeError("iterator result is not an object"),e.delegate=null,h)}function T(t){var e={tryLoc:t[0]};1 in t&&(e.catchLoc=t[1]),2 in t&&(e.finallyLoc=t[2],e.afterLoc=t[3]),this.tryEntries.push(e)}function S(t){var e=t.completion||{};e.type="normal",delete e.arg,t.completion=e}function L(t){this.tryEntries=[{tryLoc:"root"}],t.forEach(T,this),this.reset(!0)}function _(t){if(t){var e=t[s];if(e)return e.call(t);if("function"==typeof t.next)return t;if(!isNaN(t.length)){var n=-1,i=function e(){for(;++n<t.length;)if(r.call(t,n))return e.value=t[n],e.done=!1,e;return e.value=void 0,e.done=!0,e};return i.next=i}}return{next:x}}function x(){return{value:void 0,done:!0}}return f.prototype=p,n(v,"constructor",{value:p,configurable:!0}),n(p,"constructor",{value:f,configurable:!0}),f.displayName=l(p,a,"GeneratorFunction"),t.isGeneratorFunction=function(t){var e="function"==typeof t&&t.constructor;return!!e&&(e===f||"GeneratorFunction"===(e.displayName||e.name))},t.mark=function(t){return Object.setPrototypeOf?Object.setPrototypeOf(t,p):(t.__proto__=p,l(t,a,"GeneratorFunction")),t.prototype=Object.create(v),t},t.awrap=function(t){return{__await:t}},b(E.prototype),l(E.prototype,o,(function(){return this})),t.AsyncIterator=E,t.async=function(e,r,n,i,s){void 0===s&&(s=Promise);var o=new E(c(e,r,n,i),s);return t.isGeneratorFunction(r)?o:o.next().then((function(t){return t.done?t.value:o.next()}))},b(v),l(v,a,"Generator"),l(v,s,(function(){return this})),l(v,"toString",(function(){return"[object Generator]"})),t.keys=function(t){var e=Object(t),r=[];for(var n in e)r.push(n);return r.reverse(),function t(){for(;r.length;){var n=r.pop();if(n in e)return t.value=n,t.done=!1,t}return t.done=!0,t}},t.values=_,L.prototype={constructor:L,reset:function(t){if(this.prev=0,this.next=0,this.sent=this._sent=void 0,this.done=!1,this.delegate=null,this.method="next",this.arg=void 0,this.tryEntries.forEach(S),!t)for(var e in this)"t"===e.charAt(0)&&r.call(this,e)&&!isNaN(+e.slice(1))&&(this[e]=void 0)},stop:function(){this.done=!0;var t=this.tryEntries[0].completion;if("throw"===t.type)throw t.arg;return this.rval},dispatchException:function(t){if(this.done)throw t;var e=this;function n(r,n){return o.type="throw",o.arg=t,e.next=r,n&&(e.method="next",e.arg=void 0),!!n}for(var i=this.tryEntries.length-1;i>=0;--i){var s=this.tryEntries[i],o=s.completion;if("root"===s.tryLoc)return n("end");if(s.tryLoc<=this.prev){var a=r.call(s,"catchLoc"),l=r.call(s,"finallyLoc");if(a&&l){if(this.prev<s.catchLoc)return n(s.catchLoc,!0);if(this.prev<s.finallyLoc)return n(s.finallyLoc)}else if(a){if(this.prev<s.catchLoc)return n(s.catchLoc,!0)}else{if(!l)throw new Error("try statement without catch or finally");if(this.prev<s.finallyLoc)return n(s.finallyLoc)}}}},abrupt:function(t,e){for(var n=this.tryEntries.length-1;n>=0;--n){var i=this.tryEntries[n];if(i.tryLoc<=this.prev&&r.call(i,"finallyLoc")&&this.prev<i.finallyLoc){var s=i;break}}s&&("break"===t||"continue"===t)&&s.tryLoc<=e&&e<=s.finallyLoc&&(s=null);var o=s?s.completion:{};return o.type=t,o.arg=e,s?(this.method="next",this.next=s.finallyLoc,h):this.complete(o)},complete:function(t,e){if("throw"===t.type)throw t.arg;return"break"===t.type||"continue"===t.type?this.next=t.arg:"return"===t.type?(this.rval=this.arg=t.arg,this.method="return",this.next="end"):"normal"===t.type&&e&&(this.next=e),h},finish:function(t){for(var e=this.tryEntries.length-1;e>=0;--e){var r=this.tryEntries[e];if(r.finallyLoc===t)return this.complete(r.completion,r.afterLoc),S(r),h}},catch:function(t){for(var e=this.tryEntries.length-1;e>=0;--e){var r=this.tryEntries[e];if(r.tryLoc===t){var n=r.completion;if("throw"===n.type){var i=n.arg;S(r)}return i}}throw new Error("illegal catch attempt")},delegateYield:function(t,e,r){return this.delegate={iterator:_(t),resultName:e,nextLoc:r},"next"===this.method&&(this.arg=void 0),h}},t}function tr(t,e,r,n,i,s,o){try{var a=t[s](o),l=a.value}catch(t){return void r(t)}a.done?e(l):Promise.resolve(l).then(n,i)}var er=null;const rr={namespace:"template-studies-on-light",beforeEnter:function(){var t=function(t){return function(){var e=this,r=arguments;return new Promise((function(n,i){var s=t.apply(e,r);function o(t){tr(s,n,i,o,a,"next",t)}function a(t){tr(s,n,i,o,a,"throw",t)}o(void 0)}))}}(Ze().mark((function t(e){var n,i,o;return Ze().wrap((function(t){for(;;)switch(t.prev=t.next){case 0:return e.current,n=e.next,e.trigger,t.next=3,(0,s.y6)(WPURLS.themeUrl+"/dist/css/_studies-on-light.css");case 3:return t.next=5,Promise.all([r.e(9229),r.e(4279)]).then(r.bind(r,2841));case 5:i=t.sent,o=i.default,er=new o(n.container);case 8:case"end":return t.stop()}}),t)})));return function(e){return t.apply(this,arguments)}}(),afterLeave:function(t){t.current,t.next,t.trigger;er.destroy(),er=null}};var nr=r(2473);function ir(t){return ir="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(t){return typeof t}:function(t){return t&&"function"==typeof Symbol&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t},ir(t)}function sr(){sr=function(){return t};var t={},e=Object.prototype,r=e.hasOwnProperty,n=Object.defineProperty||function(t,e,r){t[e]=r.value},i="function"==typeof Symbol?Symbol:{},s=i.iterator||"@@iterator",o=i.asyncIterator||"@@asyncIterator",a=i.toStringTag||"@@toStringTag";function l(t,e,r){return Object.defineProperty(t,e,{value:r,enumerable:!0,configurable:!0,writable:!0}),t[e]}try{l({},"")}catch(t){l=function(t,e,r){return t[e]=r}}function c(t,e,r,i){var s=e&&e.prototype instanceof d?e:d,o=Object.create(s.prototype),a=new L(i||[]);return n(o,"_invoke",{value:A(t,r,a)}),o}function u(t,e,r){try{return{type:"normal",arg:t.call(e,r)}}catch(t){return{type:"throw",arg:t}}}t.wrap=c;var h={};function d(){}function f(){}function p(){}var g={};l(g,s,(function(){return this}));var m=Object.getPrototypeOf,y=m&&m(m(_([])));y&&y!==e&&r.call(y,s)&&(g=y);var v=p.prototype=d.prototype=Object.create(g);function b(t){["next","throw","return"].forEach((function(e){l(t,e,(function(t){return this._invoke(e,t)}))}))}function E(t,e){function i(n,s,o,a){var l=u(t[n],t,s);if("throw"!==l.type){var c=l.arg,h=c.value;return h&&"object"==ir(h)&&r.call(h,"__await")?e.resolve(h.__await).then((function(t){i("next",t,o,a)}),(function(t){i("throw",t,o,a)})):e.resolve(h).then((function(t){c.value=t,o(c)}),(function(t){return i("throw",t,o,a)}))}a(l.arg)}var s;n(this,"_invoke",{value:function(t,r){function n(){return new e((function(e,n){i(t,r,e,n)}))}return s=s?s.then(n,n):n()}})}function A(t,e,r){var n="suspendedStart";return function(i,s){if("executing"===n)throw new Error("Generator is already running");if("completed"===n){if("throw"===i)throw s;return x()}for(r.method=i,r.arg=s;;){var o=r.delegate;if(o){var a=w(o,r);if(a){if(a===h)continue;return a}}if("next"===r.method)r.sent=r._sent=r.arg;else if("throw"===r.method){if("suspendedStart"===n)throw n="completed",r.arg;r.dispatchException(r.arg)}else"return"===r.method&&r.abrupt("return",r.arg);n="executing";var l=u(t,e,r);if("normal"===l.type){if(n=r.done?"completed":"suspendedYield",l.arg===h)continue;return{value:l.arg,done:r.done}}"throw"===l.type&&(n="completed",r.method="throw",r.arg=l.arg)}}}function w(t,e){var r=e.method,n=t.iterator[r];if(void 0===n)return e.delegate=null,"throw"===r&&t.iterator.return&&(e.method="return",e.arg=void 0,w(t,e),"throw"===e.method)||"return"!==r&&(e.method="throw",e.arg=new TypeError("The iterator does not provide a '"+r+"' method")),h;var i=u(n,t.iterator,e.arg);if("throw"===i.type)return e.method="throw",e.arg=i.arg,e.delegate=null,h;var s=i.arg;return s?s.done?(e[t.resultName]=s.value,e.next=t.nextLoc,"return"!==e.method&&(e.method="next",e.arg=void 0),e.delegate=null,h):s:(e.method="throw",e.arg=new TypeError("iterator result is not an object"),e.delegate=null,h)}function T(t){var e={tryLoc:t[0]};1 in t&&(e.catchLoc=t[1]),2 in t&&(e.finallyLoc=t[2],e.afterLoc=t[3]),this.tryEntries.push(e)}function S(t){var e=t.completion||{};e.type="normal",delete e.arg,t.completion=e}function L(t){this.tryEntries=[{tryLoc:"root"}],t.forEach(T,this),this.reset(!0)}function _(t){if(t){var e=t[s];if(e)return e.call(t);if("function"==typeof t.next)return t;if(!isNaN(t.length)){var n=-1,i=function e(){for(;++n<t.length;)if(r.call(t,n))return e.value=t[n],e.done=!1,e;return e.value=void 0,e.done=!0,e};return i.next=i}}return{next:x}}function x(){return{value:void 0,done:!0}}return f.prototype=p,n(v,"constructor",{value:p,configurable:!0}),n(p,"constructor",{value:f,configurable:!0}),f.displayName=l(p,a,"GeneratorFunction"),t.isGeneratorFunction=function(t){var e="function"==typeof t&&t.constructor;return!!e&&(e===f||"GeneratorFunction"===(e.displayName||e.name))},t.mark=function(t){return Object.setPrototypeOf?Object.setPrototypeOf(t,p):(t.__proto__=p,l(t,a,"GeneratorFunction")),t.prototype=Object.create(v),t},t.awrap=function(t){return{__await:t}},b(E.prototype),l(E.prototype,o,(function(){return this})),t.AsyncIterator=E,t.async=function(e,r,n,i,s){void 0===s&&(s=Promise);var o=new E(c(e,r,n,i),s);return t.isGeneratorFunction(r)?o:o.next().then((function(t){return t.done?t.value:o.next()}))},b(v),l(v,a,"Generator"),l(v,s,(function(){return this})),l(v,"toString",(function(){return"[object Generator]"})),t.keys=function(t){var e=Object(t),r=[];for(var n in e)r.push(n);return r.reverse(),function t(){for(;r.length;){var n=r.pop();if(n in e)return t.value=n,t.done=!1,t}return t.done=!0,t}},t.values=_,L.prototype={constructor:L,reset:function(t){if(this.prev=0,this.next=0,this.sent=this._sent=void 0,this.done=!1,this.delegate=null,this.method="next",this.arg=void 0,this.tryEntries.forEach(S),!t)for(var e in this)"t"===e.charAt(0)&&r.call(this,e)&&!isNaN(+e.slice(1))&&(this[e]=void 0)},stop:function(){this.done=!0;var t=this.tryEntries[0].completion;if("throw"===t.type)throw t.arg;return this.rval},dispatchException:function(t){if(this.done)throw t;var e=this;function n(r,n){return o.type="throw",o.arg=t,e.next=r,n&&(e.method="next",e.arg=void 0),!!n}for(var i=this.tryEntries.length-1;i>=0;--i){var s=this.tryEntries[i],o=s.completion;if("root"===s.tryLoc)return n("end");if(s.tryLoc<=this.prev){var a=r.call(s,"catchLoc"),l=r.call(s,"finallyLoc");if(a&&l){if(this.prev<s.catchLoc)return n(s.catchLoc,!0);if(this.prev<s.finallyLoc)return n(s.finallyLoc)}else if(a){if(this.prev<s.catchLoc)return n(s.catchLoc,!0)}else{if(!l)throw new Error("try statement without catch or finally");if(this.prev<s.finallyLoc)return n(s.finallyLoc)}}}},abrupt:function(t,e){for(var n=this.tryEntries.length-1;n>=0;--n){var i=this.tryEntries[n];if(i.tryLoc<=this.prev&&r.call(i,"finallyLoc")&&this.prev<i.finallyLoc){var s=i;break}}s&&("break"===t||"continue"===t)&&s.tryLoc<=e&&e<=s.finallyLoc&&(s=null);var o=s?s.completion:{};return o.type=t,o.arg=e,s?(this.method="next",this.next=s.finallyLoc,h):this.complete(o)},complete:function(t,e){if("throw"===t.type)throw t.arg;return"break"===t.type||"continue"===t.type?this.next=t.arg:"return"===t.type?(this.rval=this.arg=t.arg,this.method="return",this.next="end"):"normal"===t.type&&e&&(this.next=e),h},finish:function(t){for(var e=this.tryEntries.length-1;e>=0;--e){var r=this.tryEntries[e];if(r.finallyLoc===t)return this.complete(r.completion,r.afterLoc),S(r),h}},catch:function(t){for(var e=this.tryEntries.length-1;e>=0;--e){var r=this.tryEntries[e];if(r.tryLoc===t){var n=r.completion;if("throw"===n.type){var i=n.arg;S(r)}return i}}throw new Error("illegal catch attempt")},delegateYield:function(t,e,r){return this.delegate={iterator:_(t),resultName:e,nextLoc:r},"next"===this.method&&(this.arg=void 0),h}},t}function or(t,e,r,n,i,s,o){try{var a=t[s](o),l=a.value}catch(t){return void r(t)}a.done?e(l):Promise.resolve(l).then(n,i)}const ar={namespace:"template-about",beforeEnter:function(){var t=function(t){return function(){var e=this,r=arguments;return new Promise((function(n,i){var s=t.apply(e,r);function o(t){or(s,n,i,o,a,"next",t)}function a(t){or(s,n,i,o,a,"throw",t)}o(void 0)}))}}(sr().mark((function t(e){var r,n;return sr().wrap((function(t){for(;;)switch(t.prev=t.next){case 0:e.current,r=e.next,e.trigger,n=r.container,n.querySelectorAll(".c-video-player video").forEach((function(t){new nr.A(t).init()}));case 4:case"end":return t.stop()}}),t)})));return function(e){return t.apply(this,arguments)}}(),afterLeave:function(t){t.current,t.next,t.trigger}},lr=[u,v,T,k,D,U,H,W,Z,it,ct,pt,bt,St,Pt,Ct,Bt,Vt,zt,te,se,ue,pe,Ee,_e,Re,Ne,je,Ye,Qe,rr,ar],cr={name:"default",before:function(t){var e=t.current;t.next,t.trigger;return document.body.classList.add("body--transitioning"),new Promise((function(t){var r=e.container.querySelector(".c-header-bar"),n=new Promise((function(t){document.body.classList.contains("has-menu-sticky")&&document.body.classList.contains("has-story-overview-openend")?(document.body.classList.remove("has-scrolled","has-menu-sticky"),r.addEventListener("transitionend",(function(){return t()}),{once:!0})):t()}));n.then((function(){f.os.to(e.container,{opacity:0,ease:"none",duration:.5,delay:0,onComplete:function(){t()}})}))}))},beforeLeave:function(t){t.current,t.next,t.trigger;document.body.classList.contains("has-menu-sticky")&&document.body.classList.remove("has-scrolled","has-menu-sticky")},afterLeave:function(t){var e=t.current,r=t.next;t.trigger;f.os.set(e.container,{position:"absolute",top:0,left:0,width:"100%"}),f.os.set(r.container,{opacity:0})},enter:function(t){t.current;var e=t.next;t.trigger;return new Promise((function(t){f.os.to(e.container,{opacity:1,ease:"none",duration:.8,delay:0,onComplete:function(){t()}})}))},after:function(t){t.current,t.next,t.trigger;document.body.classList.remove("body--transitioning")}};var ur=r(9130),hr=r.n(ur),dr=null,fr=null;const pr={name:"home-old",to:{namespace:["home-old"]},beforeOnce:function(t){t.current;var e=t.next;t.trigger;e.container.classList.add("home--before-animation"),fr=document.querySelector(".c-header"),dr=fr.querySelector(".c-header-menu"),hr().disablePageScroll(),setTimeout((function(){hr().enablePageScroll(),e.container.classList.add("home--after-animation")}),0)},once:function(t){t.current;var e=t.next;t.trigger;setTimeout((function(){dr.classList.add("c-header-menu--visible"),e.container.classList.add("home--visible")}),10)}},gr={name:"home",to:{namespace:["home"]},beforeOnce:function(t){t.current,t.next,t.trigger;hr().disablePageScroll(),setTimeout((function(){hr().enablePageScroll()}),2e3)},once:function(t){t.current,t.next,t.trigger;setTimeout((function(){}),0)}};var mr=null,yr=null,vr=null,br=null;const Er={name:"story-overview",from:{custom:function(t){t.current,t.next;var e,r=t.trigger;return(0,s.vq)(r)&&(e=r,["[data-story-card-link]"].some((function(t){return e.matches(t)})))}},beforeLeave:function(t){t.current,t.next;var e=t.trigger;return new Promise((function(t){var r;document.body.classList.contains("has-menu-sticky")&&document.body.classList.remove("has-scrolled","has-menu-sticky"),hr().disablePageScroll(),mr=document.createElement("div"),yr=document.createElement("div"),vr=function(t){return t.closest("[data-story-card]")}(e),vr.classList.add("is-clicked");var n=(br=(r=vr).classList.contains("c-story-overview-card")?r:r.querySelector("[data-thumbnail]")).getBoundingClientRect();f.os.set(yr,{width:n.width,height:n.height}),f.os.set(br,{width:n.width,height:n.height,top:n.top,left:n.left,position:"absolute",pointerEvents:"none",opacity:.9}),mr.classList.add("story-overview-fixed-container"),vr.classList.contains("c-story-overview-card")&&mr.classList.add("story-overview-fixed-container--overview"),br.parentElement.insertBefore(yr,br),mr.prepend(br),document.body.appendChild(mr),f.os.to(br,{opacity:0,delay:.2,ease:"sine.out",duration:3}),f.os.to(mr,{background:"rgba(255, 255, 255, 1)",ease:"none",duration:.8,onComplete:function(){t()}})}))},afterLeave:function(t){t.current,t.next,t.trigger;return new Promise((function(t){document.dispatchEvent(new CustomEvent("close-overview")),document.body.classList.contains("has-menu-sticky")&&document.body.classList.remove("has-scrolled","has-menu-sticky"),setTimeout((function(){t()}),1e3*(3.2-.8))}))},enter:function(t){t.current,t.next,t.trigger;return new Promise((function(t){t()}))},after:function(t){t.current,t.next,t.trigger;return new Promise((function(t){f.os.to(mr,{background:"rgba(255, 255, 255, 0)",ease:"none",duration:.8,onComplete:function(){var e;br.removeAttribute("style"),e=br,["c-story-overview-card"].some((function(t){return e.classList.contains(t)}))&&yr.replaceWith(br),mr.remove(),hr().enablePageScroll(),t()}})}))}};var Ar=null,wr=null,Tr=null,Sr=null,Lr=null,_r=window.matchMedia("(max-width:991px)");const xr={name:"events",from:{custom:function(t){t.current,t.next;var e,r=t.trigger;return(0,s.vq)(r)&&(e=r,["[data-event-transition]"].some((function(t){return e.matches(t)})))&&!_r.matches}},before:function(t){t.current,t.next;var e=t.trigger;return new Promise((function(t){document.body.classList.contains("has-menu-sticky")&&document.body.classList.remove("has-scrolled","has-menu-sticky"),hr().disablePageScroll(),wr=function(t){return t.closest(".c-event__thumb")}(e),wr.parentElement.classList.add("desktop-only");var r=wr.getBoundingClientRect().top+window.scrollY-153;(0,s.Ac)(r,800).then((function(){var e=wr.getBoundingClientRect();Tr=e.right-.4*window.innerWidth,(Ar=document.createElement("div")).classList.add("event-transition-fixed-container"),f.os.set(Ar,{width:e.width,height:e.height,left:e.left,top:e.top}),f.os.set(wr.parentElement,{width:e.width,height:e.height}),document.body.appendChild(Ar),Ar.appendChild(wr),t()}))}))},leave:function(t){t.current,t.next,t.trigger;return new Promise((function(t){t()}))},afterLeave:function(t){var e=t.current,r=t.next;t.trigger;return new Promise((function(t){(Sr=r.container.querySelector("[data-single-event-thumb]")).innerHTML="",f.os.set(e.container,{position:"absolute",top:-1*window.scrollY,left:0,width:"100%"}),f.os.set(r.container,{opacity:0}),window.scrollTo(0,0),t()}))},beforeEnter:function(t){var e=t.current,r=t.next,n=t.trigger;return new Promise((function(t){var i=r.container.querySelector("[data-single-event-content]");i.style.transform="translateX("+Tr+"px)";var s=e.container.querySelectorAll(".c-event-card");f.os.to(s,{opacity:0,x:-1*Tr,ease:"power4.inOut",duration:1.2}),f.os.to(e.container,{opacity:0,ease:"none",duration:1.2}),f.os.to(Ar,{x:-1*Tr,ease:"power4.inOut",duration:1.2}),Lr=wr.querySelector("[data-event-thumb-labels]");var o=wr.getBoundingClientRect().width-28-Lr.getBoundingClientRect().width;if(Lr&&f.os.to(Lr,{x:o,ease:"power4.inOut",duration:1.2}),n.style.pointerEvents="none",null!=n.getAttribute("data-event-transition-by-image-click")){var a=n.closest(".c-event__thumb").querySelector("[data-event-transition-by-button-click]");f.os.set(a,{pointerEvents:"none"}),f.os.to(a,{opacity:0,ease:"none",duration:.4})}else{var l=n.closest(".c-event__thumb").querySelector("[data-event-transition-by-image-click]");f.os.set(l,{pointerEvents:"none"}),f.os.to(n,{opacity:0,ease:"none",duration:1.2})}f.os.to(r.container,{opacity:1,ease:"none",duration:1.2}),f.os.to(i,{x:0,ease:"power4.inOut",duration:1.2,onComplete:function(){t()}})}))},enter:function(t){t.current,t.next,t.trigger;return new Promise((function(t){var e=Ar.querySelector(".c-event__thumb");Sr.appendChild(e),Lr.style.transform="",Ar.remove(),hr().enablePageScroll(),t()}))}};var kr=r(7571);f.os.registerPlugin(kr.I);var Pr=null,Ir=null,Rr=null;const Or={name:"film-series",from:{custom:function(t){t.current,t.next;var e,r=t.trigger;return(0,s.vq)(r)&&(e=r,["[data-fs-landing-transition-trigger]"].some((function(t){return e.matches(t)})))}},to:{namespace:["template-film-series-single"]},before:function(t){var e=t.current;t.next,t.trigger;return new Promise((function(t){document.body.classList.contains("has-menu-sticky")&&document.body.classList.remove("has-scrolled","has-menu-sticky"),hr().disablePageScroll();var r=e.container.querySelector(".c-header"),n=e.container.querySelectorAll("[data-fs-landing-trailer-content-texts]"),i=e.container.querySelector("[data-fs-landing-film-thumbnails]");Pr=e.container.querySelector("[data-fs-landing-active-trailer]"),f.os.to([r,n,i],{autoAlpha:0,pointerEvents:"none",duration:.5,ease:"none",onComplete:function(){var e=Pr.getBoundingClientRect();Rr=document.createElement("div"),f.os.set(Rr,{position:"fixed",zIndex:999,width:e.width+"px",height:e.height+"px",left:e.left+"px",top:e.top+"px",pointerEvents:"none"}),document.body.appendChild(Rr),Rr.appendChild(Pr),t()}})}))},leave:function(t){var e=t.current,r=t.next;t.trigger;return new Promise((function(t){f.os.set(e.container,{autoAlpha:0,position:"absolute"}),f.os.set(window,{scrollTo:{y:0}}),f.os.set(Rr,{zIndex:-1}),f.os.set(r.container,{background:"transparent",opacity:0}),t()}))},beforeEnter:function(t){t.current;var e=t.next;t.trigger;return new Promise((function(t){var r=(Ir=e.container.querySelector("[data-fs-single-video-poster]")).getBoundingClientRect();Ir.innerHTML="",f.os.to(Rr,{width:r.width+"px",height:r.height+"px",top:r.top+"px",left:r.left+"px",duration:1.5,ease:"sine.inOut",onComplete:function(){f.os.to(e.container,{opacity:1,duration:.5,ease:"none",onComplete:function(){Ir.appendChild(Pr),Rr.remove(),f.os.set(e.container,{background:"black"}),hr().enablePageScroll(),t()}})}})}))}},Dr=[pr,gr,Er,cr,xr,Or];var Cr=r(4183);function Mr(t){return Mr="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(t){return typeof t}:function(t){return t&&"function"==typeof Symbol&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t},Mr(t)}function Nr(t){return function(t){if(Array.isArray(t))return Fr(t)}(t)||function(t){if("undefined"!=typeof Symbol&&null!=t[Symbol.iterator]||null!=t["@@iterator"])return Array.from(t)}(t)||function(t,e){if(!t)return;if("string"==typeof t)return Fr(t,e);var r=Object.prototype.toString.call(t).slice(8,-1);"Object"===r&&t.constructor&&(r=t.constructor.name);if("Map"===r||"Set"===r)return Array.from(t);if("Arguments"===r||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(r))return Fr(t,e)}(t)||function(){throw new TypeError("Invalid attempt to spread non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}()}function Fr(t,e){(null==e||e>t.length)&&(e=t.length);for(var r=0,n=new Array(e);r<e;r++)n[r]=t[r];return n}function Ur(t,e){for(var r=0;r<e.length;r++){var n=e[r];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(t,(i=n.key,s=void 0,s=function(t,e){if("object"!==Mr(t)||null===t)return t;var r=t[Symbol.toPrimitive];if(void 0!==r){var n=r.call(t,e||"default");if("object"!==Mr(n))return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return("string"===e?String:Number)(t)}(i,"string"),"symbol"===Mr(s)?s:String(s)),n)}var i,s}var Br=function(){return t=function t(){var e=this;!function(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}(this,t),this.domparser=new DOMParser,i().hooks.before((function(t){var r=t.current,n=t.next;t.trigger,e.removeBlackBodyColor(r.namespace,n.namespace)})),i().hooks.beforeEnter((function(t){t.current;var r=t.next;t.trigger,Cr.u.getAll().forEach((function(t){t.kill(),t.scroll.rec=null,setInterval((function(){null!==t.scroll.rec&&(t.scroll.rec=null)}),10)}));var n=r.container.dataset.bodyTextColor,i=r.container.dataset.bodyTextRgb,s=r.container.dataset.bodyBackgroundColor;f.os.set(document.body,{"--text-color":n,"--text-color-rgb":i,"--background-color":s});var o=r.container.dataset.uxStylePlaceholder;document.body.setAttribute("data-ux-style",o),e.addOrRemovePinkBodyColor(r.namespace);var a=new CustomEvent("bless",{detail:{next:r}});document.dispatchEvent(a)})),i().hooks.enter((function(t){t.current,t.next,t.trigger,window.scrollTo(0,0)})),i().hooks.after((function(t){var r=t.current,n=t.next,i=(t.trigger,new CustomEvent("after",{detail:{next:n}})),s=e.domparser.parseFromString(n.html,"text/html");document.dispatchEvent(i),e.track(),e.removeMetaFromHead(),e.addMetaToHead(s),e.replaceMobileMenu(s),e.addBlackBodyColor(r.namespace,n.namespace)})),i().init({debug:"development"==window.WPURLS.env,timeout:5e3,requestError:function(t,e,r,n){return!("back"!==t&&"forward"!==t||!n.status||404!==n.status)},prevent:function(t){t.el;var e=t.event;if(t.href,"click"===e.type&&e.target.matches("[data-story-overview]"))return e.preventDefault(),e.stopPropagation(),!0},transitions:Dr,views:lr})},(e=[{key:"track",value:function(){window.WPURLS.in_production}},{key:"replaceMobileMenu",value:function(t){var e=t.querySelector("#mobile-menu");document.querySelector("#mobile-menu").replaceWith(e)}},{key:"removeMetaFromHead",value:function(){document.querySelectorAll("head meta[property], head .yoast-schema-graph").forEach((function(t){return t.remove()}))}},{key:"addMetaToHead",value:function(t){try{var e,r=t.querySelectorAll("head meta[property], head .yoast-schema-graph");(e=document.head).append.apply(e,Nr(r))}catch(t){}}},{key:"addOrRemovePinkBodyColor",value:function(t){"template-vol-3-chapter"===t?setTimeout((function(){document.body.classList.add("body--pink")}),1e3):document.body.classList.remove("body--pink")}},{key:"removeBlackBodyColor",value:function(t,e){"template-pollinators-chapter"!=e&&"template-pollinators"!=e&&"template-breathing-with-the-forest"!=e&&"template-film-series-single"!=e&&"template-film-series-landing"!=e&&document.body.classList.remove("body--black")}},{key:"addBlackBodyColor",value:function(t,e){"template-pollinators-chapter"!==e&&"template-pollinators"!==e&&"template-breathing-with-the-forest"!==e&&"template-film-series-single"!==e&&"template-film-series-landing"!==e||document.body.classList.add("body--black")}}])&&Ur(t.prototype,e),r&&Ur(t,r),Object.defineProperty(t,"prototype",{writable:!1}),t;var t,e,r}(),$r=r(5858),jr=r.n($r);function Gr(t){return Gr="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(t){return typeof t}:function(t){return t&&"function"==typeof Symbol&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t},Gr(t)}function Hr(t,e){for(var r=0;r<e.length;r++){var n=e[r];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(t,(i=n.key,s=void 0,s=function(t,e){if("object"!==Gr(t)||null===t)return t;var r=t[Symbol.toPrimitive];if(void 0!==r){var n=r.call(t,e||"default");if("object"!==Gr(n))return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return("string"===e?String:Number)(t)}(i,"string"),"symbol"===Gr(s)?s:String(s)),n)}var i,s}var Vr=function(){return t=function t(){var e=this;!function(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}(this,t),this.header=document.querySelector(".c-header-bar"),document.addEventListener("scroll",jr()((function(t){return e.checkScroll()}),100)),document.addEventListener("close-menu",(function(t){e.shouldScroll()||e.unStick()})),this.prevScroll=0,this.checkScroll()},(e=[{key:"checkScroll",value:function(){this.shouldScroll()&&(document.body.classList.contains("body--transitioning")||(window.scrollY>80?this.stick():this.unStick()),this.prevScroll=window.scrollY)}},{key:"stick",value:function(){document.body.classList.add("has-scrolled","has-menu-sticky"),this.prevScroll>window.scrollY?(document.body.classList.add("has-scrolled-up"),document.body.classList.remove("has-scrolled-down")):(document.body.classList.add("has-scrolled-down"),document.body.classList.remove("has-scrolled-up"))}},{key:"unStick",value:function(){document.body.classList.remove("has-scrolled","has-menu-sticky")}},{key:"shouldScroll",value:function(){var t=document.querySelector(".c-header-bar");return!!t&&t.hasAttribute("data-show-on-scroll")}}])&&Hr(t.prototype,e),r&&Hr(t,r),Object.defineProperty(t,"prototype",{writable:!1}),t;var t,e,r}(),Kr=r(181),Yr=r.n(Kr);function qr(t){return qr="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(t){return typeof t}:function(t){return t&&"function"==typeof Symbol&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t},qr(t)}function Wr(t,e){for(var r=0;r<e.length;r++){var n=e[r];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(t,(i=n.key,s=void 0,s=function(t,e){if("object"!==qr(t)||null===t)return t;var r=t[Symbol.toPrimitive];if(void 0!==r){var n=r.call(t,e||"default");if("object"!==qr(n))return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return("string"===e?String:Number)(t)}(i,"string"),"symbol"===qr(s)?s:String(s)),n)}var i,s}var zr=function(){return t=function t(e){var r=this;!function(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}(this,t),this.header=e,this.storyOverview=document.querySelector("[data-c-story-overview]"),this.searchInput=this.storyOverview.querySelector('input[name="q"]'),this.loadMoreButton=this.storyOverview.querySelector("[data-load-more-cats]"),this.searchForm=this.storyOverview.querySelector("form"),this.scrollElm=this.storyOverview.querySelector("[data-c-story-overview-form]"),this.storiesElm=this.storyOverview.querySelector("[data-c-story-overview-stories]"),this.breakpoint=window.matchMedia("(max-width:991px)"),this.isActive=!1,this.openend=0,document.addEventListener("bless",(function(t){t.detail,r.isActive&&r.close()})),document.addEventListener("close-overview",(function(){r.isActive&&r.close()})),this.searchForm.addEventListener("submit",(function(t){r.search(t),r.breakpoint.matches&&r.searchInput.blur(),t.preventDefault()})),this.searchForm.addEventListener("change",(function(t){t.target!==r.searchInput&&r.search()})),this.searchInput.addEventListener("keyup",Yr()((function(t){return r.search(t)}),400)),document.addEventListener("click",(function(t){var e=t.target;e.closest("[data-story-overview]")&&(r.setFilters([e.dataset.storyOverview]),r.open(!0),t.preventDefault(),t.stopPropagation(),!0===r.breakpoint.matches&&r.loadMoreCats()),e.closest("[data-toggle-stories]")&&(r.isActive?r.close():r.open())})),this.loadMoreButton.addEventListener("click",(function(t){r.loadMoreCats()})),this.breakpoint.addEventListener("change",(function(){return r.changeSearchPlaceholder()})),this.changeSearchPlaceholder()},e=[{key:"loadMoreCats",value:function(){var t=(0,s.A7)(this.loadMoreButton);this.loadMoreButton.style.display="none",t.forEach((function(t){return t.style.display="inline-flex"}))}},{key:"setFilters",value:function(){var t=this,e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:[];this.resetForm(),e.forEach((function(e){t.searchForm.querySelector('[value="'.concat(e,'"]')).checked=!0}))}},{key:"resetForm",value:function(){this.searchForm.reset()}},{key:"search",value:function(t){var e=this;this.isActive&&(this.storyOverview.classList.add("is-loading"),fetch(this.searchForm.action,{method:"POST",headers:{Accept:"application/json"},body:new FormData(this.searchForm)}).then((function(t){return t.json()})).then((function(t){return e.displayStories(t)})).catch((function(t){})).finally((function(){document.dispatchEvent(new CustomEvent("bless-search-results")),e.scrollElm.scrollTop=0,e.storyOverview.classList.remove("is-loading"),e.searchInput.value?e.storyOverview.classList.add("is-searching"):e.storyOverview.classList.remove("is-searching")})))}},{key:"displayStories",value:function(t){this.storiesElm.innerHTML=t.html}},{key:"changeSearchPlaceholder",value:function(){!0===this.breakpoint.matches?this.searchInput.placeholder=this.searchInput.dataset.placeholderMobile:this.searchInput.placeholder=this.searchInput.dataset.placeholderDesktop}},{key:"open",value:function(){var t=this,e=arguments.length>0&&void 0!==arguments[0]&&arguments[0];this.scrollDown().then((function(){t.storyOverview.scrollTop=0,t.storyOverview.classList.add("is-active"),t.storyOverview.classList.add("is-open"),t.header.stick(),document.body.classList.add("has-story-overview-openend"),document.body.classList.add("has-story-overview-opening"),t.isActive=!0,t.breakpoint.matches?hr().disablePageScroll(t.storyOverview):hr().disablePageScroll(t.scrollElm),t.changeTriggerText(),t.openend&&!e||t.search(),t.openend++,t.storyOverview.focus()}))}},{key:"close",value:function(){var t=this;this.storyOverview.classList.remove("is-active"),this.header.checkScroll();var e=this.storyOverview;!0!==this.breakpoint.matches&&(e=this.storyOverview.querySelector(".c-story-overview__container")),e.addEventListener("transitionend",(function(){t.storyOverview.classList.remove("is-open"),document.body.classList.remove("has-story-overview-opening")}),{once:!0}),document.body.classList.remove("has-story-overview-openend"),this.isActive=!1,this.breakpoint.matches?hr().enablePageScroll(this.storyOverview):hr().enablePageScroll(this.scrollElm),this.changeTriggerText();var r=new CustomEvent("close-menu");document.dispatchEvent(r)}},{key:"changeTriggerText",value:function(t){var e=this;document.querySelectorAll("[data-toggle-stories]").forEach((function(t){t.dataset.originalText&&t.dataset.toggleText&&(e.isActive?t.textContent=t.dataset.toggleText:t.textContent=t.dataset.originalText)}))}},{key:"scrollDown",value:function(){return document.body.classList.contains("has-scrolled"),new Promise((function(t){return t()}))}}],e&&Wr(t.prototype,e),r&&Wr(t,r),Object.defineProperty(t,"prototype",{writable:!1}),t;var t,e,r}(),Xr=r(9989);function Qr(t){return Qr="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(t){return typeof t}:function(t){return t&&"function"==typeof Symbol&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t},Qr(t)}function Jr(t,e){for(var r=0;r<e.length;r++){var n=e[r];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(t,(i=n.key,s=void 0,s=function(t,e){if("object"!==Qr(t)||null===t)return t;var r=t[Symbol.toPrimitive];if(void 0!==r){var n=r.call(t,e||"default");if("object"!==Qr(n))return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return("string"===e?String:Number)(t)}(i,"string"),"symbol"===Qr(s)?s:String(s)),n)}var i,s}var Zr=function(){return t=function t(){var e=this;!function(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}(this,t),!1 in window||(this.observer=new IntersectionObserver(this.handleIntersection.bind(this),{rootMargin:"200px"}),document.addEventListener("bless",(function(t){var r=t.detail;e.container=r.next.container,e.init(r.next.container)})))},(e=[{key:"init",value:function(t){var e=t.querySelectorAll("video");this.observeVideos(e)}},{key:"observeVideos",value:function(t){var e=this;t.forEach((function(t){t.dataset.autoplay&&(new Xr.A(t),e.observer.observe(t))}))}},{key:"handleIntersection",value:function(t){t.forEach((function(t){var e=t.intersectionRatio,r=t.target,n=!r.paused;e>0&&r.dispatchEvent(new CustomEvent("play-video")),n&&(e<=0||e>1)&&r.dispatchEvent(new CustomEvent("pause-video"))}))}}])&&Jr(t.prototype,e),r&&Jr(t,r),Object.defineProperty(t,"prototype",{writable:!1}),t;var t,e,r}();function tn(t){return tn="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(t){return typeof t}:function(t){return t&&"function"==typeof Symbol&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t},tn(t)}function en(t,e){for(var r=0;r<e.length;r++){var n=e[r];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(t,(i=n.key,s=void 0,s=function(t,e){if("object"!==tn(t)||null===t)return t;var r=t[Symbol.toPrimitive];if(void 0!==r){var n=r.call(t,e||"default");if("object"!==tn(n))return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return("string"===e?String:Number)(t)}(i,"string"),"symbol"===tn(s)?s:String(s)),n)}var i,s}var rn=function(){function t(e,r,n){!function(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}(this,t),this.dropin=e,this.parent=n,r&&(this.container=r),this.init()}var e,r,n;return e=t,(r=[{key:"init",value:function(){var t=this;if(this.container){var e=this.container.querySelector("#container-data");e&&(this.data=JSON.parse(e.innerHTML),this.dropin&&this.data&&(this.type=this.dropin.dataset.dropintype,this.type&&(this.dataset=this.data[this.type],this.dataset&&(this.enabled=this.dataset.enabled,this.enabled&&(this.boundScrollListener=jr()(this.scrollListener.bind(this),100),document.addEventListener("scroll",this.boundScrollListener),this.boundResizeListener=Yr()(this.resizeListener.bind(this),400),window.addEventListener("resize",this.boundResizeListener),this.boundAfterListener=this.afterListener.bind(this),document.addEventListener("after",this.boundAfterListener),document.fonts.ready.then((function(){t.setStartStop()})),this.active=!0)))))}}},{key:"scrollListener",value:function(t){this.dropin&&this.checkScroll()}},{key:"resizeListener",value:function(t){this.dropin&&this.setStartStop()}},{key:"afterListener",value:function(){this.dropin&&this.setStartStop(),document.removeEventListener("after",this.boundAfterListener)}},{key:"setStartStop",value:function(){if(this.dataset){var t=parseInt(this.dataset.show,10),e=parseInt(this.dataset.hide,10);this.calculatePositions(t,e)}}},{key:"calculatePositions",value:function(t,e){var r=document.documentElement.scrollHeight;this.positions={start:Math.floor(r/100*t),stop:Math.floor(r/100*e)},this.checkScroll()}},{key:"checkScroll",value:function(){if(this.positions){var t=window.scrollY+window.innerHeight;t<this.positions.start||t>this.positions.stop?this.hide():this.show()}}},{key:"show",value:function(){this.parent.show()}},{key:"hide",value:function(){this.parent.hide()}},{key:"destroy",value:function(){document.removeEventListener("scroll",this.boundScrollListener),window.removeEventListener("resize",this.boundResizeListener),this.active=!1}}])&&en(e.prototype,r),n&&en(e,n),Object.defineProperty(e,"prototype",{writable:!1}),t}();function nn(t){return nn="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(t){return typeof t}:function(t){return t&&"function"==typeof Symbol&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t},nn(t)}function sn(t,e){for(var r=0;r<e.length;r++){var n=e[r];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(t,(i=n.key,s=void 0,s=function(t,e){if("object"!==nn(t)||null===t)return t;var r=t[Symbol.toPrimitive];if(void 0!==r){var n=r.call(t,e||"default");if("object"!==nn(n))return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return("string"===e?String:Number)(t)}(i,"string"),"symbol"===nn(s)?s:String(s)),n)}var i,s}var on=function(){return t=function t(e){var r=this;!function(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}(this,t),this.newsletter=e,this.newsletter.isSubscribed||(this.elm=this.newsletter.newsletter,this.form=this.newsletter.form,this.title=this.elm.querySelector("[data-newsletter-title]"),this.isOpen=!1,this.measurements={desktop:90,mobile:76},this.dropin=new rn(this.elm,document.querySelector('[data-barba="container"]'),this),document.addEventListener("bless",(function(t){var e=t.detail;r.dropin&&r.dropin.destroy(),r.closeAndHide(),r.container=e.next.container,r.newsletter.isSubscribed||(r.dropin=new rn(r.elm,r.container,r))})),this.elm.addEventListener("click",(function(t){r.open()})),this.feedback=this.elm.querySelector("[data-newsletter-feedback]"),document.addEventListener("click",(function(t){t.target&&!t.target.closest("[data-newsletter]")&&r.elm&&r.close()})))},(e=[{key:"getDevice",value:function(){return!0===window.matchMedia("(max-width:575px)").matches?"mobile":"desktop"}},{key:"show",value:function(){document.body.classList.add("body--newsletter-dropin")}},{key:"hide",value:function(){this.isOpen||document.body.classList.remove("body--newsletter-dropin")}},{key:"open",value:function(){var t=this;if(!this.isOpen&&!this.newsletter.success){this.elm.style.cursor="initial";var e=f.os.timeline({onComplete:function(){t.isOpen=!0,t.elm.querySelector('[type="email"]').focus(),document.body.classList.add("has-newsletter-open")}});"desktop"==this.getDevice()?(e.to(this.title,{autoAlpha:0,duration:.3,ease:"sine.inOut"}),e.to(this.elm,{targets:this.elm,width:604,duration:.3,ease:"sine.inOut"},"<"),e.to(this.form,{opacity:1,duration:.3,ease:"sine.inOut"})):(e.to(this.title,{autoAlpha:0,duration:.15,ease:"sine.inOut"}),e.to(this.elm,{width:window.innerWidth,height:294,borderRadius:0,duration:.3,ease:"sine.inOut"},"<"),e.to(this.elm,{right:0,bottom:0,duration:.05,ease:"sine.inOut"},"<+=0.15"),e.to(this.form,{opacity:1,duration:.3,ease:"sine.inOut"}))}}},{key:"close",value:function(){var t=this;return new Promise((function(e,r){if(t.isOpen){var n=t.getDevice(),i=f.os.timeline({onComplete:function(){t.elm.style.cursor="pointer",t.isOpen=!1,t.isSubmitting=!1,document.body.classList.remove("has-newsletter-open"),t.newsletter.success?(t.elm.style.cursor="initial",f.os.to(t.feedback,{autoAlpha:1,duration:.3,ease:"sine.inOut",onComplete:function(){setTimeout((function(){t.hide()}),2e3)}})):f.os.to(t.title,{autoAlpha:1,duration:.3,ease:"sine.inOut",onComplete:function(){e()}})}});i.to(t.form,{opacity:0,duration:.3,ease:"sine.inOut"}),"desktop"==n?i.to(t.elm,{width:t.measurements[n],duration:.3,ease:"sine.inOut"}):i.to(t.elm,{width:t.measurements[n],height:t.measurements[n],borderRadius:t.measurements[n]/2,right:14,bottom:14,duration:.2,ease:"sine.inOut"})}else e()}))}},{key:"closeAndHide",value:function(){var t=this;this.close().then((function(){t.hide()}))}},{key:"showAndOpen",value:function(){this.show(),this.open()}}])&&sn(t.prototype,e),r&&sn(t,r),Object.defineProperty(t,"prototype",{writable:!1}),t;var t,e,r}();function an(t){return an="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(t){return typeof t}:function(t){return t&&"function"==typeof Symbol&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t},an(t)}function ln(t,e){for(var r=0;r<e.length;r++){var n=e[r];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(t,(i=n.key,s=void 0,s=function(t,e){if("object"!==an(t)||null===t)return t;var r=t[Symbol.toPrimitive];if(void 0!==r){var n=r.call(t,e||"default");if("object"!==an(n))return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return("string"===e?String:Number)(t)}(i,"string"),"symbol"===an(s)?s:String(s)),n)}var i,s}var cn=function(){function t(e){var r,n,i=this;!function(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}(this,t),this.newsletter=e,this.newsletter.isSubscribed||(this.isShown=(null===(r=localStorage)||void 0===r?void 0:r.getItem("newsletterPopup"))||"subscribed"===(null===(n=localStorage)||void 0===n?void 0:n.getItem("newsletter")),this.isShown||(this.wasClosed=!1,this.delay=this.newsletter.newsletter.getAttribute("data-popup-delay"),this.waitForIt(),document.addEventListener("click",(function(t){(t.target&&!t.target.closest("[data-newsletter]")||t.target.closest("[data-close-popup]"))&&i.hide()})),document.addEventListener("bless",(function(t){t.detail;i.timeout&&clearTimeout(i.timeout)}))))}var e,r,n;return e=t,(r=[{key:"waitForIt",value:function(){var t=this;this.wasClosed||(this.timeout=setTimeout((function(){t.show()}),1e3*this.delay))}},{key:"show",value:function(){document.body.classList.add("body--newsletter-popup"),localStorage.setItem("newsletterPopup","shown")}},{key:"hide",value:function(){document.body.classList.remove("body--newsletter-popup"),this.wasClosed=!0}}])&&ln(e.prototype,r),n&&ln(e,n),Object.defineProperty(e,"prototype",{writable:!1}),t}(),un=r(4062);function hn(t){return hn="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(t){return typeof t}:function(t){return t&&"function"==typeof Symbol&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t},hn(t)}function dn(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}function fn(t,e){for(var r=0;r<e.length;r++){var n=e[r];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(t,(i=n.key,s=void 0,s=function(t,e){if("object"!==hn(t)||null===t)return t;var r=t[Symbol.toPrimitive];if(void 0!==r){var n=r.call(t,e||"default");if("object"!==hn(n))return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return("string"===e?String:Number)(t)}(i,"string"),"symbol"===hn(s)?s:String(s)),n)}var i,s}function pn(t,e,r){return e&&fn(t.prototype,e),r&&fn(t,r),Object.defineProperty(t,"prototype",{writable:!1}),t}var gn=function(){return pn((function t(e,r){var n=this;dn(this,t),this.newsletter=e,this.type=r,this.form=this.newsletter.querySelector("form"),this.input=this.newsletter.querySelector('[type="email"]'),this.isSubmitting=!1,this.success=!1,this.isSubscribed=localStorage.getItem("newsletter"),this.tippy=null,this.isSubscribed?this.subscribed():("dropin"===r&&(this.dropin=new on(this)),"popup"===r&&(this.popup=new cn(this)),this.form.addEventListener("submit",(function(t){n.submit(),t.preventDefault()})))}),[{key:"displaySuccess",value:function(t){t.success?(localStorage.setItem("newsletter","subscribed"),this.isSubscribed=localStorage.getItem("newsletter"),this.success=!0,this.subscribed(),this.track()):this.displayFailure(t.data.message)}},{key:"displayFailure",value:function(t){this.isSubmitting=!1;var e=t;t.includes("member")&&(e="This email address is already subscribed"),this.showTippy(e)}},{key:"showTippy",value:function(t){this.tippy=(0,un.Ay)(this.input,{content:t,allowHTML:!0,interactive:!0,placement:"top",theme:"emergence-newsletter",animation:"fade",showOnCreate:!0,hideOnClick:!0,trigger:"manual"})}},{key:"destroyTippy",value:function(){this.tippy&&(this.tippy.destroy(),this.tippy=null)}},{key:"submit",value:function(){var t=this;this.destroyTippy(),this.isSubmitting||(this.isSubmitting=!0,fetch(this.form.action,{method:"POST",body:new FormData(this.form)}).then((function(t){return t.json()})).then((function(e){return t.displaySuccess(e)})).catch((function(e){return t.displayFailure(e)})))}},{key:"subscribed",value:function(){var t=this;this.newsletter.classList.add("subscribed"),this.dropin&&(this.dropin.closeAndHide(),this.dropin.dropin.destroy()),this.popup&&setTimeout((function(){t.popup.hide()}),2e3)}},{key:"track",value:function(){window.WPURLS.in_production&&(gtag("event","newsletter",{type:this.type}),window.plausible&&plausible("newsletter",{props:{type:this.type}}))}}])}(),mn=function(){return pn((function t(){var e=this;dn(this,t),this.init(),document.addEventListener("bless",(function(t){var r=t.detail;e.newsletters=r.next.container.querySelectorAll("[data-newsletter]"),e.newsletters.forEach((function(t,e){var r=t.getAttribute("data-newsletter");"popup"===r&&new gn(t,r),"inline"===r&&new gn(t,r)}))}))}),[{key:"init",value:function(){var t=this;document.fonts.ready.then((function(){t.newsletters=document.querySelectorAll("[data-newsletter]"),t.newsletters.forEach((function(t,e){var r=t.getAttribute("data-newsletter");"dropin"===r&&new gn(t,r),"overview"===r&&new gn(t,r)}))}))}}])}(),yn=r(4330),vn=r.n(yn);var bn=r(4816),En=r.n(bn);function An(t){return An="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(t){return typeof t}:function(t){return t&&"function"==typeof Symbol&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t},An(t)}function wn(t){return function(t){if(Array.isArray(t))return Tn(t)}(t)||function(t){if("undefined"!=typeof Symbol&&null!=t[Symbol.iterator]||null!=t["@@iterator"])return Array.from(t)}(t)||function(t,e){if(!t)return;if("string"==typeof t)return Tn(t,e);var r=Object.prototype.toString.call(t).slice(8,-1);"Object"===r&&t.constructor&&(r=t.constructor.name);if("Map"===r||"Set"===r)return Array.from(t);if("Arguments"===r||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(r))return Tn(t,e)}(t)||function(){throw new TypeError("Invalid attempt to spread non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}()}function Tn(t,e){(null==e||e>t.length)&&(e=t.length);for(var r=0,n=new Array(e);r<e;r++)n[r]=t[r];return n}function Sn(t,e){for(var r=0;r<e.length;r++){var n=e[r];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(t,(i=n.key,s=void 0,s=function(t,e){if("object"!==An(t)||null===t)return t;var r=t[Symbol.toPrimitive];if(void 0!==r){var n=r.call(t,e||"default");if("object"!==An(n))return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return("string"===e?String:Number)(t)}(i,"string"),"symbol"===An(s)?s:String(s)),n)}var i,s}var Ln=function(){return t=function t(){var e=this;!function(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}(this,t),this.breakpoint=window.matchMedia("(max-width:767px)"),this.element=document.querySelector(".c-audio-bar"),this.isPlaying=!1,this.isOpen=!1,this.currentTrackId=null,this.playListData=null,this.playListEl=this.element.querySelector("[data-audio-bar-tracks]"),this.playListToggle=this.element.querySelector("[data-toggle-playlist]"),this.playListOpen=!1,document.addEventListener("bless",(function(t){var r=t.detail;e.container=r.next.container,e.init()})),document.addEventListener("click",(function(t){var r=t.target.closest('[data-play="audio"]'),n=t.target.closest("[data-playlist]");if(r&&(r.dataset.playlistid||e.unloadPlaylist(),r.dataset.id==e.currentTrackId&&e.isPlaying?e.pause():e.open(r.dataset)),n){var i=n.getAttribute("data-playlist");window.location.hash="#"+i}})),window.addEventListener("hashchange",(function(t){window.location.hash&&e.activatePlaylist(window.location.hash)})),this.playListEl.addEventListener("click",(function(t){t.target.closest("[data-toggle-playlist]")&&e.togglePlaylist()})),this.playListToggle.addEventListener("click",(function(t){e.togglePlaylist()})),document.addEventListener("filmstart",(function(t){e.close()})),document.addEventListener("inlineaudioplaying",(function(t){e.close()}))},(e=[{key:"activatePlaylist",value:function(t){var e=this;if(t){var r=t.replace("#",""),n=document.querySelector('[data-playlist="'.concat(r,'"]'));if(n){var i=JSON.parse(n.querySelector("script").innerHTML);setTimeout((function(){e.loadPlaylist(i)}),1e3)}}}},{key:"init",value:function(){var t=this;if(this.dropin&&this.dropin.destroy(),this.isPlaying||(this.dropin=new rn(this.element,this.container,this)),this.player)return this.checkForNarration(),this.addElStatusClasses("is-active"),this.addElStatusClasses("is-playing"),void(this.isPlaying||this.hide());if(window.location.hash){var e=document.querySelector("#playlists");e&&setTimeout((function(){(0,s.Ac)(e,2e3)}),1e3),this.activatePlaylist(window.location.hash)}var r=document.querySelector(".c-audio-player");r&&(this.player=new(vn())(r,{controls:'\n<div class="plyr__controls c-audio-bar__controls">\n\t<div class="plyr__controls__item plyr__time--current plyr__time" aria-label="Current time">00:00</div>\n\t<div class="plyr__controls__item plyr__progress__container">\n\t\t<div class="plyr__progress">\n\t\t\t<input data-plyr="seek" type="range" min="0" max="100" step="0.01" value="0" autocomplete="off" role="slider" aria-label="Seek" aria-valuemin="0">\n\t\t\t<progress class="plyr__progress__buffer" min="0" max="100" value="0" role="progressbar" aria-hidden="true">% buffered</progress>\n\t\t\t<span class="plyr__tooltip">00:00</span>\n\t\t</div>\n\t</div>\n\t<div class="plyr__controls__item plyr__time--duration plyr__time" aria-label="Duration">00:00</div>\n\t<div class="plyr__controls__item plyr__volume c-audio-bar__volume">\n\t\t<button type="button" class="plyr__control" data-plyr="mute">\n\t\t\t<svg class="icon--pressed" aria-hidden="true" focusable="false">\n\t\t\t\t<use xlink:href="#plyr-muted"></use>\n\t\t\t</svg>\n\t\t\t<svg class="icon--not-pressed" aria-hidden="true" focusable="false">\n\t\t\t\t<use xlink:href="#plyr-volume"></use>\n\t\t\t</svg>\n\t\t\t<span class="label--pressed plyr__sr-only">Unmute</span>\n\t\t\t<span class="label--not-pressed plyr__sr-only">Mute</span>\n\t\t</button>\n\t\t<div class="plyr__volume-wrapper">\n\t\t\t<input data-plyr="volume" type="range" min="0" max="1" step="0.05" autocomplete="off" role="slider" aria-label="Volume">\n\t\t</div>\n\t</div>\n</div>',loadSprite:!1,seekTime:10,blankVideo:"data:video/mp4;base64,AAAAHGZ0eXBpc29tAAACAGlzb21pc28ybXA0MQAAAAhmcmVlAAAC721kYXQhEAUgpBv/wAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAA3pwAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAcCEQBSCkG//AAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAADengAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAcAAAAsJtb292AAAAbG12aGQAAAAAAAAAAAAAAAAAAAPoAAAALwABAAABAAAAAAAAAAAAAAAAAQAAAAAAAAAAAAAAAAAAAAEAAAAAAAAAAAAAAAAAAEAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAADAAAB7HRyYWsAAABcdGtoZAAAAAMAAAAAAAAAAAAAAAIAAAAAAAAALwAAAAAAAAAAAAAAAQEAAAAAAQAAAAAAAAAAAAAAAAAAAAEAAAAAAAAAAAAAAAAAAEAAAAAAAAAAAAAAAAAAACRlZHRzAAAAHGVsc3QAAAAAAAAAAQAAAC8AAAAAAAEAAAAAAWRtZGlhAAAAIG1kaGQAAAAAAAAAAAAAAAAAAKxEAAAIAFXEAAAAAAAtaGRscgAAAAAAAAAAc291bgAAAAAAAAAAAAAAAFNvdW5kSGFuZGxlcgAAAAEPbWluZgAAABBzbWhkAAAAAAAAAAAAAAAkZGluZgAAABxkcmVmAAAAAAAAAAEAAAAMdXJsIAAAAAEAAADTc3RibAAAAGdzdHNkAAAAAAAAAAEAAABXbXA0YQAAAAAAAAABAAAAAAAAAAAAAgAQAAAAAKxEAAAAAAAzZXNkcwAAAAADgICAIgACAASAgIAUQBUAAAAAAfQAAAHz+QWAgIACEhAGgICAAQIAAAAYc3R0cwAAAAAAAAABAAAAAgAABAAAAAAcc3RzYwAAAAAAAAABAAAAAQAAAAIAAAABAAAAHHN0c3oAAAAAAAAAAAAAAAIAAAFzAAABdAAAABRzdGNvAAAAAAAAAAEAAAAsAAAAYnVkdGEAAABabWV0YQAAAAAAAAAhaGRscgAAAAAAAAAAbWRpcmFwcGwAAAAAAAAAAAAAAAAtaWxzdAAAACWpdG9vAAAAHWRhdGEAAAABAAAAAExhdmY1Ni40MC4xMDE=",volume:1}),setTimeout((function(){t.checkForNarration()}),0),this.element.addEventListener("click",(function(e){e.target.closest(".c-audio-bar__close")&&t.close(),e.target.closest("[data-play]")&&t.togglePlay(),e.target.closest("[data-rewind]")&&t.rewind(),e.target.closest("[data-forward]")&&t.fastForward(),e.target.closest(".c-audio-bar__meta")&&!0===t.breakpoint.matches&&t.toggleUnfold()})),this.player.on("play",(function(){t.element.classList.add("is-playing"),t.element.classList.add("has-played"),t.isPlaying=!0,t.addElStatusClasses("is-active"),t.addElStatusClasses("is-playing"),t.setPlaylistImage(),document.dispatchEvent(new CustomEvent("audioplayerplaying"))})),this.player.on("pause",(function(){t.element.classList.remove("is-playing"),t.isPlaying=!1,t.removeElStatusClasses(["is-playing"])})),this.player.on("ended",(function(){t.element.classList.remove("is-playing"),t.isPlaying=!1;var e=t.getNextPlaylistTrack();e&&t.open(e)})),this.player.on("ready",(function(){t.volumeTippies&&t.volumeTippies.forEach((function(t){return t.destroy()})),t.volumeTippies=(0,un.Ay)(t.element.querySelectorAll('[data-plyr="mute"]'),{content:function(t){return t.nextElementSibling},allowHTML:!0,interactive:!0,placement:"top",theme:"volume-slider",arrow:!1,zIndex:-1,offset:[0,-34]});var e=t.element.querySelector('[data-plyr="seek"]'),r=(new(En())(e),t.element.querySelector('[data-plyr="volume"]'));new(En())(r)})))}},{key:"togglePlaylist",value:function(){this.playListOpen?this.closePlaylist():this.openPlaylist()}},{key:"openPlaylist",value:function(){this.playListEl.classList.add("is-open"),this.playListOpen=!0,this.element.classList.add("has-playlist-open"),this.element.classList.remove("is-open")}},{key:"closePlaylist",value:function(){history.pushState(null,null," "),this.playListEl.classList.remove("is-open"),this.element.classList.remove("has-playlist-open"),this.playListOpen=!1,this.playListEl.scrollTo(0,0)}},{key:"unloadPlaylist",value:function(){this.closePlaylist(),this.playListEl.innerHTML="",this.playListData=null,this.element.classList.remove("has-playlist"),this.playListToggle.classList.remove("is-active")}},{key:"loadPlaylist",value:function(t){t&&(this.playListData=t,this.playListEl.innerHTML=t.html,this.playListToggle.classList.add("is-active"),this.element.classList.add("has-playlist"),this.openPlaylist(),t.podcasts.length&&this.open(t.podcasts[0]))}},{key:"getCurrentPlaylistTrack",value:function(){var t=this;return this.currentTrackId&&this.playListData?this.playListData.podcasts.find((function(e){return e.id==t.currentTrackId})):null}},{key:"getNextPlaylistTrack",value:function(){var t=this;if(!this.currentTrackId||!this.playListData)return null;var e=this.playListData.podcasts.findIndex((function(e){return e.id==t.currentTrackId}));return e<this.playListData.podcasts.length?this.playListData.podcasts[e+1]:null}},{key:"prepareClassNames",value:function(t){return Array.isArray(t)?t:[t]}},{key:"removeElStatusClasses",value:function(t){t=this.prepareClassNames(t),document.querySelectorAll("[data-audio-element].".concat(t.join("."))).forEach((function(e){var r;return(r=e.classList).remove.apply(r,wn(t))}))}},{key:"addElStatusClasses",value:function(t){var e;if(this.removeElStatusClasses(t),this.currentTrackId&&("is-playing"!=t||this.isPlaying)){var r=document.querySelector('[data-id="'.concat(this.currentTrackId,'"]'));r&&(null===(e=r.closest("[data-audio-element]"))||void 0===e||e.classList.add(t))}}},{key:"setPlaylistImage",value:function(){if(this.playListData){var t=this.getCurrentPlaylistTrack(),e=this.playListEl.querySelector("[data-image-container]");t.image?(e.classList.add("has-image"),e.innerHTML=t.image):(e.classList.remove("has-image"),e.innerHTML="")}}},{key:"checkForNarration",value:function(){if(this.data=JSON.parse(this.container.querySelector("#container-data").innerHTML),this.narration=this.data["story-narration"],this.narration&&!this.isPlaying){var t={src:this.narration.audio,title:this.narration.title,author:this.narration.narrated_by,type:"audio/mp3",play:"audio",id:this.narration.id};this.setSource(t)}}},{key:"togglePlay",value:function(){this.player.togglePlay()}},{key:"fastForward",value:function(){this.player.forward()}},{key:"rewind",value:function(){this.player.rewind()}},{key:"show",value:function(){document.body.classList.add("body--audio-bar-dropin"),this.isOpen=!0}},{key:"hide",value:function(){this.isPlaying||document.body.classList.remove("body--audio-bar-dropin"),this.isOpen=!1,this.removeElStatusClasses(["is-active"])}},{key:"setAndShow",value:function(t){this.show(),this.player.source!==t.src&&this.setSource(t)}},{key:"open",value:function(t){this.show(),this.player.source!==t.src&&this.setSource(t),this.play()}},{key:"play",value:function(){this.player.play()}},{key:"pause",value:function(){this.player.pause()}},{key:"close",value:function(){var t=this;this.pause(),this.closePlaylist(),setTimeout((function(){t.hide()}),0),this.dropin&&this.dropin.destroy()}},{key:"setSource",value:function(t){var e=t.src,r=t.title,n=t.type,i=t.author,s=t.id;this.player.source={type:"audio",title:r,sources:[{src:e,type:n}]},this.setTitle(r,i),this.track(r),this.currentTrackId=s}},{key:"setTitle",value:function(t,e){var r=this.element.querySelector(".c-audio-bar__meta"),n='\n\t\t\t<div class="c-audio-bar__title">'.concat(t,'</div>\n\t\t\t<div class="c-audio-bar__author">').concat(e,"</div>\n\t\t");r.innerHTML=n}},{key:"toggleUnfold",value:function(){var t=this.element.classList;t.contains("is-open")?t.remove("is-open"):(t.add("is-open"),this.closePlaylist())}},{key:"track",value:function(t){window.plausible&&plausible("Audio play",{props:{Name:t}})}}])&&Sn(t.prototype,e),r&&Sn(t,r),Object.defineProperty(t,"prototype",{writable:!1}),t;var t,e,r}();function _n(t){return _n="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(t){return typeof t}:function(t){return t&&"function"==typeof Symbol&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t},_n(t)}function xn(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}function kn(t,e){for(var r=0;r<e.length;r++){var n=e[r];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(t,(i=n.key,s=void 0,s=function(t,e){if("object"!==_n(t)||null===t)return t;var r=t[Symbol.toPrimitive];if(void 0!==r){var n=r.call(t,e||"default");if("object"!==_n(n))return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return("string"===e?String:Number)(t)}(i,"string"),"symbol"===_n(s)?s:String(s)),n)}var i,s}function Pn(t,e,r){return e&&kn(t.prototype,e),r&&kn(t,r),Object.defineProperty(t,"prototype",{writable:!1}),t}var In=function(){return Pn((function t(e,r){var n=this;xn(this,t),this.button=e,this.container=r,this.targets=this.container.querySelectorAll(this.button.dataset.toggleTarget),this.isAnimating=!1,this.button.addEventListener("click",(function(t){n.toggle()}))}),[{key:"toggle",value:function(){var t=this;if(!this.isAnimating){this.isAnimating=!0;var e=!!this.button.classList.contains("is-active");Promise.all(Array.from(this.targets).map((function(t){return new Promise((function(r){if(e){f.os.set(t,{height:t.scrollHeight});var n=f.os.timeline({onComplete:function(){f.os.set(t,{height:0}),r()}});n.to(t,{opacity:0,duration:.3,ease:"none"}),n.to(t,{height:0,duration:.15,ease:"none"})}else{var i=t.scrollHeight;f.os.set(t,{opacity:0});var s=f.os.timeline({onComplete:function(){f.os.set(t,{height:"auto"}),r()}});s.to(t,{targets:t,height:i,duration:.15,ease:"none"}),s.to(t,{targets:t,opacity:1,duration:.3,ease:"none"})}}))}))).then((function(){t.isAnimating=!1})),e?this.button.classList.remove("is-active"):this.button.classList.add("is-active")}}}])}(),Rn=function(){return Pn((function t(){var e=this;xn(this,t),document.addEventListener("bless",(function(t){var r=t.detail;e.init(r.next.container)}))}),[{key:"init",value:function(t){t.querySelectorAll("[data-toggle-target]").forEach((function(e){new In(e,t)}))}}])}(),On=r(7965),Dn=r.n(On);function Cn(t){return Cn="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(t){return typeof t}:function(t){return t&&"function"==typeof Symbol&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t},Cn(t)}function Mn(t,e){for(var r=0;r<e.length;r++){var n=e[r];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(t,(i=n.key,s=void 0,s=function(t,e){if("object"!==Cn(t)||null===t)return t;var r=t[Symbol.toPrimitive];if(void 0!==r){var n=r.call(t,e||"default");if("object"!==Cn(n))return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return("string"===e?String:Number)(t)}(i,"string"),"symbol"===Cn(s)?s:String(s)),n)}var i,s}function Nn(t,e,r){return e&&Mn(t.prototype,e),r&&Mn(t,r),Object.defineProperty(t,"prototype",{writable:!1}),t}var Fn=Nn((function t(){!function(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}(this,t),document.addEventListener("click",(function(t){var e=t.target;e.closest("[data-copy-to-clipboard]")&&(Dn()(e.dataset.copyToClipboard),e.classList.add("is-active"),setTimeout((function(){e.classList.remove("is-active")}),1e3))}))})),Un=["second","minute","hour","day","week","month","year"];var Bn=["","","","","","",""];var $n={},jn=function(t,e){$n[t]=e},Gn=[60,60,24,7,365/7/12,12];function Hn(t){return t instanceof Date?t:!isNaN(t)||/^\d+$/.test(t)?new Date(parseInt(t)):(t=(t||"").trim().replace(/\.\d+/,"").replace(/-/,"/").replace(/-/,"/").replace(/(\d)T(\d)/,"$1 $2").replace(/Z/," UTC").replace(/([+-]\d\d):?(\d\d)/," $1$2"),new Date(t))}var Vn=function(t,e,r){var n=function(t,e){return(+(e?Hn(e):new Date)-+Hn(t))/1e3}(t,r&&r.relativeDate);return function(t,e){for(var r=t<0?1:0,n=t=Math.abs(t),i=0;t>=Gn[i]&&i<Gn.length;i++)t/=Gn[i];return(t=Math.floor(t))>(0==(i*=2)?9:1)&&(i+=1),e(t,i,n)[r].replace("%s",t.toString())}(n,function(t){return $n[t]||$n.en_US}(e))};function Kn(t){return Kn="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(t){return typeof t}:function(t){return t&&"function"==typeof Symbol&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t},Kn(t)}function Yn(t,e){for(var r=0;r<e.length;r++){var n=e[r];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(t,(i=n.key,s=void 0,s=function(t,e){if("object"!==Kn(t)||null===t)return t;var r=t[Symbol.toPrimitive];if(void 0!==r){var n=r.call(t,e||"default");if("object"!==Kn(n))return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return("string"===e?String:Number)(t)}(i,"string"),"symbol"===Kn(s)?s:String(s)),n)}var i,s}jn("en_US",(function(t,e){if(0===e)return["just now","right now"];var r=Un[Math.floor(e/2)];return t>1&&(r+="s"),[t+" "+r+" ago","in "+t+" "+r]})),jn("zh_CN",(function(t,e){if(0===e)return["",""];var r=Bn[~~(e/2)];return[t+" "+r+"",t+" "+r+""]}));var qn=function(){function t(){var e=this;!function(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}(this,t),document.addEventListener("bless",(function(t){var r=t.detail;e.container=r.next.container,e.init()}))}var e,r,n;return e=t,(r=[{key:"init",value:function(){this.container.querySelectorAll("[data-timestamp]").forEach((function(t){var e=parseInt(t.dataset.timestamp,10),r=new Date(1e3*e);((new Date).getTime()-r.getTime())/864e5<8&&(t.innerHTML=Vn(r),t.classList.add("has-date-hydrated"))}))}}])&&Yn(e.prototype,r),n&&Yn(e,n),Object.defineProperty(e,"prototype",{writable:!1}),t}();function Wn(t){return Wn="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(t){return typeof t}:function(t){return t&&"function"==typeof Symbol&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t},Wn(t)}function zn(t,e){for(var r=0;r<e.length;r++){var n=e[r];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(t,(i=n.key,s=void 0,s=function(t,e){if("object"!==Wn(t)||null===t)return t;var r=t[Symbol.toPrimitive];if(void 0!==r){var n=r.call(t,e||"default");if("object"!==Wn(n))return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return("string"===e?String:Number)(t)}(i,"string"),"symbol"===Wn(s)?s:String(s)),n)}var i,s}var Xn=function(){function t(){var e=this;!function(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}(this,t),this.tippies=[],document.addEventListener("bless",(function(t){var r=t.detail;e.init(r.next.container)}))}var e,r,n;return e=t,(r=[{key:"init",value:function(t){var e=this;this.tippies&&(this.tippies.forEach((function(t){t.destroy()})),this.tippies=[]),t.querySelectorAll(".c-footnote").forEach((function(t,r){var n=JSON.parse(t.dataset.content),i=(0,un.Ay)(t,{content:n,allowHTML:!0,interactive:!0,placement:"top",theme:"emergence-footnotes",animation:"fade",onShow:function(t){t.reference.classList.add("c-footnote--visible")},onHide:function(t){t.reference.classList.remove("c-footnote--visible")}});e.tippies.push(i)}))}}])&&zn(e.prototype,r),n&&zn(e,n),Object.defineProperty(e,"prototype",{writable:!1}),t}();function Qn(t){return Qn="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(t){return typeof t}:function(t){return t&&"function"==typeof Symbol&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t},Qn(t)}function Jn(t,e){for(var r=0;r<e.length;r++){var n=e[r];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(t,(i=n.key,s=void 0,s=function(t,e){if("object"!==Qn(t)||null===t)return t;var r=t[Symbol.toPrimitive];if(void 0!==r){var n=r.call(t,e||"default");if("object"!==Qn(n))return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return("string"===e?String:Number)(t)}(i,"string"),"symbol"===Qn(s)?s:String(s)),n)}var i,s}var Zn=function(){return t=function t(){var e=this;!function(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}(this,t),document.addEventListener("bless",(function(t){var r=t.detail;e.container=r.next.container,e.init(r.next.container)})),this.openedDropdown=null},(e=[{key:"init",value:function(){var t=this;this.dropin&&this.dropin.destroy(),this.container||(this.container=document.querySelector("body")),this.dropinElm=this.container.querySelector(".c-social-dropin"),this.dropin=new rn(this.dropinElm,this.container,this),this.socialDropdowns=this.container.querySelectorAll(".c-social-dropdown"),document.addEventListener("click",(function(e){e.target.closest("[data-socialdropdown]")&&t.open(e.target.closest("[data-socialdropdown]")),e.target.closest("[data-socialdropdown]")||t.openedDropdown&&t.close(),e.target.closest("[data-close-socialdropdown]")&&t.openedDropdown&&t.close()}))}},{key:"open",value:function(t,e){var r=this;this.socialDropdowns.forEach((function(t){r.close(t)})),this.openedDropdown=t,t.classList.add("c-social-dropdown--open");var n=t.querySelector(".c-social-dropdown__menu").offsetHeight,i=t.querySelector(".c-social-dropdown__menu-wrapper"),s=.6;t.classList.contains("c-social-dropdown--event")&&(s=0),f.os.to(i,{height:n,duration:s,ease:"expo.out"})}},{key:"close",value:function(){if(this.openedDropdown){this.openedDropdown.classList.remove("c-social-dropdown--open");var t=this.openedDropdown.querySelector(".c-social-dropdown__menu-wrapper"),e=getComputedStyle(this.openedDropdown).getPropertyValue("--social-dropdown-height"),r=.6;this.openedDropdown.classList.contains("c-social-dropdown--event")&&(r=0),f.os.to(t,{height:e,duration:r,ease:"expo.out"}),this.openedDropdown=null}}},{key:"show",value:function(){document.body.classList.add("body--social-dropdowns-dropin")}},{key:"hide",value:function(){document.body.classList.remove("body--social-dropdowns-dropin"),this.close()}}])&&Jn(t.prototype,e),r&&Jn(t,r),Object.defineProperty(t,"prototype",{writable:!1}),t;var t,e,r}();function ti(t){return ti="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(t){return typeof t}:function(t){return t&&"function"==typeof Symbol&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t},ti(t)}function ei(t,e){for(var r=0;r<e.length;r++){var n=e[r];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(t,(i=n.key,s=void 0,s=function(t,e){if("object"!==ti(t)||null===t)return t;var r=t[Symbol.toPrimitive];if(void 0!==r){var n=r.call(t,e||"default");if("object"!==ti(n))return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return("string"===e?String:Number)(t)}(i,"string"),"symbol"===ti(s)?s:String(s)),n)}var i,s}var ri=function(){function t(e){!function(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}(this,t),this.el=e,this.playerEl=this.el.querySelector(".c-inline-audio-player"),this.toggleButton=this.el.querySelector(".c-play-button"),this.isPlaying=!1,this.events=[],this.DASHARRAY=166}var e,r,n;return e=t,(r=[{key:"init",value:function(){var t=this;this.setProgress(0),this.player=new(vn())(this.playerEl,{loadSprite:!1,volume:1}),this.player.on("play",(function(){t.isPlaying=!0,t.el.classList.add("is-playing"),t.dispatch("play"),document.dispatchEvent(new CustomEvent("inlineaudioplaying",{detail:t.el}))})),this.player.on("pause",(function(){t.isPlaying=!1,t.el.classList.remove("is-playing"),t.dispatch("pause")})),this.player.on("ended",(function(){t.isPlaying=!1,t.setProgress(0)})),this.player.on("timeupdate",(function(e){var r=e.detail.plyr.currentTime/e.detail.plyr.duration;t.setProgress(r)})),this.toggleButton.addEventListener("click",(function(e){t.isPlaying?t.pause():t.play()}))}},{key:"pause",value:function(){this.player.pause()}},{key:"play",value:function(){this.player.play()}},{key:"setProgress",value:function(t){var e=t*this.DASHARRAY+this.DASHARRAY;this.el.style.setProperty("--play-button-progress",e)}},{key:"on",value:function(t,e){this.events.push({eventName:t,callback:e})}},{key:"dispatch",value:function(t){var e=this,r=this.events.filter((function(e){return e.eventName===t}));r&&r.forEach((function(t){t.callback(e)}))}},{key:"destroy",value:function(){this.player.destroy()}}])&&ei(e.prototype,r),n&&ei(e,n),Object.defineProperty(e,"prototype",{writable:!1}),t}();function ni(t){return ni="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(t){return typeof t}:function(t){return t&&"function"==typeof Symbol&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t},ni(t)}function ii(t,e){for(var r=0;r<e.length;r++){var n=e[r];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(t,(i=n.key,s=void 0,s=function(t,e){if("object"!==ni(t)||null===t)return t;var r=t[Symbol.toPrimitive];if(void 0!==r){var n=r.call(t,e||"default");if("object"!==ni(n))return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return("string"===e?String:Number)(t)}(i,"string"),"symbol"===ni(s)?s:String(s)),n)}var i,s}var si=function(){function t(){var e=this;!function(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}(this,t),this.players=new Map,document.addEventListener("bless",(function(t){var r=t.detail;e.container=r.next.container,e.init()})),document.addEventListener("audioplayerplaying",(function(t){e.players.forEach((function(t){t.pause()}))}))}var e,r,n;return e=t,(r=[{key:"init",value:function(){var t=this;this.players&&(this.players.forEach((function(t){t.destroy()})),this.players=new Map),this.container.querySelectorAll("[data-inline-audio]").forEach((function(e){var r=new ri(e);r.init(),r.on("play",(function(e){t.players.forEach((function(t,r){e.el!==r&&t.pause()}))})),t.players.set(e,r)}))}}])&&ii(e.prototype,r),n&&ii(e,n),Object.defineProperty(e,"prototype",{writable:!1}),t}();function oi(t){return oi="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(t){return typeof t}:function(t){return t&&"function"==typeof Symbol&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t},oi(t)}function ai(t){return function(t){if(Array.isArray(t))return li(t)}(t)||function(t){if("undefined"!=typeof Symbol&&null!=t[Symbol.iterator]||null!=t["@@iterator"])return Array.from(t)}(t)||function(t,e){if(!t)return;if("string"==typeof t)return li(t,e);var r=Object.prototype.toString.call(t).slice(8,-1);"Object"===r&&t.constructor&&(r=t.constructor.name);if("Map"===r||"Set"===r)return Array.from(t);if("Arguments"===r||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(r))return li(t,e)}(t)||function(){throw new TypeError("Invalid attempt to spread non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}()}function li(t,e){(null==e||e>t.length)&&(e=t.length);for(var r=0,n=new Array(e);r<e;r++)n[r]=t[r];return n}function ci(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}function ui(t,e){for(var r=0;r<e.length;r++){var n=e[r];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(t,(i=n.key,s=void 0,s=function(t,e){if("object"!==oi(t)||null===t)return t;var r=t[Symbol.toPrimitive];if(void 0!==r){var n=r.call(t,e||"default");if("object"!==oi(n))return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return("string"===e?String:Number)(t)}(i,"string"),"symbol"===oi(s)?s:String(s)),n)}var i,s}function hi(t,e,r){return e&&ui(t.prototype,e),r&&ui(t,r),Object.defineProperty(t,"prototype",{writable:!1}),t}var di=function(){function t(e){ci(this,t),this.form=e,this.feedback=e.querySelector("[data-form-feedback]"),this.form.addEventListener("submit",this.submit.bind(this)),this.timer=null}return hi(t,[{key:"resetFeedback",value:function(){window.clearTimeout(this.timer),this.feedback.innerHTML="",this.feedback.classList.remove("is-success","is-error","is-active")}},{key:"addFeedback",value:function(t,e){var r;(r=this.feedback.classList).add.apply(r,ai(e)),this.feedback.innerHTML=t}},{key:"displaySuccess",value:function(t){var e,r=this;t.success?(this.resetFeedback(),this.form.reset(),this.addFeedback(t.data.message,["is-success","is-active"]),this.timer=window.setTimeout((function(){r.feedback.classList.remove("is-active")}),1e4)):this.displayFailure(null==t||null===(e=t.data)||void 0===e?void 0:e.message)}},{key:"displayFailure",value:function(t){var e;t=null!==(e=t)&&void 0!==e?e:"Someting went wrong",this.resetFeedback(),this.addFeedback(t,["is-error","is-active"])}},{key:"submit",value:function(t){var e=this;t.preventDefault(),this.isSubmitting||(this.isSubmitting=!0,fetch(this.form.action,{method:"POST",body:new FormData(this.form)}).then((function(t){return t.json()})).then((function(t){return e.displaySuccess(t)})).catch((function(t){return e.displayFailure(t)})).finally((function(){return e.isSubmitting=!1})))}}]),t}(),fi=function(){function t(){var e=this;ci(this,t),document.addEventListener("bless",(function(t){var r=t.detail;e.init(r.next.container)}))}return hi(t,[{key:"init",value:function(t){var e=this;this.container=t,this.forms=[],this.container.querySelectorAll("[data-form]").forEach((function(t){e.forms.push(new di(t))}))}}]),t}();function pi(t){return pi="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(t){return typeof t}:function(t){return t&&"function"==typeof Symbol&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t},pi(t)}function gi(t,e){for(var r=0;r<e.length;r++){var n=e[r];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(t,(i=n.key,s=void 0,s=function(t,e){if("object"!==pi(t)||null===t)return t;var r=t[Symbol.toPrimitive];if(void 0!==r){var n=r.call(t,e||"default");if("object"!==pi(n))return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return("string"===e?String:Number)(t)}(i,"string"),"symbol"===pi(s)?s:String(s)),n)}var i,s}function mi(t,e,r){return e&&gi(t.prototype,e),r&&gi(t,r),Object.defineProperty(t,"prototype",{writable:!1}),t}var yi=mi((function t(){!function(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}(this,t),document.addEventListener("click",(function(t){t.target&&t.target.closest("[data-back-to-top]")&&(t.preventDefault(),window.scroll({top:0,behavior:"smooth"}))}))}));function vi(t){return vi="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(t){return typeof t}:function(t){return t&&"function"==typeof Symbol&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t},vi(t)}function bi(t,e){for(var r=0;r<e.length;r++){var n=e[r];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(t,(i=n.key,s=void 0,s=function(t,e){if("object"!==vi(t)||null===t)return t;var r=t[Symbol.toPrimitive];if(void 0!==r){var n=r.call(t,e||"default");if("object"!==vi(n))return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return("string"===e?String:Number)(t)}(i,"string"),"symbol"===vi(s)?s:String(s)),n)}var i,s}var Ei=function(){return t=function t(e){!function(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}(this,t),this.elm=e,this.isAnimating=!1,this.isOpen=!1,this.glass=this.elm.querySelector("[data-glass-credits-glass]"),this.button=this.elm.querySelector("[data-glass-credits-button]"),this.text=this.elm.querySelector("[data-glass-credits-text]"),this.init()},(e=[{key:"init",value:function(){var t=this;this.elm.addEventListener("click",(function(){t.isOpen?t.close():t.open()})),this.elm.addEventListener("mouseenter",(function(){t.open()})),this.elm.addEventListener("mouseleave",(function(){t.close()}))}},{key:"open",value:function(){var t=this;if(!this.isAnimating&&!this.isOpen)return this.isAnimating=!0,this.elm.classList.add("c-glass-credits--open"),new Promise((function(e){var r=t.text.scrollWidth,n=t.text.scrollHeight,i=f.os.timeline({onComplete:function(){t.isOpen=!0,t.isAnimating=!1,e()}});i.to(t.glass,{height:n,width:r,borderRadius:8,duration:.4,ease:"sine.inOut"}),i.to(t.button,{opacity:0,duration:.4,ease:"none"},0),i.to(t.text,{opacity:1,duration:.4,ease:"none"})}))}},{key:"close",value:function(){var t=this;if(!this.isAnimating&&this.isOpen)return this.elm.classList.remove("c-glass-credits--open"),this.isAnimating=!0,new Promise((function(e){var r=t.button.scrollWidth,n=t.button.scrollHeight,i=f.os.timeline({onComplete:function(){t.isOpen=!1,t.isAnimating=!1,e()}});i.to(t.text,{opacity:0,duration:.4,ease:"none"}),i.to(t.glass,{height:n,width:r,borderRadius:21,duration:.4,ease:"sine.inOut"}),i.to(t.button,{opacity:1,duration:.4,ease:"none"},"<")}))}}])&&bi(t.prototype,e),r&&bi(t,r),Object.defineProperty(t,"prototype",{writable:!1}),t;var t,e,r}();function Ai(t){return Ai="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(t){return typeof t}:function(t){return t&&"function"==typeof Symbol&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t},Ai(t)}function wi(t,e){for(var r=0;r<e.length;r++){var n=e[r];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(t,(i=n.key,s=void 0,s=function(t,e){if("object"!==Ai(t)||null===t)return t;var r=t[Symbol.toPrimitive];if(void 0!==r){var n=r.call(t,e||"default");if("object"!==Ai(n))return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return("string"===e?String:Number)(t)}(i,"string"),"symbol"===Ai(s)?s:String(s)),n)}var i,s}var Ti=function(){function t(){var e=this;!function(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}(this,t),document.addEventListener("bless",(function(t){var r=t.detail;e.container=r.next.container,e.init()}))}var e,r,n;return e=t,(r=[{key:"init",value:function(){this.container.querySelectorAll("[data-glass-credits]").forEach((function(t){new Ei(t)}))}}])&&wi(e.prototype,r),n&&wi(e,n),Object.defineProperty(e,"prototype",{writable:!1}),t}();function Si(t){return Si="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(t){return typeof t}:function(t){return t&&"function"==typeof Symbol&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t},Si(t)}function Li(t,e){for(var r=0;r<e.length;r++){var n=e[r];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(t,(i=n.key,s=void 0,s=function(t,e){if("object"!==Si(t)||null===t)return t;var r=t[Symbol.toPrimitive];if(void 0!==r){var n=r.call(t,e||"default");if("object"!==Si(n))return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return("string"===e?String:Number)(t)}(i,"string"),"symbol"===Si(s)?s:String(s)),n)}var i,s}var _i=function(){function t(){!function(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}(this,t),this.init()}var e,r,n;return e=t,(r=[{key:"init",value:function(){var t=this;"undefined"!=typeof window&&(this.setVh(),document.addEventListener("DOMContentLoaded",(function(){t.setVh()})),this.boundResizeListener=Yr()(this.setVh.bind(this),100),window.addEventListener("resize",this.boundResizeListener))}},{key:"setVh",value:function(){var t=.01*document.documentElement.clientHeight;document.documentElement.style.setProperty("--1svh",t+"px");var e=.01*window.innerHeight;if(document.documentElement.style.setProperty("--1dvh",e+"px"),document.body){var r=document.createElement("div");r.style.width="1px",r.style.height="100vh",r.style.position="fixed",r.style.left="0",r.style.top="0",r.style.bottom="0",r.style.visibility="hidden",document.body.appendChild(r);var n=r.clientHeight;r.remove();var i=.01*n;document.documentElement.style.setProperty("--1lvh",i+"px")}}}])&&Li(e.prototype,r),n&&Li(e,n),Object.defineProperty(e,"prototype",{writable:!1}),t}();function xi(t){return xi="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(t){return typeof t}:function(t){return t&&"function"==typeof Symbol&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t},xi(t)}function ki(t,e){for(var r=0;r<e.length;r++){var n=e[r];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(t,(i=n.key,s=void 0,s=function(t,e){if("object"!==xi(t)||null===t)return t;var r=t[Symbol.toPrimitive];if(void 0!==r){var n=r.call(t,e||"default");if("object"!==xi(n))return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return("string"===e?String:Number)(t)}(i,"string"),"symbol"===xi(s)?s:String(s)),n)}var i,s}var Pi=function(){return t=function t(){var e=this;!function(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}(this,t),document.addEventListener("bless",(function(t){var r=t.detail;e.container=r.next.container,e.init(e.container)})),this.storiesElm=document.querySelector("[data-c-story-overview-stories]"),document.addEventListener("bless-search-results",(function(){e.init(e.storiesElm)}))},(e=[{key:"init",value:function(t){t.querySelectorAll("[data-story-card]").forEach((function(t){var e=t.querySelector("a"),r=t.querySelector(".t-category");e&&t.addEventListener("click",(function(t){t.target!==e&&t.target!==r&&e.click()}))}))}}])&&ki(t.prototype,e),r&&ki(t,r),Object.defineProperty(t,"prototype",{writable:!1}),t;var t,e,r}(),Ii=r(4945);function Ri(t){return Ri="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(t){return typeof t}:function(t){return t&&"function"==typeof Symbol&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t},Ri(t)}function Oi(t,e){for(var r=0;r<e.length;r++){var n=e[r];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(t,(i=n.key,s=void 0,s=function(t,e){if("object"!==Ri(t)||null===t)return t;var r=t[Symbol.toPrimitive];if(void 0!==r){var n=r.call(t,e||"default");if("object"!==Ri(n))return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return("string"===e?String:Number)(t)}(i,"string"),"symbol"===Ri(s)?s:String(s)),n)}var i,s}var Di=function(){return t=function t(e){var r=this;!function(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}(this,t),this.wrapper=e,this.video=this.wrapper.querySelector("video"),this.video&&(this.shouldPlay=!1,this.isPlaying=!1,this.wrapper.addEventListener("init",(function(){r.startHls()})),this.wrapper.addEventListener("play-video",(function(){r.shouldPlay=!0,r.hasStartedHls?r.playVideo():r.startHls()})),this.wrapper.addEventListener("pause-video",(function(){r.pauseVideo()})),this.wrapper.addEventListener("show-poster",(function(){r.showPoster()})),this.boundHandleAfterleave=this.destroy.bind(this),document.addEventListener("afterLeave",this.boundHandleAfterleave))},(e=[{key:"startHls",value:function(){var t=this,e=this.video.dataset.hlsSrc;Ii.Ay.isSupported()?(this.hls=new Ii.Ay({capLevelToPlayerSize:!0}),this.hls.on(Ii.Ay.Events.MANIFEST_PARSED,(function(){for(var e=t.hls.levels.length,r=e-1,n=e-1;n>=0;n--)if(t.hls.levels[n].bitrate<=6e6){r=n;break}r<e-1&&(t.hls.autoLevelCapping=r)})),this.hls.loadSource(e),this.hls.attachMedia(this.video),this.hls.on(Ii.Ay.Events.ERROR,(function(e,r){r.fatal&&t.showPoster()}))):this.video.canPlayType("application/vnd.apple.mpegurl")&&(this.video.src=e),this.hasStartedHls=!0}},{key:"playVideo",value:function(){var t=this;this.hls&&this.hls.resumeBuffering();var e=this.video.play();void 0!==e&&e.then((function(){t.hidePoster(),t.wrapper.classList.add("is-playing"),t.isPlaying=!0})).catch((function(e){t.wrapper&&setTimeout((function(){t.wrapper.classList.contains("is-playing")||t.showPoster()}),1e3)}))}},{key:"showPoster",value:function(){this.wrapper.classList.add("show-poster");var t=this.wrapper.querySelector("img");lazySizes.loader.unveil(t)}},{key:"hidePoster",value:function(){this.wrapper.classList.remove("show-poster")}},{key:"pauseVideo",value:function(){this.video.pause(),this.isPlaying=!1,this.shouldPlay=!1,this.hls&&this.hls.pauseBuffering()}},{key:"destroy",value:function(){document.removeEventListener("afterLeave",this.boundHandleAfterleave),this.hls&&(this.hls.stopLoad(),this.hls.detachMedia())}}])&&Oi(t.prototype,e),r&&Oi(t,r),Object.defineProperty(t,"prototype",{writable:!1}),t;var t,e,r}();function Ci(t){return Ci="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(t){return typeof t}:function(t){return t&&"function"==typeof Symbol&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t},Ci(t)}function Mi(t,e){for(var r=0;r<e.length;r++){var n=e[r];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(t,(i=n.key,s=void 0,s=function(t,e){if("object"!==Ci(t)||null===t)return t;var r=t[Symbol.toPrimitive];if(void 0!==r){var n=r.call(t,e||"default");if("object"!==Ci(n))return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return("string"===e?String:Number)(t)}(i,"string"),"symbol"===Ci(s)?s:String(s)),n)}var i,s}var Ni=function(){return t=function t(){var e=this;!function(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}(this,t),!1 in window||(this.reduceMotionMediaQuery=window.matchMedia("(prefers-reduced-motion: reduce)"),this.intersectionObserver=new IntersectionObserver(this.handleIntersection.bind(this),{rootMargin:"200px"}),document.addEventListener("bless",(function(t){var r=t.target;e.init(r)})))},(e=[{key:"init",value:function(t){var e=this;t.querySelectorAll("[data-autoplay-video]").forEach((function(t){new Di(t),e.reduceMotionMediaQuery.matches?t.dispatchEvent(new CustomEvent("show-poster")):"true"===t.dataset.autoplayVideo&&(e.intersectionObserver.observe(t),t.dispatchEvent(new CustomEvent("init")))}))}},{key:"handleIntersection",value:function(t){t.forEach((function(t){var e=t.intersectionRatio,r=t.target;e>0?r.dispatchEvent(new CustomEvent("play-video")):r.dispatchEvent(new CustomEvent("pause-video"))}))}}])&&Mi(t.prototype,e),r&&Mi(t,r),Object.defineProperty(t,"prototype",{writable:!1}),t;var t,e,r}();function Fi(t){return Fi="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(t){return typeof t}:function(t){return t&&"function"==typeof Symbol&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t},Fi(t)}function Ui(t,e){for(var r=0;r<e.length;r++){var n=e[r];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(t,(i=n.key,s=void 0,s=function(t,e){if("object"!==Fi(t)||null===t)return t;var r=t[Symbol.toPrimitive];if(void 0!==r){var n=r.call(t,e||"default");if("object"!==Fi(n))return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return("string"===e?String:Number)(t)}(i,"string"),"symbol"===Fi(s)?s:String(s)),n)}var i,s}"scrollRestoration"in history&&(history.scrollRestoration="manual"),navigator.serviceWorker&&navigator.serviceWorker.register("/video-buffer-service-worker.js").then((function(t){return t.update()})).catch(console.log),new(function(){return t=function t(){var e=this;!function(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}(this,t),Promise.all([t.domReady]).then((function(){return e.init()}))},r=[{key:"domReady",value:function(){return new Promise((function(t){return document.addEventListener("DOMContentLoaded",t)}))}}],(e=[{key:"init",value:function(){this.header=new Vr,new Ni,new zr(this.header),new Zr,new mn,new Ln,new Rn,new Fn,new qn,new Xn,new si,new Zn,new fi,new Br,new yi,new Ti,new _i,new Pi}}])&&Ui(t.prototype,e),r&&Ui(t,r),Object.defineProperty(t,"prototype",{writable:!1}),t;var t,e,r}())},8150:(t,e,r)=>{"use strict";function n(t){return Array.prototype.filter.call(t.parentNode.children,(function(e){return e!==t}))}function i(t){var e=arguments.length>1&&void 0!==arguments[1]?arguments[1]:500,r=arguments.length>2&&void 0!==arguments[2]?arguments[2]:0,n=arguments.length>3&&void 0!==arguments[3]?arguments[3]:document.scrollingElement;return new Promise((function(i,s){"string"==typeof t&&(t=document.querySelector(t)||s()),"number"!=typeof t&&(t=t.getBoundingClientRect().top+n.scrollTop),t+=r;var o=n.scrollTop,a=t-o,l=0;!function t(){var r,s,c,u=(r=l+=20,s=o,c=a,(r/=e/2)<1?c/2*r*r+s:-c/2*(--r*(r-2)-1)+s);n.scrollTop=u,l<e?requestAnimationFrame(t):i()}()}))}function s(t){return t instanceof Element||t instanceof HTMLDocument}function o(t,e,r){return(t-e)/(r-e)}function a(){return["iPad Simulator","iPhone Simulator","iPod Simulator","iPad","iPhone","iPod"].includes(navigator.platform)||navigator.userAgent.includes("Mac")&&"ontouchend"in document}function l(t){return new Promise((function(e,r){var n=t.split("/").pop(),i=document.head.querySelectorAll('link[rel="stylesheet"]'),s=!1;if(i.forEach((function(t){t.href&&t.href.includes(n)&&(s=!0)})),s)e();else{var o=document.createElement("link");o.rel="stylesheet",o.href=t,o.onload=function(){return e()},o.onerror=function(){return r(new Error("CSS load failed: ".concat(t)))},document.head.appendChild(o)}}))}function c(t,e,r){return(1-r)*t+r*e}function u(t,e,r,n,i){return(t-e)*(i-n)/(r-e)+n}function h(t){var e=window.scrollY,r=window.scrollY+window.innerHeight,n=t.getBoundingClientRect(),i=n.y+window.scrollY,s=n.y+n.height+window.scrollY;if(e>s||r<i)return 0;if(e<i&&r>s)return 100;if(i<e&&s>r)return 100;var o=n.height,a=o;i<e&&(a=o-(window.scrollY-i)),s>r&&(a-=s-r);var l=a/window.innerHeight*100;return Math.round(l)}function d(t,e){return new Promise((function(e){var r;if(t){var n=n,i=t.getBoundingClientRect(),s=i.width*window.devicePixelRatio,o=i.height*window.devicePixelRatio,a=s/o,l=t.getAttribute("width")/t.getAttribute("height"),c=null!==(r=t.getAttribute("data-quality"))&&void 0!==r?r:1,u="";u=a>l?s*c:o*l*c;var h=null,d=999999,f=t.querySelectorAll("source"),p=f.length,g=0,m=new Promise((function(t,e){Array.from(f).forEach((function(e){if(e.dataset.sourcetype==n){var r=e.dataset.sourcewidth-u;r<=0&&(r*=-1),r<=d&&(h=e),d=r,setTimeout((function(){++g>=p&&t("Checked All Sources")}),0)}}))}));m.then((function(){h&&t.src!=h.src&&(t.pause(),t.src=h.src,e())}))}}))}r.d(e,{A7:()=>n,Ac:()=>i,Cc:()=>c,Oh:()=>a,S8:()=>o,Sp:()=>h,Tj:()=>u,W6:()=>d,vq:()=>s,y6:()=>l})},7965:(t,e,r)=>{"use strict";var n=r(6426),i={"text/plain":"Text","text/html":"Url",default:"Text"},s="Copy to clipboard: #{key}, Enter";t.exports=function(t,e){var r,o,a,l,c,u=!1;e||(e={}),e.debug;try{if(o=n(),a=document.createRange(),l=document.getSelection(),(c=document.createElement("span")).textContent=t,c.ariaHidden="true",c.style.all="unset",c.style.position="fixed",c.style.top=0,c.style.clip="rect(0, 0, 0, 0)",c.style.whiteSpace="pre",c.style.webkitUserSelect="text",c.style.MozUserSelect="text",c.style.msUserSelect="text",c.style.userSelect="text",c.addEventListener("copy",(function(r){if(r.stopPropagation(),e.format)if(r.preventDefault(),void 0===r.clipboardData){window.clipboardData.clearData();var n=i[e.format]||i.default;window.clipboardData.setData(n,t)}else r.clipboardData.clearData(),r.clipboardData.setData(e.format,t);e.onCopy&&(r.preventDefault(),e.onCopy(r.clipboardData))})),document.body.appendChild(c),a.selectNodeContents(c),l.addRange(a),!document.execCommand("copy"))throw new Error("copy command was unsuccessful");u=!0}catch(n){try{window.clipboardData.setData(e.format||"text",t),e.onCopy&&e.onCopy(window.clipboardData),u=!0}catch(n){r=function(t){var e=(/mac os x/i.test(navigator.userAgent)?"":"Ctrl")+"+C";return t.replace(/#{\s*key\s*}/g,e)}("message"in e?e.message:s),window.prompt(r,t)}}finally{l&&("function"==typeof l.removeRange?l.removeRange(a):l.removeAllRanges()),c&&document.body.removeChild(c),o()}return u}},2650:(t,e,r)=>{"use strict";r.d(e,{H0:()=>St});var n,i,s,o,a,l,c,u,h=r(8607),d={},f=180/Math.PI,p=Math.PI/180,g=Math.atan2,m=/([A-Z])/g,y=/(left|right|width|margin|padding|x)/i,v=/[\s,\(]\S/,b={autoAlpha:"opacity,visibility",scale:"scaleX,scaleY",alpha:"opacity"},E=function(t,e){return e.set(e.t,e.p,Math.round(1e4*(e.s+e.c*t))/1e4+e.u,e)},A=function(t,e){return e.set(e.t,e.p,1===t?e.e:Math.round(1e4*(e.s+e.c*t))/1e4+e.u,e)},w=function(t,e){return e.set(e.t,e.p,t?Math.round(1e4*(e.s+e.c*t))/1e4+e.u:e.b,e)},T=function(t,e){var r=e.s+e.c*t;e.set(e.t,e.p,~~(r+(r<0?-.5:.5))+e.u,e)},S=function(t,e){return e.set(e.t,e.p,t?e.e:e.b,e)},L=function(t,e){return e.set(e.t,e.p,1!==t?e.b:e.e,e)},_=function(t,e,r){return t.style[e]=r},x=function(t,e,r){return t.style.setProperty(e,r)},k=function(t,e,r){return t._gsap[e]=r},P=function(t,e,r){return t._gsap.scaleX=t._gsap.scaleY=r},I=function(t,e,r,n,i){var s=t._gsap;s.scaleX=s.scaleY=r,s.renderTransform(i,s)},R=function(t,e,r,n,i){var s=t._gsap;s[e]=r,s.renderTransform(i,s)},O="transform",D=O+"Origin",C=function t(e,r){var n=this,i=this.target,s=i.style,o=i._gsap;if(e in d&&s){if(this.tfm=this.tfm||{},"transform"===e)return b.transform.split(",").forEach((function(e){return t.call(n,e,r)}));if(~(e=b[e]||e).indexOf(",")?e.split(",").forEach((function(t){return n.tfm[t]=J(i,t)})):this.tfm[e]=o.x?o[e]:J(i,e),e===D&&(this.tfm.zOrigin=o.zOrigin),this.props.indexOf(O)>=0)return;o.svg&&(this.svgo=i.getAttribute("data-svg-origin"),this.props.push(D,r,"")),e=O}(s||r)&&this.props.push(e,r,s[e])},M=function(t){t.translate&&(t.removeProperty("translate"),t.removeProperty("scale"),t.removeProperty("rotate"))},N=function(){var t,e,r=this.props,n=this.target,i=n.style,s=n._gsap;for(t=0;t<r.length;t+=3)r[t+1]?2===r[t+1]?n[r[t]](r[t+2]):n[r[t]]=r[t+2]:r[t+2]?i[r[t]]=r[t+2]:i.removeProperty("--"===r[t].substr(0,2)?r[t]:r[t].replace(m,"-$1").toLowerCase());if(this.tfm){for(e in this.tfm)s[e]=this.tfm[e];s.svg&&(s.renderTransform(),n.setAttribute("data-svg-origin",this.svgo||"")),(t=c())&&t.isStart||i[O]||(M(i),s.zOrigin&&i[D]&&(i[D]+=" "+s.zOrigin+"px",s.zOrigin=0,s.renderTransform()),s.uncache=1)}},F=function(t,e){var r={target:t,props:[],revert:N,save:C};return t._gsap||h.os.core.getCache(t),e&&t.style&&t.nodeType&&e.split(",").forEach((function(t){return r.save(t)})),r},U=function(t,e){var r=i.createElementNS?i.createElementNS((e||"http://www.w3.org/1999/xhtml").replace(/^https/,"http"),t):i.createElement(t);return r&&r.style?r:i.createElement(t)},B=function t(e,r,n){var i=getComputedStyle(e);return i[r]||i.getPropertyValue(r.replace(m,"-$1").toLowerCase())||i.getPropertyValue(r)||!n&&t(e,j(r)||r,1)||""},$="O,Moz,ms,Ms,Webkit".split(","),j=function(t,e,r){var n=(e||a).style,i=5;if(t in n&&!r)return t;for(t=t.charAt(0).toUpperCase()+t.substr(1);i--&&!($[i]+t in n););return i<0?null:(3===i?"ms":i>=0?$[i]:"")+t},G=function(){"undefined"!=typeof window&&window.document&&(n=window,i=n.document,s=i.documentElement,a=U("div")||{style:{}},U("div"),O=j(O),D=O+"Origin",a.style.cssText="border-width:0;line-height:0;position:absolute;padding:0",u=!!j("perspective"),c=h.os.core.reverting,o=1)},H=function(t){var e,r=t.ownerSVGElement,n=U("svg",r&&r.getAttribute("xmlns")||"http://www.w3.org/2000/svg"),i=t.cloneNode(!0);i.style.display="block",n.appendChild(i),s.appendChild(n);try{e=i.getBBox()}catch(t){}return n.removeChild(i),s.removeChild(n),e},V=function(t,e){for(var r=e.length;r--;)if(t.hasAttribute(e[r]))return t.getAttribute(e[r])},K=function(t){var e,r;try{e=t.getBBox()}catch(n){e=H(t),r=1}return e&&(e.width||e.height)||r||(e=H(t)),!e||e.width||e.x||e.y?e:{x:+V(t,["x","cx","x1"])||0,y:+V(t,["y","cy","y1"])||0,width:0,height:0}},Y=function(t){return!(!t.getCTM||t.parentNode&&!t.ownerSVGElement||!K(t))},q=function(t,e){if(e){var r,n=t.style;e in d&&e!==D&&(e=O),n.removeProperty?("ms"!==(r=e.substr(0,2))&&"webkit"!==e.substr(0,6)||(e="-"+e),n.removeProperty("--"===r?e:e.replace(m,"-$1").toLowerCase())):n.removeAttribute(e)}},W=function(t,e,r,n,i,s){var o=new h.J7(t._pt,e,r,0,1,s?L:S);return t._pt=o,o.b=n,o.e=i,t._props.push(r),o},z={deg:1,rad:1,turn:1},X={grid:1,flex:1},Q=function t(e,r,n,s){var o,l,c,u,f=parseFloat(n)||0,p=(n+"").trim().substr((f+"").length)||"px",g=a.style,m=y.test(r),v="svg"===e.tagName.toLowerCase(),b=(v?"client":"offset")+(m?"Width":"Height"),E=100,A="px"===s,w="%"===s;if(s===p||!f||z[s]||z[p])return f;if("px"!==p&&!A&&(f=t(e,r,n,"px")),u=e.getCTM&&Y(e),(w||"%"===p)&&(d[r]||~r.indexOf("adius")))return o=u?e.getBBox()[m?"width":"height"]:e[b],(0,h.E_)(w?f/o*E:f/100*o);if(g[m?"width":"height"]=E+(A?p:s),l="rem"!==s&&~r.indexOf("adius")||"em"===s&&e.appendChild&&!v?e:e.parentNode,u&&(l=(e.ownerSVGElement||{}).parentNode),l&&l!==i&&l.appendChild||(l=i.body),(c=l._gsap)&&w&&c.width&&m&&c.time===h.au.time&&!c.uncache)return(0,h.E_)(f/c.width*E);if(!w||"height"!==r&&"width"!==r)(w||"%"===p)&&!X[B(l,"display")]&&(g.position=B(e,"position")),l===e&&(g.position="static"),l.appendChild(a),o=a[b],l.removeChild(a),g.position="absolute";else{var T=e.style[r];e.style[r]=E+s,o=e[b],T?e.style[r]=T:q(e,r)}return m&&w&&((c=(0,h.a0)(l)).time=h.au.time,c.width=l[b]),(0,h.E_)(A?o*f/E:o&&f?E/o*f:0)},J=function(t,e,r,n){var i;return o||G(),e in b&&"transform"!==e&&~(e=b[e]).indexOf(",")&&(e=e.split(",")[0]),d[e]&&"transform"!==e?(i=ct(t,n),i="transformOrigin"!==e?i[e]:i.svg?i.origin:ut(B(t,D))+" "+i.zOrigin+"px"):(!(i=t.style[e])||"auto"===i||n||~(i+"").indexOf("calc("))&&(i=rt[e]&&rt[e](t,e,r)||B(t,e)||(0,h.n)(t,e)||("opacity"===e?1:0)),r&&!~(i+"").trim().indexOf(" ")?Q(t,e,i,r)+r:i},Z=function(t,e,r,n){if(!r||"none"===r){var i=j(e,t,1),s=i&&B(t,i,1);s&&s!==r?(e=i,r=s):"borderColor"===e&&(r=B(t,"borderTopColor"))}var o,a,l,c,u,d,f,p,g,m,y,v=new h.J7(this._pt,t.style,e,0,1,h.l1),b=0,E=0;if(v.b=r,v.e=n,r+="","var(--"===(n+="").substring(0,6)&&(n=B(t,n.substring(4,n.indexOf(")")))),"auto"===n&&(d=t.style[e],t.style[e]=n,n=B(t,e)||n,d?t.style[e]=d:q(t,e)),o=[r,n],(0,h.Uc)(o),n=o[1],l=(r=o[0]).match(h.vM)||[],(n.match(h.vM)||[]).length){for(;a=h.vM.exec(n);)f=a[0],g=n.substring(b,a.index),u?u=(u+1)%5:"rgba("!==g.substr(-5)&&"hsla("!==g.substr(-5)||(u=1),f!==(d=l[E++]||"")&&(c=parseFloat(d)||0,y=d.substr((c+"").length),"="===f.charAt(1)&&(f=(0,h.B0)(c,f)+y),p=parseFloat(f),m=f.substr((p+"").length),b=h.vM.lastIndex-m.length,m||(m=m||h.Yz.units[e]||y,b===n.length&&(n+=m,v.e+=m)),y!==m&&(c=Q(t,e,d,m)||0),v._pt={_next:v._pt,p:g||1===E?g:",",s:c,c:p-c,m:u&&u<4||"zIndex"===e?Math.round:0});v.c=b<n.length?n.substring(b,n.length):""}else v.r="display"===e&&"none"===n?L:S;return h.Ks.test(n)&&(v.e=0),this._pt=v,v},tt={top:"0%",bottom:"100%",left:"0%",right:"100%",center:"50%"},et=function(t,e){if(e.tween&&e.tween._time===e.tween._dur){var r,n,i,s=e.t,o=s.style,a=e.u,l=s._gsap;if("all"===a||!0===a)o.cssText="",n=1;else for(i=(a=a.split(",")).length;--i>-1;)r=a[i],d[r]&&(n=1,r="transformOrigin"===r?D:O),q(s,r);n&&(q(s,O),l&&(l.svg&&s.removeAttribute("transform"),o.scale=o.rotate=o.translate="none",ct(s,1),l.uncache=1,M(o)))}},rt={clearProps:function(t,e,r,n,i){if("isFromStart"!==i.data){var s=t._pt=new h.J7(t._pt,e,r,0,0,et);return s.u=n,s.pr=-10,s.tween=i,t._props.push(r),1}}},nt=[1,0,0,1,0,0],it={},st=function(t){return"matrix(1, 0, 0, 1, 0, 0)"===t||"none"===t||!t},ot=function(t){var e=B(t,O);return st(e)?nt:e.substr(7).match(h.vX).map(h.E_)},at=function(t,e){var r,n,i,o,a=t._gsap||(0,h.a0)(t),l=t.style,c=ot(t);return a.svg&&t.getAttribute("transform")?"1,0,0,1,0,0"===(c=[(i=t.transform.baseVal.consolidate().matrix).a,i.b,i.c,i.d,i.e,i.f]).join(",")?nt:c:(c!==nt||t.offsetParent||t===s||a.svg||(i=l.display,l.display="block",(r=t.parentNode)&&(t.offsetParent||t.getBoundingClientRect().width)||(o=1,n=t.nextElementSibling,s.appendChild(t)),c=ot(t),i?l.display=i:q(t,"display"),o&&(n?r.insertBefore(t,n):r?r.appendChild(t):s.removeChild(t))),e&&c.length>6?[c[0],c[1],c[4],c[5],c[12],c[13]]:c)},lt=function(t,e,r,n,i,s){var o,a,l,c=t._gsap,u=i||at(t,!0),h=c.xOrigin||0,d=c.yOrigin||0,f=c.xOffset||0,p=c.yOffset||0,g=u[0],m=u[1],y=u[2],v=u[3],b=u[4],E=u[5],A=e.split(" "),w=parseFloat(A[0])||0,T=parseFloat(A[1])||0;r?u!==nt&&(a=g*v-m*y)&&(l=w*(-m/a)+T*(g/a)-(g*E-m*b)/a,w=w*(v/a)+T*(-y/a)+(y*E-v*b)/a,T=l):(w=(o=K(t)).x+(~A[0].indexOf("%")?w/100*o.width:w),T=o.y+(~(A[1]||A[0]).indexOf("%")?T/100*o.height:T)),n||!1!==n&&c.smooth?(b=w-h,E=T-d,c.xOffset=f+(b*g+E*y)-b,c.yOffset=p+(b*m+E*v)-E):c.xOffset=c.yOffset=0,c.xOrigin=w,c.yOrigin=T,c.smooth=!!n,c.origin=e,c.originIsAbsolute=!!r,t.style[D]="0px 0px",s&&(W(s,c,"xOrigin",h,w),W(s,c,"yOrigin",d,T),W(s,c,"xOffset",f,c.xOffset),W(s,c,"yOffset",p,c.yOffset)),t.setAttribute("data-svg-origin",w+" "+T)},ct=function(t,e){var r=t._gsap||new h.n6(t);if("x"in r&&!e&&!r.uncache)return r;var n,i,s,o,a,l,c,d,m,y,v,b,E,A,w,T,S,L,_,x,k,P,I,R,C,M,N,F,U,$,j,G,H=t.style,V=r.scaleX<0,K="px",q="deg",W=getComputedStyle(t),z=B(t,D)||"0";return n=i=s=l=c=d=m=y=v=0,o=a=1,r.svg=!(!t.getCTM||!Y(t)),W.translate&&("none"===W.translate&&"none"===W.scale&&"none"===W.rotate||(H[O]=("none"!==W.translate?"translate3d("+(W.translate+" 0 0").split(" ").slice(0,3).join(", ")+") ":"")+("none"!==W.rotate?"rotate("+W.rotate+") ":"")+("none"!==W.scale?"scale("+W.scale.split(" ").join(",")+") ":"")+("none"!==W[O]?W[O]:"")),H.scale=H.rotate=H.translate="none"),A=at(t,r.svg),r.svg&&(r.uncache?(C=t.getBBox(),z=r.xOrigin-C.x+"px "+(r.yOrigin-C.y)+"px",R=""):R=!e&&t.getAttribute("data-svg-origin"),lt(t,R||z,!!R||r.originIsAbsolute,!1!==r.smooth,A)),b=r.xOrigin||0,E=r.yOrigin||0,A!==nt&&(L=A[0],_=A[1],x=A[2],k=A[3],n=P=A[4],i=I=A[5],6===A.length?(o=Math.sqrt(L*L+_*_),a=Math.sqrt(k*k+x*x),l=L||_?g(_,L)*f:0,(m=x||k?g(x,k)*f+l:0)&&(a*=Math.abs(Math.cos(m*p))),r.svg&&(n-=b-(b*L+E*x),i-=E-(b*_+E*k))):(G=A[6],$=A[7],N=A[8],F=A[9],U=A[10],j=A[11],n=A[12],i=A[13],s=A[14],c=(w=g(G,U))*f,w&&(R=P*(T=Math.cos(-w))+N*(S=Math.sin(-w)),C=I*T+F*S,M=G*T+U*S,N=P*-S+N*T,F=I*-S+F*T,U=G*-S+U*T,j=$*-S+j*T,P=R,I=C,G=M),d=(w=g(-x,U))*f,w&&(T=Math.cos(-w),j=k*(S=Math.sin(-w))+j*T,L=R=L*T-N*S,_=C=_*T-F*S,x=M=x*T-U*S),l=(w=g(_,L))*f,w&&(R=L*(T=Math.cos(w))+_*(S=Math.sin(w)),C=P*T+I*S,_=_*T-L*S,I=I*T-P*S,L=R,P=C),c&&Math.abs(c)+Math.abs(l)>359.9&&(c=l=0,d=180-d),o=(0,h.E_)(Math.sqrt(L*L+_*_+x*x)),a=(0,h.E_)(Math.sqrt(I*I+G*G)),w=g(P,I),m=Math.abs(w)>2e-4?w*f:0,v=j?1/(j<0?-j:j):0),r.svg&&(R=t.getAttribute("transform"),r.forceCSS=t.setAttribute("transform","")||!st(B(t,O)),R&&t.setAttribute("transform",R))),Math.abs(m)>90&&Math.abs(m)<270&&(V?(o*=-1,m+=l<=0?180:-180,l+=l<=0?180:-180):(a*=-1,m+=m<=0?180:-180)),e=e||r.uncache,r.x=n-((r.xPercent=n&&(!e&&r.xPercent||(Math.round(t.offsetWidth/2)===Math.round(-n)?-50:0)))?t.offsetWidth*r.xPercent/100:0)+K,r.y=i-((r.yPercent=i&&(!e&&r.yPercent||(Math.round(t.offsetHeight/2)===Math.round(-i)?-50:0)))?t.offsetHeight*r.yPercent/100:0)+K,r.z=s+K,r.scaleX=(0,h.E_)(o),r.scaleY=(0,h.E_)(a),r.rotation=(0,h.E_)(l)+q,r.rotationX=(0,h.E_)(c)+q,r.rotationY=(0,h.E_)(d)+q,r.skewX=m+q,r.skewY=y+q,r.transformPerspective=v+K,(r.zOrigin=parseFloat(z.split(" ")[2])||!e&&r.zOrigin||0)&&(H[D]=ut(z)),r.xOffset=r.yOffset=0,r.force3D=h.Yz.force3D,r.renderTransform=r.svg?yt:u?mt:dt,r.uncache=0,r},ut=function(t){return(t=t.split(" "))[0]+" "+t[1]},ht=function(t,e,r){var n=(0,h.l_)(e);return(0,h.E_)(parseFloat(e)+parseFloat(Q(t,"x",r+"px",n)))+n},dt=function(t,e){e.z="0px",e.rotationY=e.rotationX="0deg",e.force3D=0,mt(t,e)},ft="0deg",pt="0px",gt=") ",mt=function(t,e){var r=e||this,n=r.xPercent,i=r.yPercent,s=r.x,o=r.y,a=r.z,l=r.rotation,c=r.rotationY,u=r.rotationX,h=r.skewX,d=r.skewY,f=r.scaleX,g=r.scaleY,m=r.transformPerspective,y=r.force3D,v=r.target,b=r.zOrigin,E="",A="auto"===y&&t&&1!==t||!0===y;if(b&&(u!==ft||c!==ft)){var w,T=parseFloat(c)*p,S=Math.sin(T),L=Math.cos(T);T=parseFloat(u)*p,w=Math.cos(T),s=ht(v,s,S*w*-b),o=ht(v,o,-Math.sin(T)*-b),a=ht(v,a,L*w*-b+b)}m!==pt&&(E+="perspective("+m+gt),(n||i)&&(E+="translate("+n+"%, "+i+"%) "),(A||s!==pt||o!==pt||a!==pt)&&(E+=a!==pt||A?"translate3d("+s+", "+o+", "+a+") ":"translate("+s+", "+o+gt),l!==ft&&(E+="rotate("+l+gt),c!==ft&&(E+="rotateY("+c+gt),u!==ft&&(E+="rotateX("+u+gt),h===ft&&d===ft||(E+="skew("+h+", "+d+gt),1===f&&1===g||(E+="scale("+f+", "+g+gt),v.style[O]=E||"translate(0, 0)"},yt=function(t,e){var r,n,i,s,o,a=e||this,l=a.xPercent,c=a.yPercent,u=a.x,d=a.y,f=a.rotation,g=a.skewX,m=a.skewY,y=a.scaleX,v=a.scaleY,b=a.target,E=a.xOrigin,A=a.yOrigin,w=a.xOffset,T=a.yOffset,S=a.forceCSS,L=parseFloat(u),_=parseFloat(d);f=parseFloat(f),g=parseFloat(g),(m=parseFloat(m))&&(g+=m=parseFloat(m),f+=m),f||g?(f*=p,g*=p,r=Math.cos(f)*y,n=Math.sin(f)*y,i=Math.sin(f-g)*-v,s=Math.cos(f-g)*v,g&&(m*=p,o=Math.tan(g-m),i*=o=Math.sqrt(1+o*o),s*=o,m&&(o=Math.tan(m),r*=o=Math.sqrt(1+o*o),n*=o)),r=(0,h.E_)(r),n=(0,h.E_)(n),i=(0,h.E_)(i),s=(0,h.E_)(s)):(r=y,s=v,n=i=0),(L&&!~(u+"").indexOf("px")||_&&!~(d+"").indexOf("px"))&&(L=Q(b,"x",u,"px"),_=Q(b,"y",d,"px")),(E||A||w||T)&&(L=(0,h.E_)(L+E-(E*r+A*i)+w),_=(0,h.E_)(_+A-(E*n+A*s)+T)),(l||c)&&(o=b.getBBox(),L=(0,h.E_)(L+l/100*o.width),_=(0,h.E_)(_+c/100*o.height)),o="matrix("+r+","+n+","+i+","+s+","+L+","+_+")",b.setAttribute("transform",o),S&&(b.style[O]=o)},vt=function(t,e,r,n,i){var s,o,a=360,l=(0,h.vQ)(i),c=parseFloat(i)*(l&&~i.indexOf("rad")?f:1)-n,u=n+c+"deg";return l&&("short"===(s=i.split("_")[1])&&(c%=a)!==c%180&&(c+=c<0?a:-360),"cw"===s&&c<0?c=(c+36e9)%a-~~(c/a)*a:"ccw"===s&&c>0&&(c=(c-36e9)%a-~~(c/a)*a)),t._pt=o=new h.J7(t._pt,e,r,n,c,A),o.e=u,o.u="deg",t._props.push(r),o},bt=function(t,e){for(var r in e)t[r]=e[r];return t},Et=function(t,e,r){var n,i,s,o,a,l,c,u=bt({},r._gsap),f=r.style;for(i in u.svg?(s=r.getAttribute("transform"),r.setAttribute("transform",""),f[O]=e,n=ct(r,1),q(r,O),r.setAttribute("transform",s)):(s=getComputedStyle(r)[O],f[O]=e,n=ct(r,1),f[O]=s),d)(s=u[i])!==(o=n[i])&&"perspective,force3D,transformOrigin,svgOrigin".indexOf(i)<0&&(a=(0,h.l_)(s)!==(c=(0,h.l_)(o))?Q(r,i,s,c):parseFloat(s),l=parseFloat(o),t._pt=new h.J7(t._pt,n,i,a,l-a,E),t._pt.u=c||0,t._props.push(i));bt(n,u)};(0,h.fA)("padding,margin,Width,Radius",(function(t,e){var r="Top",n="Right",i="Bottom",s="Left",o=(e<3?[r,n,i,s]:[r+s,r+n,i+n,i+s]).map((function(r){return e<2?t+r:"border"+r+t}));rt[e>1?"border"+t:t]=function(t,e,r,n,i){var s,a;if(arguments.length<4)return s=o.map((function(e){return J(t,e,r)})),5===(a=s.join(" ")).split(s[0]).length?s[0]:a;s=(n+"").split(" "),a={},o.forEach((function(t,e){return a[t]=s[e]=s[e]||s[(e-1)/2|0]})),t.init(e,a,i)}}));var At,wt,Tt,St={name:"css",register:G,targetTest:function(t){return t.style&&t.nodeType},init:function(t,e,r,n,i){var s,a,l,c,u,f,p,g,m,y,A,S,L,_,x,k,P,I,R,C,M=this._props,N=t.style,U=r.vars.startAt;for(p in o||G(),this.styles=this.styles||F(t),k=this.styles.props,this.tween=r,e)if("autoRound"!==p&&(a=e[p],!h.wU[p]||!(0,h.Zm)(p,e,r,n,t,i)))if(u=typeof a,f=rt[p],"function"===u&&(u=typeof(a=a.call(r,n,t,i))),"string"===u&&~a.indexOf("random(")&&(a=(0,h.Vy)(a)),f)f(this,t,p,a,r)&&(x=1);else if("--"===p.substr(0,2))s=(getComputedStyle(t).getPropertyValue(p)+"").trim(),a+="",h.qA.lastIndex=0,h.qA.test(s)||(g=(0,h.l_)(s),m=(0,h.l_)(a)),m?g!==m&&(s=Q(t,p,s,m)+m):g&&(a+=g),this.add(N,"setProperty",s,a,n,i,0,0,p),M.push(p),k.push(p,0,N[p]);else if("undefined"!==u){if(U&&p in U?(s="function"==typeof U[p]?U[p].call(r,n,t,i):U[p],(0,h.vQ)(s)&&~s.indexOf("random(")&&(s=(0,h.Vy)(s)),(0,h.l_)(s+"")||"auto"===s||(s+=h.Yz.units[p]||(0,h.l_)(J(t,p))||""),"="===(s+"").charAt(1)&&(s=J(t,p))):s=J(t,p),c=parseFloat(s),(y="string"===u&&"="===a.charAt(1)&&a.substr(0,2))&&(a=a.substr(2)),l=parseFloat(a),p in b&&("autoAlpha"===p&&(1===c&&"hidden"===J(t,"visibility")&&l&&(c=0),k.push("visibility",0,N.visibility),W(this,N,"visibility",c?"inherit":"hidden",l?"inherit":"hidden",!l)),"scale"!==p&&"transform"!==p&&~(p=b[p]).indexOf(",")&&(p=p.split(",")[0])),A=p in d)if(this.styles.save(p),"string"===u&&"var(--"===a.substring(0,6)&&(a=B(t,a.substring(4,a.indexOf(")"))),l=parseFloat(a)),S||((L=t._gsap).renderTransform&&!e.parseTransform||ct(t,e.parseTransform),_=!1!==e.smoothOrigin&&L.smooth,(S=this._pt=new h.J7(this._pt,N,O,0,1,L.renderTransform,L,0,-1)).dep=1),"scale"===p)this._pt=new h.J7(this._pt,L,"scaleY",L.scaleY,(y?(0,h.B0)(L.scaleY,y+l):l)-L.scaleY||0,E),this._pt.u=0,M.push("scaleY",p),p+="X";else{if("transformOrigin"===p){k.push(D,0,N[D]),I=void 0,R=void 0,C=void 0,I=(P=a).split(" "),R=I[0],C=I[1]||"50%","top"!==R&&"bottom"!==R&&"left"!==C&&"right"!==C||(P=R,R=C,C=P),I[0]=tt[R]||R,I[1]=tt[C]||C,a=I.join(" "),L.svg?lt(t,a,0,_,0,this):((m=parseFloat(a.split(" ")[2])||0)!==L.zOrigin&&W(this,L,"zOrigin",L.zOrigin,m),W(this,N,p,ut(s),ut(a)));continue}if("svgOrigin"===p){lt(t,a,1,_,0,this);continue}if(p in it){vt(this,L,p,c,y?(0,h.B0)(c,y+a):a);continue}if("smoothOrigin"===p){W(this,L,"smooth",L.smooth,a);continue}if("force3D"===p){L[p]=a;continue}if("transform"===p){Et(this,a,t);continue}}else p in N||(p=j(p)||p);if(A||(l||0===l)&&(c||0===c)&&!v.test(a)&&p in N)l||(l=0),(g=(s+"").substr((c+"").length))!==(m=(0,h.l_)(a)||(p in h.Yz.units?h.Yz.units[p]:g))&&(c=Q(t,p,s,m)),this._pt=new h.J7(this._pt,A?L:N,p,c,(y?(0,h.B0)(c,y+l):l)-c,A||"px"!==m&&"zIndex"!==p||!1===e.autoRound?E:T),this._pt.u=m||0,g!==m&&"%"!==m&&(this._pt.b=s,this._pt.r=w);else if(p in N)Z.call(this,t,p,s,y?y+a:a);else if(p in t)this.add(t,p,s||t[p],y?y+a:a,n,i);else if("parseTransform"!==p){(0,h.dg)(p,a);continue}A||(p in N?k.push(p,0,N[p]):"function"==typeof t[p]?k.push(p,2,t[p]()):k.push(p,1,s||t[p])),M.push(p)}x&&(0,h.St)(this)},render:function(t,e){if(e.tween._time||!c())for(var r=e._pt;r;)r.r(t,r.d),r=r._next;else e.styles.revert()},get:J,aliases:b,getSetter:function(t,e,r){var n=b[e];return n&&n.indexOf(",")<0&&(e=n),e in d&&e!==D&&(t._gsap.x||J(t,"x"))?r&&l===r?"scale"===e?P:k:(l=r||{})&&("scale"===e?I:R):t.style&&!(0,h.OF)(t.style[e])?_:~e.indexOf("-")?x:(0,h.Dx)(t,e)},core:{_removeProperty:q,_getMatrix:at}};h.os.utils.checkPrefix=j,h.os.core.getStyleSaver=F,At="x,y,z,scale,scaleX,scaleY,xPercent,yPercent",wt="rotation,rotationX,rotationY,skewX,skewY",Tt=(0,h.fA)(At+","+wt+",transform,transformOrigin,svgOrigin,force3D,smoothOrigin,transformPerspective",(function(t){d[t]=1})),(0,h.fA)(wt,(function(t){h.Yz.units[t]="deg",it[t]=1})),b[Tt[13]]=At+","+wt,(0,h.fA)("0:translateX,1:translateY,2:translateZ,8:rotate,8:rotationZ,8:rotateZ,9:rotateX,10:rotateY",(function(t){var e=t.split(":");b[e[1]]=Tt[e[0]]})),(0,h.fA)("x,y,z,top,right,bottom,left,width,height,fontSize,padding,margin,perspective",(function(t){h.Yz.units[t]="px"})),h.os.registerPlugin(St)},7571:(t,e,r)=>{"use strict";r.d(e,{I:()=>E});var n,i,s,o,a,l,c,u,h=function(){return"undefined"!=typeof window},d=function(){return n||h()&&(n=window.gsap)&&n.registerPlugin&&n},f=function(t){return"string"==typeof t},p=function(t){return"function"==typeof t},g=function(t,e){var r="x"===e?"Width":"Height",n="scroll"+r,i="client"+r;return t===s||t===o||t===a?Math.max(o[n],a[n])-(s["inner"+r]||o[i]||a[i]):t[n]-t["offset"+r]},m=function(t,e){var r="scroll"+("x"===e?"Left":"Top");return t===s&&(null!=t.pageXOffset?r="page"+e.toUpperCase()+"Offset":t=null!=o[r]?o:a),function(){return t[r]}},y=function(t,e){if(!(t=l(t)[0])||!t.getBoundingClientRect)return{x:0,y:0};var r=t.getBoundingClientRect(),n=!e||e===s||e===a,i=n?{top:o.clientTop-(s.pageYOffset||o.scrollTop||a.scrollTop||0),left:o.clientLeft-(s.pageXOffset||o.scrollLeft||a.scrollLeft||0)}:e.getBoundingClientRect(),c={x:r.left-i.left,y:r.top-i.top};return!n&&e&&(c.x+=m(e,"x")(),c.y+=m(e,"y")()),c},v=function(t,e,r,n,i){return isNaN(t)||"object"==typeof t?f(t)&&"="===t.charAt(1)?parseFloat(t.substr(2))*("-"===t.charAt(0)?-1:1)+n-i:"max"===t?g(e,r)-i:Math.min(g(e,r),y(t,e)[r]-i):parseFloat(t)-i},b=function(){n=d(),h()&&n&&"undefined"!=typeof document&&document.body&&(s=window,a=document.body,o=document.documentElement,l=n.utils.toArray,n.config({autoKillThreshold:7}),c=n.config(),i=1)},E={version:"3.13.0",name:"scrollTo",rawVars:1,register:function(t){n=t,b()},init:function(t,e,r,o,a){i||b();var l=this,h=n.getProperty(t,"scrollSnapType");l.isWin=t===s,l.target=t,l.tween=r,e=function(t,e,r,n){if(p(t)&&(t=t(e,r,n)),"object"!=typeof t)return f(t)&&"max"!==t&&"="!==t.charAt(1)?{x:t,y:t}:{y:t};if(t.nodeType)return{y:t,x:t};var i,s={};for(i in t)s[i]="onAutoKill"!==i&&p(t[i])?t[i](e,r,n):t[i];return s}(e,o,t,a),l.vars=e,l.autoKill=!!("autoKill"in e?e:c).autoKill,l.getX=m(t,"x"),l.getY=m(t,"y"),l.x=l.xPrev=l.getX(),l.y=l.yPrev=l.getY(),u||(u=n.core.globals().ScrollTrigger),"smooth"===n.getProperty(t,"scrollBehavior")&&n.set(t,{scrollBehavior:"auto"}),h&&"none"!==h&&(l.snap=1,l.snapInline=t.style.scrollSnapType,t.style.scrollSnapType="none"),null!=e.x?(l.add(l,"x",l.x,v(e.x,t,"x",l.x,e.offsetX||0),o,a),l._props.push("scrollTo_x")):l.skipX=1,null!=e.y?(l.add(l,"y",l.y,v(e.y,t,"y",l.y,e.offsetY||0),o,a),l._props.push("scrollTo_y")):l.skipY=1},render:function(t,e){for(var r,n,i,o,a,l=e._pt,h=e.target,d=e.tween,f=e.autoKill,p=e.xPrev,m=e.yPrev,y=e.isWin,v=e.snap,b=e.snapInline;l;)l.r(t,l.d),l=l._next;r=y||!e.skipX?e.getX():p,i=(n=y||!e.skipY?e.getY():m)-m,o=r-p,a=c.autoKillThreshold,e.x<0&&(e.x=0),e.y<0&&(e.y=0),f&&(!e.skipX&&(o>a||o<-a)&&r<g(h,"x")&&(e.skipX=1),!e.skipY&&(i>a||i<-a)&&n<g(h,"y")&&(e.skipY=1),e.skipX&&e.skipY&&(d.kill(),e.vars.onAutoKill&&e.vars.onAutoKill.apply(d,e.vars.onAutoKillParams||[]))),y?s.scrollTo(e.skipX?r:e.x,e.skipY?n:e.y):(e.skipY||(h.scrollTop=e.y),e.skipX||(h.scrollLeft=e.x)),!v||1!==t&&0!==t||(n=h.scrollTop,r=h.scrollLeft,b?h.style.scrollSnapType=b:h.style.removeProperty("scroll-snap-type"),h.scrollTop=n+1,h.scrollLeft=r+1,h.scrollTop=n,h.scrollLeft=r),e.xPrev=e.x,e.yPrev=e.y,u&&u.update()},kill:function(t){var e="scrollTo"===t,r=this._props.indexOf(t);return(e||"scrollTo_x"===t)&&(this.skipX=1),(e||"scrollTo_y"===t)&&(this.skipY=1),r>-1&&this._props.splice(r,1),!this._props.length}};E.max=g,E.getOffset=y,E.buildGetter=m,E.config=function(t){for(var e in c||b()||(c=n.config()),t)c[e]=t[e]},d()&&n.registerPlugin(E)},4183:(t,e,r)=>{"use strict";function n(t,e){for(var r=0;r<e.length;r++){var n=e[r];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(t,n.key,n)}}r.d(e,{u:()=>lr});var i,s,o,a,l,c,u,h,d,f,p,g,m,y=function(){return i||"undefined"!=typeof window&&(i=window.gsap)&&i.registerPlugin&&i},v=1,b=[],E=[],A=[],w=Date.now,T=function(t,e){return e},S=function(t,e){return~A.indexOf(t)&&A[A.indexOf(t)+1][e]},L=function(t){return!!~f.indexOf(t)},_=function(t,e,r,n,i){return t.addEventListener(e,r,{passive:!1!==n,capture:!!i})},x=function(t,e,r,n){return t.removeEventListener(e,r,!!n)},k="scrollLeft",P="scrollTop",I=function(){return p&&p.isPressed||E.cache++},R=function(t,e){var r=function r(n){if(n||0===n){v&&(o.history.scrollRestoration="manual");var i=p&&p.isPressed;n=r.v=Math.round(n)||(p&&p.iOS?1:0),t(n),r.cacheID=E.cache,i&&T("ss",n)}else(e||E.cache!==r.cacheID||T("ref"))&&(r.cacheID=E.cache,r.v=t());return r.v+r.offset};return r.offset=0,t&&r},O={s:k,p:"left",p2:"Left",os:"right",os2:"Right",d:"width",d2:"Width",a:"x",sc:R((function(t){return arguments.length?o.scrollTo(t,D.sc()):o.pageXOffset||a[k]||l[k]||c[k]||0}))},D={s:P,p:"top",p2:"Top",os:"bottom",os2:"Bottom",d:"height",d2:"Height",a:"y",op:O,sc:R((function(t){return arguments.length?o.scrollTo(O.sc(),t):o.pageYOffset||a[P]||l[P]||c[P]||0}))},C=function(t,e){return(e&&e._ctx&&e._ctx.selector||i.utils.toArray)(t)[0]||("string"==typeof t&&!1!==i.config().nullTargetWarn?void 0:null)},M=function(t,e){var r=e.s,n=e.sc;L(t)&&(t=a.scrollingElement||l);var s=E.indexOf(t),o=n===D.sc?1:2;!~s&&(s=E.push(t)-1),E[s+o]||_(t,"scroll",I);var c=E[s+o],u=c||(E[s+o]=R(S(t,r),!0)||(L(t)?n:R((function(e){return arguments.length?t[r]=e:t[r]}))));return u.target=t,c||(u.smooth="smooth"===i.getProperty(t,"scrollBehavior")),u},N=function(t,e,r){var n=t,i=t,s=w(),o=s,a=e||50,l=Math.max(500,3*a),c=function(t,e){var l=w();e||l-s>a?(i=n,n=t,o=s,s=l):r?n+=t:n=i+(t-i)/(l-o)*(s-o)};return{update:c,reset:function(){i=n=r?0:n,o=s=0},getVelocity:function(t){var e=o,a=i,u=w();return(t||0===t)&&t!==n&&c(t),s===o||u-o>l?0:(n+(r?a:-a))/((r?u:s)-e)*1e3}}},F=function(t,e){return e&&!t._gsapAllow&&t.preventDefault(),t.changedTouches?t.changedTouches[0]:t},U=function(t){var e=Math.max.apply(Math,t),r=Math.min.apply(Math,t);return Math.abs(e)>=Math.abs(r)?e:r},B=function(){var t,e,r,n;(d=i.core.globals().ScrollTrigger)&&d.core&&(t=d.core,e=t.bridge||{},r=t._scrollers,n=t._proxies,r.push.apply(r,E),n.push.apply(n,A),E=r,A=n,T=function(t,r){return e[t](r)})},$=function(t){return i=t||y(),!s&&i&&"undefined"!=typeof document&&document.body&&(o=window,a=document,l=a.documentElement,c=a.body,f=[o,a,l,c],i.utils.clamp,m=i.core.context||function(){},h="onpointerenter"in c?"pointer":"mouse",u=j.isTouch=o.matchMedia&&o.matchMedia("(hover: none), (pointer: coarse)").matches?1:"ontouchstart"in o||navigator.maxTouchPoints>0||navigator.msMaxTouchPoints>0?2:0,g=j.eventTypes=("ontouchstart"in l?"touchstart,touchmove,touchcancel,touchend":"onpointerdown"in l?"pointerdown,pointermove,pointercancel,pointerup":"mousedown,mousemove,mouseup,mouseup").split(","),setTimeout((function(){return v=0}),500),B(),s=1),s};O.op=D,E.cache=0;var j=function(){function t(t){this.init(t)}var e,r,f;return t.prototype.init=function(t){s||$(i),d||B();var e=t.tolerance,r=t.dragMinimum,n=t.type,f=t.target,y=t.lineHeight,v=t.debounce,E=t.preventDefault,A=t.onStop,T=t.onStopDelay,S=t.ignore,k=t.wheelSpeed,P=t.event,R=t.onDragStart,j=t.onDragEnd,G=t.onDrag,H=t.onPress,V=t.onRelease,K=t.onRight,Y=t.onLeft,q=t.onUp,W=t.onDown,z=t.onChangeX,X=t.onChangeY,Q=t.onChange,J=t.onToggleX,Z=t.onToggleY,tt=t.onHover,et=t.onHoverEnd,rt=t.onMove,nt=t.ignoreCheck,it=t.isNormalizer,st=t.onGestureStart,ot=t.onGestureEnd,at=t.onWheel,lt=t.onEnable,ct=t.onDisable,ut=t.onClick,ht=t.scrollSpeed,dt=t.capture,ft=t.allowClicks,pt=t.lockAxis,gt=t.onLockAxis;this.target=f=C(f)||l,this.vars=t,S&&(S=i.utils.toArray(S)),e=e||1e-9,r=r||0,k=k||1,ht=ht||1,n=n||"wheel,touch,pointer",v=!1!==v,y||(y=parseFloat(o.getComputedStyle(c).lineHeight)||22);var mt,yt,vt,bt,Et,At,wt,Tt=this,St=0,Lt=0,_t=t.passive||!E&&!1!==t.passive,xt=M(f,O),kt=M(f,D),Pt=xt(),It=kt(),Rt=~n.indexOf("touch")&&!~n.indexOf("pointer")&&"pointerdown"===g[0],Ot=L(f),Dt=f.ownerDocument||a,Ct=[0,0,0],Mt=[0,0,0],Nt=0,Ft=function(){return Nt=w()},Ut=function(t,e){return(Tt.event=t)&&S&&function(t,e){for(var r=e.length;r--;)if(e[r]===t||e[r].contains(t))return!0;return!1}(t.target,S)||e&&Rt&&"touch"!==t.pointerType||nt&&nt(t,e)},Bt=function(){var t=Tt.deltaX=U(Ct),r=Tt.deltaY=U(Mt),n=Math.abs(t)>=e,i=Math.abs(r)>=e;Q&&(n||i)&&Q(Tt,t,r,Ct,Mt),n&&(K&&Tt.deltaX>0&&K(Tt),Y&&Tt.deltaX<0&&Y(Tt),z&&z(Tt),J&&Tt.deltaX<0!=St<0&&J(Tt),St=Tt.deltaX,Ct[0]=Ct[1]=Ct[2]=0),i&&(W&&Tt.deltaY>0&&W(Tt),q&&Tt.deltaY<0&&q(Tt),X&&X(Tt),Z&&Tt.deltaY<0!=Lt<0&&Z(Tt),Lt=Tt.deltaY,Mt[0]=Mt[1]=Mt[2]=0),(bt||vt)&&(rt&&rt(Tt),vt&&(R&&1===vt&&R(Tt),G&&G(Tt),vt=0),bt=!1),At&&!(At=!1)&&gt&&gt(Tt),Et&&(at(Tt),Et=!1),mt=0},$t=function(t,e,r){Ct[r]+=t,Mt[r]+=e,Tt._vx.update(t),Tt._vy.update(e),v?mt||(mt=requestAnimationFrame(Bt)):Bt()},jt=function(t,e){pt&&!wt&&(Tt.axis=wt=Math.abs(t)>Math.abs(e)?"x":"y",At=!0),"y"!==wt&&(Ct[2]+=t,Tt._vx.update(t,!0)),"x"!==wt&&(Mt[2]+=e,Tt._vy.update(e,!0)),v?mt||(mt=requestAnimationFrame(Bt)):Bt()},Gt=function(t){if(!Ut(t,1)){var e=(t=F(t,E)).clientX,n=t.clientY,i=e-Tt.x,s=n-Tt.y,o=Tt.isDragging;Tt.x=e,Tt.y=n,(o||(i||s)&&(Math.abs(Tt.startX-e)>=r||Math.abs(Tt.startY-n)>=r))&&(vt=o?2:1,o||(Tt.isDragging=!0),jt(i,s))}},Ht=Tt.onPress=function(t){Ut(t,1)||t&&t.button||(Tt.axis=wt=null,yt.pause(),Tt.isPressed=!0,t=F(t),St=Lt=0,Tt.startX=Tt.x=t.clientX,Tt.startY=Tt.y=t.clientY,Tt._vx.reset(),Tt._vy.reset(),_(it?f:Dt,g[1],Gt,_t,!0),Tt.deltaX=Tt.deltaY=0,H&&H(Tt))},Vt=Tt.onRelease=function(t){if(!Ut(t,1)){x(it?f:Dt,g[1],Gt,!0);var e=!isNaN(Tt.y-Tt.startY),r=Tt.isDragging,n=r&&(Math.abs(Tt.x-Tt.startX)>3||Math.abs(Tt.y-Tt.startY)>3),s=F(t);!n&&e&&(Tt._vx.reset(),Tt._vy.reset(),E&&ft&&i.delayedCall(.08,(function(){if(w()-Nt>300&&!t.defaultPrevented)if(t.target.click)t.target.click();else if(Dt.createEvent){var e=Dt.createEvent("MouseEvents");e.initMouseEvent("click",!0,!0,o,1,s.screenX,s.screenY,s.clientX,s.clientY,!1,!1,!1,!1,0,null),t.target.dispatchEvent(e)}}))),Tt.isDragging=Tt.isGesturing=Tt.isPressed=!1,A&&r&&!it&&yt.restart(!0),vt&&Bt(),j&&r&&j(Tt),V&&V(Tt,n)}},Kt=function(t){return t.touches&&t.touches.length>1&&(Tt.isGesturing=!0)&&st(t,Tt.isDragging)},Yt=function(){return(Tt.isGesturing=!1)||ot(Tt)},qt=function(t){if(!Ut(t)){var e=xt(),r=kt();$t((e-Pt)*ht,(r-It)*ht,1),Pt=e,It=r,A&&yt.restart(!0)}},Wt=function(t){if(!Ut(t)){t=F(t,E),at&&(Et=!0);var e=(1===t.deltaMode?y:2===t.deltaMode?o.innerHeight:1)*k;$t(t.deltaX*e,t.deltaY*e,0),A&&!it&&yt.restart(!0)}},zt=function(t){if(!Ut(t)){var e=t.clientX,r=t.clientY,n=e-Tt.x,i=r-Tt.y;Tt.x=e,Tt.y=r,bt=!0,A&&yt.restart(!0),(n||i)&&jt(n,i)}},Xt=function(t){Tt.event=t,tt(Tt)},Qt=function(t){Tt.event=t,et(Tt)},Jt=function(t){return Ut(t)||F(t,E)&&ut(Tt)};yt=Tt._dc=i.delayedCall(T||.25,(function(){Tt._vx.reset(),Tt._vy.reset(),yt.pause(),A&&A(Tt)})).pause(),Tt.deltaX=Tt.deltaY=0,Tt._vx=N(0,50,!0),Tt._vy=N(0,50,!0),Tt.scrollX=xt,Tt.scrollY=kt,Tt.isDragging=Tt.isGesturing=Tt.isPressed=!1,m(this),Tt.enable=function(t){return Tt.isEnabled||(_(Ot?Dt:f,"scroll",I),n.indexOf("scroll")>=0&&_(Ot?Dt:f,"scroll",qt,_t,dt),n.indexOf("wheel")>=0&&_(f,"wheel",Wt,_t,dt),(n.indexOf("touch")>=0&&u||n.indexOf("pointer")>=0)&&(_(f,g[0],Ht,_t,dt),_(Dt,g[2],Vt),_(Dt,g[3],Vt),ft&&_(f,"click",Ft,!0,!0),ut&&_(f,"click",Jt),st&&_(Dt,"gesturestart",Kt),ot&&_(Dt,"gestureend",Yt),tt&&_(f,h+"enter",Xt),et&&_(f,h+"leave",Qt),rt&&_(f,h+"move",zt)),Tt.isEnabled=!0,Tt.isDragging=Tt.isGesturing=Tt.isPressed=bt=vt=!1,Tt._vx.reset(),Tt._vy.reset(),Pt=xt(),It=kt(),t&&t.type&&Ht(t),lt&&lt(Tt)),Tt},Tt.disable=function(){Tt.isEnabled&&(b.filter((function(t){return t!==Tt&&L(t.target)})).length||x(Ot?Dt:f,"scroll",I),Tt.isPressed&&(Tt._vx.reset(),Tt._vy.reset(),x(it?f:Dt,g[1],Gt,!0)),x(Ot?Dt:f,"scroll",qt,dt),x(f,"wheel",Wt,dt),x(f,g[0],Ht,dt),x(Dt,g[2],Vt),x(Dt,g[3],Vt),x(f,"click",Ft,!0),x(f,"click",Jt),x(Dt,"gesturestart",Kt),x(Dt,"gestureend",Yt),x(f,h+"enter",Xt),x(f,h+"leave",Qt),x(f,h+"move",zt),Tt.isEnabled=Tt.isPressed=Tt.isDragging=!1,ct&&ct(Tt))},Tt.kill=Tt.revert=function(){Tt.disable();var t=b.indexOf(Tt);t>=0&&b.splice(t,1),p===Tt&&(p=0)},b.push(Tt),it&&L(f)&&(p=Tt),Tt.enable(P)},e=t,(r=[{key:"velocityX",get:function(){return this._vx.getVelocity()}},{key:"velocityY",get:function(){return this._vy.getVelocity()}}])&&n(e.prototype,r),f&&n(e,f),t}();j.version="3.13.0",j.create=function(t){return new j(t)},j.register=$,j.getAll=function(){return b.slice()},j.getById=function(t){return b.filter((function(e){return e.vars.id===t}))[0]},y()&&i.registerPlugin(j);var G,H,V,K,Y,q,W,z,X,Q,J,Z,tt,et,rt,nt,it,st,ot,at,lt,ct,ut,ht,dt,ft,pt,gt,mt,yt,vt,bt,Et,At,wt,Tt,St,Lt,_t=1,xt=Date.now,kt=xt(),Pt=0,It=0,Rt=function(t,e,r){var n=Kt(t)&&("clamp("===t.substr(0,6)||t.indexOf("max")>-1);return r["_"+e+"Clamp"]=n,n?t.substr(6,t.length-7):t},Ot=function(t,e){return!e||Kt(t)&&"clamp("===t.substr(0,6)?t:"clamp("+t+")"},Dt=function t(){return It&&requestAnimationFrame(t)},Ct=function(){return et=1},Mt=function(){return et=0},Nt=function(t){return t},Ft=function(t){return Math.round(1e5*t)/1e5||0},Ut=function(){return"undefined"!=typeof window},Bt=function(){return G||Ut()&&(G=window.gsap)&&G.registerPlugin&&G},$t=function(t){return!!~W.indexOf(t)},jt=function(t){return("Height"===t?vt:V["inner"+t])||Y["client"+t]||q["client"+t]},Gt=function(t){return S(t,"getBoundingClientRect")||($t(t)?function(){return er.width=V.innerWidth,er.height=vt,er}:function(){return pe(t)})},Ht=function(t,e){var r=e.s,n=e.d2,i=e.d,s=e.a;return Math.max(0,(r="scroll"+n)&&(s=S(t,r))?s()-Gt(t)()[i]:$t(t)?(Y[r]||q[r])-jt(n):t[r]-t["offset"+n])},Vt=function(t,e){for(var r=0;r<ot.length;r+=3)(!e||~e.indexOf(ot[r+1]))&&t(ot[r],ot[r+1],ot[r+2])},Kt=function(t){return"string"==typeof t},Yt=function(t){return"function"==typeof t},qt=function(t){return"number"==typeof t},Wt=function(t){return"object"==typeof t},zt=function(t,e,r){return t&&t.progress(e?0:1)&&r&&t.pause()},Xt=function(t,e){if(t.enabled){var r=t._ctx?t._ctx.add((function(){return e(t)})):e(t);r&&r.totalTime&&(t.callbackAnimation=r)}},Qt=Math.abs,Jt="left",Zt="right",te="bottom",ee="width",re="height",ne="Right",ie="Left",se="Top",oe="Bottom",ae="padding",le="margin",ce="Width",ue="Height",he="px",de=function(t){return V.getComputedStyle(t)},fe=function(t,e){for(var r in e)r in t||(t[r]=e[r]);return t},pe=function(t,e){var r=e&&"matrix(1, 0, 0, 1, 0, 0)"!==de(t)[rt]&&G.to(t,{x:0,y:0,xPercent:0,yPercent:0,rotation:0,rotationX:0,rotationY:0,scale:1,skewX:0,skewY:0}).progress(1),n=t.getBoundingClientRect();return r&&r.progress(0).kill(),n},ge=function(t,e){var r=e.d2;return t["offset"+r]||t["client"+r]||0},me=function(t){var e,r=[],n=t.labels,i=t.duration();for(e in n)r.push(n[e]/i);return r},ye=function(t){var e=G.utils.snap(t),r=Array.isArray(t)&&t.slice(0).sort((function(t,e){return t-e}));return r?function(t,n,i){var s;if(void 0===i&&(i=.001),!n)return e(t);if(n>0){for(t-=i,s=0;s<r.length;s++)if(r[s]>=t)return r[s];return r[s-1]}for(s=r.length,t+=i;s--;)if(r[s]<=t)return r[s];return r[0]}:function(r,n,i){void 0===i&&(i=.001);var s=e(r);return!n||Math.abs(s-r)<i||s-r<0==n<0?s:e(n<0?r-t:r+t)}},ve=function(t,e,r,n){return r.split(",").forEach((function(r){return t(e,r,n)}))},be=function(t,e,r,n,i){return t.addEventListener(e,r,{passive:!n,capture:!!i})},Ee=function(t,e,r,n){return t.removeEventListener(e,r,!!n)},Ae=function(t,e,r){(r=r&&r.wheelHandler)&&(t(e,"wheel",r),t(e,"touchmove",r))},we={startColor:"green",endColor:"red",indent:0,fontSize:"16px",fontWeight:"normal"},Te={toggleActions:"play",anticipatePin:0},Se={top:0,left:0,center:.5,bottom:1,right:1},Le=function(t,e){if(Kt(t)){var r=t.indexOf("="),n=~r?+(t.charAt(r-1)+1)*parseFloat(t.substr(r+1)):0;~r&&(t.indexOf("%")>r&&(n*=e/100),t=t.substr(0,r-1)),t=n+(t in Se?Se[t]*e:~t.indexOf("%")?parseFloat(t)*e/100:parseFloat(t)||0)}return t},_e=function(t,e,r,n,i,s,o,a){var l=i.startColor,c=i.endColor,u=i.fontSize,h=i.indent,d=i.fontWeight,f=K.createElement("div"),p=$t(r)||"fixed"===S(r,"pinType"),g=-1!==t.indexOf("scroller"),m=p?q:r,y=-1!==t.indexOf("start"),v=y?l:c,b="border-color:"+v+";font-size:"+u+";color:"+v+";font-weight:"+d+";pointer-events:none;white-space:nowrap;font-family:sans-serif,Arial;z-index:1000;padding:4px 8px;border-width:0;border-style:solid;";return b+="position:"+((g||a)&&p?"fixed;":"absolute;"),(g||a||!p)&&(b+=(n===D?Zt:te)+":"+(s+parseFloat(h))+"px;"),o&&(b+="box-sizing:border-box;text-align:left;width:"+o.offsetWidth+"px;"),f._isStart=y,f.setAttribute("class","gsap-marker-"+t+(e?" marker-"+e:"")),f.style.cssText=b,f.innerText=e||0===e?t+"-"+e:t,m.children[0]?m.insertBefore(f,m.children[0]):m.appendChild(f),f._offset=f["offset"+n.op.d2],xe(f,0,n,y),f},xe=function(t,e,r,n){var i={display:"block"},s=r[n?"os2":"p2"],o=r[n?"p2":"os2"];t._isFlipped=n,i[r.a+"Percent"]=n?-100:0,i[r.a]=n?"1px":0,i["border"+s+ce]=1,i["border"+o+ce]=0,i[r.p]=e+"px",G.set(t,i)},ke=[],Pe={},Ie=function(){return xt()-Pt>34&&(wt||(wt=requestAnimationFrame(We)))},Re=function(){(!ut||!ut.isPressed||ut.startX>q.clientWidth)&&(E.cache++,ut?wt||(wt=requestAnimationFrame(We)):We(),Pt||Fe("scrollStart"),Pt=xt())},Oe=function(){ft=V.innerWidth,dt=V.innerHeight},De=function(t){E.cache++,(!0===t||!tt&&!ct&&!K.fullscreenElement&&!K.webkitFullscreenElement&&(!ht||ft!==V.innerWidth||Math.abs(V.innerHeight-dt)>.25*V.innerHeight))&&z.restart(!0)},Ce={},Me=[],Ne=function t(){return Ee(lr,"scrollEnd",t)||Ke(!0)},Fe=function(t){return Ce[t]&&Ce[t].map((function(t){return t()}))||Me},Ue=[],Be=function(t){for(var e=0;e<Ue.length;e+=5)(!t||Ue[e+4]&&Ue[e+4].query===t)&&(Ue[e].style.cssText=Ue[e+1],Ue[e].getBBox&&Ue[e].setAttribute("transform",Ue[e+2]||""),Ue[e+3].uncache=1)},$e=function(t,e){var r;for(nt=0;nt<ke.length;nt++)!(r=ke[nt])||e&&r._ctx!==e||(t?r.kill(1):r.revert(!0,!0));bt=!0,e&&Be(e),e||Fe("revert")},je=function(t,e){E.cache++,(e||!Tt)&&E.forEach((function(t){return Yt(t)&&t.cacheID++&&(t.rec=0)})),Kt(t)&&(V.history.scrollRestoration=mt=t)},Ge=0,He=function(){q.appendChild(yt),vt=!ut&&yt.offsetHeight||V.innerHeight,q.removeChild(yt)},Ve=function(t){return X(".gsap-marker-start, .gsap-marker-end, .gsap-marker-scroller-start, .gsap-marker-scroller-end").forEach((function(e){return e.style.display=t?"none":"block"}))},Ke=function(t,e){if(Y=K.documentElement,q=K.body,W=[V,K,Y,q],!Pt||t||bt){He(),Tt=lr.isRefreshing=!0,E.forEach((function(t){return Yt(t)&&++t.cacheID&&(t.rec=t())}));var r=Fe("refreshInit");at&&lr.sort(),e||$e(),E.forEach((function(t){Yt(t)&&(t.smooth&&(t.target.style.scrollBehavior="auto"),t(0))})),ke.slice(0).forEach((function(t){return t.refresh()})),bt=!1,ke.forEach((function(t){if(t._subPinOffset&&t.pin){var e=t.vars.horizontal?"offsetWidth":"offsetHeight",r=t.pin[e];t.revert(!0,1),t.adjustPinSpacing(t.pin[e]-r),t.refresh()}})),Et=1,Ve(!0),ke.forEach((function(t){var e=Ht(t.scroller,t._dir),r="max"===t.vars.end||t._endClamp&&t.end>e,n=t._startClamp&&t.start>=e;(r||n)&&t.setPositions(n?e-1:t.start,r?Math.max(n?e:t.start+1,e):t.end,!0)})),Ve(!1),Et=0,r.forEach((function(t){return t&&t.render&&t.render(-1)})),E.forEach((function(t){Yt(t)&&(t.smooth&&requestAnimationFrame((function(){return t.target.style.scrollBehavior="smooth"})),t.rec&&t(t.rec))})),je(mt,1),z.pause(),Ge++,Tt=2,We(2),ke.forEach((function(t){return Yt(t.vars.onRefresh)&&t.vars.onRefresh(t)})),Tt=lr.isRefreshing=!1,Fe("refresh")}else be(lr,"scrollEnd",Ne)},Ye=0,qe=1,We=function(t){if(2===t||!Tt&&!bt){lr.isUpdating=!0,Lt&&Lt.update(0);var e=ke.length,r=xt(),n=r-kt>=50,i=e&&ke[0].scroll();if(qe=Ye>i?-1:1,Tt||(Ye=i),n&&(Pt&&!et&&r-Pt>200&&(Pt=0,Fe("scrollEnd")),J=kt,kt=r),qe<0){for(nt=e;nt-- >0;)ke[nt]&&ke[nt].update(0,n);qe=1}else for(nt=0;nt<e;nt++)ke[nt]&&ke[nt].update(0,n);lr.isUpdating=!1}wt=0},ze=[Jt,"top",te,Zt,le+oe,le+ne,le+se,le+ie,"display","flexShrink","float","zIndex","gridColumnStart","gridColumnEnd","gridRowStart","gridRowEnd","gridArea","justifySelf","alignSelf","placeSelf","order"],Xe=ze.concat([ee,re,"boxSizing","max"+ce,"max"+ue,"position",le,ae,ae+se,ae+ne,ae+oe,ae+ie]),Qe=function(t,e,r,n){if(!t._gsap.swappedIn){for(var i,s=ze.length,o=e.style,a=t.style;s--;)o[i=ze[s]]=r[i];o.position="absolute"===r.position?"absolute":"relative","inline"===r.display&&(o.display="inline-block"),a[te]=a[Zt]="auto",o.flexBasis=r.flexBasis||"auto",o.overflow="visible",o.boxSizing="border-box",o[ee]=ge(t,O)+he,o[re]=ge(t,D)+he,o[ae]=a[le]=a.top=a[Jt]="0",Ze(n),a[ee]=a["max"+ce]=r[ee],a[re]=a["max"+ue]=r[re],a[ae]=r[ae],t.parentNode!==e&&(t.parentNode.insertBefore(e,t),e.appendChild(t)),t._gsap.swappedIn=!0}},Je=/([A-Z])/g,Ze=function(t){if(t){var e,r,n=t.t.style,i=t.length,s=0;for((t.t._gsap||G.core.getCache(t.t)).uncache=1;s<i;s+=2)r=t[s+1],e=t[s],r?n[e]=r:n[e]&&n.removeProperty(e.replace(Je,"-$1").toLowerCase())}},tr=function(t){for(var e=Xe.length,r=t.style,n=[],i=0;i<e;i++)n.push(Xe[i],r[Xe[i]]);return n.t=t,n},er={left:0,top:0},rr=function(t,e,r,n,i,s,o,a,l,c,u,h,d,f){Yt(t)&&(t=t(a)),Kt(t)&&"max"===t.substr(0,3)&&(t=h+("="===t.charAt(4)?Le("0"+t.substr(3),r):0));var p,g,m,y=d?d.time():0;if(d&&d.seek(0),isNaN(t)||(t=+t),qt(t))d&&(t=G.utils.mapRange(d.scrollTrigger.start,d.scrollTrigger.end,0,h,t)),o&&xe(o,r,n,!0);else{Yt(e)&&(e=e(a));var v,b,E,A,w=(t||"0").split(" ");m=C(e,a)||q,(v=pe(m)||{})&&(v.left||v.top)||"none"!==de(m).display||(A=m.style.display,m.style.display="block",v=pe(m),A?m.style.display=A:m.style.removeProperty("display")),b=Le(w[0],v[n.d]),E=Le(w[1]||"0",r),t=v[n.p]-l[n.p]-c+b+i-E,o&&xe(o,E,n,r-E<20||o._isStart&&E>20),r-=r-E}if(f&&(a[f]=t||-.001,t<0&&(t=0)),s){var T=t+r,S=s._isStart;p="scroll"+n.d2,xe(s,T,n,S&&T>20||!S&&(u?Math.max(q[p],Y[p]):s.parentNode[p])<=T+1),u&&(l=pe(o),u&&(s.style[n.op.p]=l[n.op.p]-n.op.m-s._offset+he))}return d&&m&&(p=pe(m),d.seek(h),g=pe(m),d._caScrollDist=p[n.p]-g[n.p],t=t/d._caScrollDist*h),d&&d.seek(y),d?t:Math.round(t)},nr=/(webkit|moz|length|cssText|inset)/i,ir=function(t,e,r,n){if(t.parentNode!==e){var i,s,o=t.style;if(e===q){for(i in t._stOrig=o.cssText,s=de(t))+i||nr.test(i)||!s[i]||"string"!=typeof o[i]||"0"===i||(o[i]=s[i]);o.top=r,o.left=n}else o.cssText=t._stOrig;G.core.getCache(t).uncache=1,e.appendChild(t)}},sr=function(t,e,r){var n=e,i=n;return function(e){var s=Math.round(t());return s!==n&&s!==i&&Math.abs(s-n)>3&&Math.abs(s-i)>3&&(e=s,r&&r()),i=n,n=Math.round(e)}},or=function(t,e,r){var n={};n[e.p]="+="+r,G.set(t,n)},ar=function(t,e){var r=M(t,e),n="_scroll"+e.p2,i=function e(i,s,o,a,l){var c=e.tween,u=s.onComplete,h={};o=o||r();var d=sr(r,o,(function(){c.kill(),e.tween=0}));return l=a&&l||0,a=a||i-o,c&&c.kill(),s[n]=i,s.inherit=!1,s.modifiers=h,h[n]=function(){return d(o+a*c.ratio+l*c.ratio*c.ratio)},s.onUpdate=function(){E.cache++,e.tween&&We()},s.onComplete=function(){e.tween=0,u&&u.call(c)},c=e.tween=G.to(t,s)};return t[n]=r,r.wheelHandler=function(){return i.tween&&i.tween.kill()&&(i.tween=0)},be(t,"wheel",r.wheelHandler),lr.isTouch&&be(t,"touchmove",r.wheelHandler),i},lr=function(){function t(e,r){H||t.register(G),gt(this),this.init(e,r)}return t.prototype.init=function(e,r){if(this.progress=this.start=0,this.vars&&this.kill(!0,!0),It){var n,i,s,o,a,l,c,u,h,d,f,p,g,m,y,v,b,w,T,L,_,x,k,P,I,R,N,F,U,B,$,j,H,W,z,Z,rt,it,st,ot,ct,ut,ht=e=fe(Kt(e)||qt(e)||e.nodeType?{trigger:e}:e,Te),dt=ht.onUpdate,ft=ht.toggleClass,pt=ht.id,gt=ht.onToggle,mt=ht.onRefresh,yt=ht.scrub,vt=ht.trigger,bt=ht.pin,wt=ht.pinSpacing,kt=ht.invalidateOnRefresh,Dt=ht.anticipatePin,Ct=ht.onScrubComplete,Mt=ht.onSnapComplete,Ut=ht.once,Bt=ht.snap,Vt=ht.pinReparent,Jt=ht.pinSpacer,Zt=ht.containerAnimation,te=ht.fastScrollEnd,ve=ht.preventOverlaps,Ae=e.horizontal||e.containerAnimation&&!1!==e.horizontal?O:D,Se=!yt&&0!==yt,xe=C(e.scroller||V),Ie=G.core.getCache(xe),Oe=$t(xe),Ce="fixed"===("pinType"in e?e.pinType:S(xe,"pinType")||Oe&&"fixed"),Me=[e.onEnter,e.onLeave,e.onEnterBack,e.onLeaveBack],Fe=Se&&e.toggleActions.split(" "),Ue="markers"in e?e.markers:Te.markers,Be=Oe?0:parseFloat(de(xe)["border"+Ae.p2+ce])||0,$e=this,je=e.onRefreshInit&&function(){return e.onRefreshInit($e)},He=function(t,e,r){var n=r.d,i=r.d2,s=r.a;return(s=S(t,"getBoundingClientRect"))?function(){return s()[n]}:function(){return(e?jt(i):t["client"+i])||0}}(xe,Oe,Ae),Ve=function(t,e){return!e||~A.indexOf(t)?Gt(t):function(){return er}}(xe,Oe),Ye=0,We=0,ze=0,Xe=M(xe,Ae);if($e._startClamp=$e._endClamp=!1,$e._dir=Ae,Dt*=45,$e.scroller=xe,$e.scroll=Zt?Zt.time.bind(Zt):Xe,o=Xe(),$e.vars=e,r=r||e.animation,"refreshPriority"in e&&(at=1,-9999===e.refreshPriority&&(Lt=$e)),Ie.tweenScroll=Ie.tweenScroll||{top:ar(xe,D),left:ar(xe,O)},$e.tweenTo=n=Ie.tweenScroll[Ae.p],$e.scrubDuration=function(t){(H=qt(t)&&t)?j?j.duration(t):j=G.to(r,{ease:"expo",totalProgress:"+=0",inherit:!1,duration:H,paused:!0,onComplete:function(){return Ct&&Ct($e)}}):(j&&j.progress(1).kill(),j=0)},r&&(r.vars.lazy=!1,r._initted&&!$e.isReverted||!1!==r.vars.immediateRender&&!1!==e.immediateRender&&r.duration()&&r.render(0,!0,!0),$e.animation=r.pause(),r.scrollTrigger=$e,$e.scrubDuration(yt),B=0,pt||(pt=r.vars.id)),Bt&&(Wt(Bt)&&!Bt.push||(Bt={snapTo:Bt}),"scrollBehavior"in q.style&&G.set(Oe?[q,Y]:xe,{scrollBehavior:"auto"}),E.forEach((function(t){return Yt(t)&&t.target===(Oe?K.scrollingElement||Y:xe)&&(t.smooth=!1)})),s=Yt(Bt.snapTo)?Bt.snapTo:"labels"===Bt.snapTo?function(t){return function(e){return G.utils.snap(me(t),e)}}(r):"labelsDirectional"===Bt.snapTo?(ot=r,function(t,e){return ye(me(ot))(t,e.direction)}):!1!==Bt.directional?function(t,e){return ye(Bt.snapTo)(t,xt()-We<500?0:e.direction)}:G.utils.snap(Bt.snapTo),W=Bt.duration||{min:.1,max:2},W=Wt(W)?Q(W.min,W.max):Q(W,W),z=G.delayedCall(Bt.delay||H/2||.1,(function(){var t=Xe(),e=xt()-We<500,i=n.tween;if(!(e||Math.abs($e.getVelocity())<10)||i||et||Ye===t)$e.isActive&&Ye!==t&&z.restart(!0);else{var o,a,u=(t-l)/m,h=r&&!Se?r.totalProgress():u,d=e?0:(h-$)/(xt()-J)*1e3||0,f=G.utils.clamp(-u,1-u,Qt(d/2)*d/.185),p=u+(!1===Bt.inertia?0:f),g=Bt,y=g.onStart,v=g.onInterrupt,b=g.onComplete;if(o=s(p,$e),qt(o)||(o=p),a=Math.max(0,Math.round(l+o*m)),t<=c&&t>=l&&a!==t){if(i&&!i._initted&&i.data<=Qt(a-t))return;!1===Bt.inertia&&(f=o-u),n(a,{duration:W(Qt(.185*Math.max(Qt(p-h),Qt(o-h))/d/.05||0)),ease:Bt.ease||"power3",data:Qt(a-t),onInterrupt:function(){return z.restart(!0)&&v&&v($e)},onComplete:function(){$e.update(),Ye=Xe(),r&&!Se&&(j?j.resetTo("totalProgress",o,r._tTime/r._tDur):r.progress(o)),B=$=r&&!Se?r.totalProgress():$e.progress,Mt&&Mt($e),b&&b($e)}},t,f*m,a-t-f*m),y&&y($e,n.tween)}}})).pause()),pt&&(Pe[pt]=$e),(st=(vt=$e.trigger=C(vt||!0!==bt&&bt))&&vt._gsap&&vt._gsap.stRevert)&&(st=st($e)),bt=!0===bt?vt:C(bt),Kt(ft)&&(ft={targets:vt,className:ft}),bt&&(!1===wt||wt===le||(wt=!(!wt&&bt.parentNode&&bt.parentNode.style&&"flex"===de(bt.parentNode).display)&&ae),$e.pin=bt,(i=G.core.getCache(bt)).spacer?y=i.pinState:(Jt&&((Jt=C(Jt))&&!Jt.nodeType&&(Jt=Jt.current||Jt.nativeElement),i.spacerIsNative=!!Jt,Jt&&(i.spacerState=tr(Jt))),i.spacer=w=Jt||K.createElement("div"),w.classList.add("pin-spacer"),pt&&w.classList.add("pin-spacer-"+pt),i.pinState=y=tr(bt)),!1!==e.force3D&&G.set(bt,{force3D:!0}),$e.spacer=w=i.spacer,U=de(bt),P=U[wt+Ae.os2],L=G.getProperty(bt),_=G.quickSetter(bt,Ae.a,he),Qe(bt,w,U),b=tr(bt)),Ue){p=Wt(Ue)?fe(Ue,we):we,d=_e("scroller-start",pt,xe,Ae,p,0),f=_e("scroller-end",pt,xe,Ae,p,0,d),T=d["offset"+Ae.op.d2];var Je=C(S(xe,"content")||xe);u=this.markerStart=_e("start",pt,Je,Ae,p,T,0,Zt),h=this.markerEnd=_e("end",pt,Je,Ae,p,T,0,Zt),Zt&&(it=G.quickSetter([u,h],Ae.a,he)),Ce||A.length&&!0===S(xe,"fixedMarkers")||(ut=de(ct=Oe?q:xe).position,ct.style.position="absolute"===ut||"fixed"===ut?ut:"relative",G.set([d,f],{force3D:!0}),R=G.quickSetter(d,Ae.a,he),F=G.quickSetter(f,Ae.a,he))}if(Zt){var nr=Zt.vars.onUpdate,sr=Zt.vars.onUpdateParams;Zt.eventCallback("onUpdate",(function(){$e.update(0,0,1),nr&&nr.apply(Zt,sr||[])}))}if($e.previous=function(){return ke[ke.indexOf($e)-1]},$e.next=function(){return ke[ke.indexOf($e)+1]},$e.revert=function(t,e){if(!e)return $e.kill(!0);var n=!1!==t||!$e.enabled,i=tt;n!==$e.isReverted&&(n&&(Z=Math.max(Xe(),$e.scroll.rec||0),ze=$e.progress,rt=r&&r.progress()),u&&[u,h,d,f].forEach((function(t){return t.style.display=n?"none":"block"})),n&&(tt=$e,$e.update(n)),!bt||Vt&&$e.isActive||(n?function(t,e,r){Ze(r);var n=t._gsap;if(n.spacerIsNative)Ze(n.spacerState);else if(t._gsap.swappedIn){var i=e.parentNode;i&&(i.insertBefore(t,e),i.removeChild(e))}t._gsap.swappedIn=!1}(bt,w,y):Qe(bt,w,de(bt),I)),n||$e.update(n),tt=i,$e.isReverted=n)},$e.refresh=function(i,s,p,E){if(!tt&&$e.enabled||s)if(bt&&i&&Pt)be(t,"scrollEnd",Ne);else{!Tt&&je&&je($e),tt=$e,n.tween&&!p&&(n.tween.kill(),n.tween=0),j&&j.pause(),kt&&r&&(r.revert({kill:!1}).invalidate(),r.getChildren&&r.getChildren(!0,!0,!1).forEach((function(t){return t.vars.immediateRender&&t.render(0,!0,!0)}))),$e.isReverted||$e.revert(!0,!0),$e._subPinOffset=!1;var A,T,S,_,P,R,F,U,B,$,H,V,W,X=He(),Q=Ve(),J=Zt?Zt.duration():Ht(xe,Ae),et=m<=.01||!m,nt=0,it=E||0,st=Wt(p)?p.end:e.end,ot=e.endTrigger||vt,at=Wt(p)?p.start:e.start||(0!==e.start&&vt?bt?"0 0":"0 100%":0),ct=$e.pinnedContainer=e.pinnedContainer&&C(e.pinnedContainer,$e),ut=vt&&Math.max(0,ke.indexOf($e))||0,ht=ut;for(Ue&&Wt(p)&&(V=G.getProperty(d,Ae.p),W=G.getProperty(f,Ae.p));ht-- >0;)(R=ke[ht]).end||R.refresh(0,1)||(tt=$e),!(F=R.pin)||F!==vt&&F!==bt&&F!==ct||R.isReverted||($||($=[]),$.unshift(R),R.revert(!0,!0)),R!==ke[ht]&&(ut--,ht--);for(Yt(at)&&(at=at($e)),at=Rt(at,"start",$e),l=rr(at,vt,X,Ae,Xe(),u,d,$e,Q,Be,Ce,J,Zt,$e._startClamp&&"_startClamp")||(bt?-.001:0),Yt(st)&&(st=st($e)),Kt(st)&&!st.indexOf("+=")&&(~st.indexOf(" ")?st=(Kt(at)?at.split(" ")[0]:"")+st:(nt=Le(st.substr(2),X),st=Kt(at)?at:(Zt?G.utils.mapRange(0,Zt.duration(),Zt.scrollTrigger.start,Zt.scrollTrigger.end,l):l)+nt,ot=vt)),st=Rt(st,"end",$e),c=Math.max(l,rr(st||(ot?"100% 0":J),ot,X,Ae,Xe()+nt,h,f,$e,Q,Be,Ce,J,Zt,$e._endClamp&&"_endClamp"))||-.001,nt=0,ht=ut;ht--;)(F=(R=ke[ht]).pin)&&R.start-R._pinPush<=l&&!Zt&&R.end>0&&(A=R.end-($e._startClamp?Math.max(0,R.start):R.start),(F===vt&&R.start-R._pinPush<l||F===ct)&&isNaN(at)&&(nt+=A*(1-R.progress)),F===bt&&(it+=A));if(l+=nt,c+=nt,$e._startClamp&&($e._startClamp+=nt),$e._endClamp&&!Tt&&($e._endClamp=c||-.001,c=Math.min(c,Ht(xe,Ae))),m=c-l||(l-=.01)&&.001,et&&(ze=G.utils.clamp(0,1,G.utils.normalize(l,c,Z))),$e._pinPush=it,u&&nt&&((A={})[Ae.a]="+="+nt,ct&&(A[Ae.p]="-="+Xe()),G.set([u,h],A)),!bt||Et&&$e.end>=Ht(xe,Ae)){if(vt&&Xe()&&!Zt)for(T=vt.parentNode;T&&T!==q;)T._pinOffset&&(l-=T._pinOffset,c-=T._pinOffset),T=T.parentNode}else A=de(bt),_=Ae===D,S=Xe(),x=parseFloat(L(Ae.a))+it,!J&&c>1&&(H={style:H=(Oe?K.scrollingElement||Y:xe).style,value:H["overflow"+Ae.a.toUpperCase()]},Oe&&"scroll"!==de(q)["overflow"+Ae.a.toUpperCase()]&&(H.style["overflow"+Ae.a.toUpperCase()]="scroll")),Qe(bt,w,A),b=tr(bt),T=pe(bt,!0),U=Ce&&M(xe,_?O:D)(),wt?((I=[wt+Ae.os2,m+it+he]).t=w,(ht=wt===ae?ge(bt,Ae)+m+it:0)&&(I.push(Ae.d,ht+he),"auto"!==w.style.flexBasis&&(w.style.flexBasis=ht+he)),Ze(I),ct&&ke.forEach((function(t){t.pin===ct&&!1!==t.vars.pinSpacing&&(t._subPinOffset=!0)})),Ce&&Xe(Z)):(ht=ge(bt,Ae))&&"auto"!==w.style.flexBasis&&(w.style.flexBasis=ht+he),Ce&&((P={top:T.top+(_?S-l:U)+he,left:T.left+(_?U:S-l)+he,boxSizing:"border-box",position:"fixed"})[ee]=P["max"+ce]=Math.ceil(T.width)+he,P[re]=P["max"+ue]=Math.ceil(T.height)+he,P[le]=P[le+se]=P[le+ne]=P[le+oe]=P[le+ie]="0",P[ae]=A[ae],P[ae+se]=A[ae+se],P[ae+ne]=A[ae+ne],P[ae+oe]=A[ae+oe],P[ae+ie]=A[ae+ie],v=function(t,e,r){for(var n,i=[],s=t.length,o=r?8:0;o<s;o+=2)n=t[o],i.push(n,n in e?e[n]:t[o+1]);return i.t=t.t,i}(y,P,Vt),Tt&&Xe(0)),r?(B=r._initted,lt(1),r.render(r.duration(),!0,!0),k=L(Ae.a)-x+m+it,N=Math.abs(m-k)>1,Ce&&N&&v.splice(v.length-2,2),r.render(0,!0,!0),B||r.invalidate(!0),r.parent||r.totalTime(r.totalTime()),lt(0)):k=m,H&&(H.value?H.style["overflow"+Ae.a.toUpperCase()]=H.value:H.style.removeProperty("overflow-"+Ae.a));$&&$.forEach((function(t){return t.revert(!1,!0)})),$e.start=l,$e.end=c,o=a=Tt?Z:Xe(),Zt||Tt||(o<Z&&Xe(Z),$e.scroll.rec=0),$e.revert(!1,!0),We=xt(),z&&(Ye=-1,z.restart(!0)),tt=0,r&&Se&&(r._initted||rt)&&r.progress()!==rt&&r.progress(rt||0,!0).render(r.time(),!0,!0),(et||ze!==$e.progress||Zt||kt||r&&!r._initted)&&(r&&!Se&&(r._initted||ze||!1!==r.vars.immediateRender)&&r.totalProgress(Zt&&l<-.001&&!ze?G.utils.normalize(l,c,0):ze,!0),$e.progress=et||(o-l)/m===ze?0:ze),bt&&wt&&(w._pinOffset=Math.round($e.progress*k)),j&&j.invalidate(),isNaN(V)||(V-=G.getProperty(d,Ae.p),W-=G.getProperty(f,Ae.p),or(d,Ae,V),or(u,Ae,V-(E||0)),or(f,Ae,W),or(h,Ae,W-(E||0))),et&&!Tt&&$e.update(),!mt||Tt||g||(g=!0,mt($e),g=!1)}},$e.getVelocity=function(){return(Xe()-a)/(xt()-J)*1e3||0},$e.endAnimation=function(){zt($e.callbackAnimation),r&&(j?j.progress(1):r.paused()?Se||zt(r,$e.direction<0,1):zt(r,r.reversed()))},$e.labelToScroll=function(t){return r&&r.labels&&(l||$e.refresh()||l)+r.labels[t]/r.duration()*m||0},$e.getTrailing=function(t){var e=ke.indexOf($e),r=$e.direction>0?ke.slice(0,e).reverse():ke.slice(e+1);return(Kt(t)?r.filter((function(e){return e.vars.preventOverlaps===t})):r).filter((function(t){return $e.direction>0?t.end<=l:t.start>=c}))},$e.update=function(t,e,i){if(!Zt||i||t){var s,u,h,f,p,g,y,E=!0===Tt?Z:$e.scroll(),A=t?0:(E-l)/m,T=A<0?0:A>1?1:A||0,S=$e.progress;if(e&&(a=o,o=Zt?Xe():E,Bt&&($=B,B=r&&!Se?r.totalProgress():T)),Dt&&bt&&!tt&&!_t&&Pt&&(!T&&l<E+(E-a)/(xt()-J)*Dt?T=1e-4:1===T&&c>E+(E-a)/(xt()-J)*Dt&&(T=.9999)),T!==S&&$e.enabled){if(f=(p=(s=$e.isActive=!!T&&T<1)!==(!!S&&S<1))||!!T!=!!S,$e.direction=T>S?1:-1,$e.progress=T,f&&!tt&&(u=T&&!S?0:1===T?1:1===S?2:3,Se&&(h=!p&&"none"!==Fe[u+1]&&Fe[u+1]||Fe[u],y=r&&("complete"===h||"reset"===h||h in r))),ve&&(p||y)&&(y||yt||!r)&&(Yt(ve)?ve($e):$e.getTrailing(ve).forEach((function(t){return t.endAnimation()}))),Se||(!j||tt||_t?r&&r.totalProgress(T,!(!tt||!We&&!t)):(j._dp._time-j._start!==j._time&&j.render(j._dp._time-j._start),j.resetTo?j.resetTo("totalProgress",T,r._tTime/r._tDur):(j.vars.totalProgress=T,j.invalidate().restart()))),bt)if(t&&wt&&(w.style[wt+Ae.os2]=P),Ce){if(f){if(g=!t&&T>S&&c+1>E&&E+1>=Ht(xe,Ae),Vt)if(t||!s&&!g)ir(bt,w);else{var L=pe(bt,!0),I=E-l;ir(bt,q,L.top+(Ae===D?I:0)+he,L.left+(Ae===D?0:I)+he)}Ze(s||g?v:b),N&&T<1&&s||_(x+(1!==T||g?0:k))}}else _(Ft(x+k*T));Bt&&!n.tween&&!tt&&!_t&&z.restart(!0),ft&&(p||Ut&&T&&(T<1||!At))&&X(ft.targets).forEach((function(t){return t.classList[s||Ut?"add":"remove"](ft.className)})),dt&&!Se&&!t&&dt($e),f&&!tt?(Se&&(y&&("complete"===h?r.pause().totalProgress(1):"reset"===h?r.restart(!0).pause():"restart"===h?r.restart(!0):r[h]()),dt&&dt($e)),!p&&At||(gt&&p&&Xt($e,gt),Me[u]&&Xt($e,Me[u]),Ut&&(1===T?$e.kill(!1,1):Me[u]=0),p||Me[u=1===T?1:3]&&Xt($e,Me[u])),te&&!s&&Math.abs($e.getVelocity())>(qt(te)?te:2500)&&(zt($e.callbackAnimation),j?j.progress(1):zt(r,"reverse"===h?1:!T,1))):Se&&dt&&!tt&&dt($e)}if(F){var O=Zt?E/Zt.duration()*(Zt._caScrollDist||0):E;R(O+(d._isFlipped?1:0)),F(O)}it&&it(-E/Zt.duration()*(Zt._caScrollDist||0))}},$e.enable=function(e,r){$e.enabled||($e.enabled=!0,be(xe,"resize",De),Oe||be(xe,"scroll",Re),je&&be(t,"refreshInit",je),!1!==e&&($e.progress=ze=0,o=a=Ye=Xe()),!1!==r&&$e.refresh())},$e.getTween=function(t){return t&&n?n.tween:j},$e.setPositions=function(t,e,r,n){if(Zt){var i=Zt.scrollTrigger,s=Zt.duration(),o=i.end-i.start;t=i.start+o*t/s,e=i.start+o*e/s}$e.refresh(!1,!1,{start:Ot(t,r&&!!$e._startClamp),end:Ot(e,r&&!!$e._endClamp)},n),$e.update()},$e.adjustPinSpacing=function(t){if(I&&t){var e=I.indexOf(Ae.d)+1;I[e]=parseFloat(I[e])+t+he,I[1]=parseFloat(I[1])+t+he,Ze(I)}},$e.disable=function(e,r){if($e.enabled&&(!1!==e&&$e.revert(!0,!0),$e.enabled=$e.isActive=!1,r||j&&j.pause(),Z=0,i&&(i.uncache=1),je&&Ee(t,"refreshInit",je),z&&(z.pause(),n.tween&&n.tween.kill()&&(n.tween=0)),!Oe)){for(var s=ke.length;s--;)if(ke[s].scroller===xe&&ke[s]!==$e)return;Ee(xe,"resize",De),Oe||Ee(xe,"scroll",Re)}},$e.kill=function(t,n){$e.disable(t,n),j&&!n&&j.kill(),pt&&delete Pe[pt];var s=ke.indexOf($e);s>=0&&ke.splice(s,1),s===nt&&qe>0&&nt--,s=0,ke.forEach((function(t){return t.scroller===$e.scroller&&(s=1)})),s||Tt||($e.scroll.rec=0),r&&(r.scrollTrigger=null,t&&r.revert({kill:!1}),n||r.kill()),u&&[u,h,d,f].forEach((function(t){return t.parentNode&&t.parentNode.removeChild(t)})),Lt===$e&&(Lt=0),bt&&(i&&(i.uncache=1),s=0,ke.forEach((function(t){return t.pin===bt&&s++})),s||(i.spacer=0)),e.onKill&&e.onKill($e)},ke.push($e),$e.enable(!1,!1),st&&st($e),r&&r.add&&!m){var lr=$e.update;$e.update=function(){$e.update=lr,E.cache++,l||c||$e.refresh()},G.delayedCall(.01,$e.update),m=.01,l=c=0}else $e.refresh();bt&&function(){if(St!==Ge){var t=St=Ge;requestAnimationFrame((function(){return t===Ge&&Ke(!0)}))}}()}else this.update=this.refresh=this.kill=Nt},t.register=function(e){return H||(G=e||Bt(),Ut()&&window.document&&t.enable(),H=It),H},t.defaults=function(t){if(t)for(var e in t)Te[e]=t[e];return Te},t.disable=function(t,e){It=0,ke.forEach((function(r){return r[e?"kill":"disable"](t)})),Ee(V,"wheel",Re),Ee(K,"scroll",Re),clearInterval(Z),Ee(K,"touchcancel",Nt),Ee(q,"touchstart",Nt),ve(Ee,K,"pointerdown,touchstart,mousedown",Ct),ve(Ee,K,"pointerup,touchend,mouseup",Mt),z.kill(),Vt(Ee);for(var r=0;r<E.length;r+=3)Ae(Ee,E[r],E[r+1]),Ae(Ee,E[r],E[r+2])},t.enable=function(){if(V=window,K=document,Y=K.documentElement,q=K.body,G&&(X=G.utils.toArray,Q=G.utils.clamp,gt=G.core.context||Nt,lt=G.core.suppressOverwrites||Nt,mt=V.history.scrollRestoration||"auto",Ye=V.pageYOffset||0,G.core.globals("ScrollTrigger",t),q)){It=1,(yt=document.createElement("div")).style.height="100vh",yt.style.position="absolute",He(),Dt(),j.register(G),t.isTouch=j.isTouch,pt=j.isTouch&&/(iPad|iPhone|iPod|Mac)/g.test(navigator.userAgent),ht=1===j.isTouch,be(V,"wheel",Re),W=[V,K,Y,q],G.matchMedia&&(t.matchMedia=function(t){var e,r=G.matchMedia();for(e in t)r.add(e,t[e]);return r},G.addEventListener("matchMediaInit",(function(){return $e()})),G.addEventListener("matchMediaRevert",(function(){return Be()})),G.addEventListener("matchMedia",(function(){Ke(0,1),Fe("matchMedia")})),G.matchMedia().add("(orientation: portrait)",(function(){return Oe(),Oe}))),Oe(),be(K,"scroll",Re);var e,r,n=q.hasAttribute("style"),i=q.style,s=i.borderTopStyle,o=G.core.Animation.prototype;for(o.revert||Object.defineProperty(o,"revert",{value:function(){return this.time(-.01,!0)}}),i.borderTopStyle="solid",e=pe(q),D.m=Math.round(e.top+D.sc())||0,O.m=Math.round(e.left+O.sc())||0,s?i.borderTopStyle=s:i.removeProperty("border-top-style"),n||(q.setAttribute("style",""),q.removeAttribute("style")),Z=setInterval(Ie,250),G.delayedCall(.5,(function(){return _t=0})),be(K,"touchcancel",Nt),be(q,"touchstart",Nt),ve(be,K,"pointerdown,touchstart,mousedown",Ct),ve(be,K,"pointerup,touchend,mouseup",Mt),rt=G.utils.checkPrefix("transform"),Xe.push(rt),H=xt(),z=G.delayedCall(.2,Ke).pause(),ot=[K,"visibilitychange",function(){var t=V.innerWidth,e=V.innerHeight;K.hidden?(it=t,st=e):it===t&&st===e||De()},K,"DOMContentLoaded",Ke,V,"load",Ke,V,"resize",De],Vt(be),ke.forEach((function(t){return t.enable(0,1)})),r=0;r<E.length;r+=3)Ae(Ee,E[r],E[r+1]),Ae(Ee,E[r],E[r+2])}},t.config=function(e){"limitCallbacks"in e&&(At=!!e.limitCallbacks);var r=e.syncInterval;r&&clearInterval(Z)||(Z=r)&&setInterval(Ie,r),"ignoreMobileResize"in e&&(ht=1===t.isTouch&&e.ignoreMobileResize),"autoRefreshEvents"in e&&(Vt(Ee)||Vt(be,e.autoRefreshEvents||"none"),ct=-1===(e.autoRefreshEvents+"").indexOf("resize"))},t.scrollerProxy=function(t,e){var r=C(t),n=E.indexOf(r),i=$t(r);~n&&E.splice(n,i?6:2),e&&(i?A.unshift(V,e,q,e,Y,e):A.unshift(r,e))},t.clearMatchMedia=function(t){ke.forEach((function(e){return e._ctx&&e._ctx.query===t&&e._ctx.kill(!0,!0)}))},t.isInViewport=function(t,e,r){var n=(Kt(t)?C(t):t).getBoundingClientRect(),i=n[r?ee:re]*e||0;return r?n.right-i>0&&n.left+i<V.innerWidth:n.bottom-i>0&&n.top+i<V.innerHeight},t.positionInViewport=function(t,e,r){Kt(t)&&(t=C(t));var n=t.getBoundingClientRect(),i=n[r?ee:re],s=null==e?i/2:e in Se?Se[e]*i:~e.indexOf("%")?parseFloat(e)*i/100:parseFloat(e)||0;return r?(n.left+s)/V.innerWidth:(n.top+s)/V.innerHeight},t.killAll=function(t){if(ke.slice(0).forEach((function(t){return"ScrollSmoother"!==t.vars.id&&t.kill()})),!0!==t){var e=Ce.killAll||[];Ce={},e.forEach((function(t){return t()}))}},t}();lr.version="3.13.0",lr.saveStyles=function(t){return t?X(t).forEach((function(t){if(t&&t.style){var e=Ue.indexOf(t);e>=0&&Ue.splice(e,5),Ue.push(t,t.style.cssText,t.getBBox&&t.getAttribute("transform"),G.core.getCache(t),gt())}})):Ue},lr.revert=function(t,e){return $e(!t,e)},lr.create=function(t,e){return new lr(t,e)},lr.refresh=function(t){return t?De(!0):(H||lr.register())&&Ke(!0)},lr.update=function(t){return++E.cache&&We(!0===t?2:0)},lr.clearScrollMemory=je,lr.maxScroll=function(t,e){return Ht(t,e?O:D)},lr.getScrollFunc=function(t,e){return M(C(t),e?O:D)},lr.getById=function(t){return Pe[t]},lr.getAll=function(){return ke.filter((function(t){return"ScrollSmoother"!==t.vars.id}))},lr.isScrolling=function(){return!!Pt},lr.snapDirectional=ye,lr.addEventListener=function(t,e){var r=Ce[t]||(Ce[t]=[]);~r.indexOf(e)||r.push(e)},lr.removeEventListener=function(t,e){var r=Ce[t],n=r&&r.indexOf(e);n>=0&&r.splice(n,1)},lr.batch=function(t,e){var r,n=[],i={},s=e.interval||.016,o=e.batchMax||1e9,a=function(t,e){var r=[],n=[],i=G.delayedCall(s,(function(){e(r,n),r=[],n=[]})).pause();return function(t){r.length||i.restart(!0),r.push(t.trigger),n.push(t),o<=r.length&&i.progress(1)}};for(r in e)i[r]="on"===r.substr(0,2)&&Yt(e[r])&&"onRefreshInit"!==r?a(0,e[r]):e[r];return Yt(o)&&(o=o(),be(lr,"refresh",(function(){return o=e.batchMax()}))),X(t).forEach((function(t){var e={};for(r in i)e[r]=i[r];e.trigger=t,n.push(lr.create(e))})),n};var cr,ur=function(t,e,r,n){return e>n?t(n):e<0&&t(0),r>n?(n-e)/(r-e):r<0?e/(e-r):1},hr=function t(e,r){!0===r?e.style.removeProperty("touch-action"):e.style.touchAction=!0===r?"auto":r?"pan-"+r+(j.isTouch?" pinch-zoom":""):"none",e===Y&&t(q,r)},dr={auto:1,scroll:1},fr=function(t){var e,r=t.event,n=t.target,i=t.axis,s=(r.changedTouches?r.changedTouches[0]:r).target,o=s._gsap||G.core.getCache(s),a=xt();if(!o._isScrollT||a-o._isScrollT>2e3){for(;s&&s!==q&&(s.scrollHeight<=s.clientHeight&&s.scrollWidth<=s.clientWidth||!dr[(e=de(s)).overflowY]&&!dr[e.overflowX]);)s=s.parentNode;o._isScroll=s&&s!==n&&!$t(s)&&(dr[(e=de(s)).overflowY]||dr[e.overflowX]),o._isScrollT=a}(o._isScroll||"x"===i)&&(r.stopPropagation(),r._gsapAllow=!0)},pr=function(t,e,r,n){return j.create({target:t,capture:!0,debounce:!1,lockAxis:!0,type:e,onWheel:n=n&&fr,onPress:n,onDrag:n,onScroll:n,onEnable:function(){return r&&be(K,j.eventTypes[0],mr,!1,!0)},onDisable:function(){return Ee(K,j.eventTypes[0],mr,!0)}})},gr=/(input|label|select|textarea)/i,mr=function(t){var e=gr.test(t.target.tagName);(e||cr)&&(t._gsapAllow=!0,cr=e)},yr=function(t){Wt(t)||(t={}),t.preventDefault=t.isNormalizer=t.allowClicks=!0,t.type||(t.type="wheel,touch"),t.debounce=!!t.debounce,t.id=t.id||"normalizer";var e,r,n,i,s,o,a,l,c=t,u=c.normalizeScrollX,h=c.momentum,d=c.allowNestedScroll,f=c.onRelease,p=C(t.target)||Y,g=G.core.globals().ScrollSmoother,m=g&&g.get(),y=pt&&(t.content&&C(t.content)||m&&!1!==t.content&&!m.smooth()&&m.content()),v=M(p,D),b=M(p,O),A=1,w=(j.isTouch&&V.visualViewport?V.visualViewport.scale*V.visualViewport.width:V.outerWidth)/V.innerWidth,T=0,S=Yt(h)?function(){return h(e)}:function(){return h||2.8},L=pr(p,t.type,!0,d),_=function(){return i=!1},x=Nt,k=Nt,P=function(){r=Ht(p,D),k=Q(pt?1:0,r),u&&(x=Q(0,Ht(p,O))),n=Ge},I=function(){y._gsap.y=Ft(parseFloat(y._gsap.y)+v.offset)+"px",y.style.transform="matrix3d(1, 0, 0, 0, 0, 1, 0, 0, 0, 0, 1, 0, 0, "+parseFloat(y._gsap.y)+", 0, 1)",v.offset=v.cacheID=0},R=function(){P(),s.isActive()&&s.vars.scrollY>r&&(v()>r?s.progress(1)&&v(r):s.resetTo("scrollY",r))};return y&&G.set(y,{y:"+=0"}),t.ignoreCheck=function(t){return pt&&"touchmove"===t.type&&function(){if(i){requestAnimationFrame(_);var t=Ft(e.deltaY/2),r=k(v.v-t);if(y&&r!==v.v+v.offset){v.offset=r-v.v;var n=Ft((parseFloat(y&&y._gsap.y)||0)-v.offset);y.style.transform="matrix3d(1, 0, 0, 0, 0, 1, 0, 0, 0, 0, 1, 0, 0, "+n+", 0, 1)",y._gsap.y=n+"px",v.cacheID=E.cache,We()}return!0}v.offset&&I(),i=!0}()||A>1.05&&"touchstart"!==t.type||e.isGesturing||t.touches&&t.touches.length>1},t.onPress=function(){i=!1;var t=A;A=Ft((V.visualViewport&&V.visualViewport.scale||1)/w),s.pause(),t!==A&&hr(p,A>1.01||!u&&"x"),o=b(),a=v(),P(),n=Ge},t.onRelease=t.onGestureStart=function(t,e){if(v.offset&&I(),e){E.cache++;var n,i,o=S();u&&(i=(n=b())+.05*o*-t.velocityX/.227,o*=ur(b,n,i,Ht(p,O)),s.vars.scrollX=x(i)),i=(n=v())+.05*o*-t.velocityY/.227,o*=ur(v,n,i,Ht(p,D)),s.vars.scrollY=k(i),s.invalidate().duration(o).play(.01),(pt&&s.vars.scrollY>=r||n>=r-1)&&G.to({},{onUpdate:R,duration:o})}else l.restart(!0);f&&f(t)},t.onWheel=function(){s._ts&&s.pause(),xt()-T>1e3&&(n=0,T=xt())},t.onChange=function(t,e,r,i,s){if(Ge!==n&&P(),e&&u&&b(x(i[2]===e?o+(t.startX-t.x):b()+e-i[1])),r){v.offset&&I();var l=s[2]===r,c=l?a+t.startY-t.y:v()+r-s[1],h=k(c);l&&c!==h&&(a+=h-c),v(h)}(r||e)&&We()},t.onEnable=function(){hr(p,!u&&"x"),lr.addEventListener("refresh",R),be(V,"resize",R),v.smooth&&(v.target.style.scrollBehavior="auto",v.smooth=b.smooth=!1),L.enable()},t.onDisable=function(){hr(p,!0),Ee(V,"resize",R),lr.removeEventListener("refresh",R),L.kill()},t.lockAxis=!1!==t.lockAxis,(e=new j(t)).iOS=pt,pt&&!v()&&v(1),pt&&G.ticker.add(Nt),l=e._dc,s=G.to(e,{ease:"power4",paused:!0,inherit:!1,scrollX:u?"+=0.1":"+=0",scrollY:"+=0.1",modifiers:{scrollY:sr(v,v(),(function(){return s.pause()}))},onUpdate:We,onComplete:l.vars.onComplete}),e};lr.sort=function(t){if(Yt(t))return ke.sort(t);var e=V.pageYOffset||0;return lr.getAll().forEach((function(t){return t._sortY=t.trigger?e+t.trigger.getBoundingClientRect().top:t.start+V.innerHeight})),ke.sort(t||function(t,e){return-1e6*(t.vars.refreshPriority||0)+(t.vars.containerAnimation?1e6:t._sortY)-((e.vars.containerAnimation?1e6:e._sortY)+-1e6*(e.vars.refreshPriority||0))})},lr.observe=function(t){return new j(t)},lr.normalizeScroll=function(t){if(void 0===t)return ut;if(!0===t&&ut)return ut.enable();if(!1===t)return ut&&ut.kill(),void(ut=t);var e=t instanceof j?t:yr(t);return ut&&ut.target===e.target&&ut.kill(),$t(e.target)&&(ut=e),e},lr.core={_getVelocityProp:N,_inputObserver:pr,_scrollers:E,_proxies:A,bridge:{ss:function(){Pt||Fe("scrollStart"),Pt=xt()},ref:function(){return tt}}},Bt()&&G.registerPlugin(lr)},8607:(t,e,r)=>{"use strict";function n(t){if(void 0===t)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return t}function i(t,e){t.prototype=Object.create(e.prototype),t.prototype.constructor=t,t.__proto__=e}r.d(e,{B0:()=>yt,Dx:()=>sr,E_:()=>gt,J7:()=>pr,Ks:()=>V,OF:()=>D,St:()=>fr,Uc:()=>xe,Vy:()=>de,Yz:()=>E,Zm:()=>We,a0:()=>dt,au:()=>ke,dg:()=>X,fA:()=>pt,l1:()=>lr,l_:()=>te,n:()=>ft,n6:()=>je,os:()=>xr,qA:()=>Le,vM:()=>G,vQ:()=>I,vX:()=>j,wU:()=>ot});var s,o,a,l,c,u,h,d,f,p,g,m,y,v,b,E={autoSleep:120,force3D:"auto",nullTargetWarn:1,units:{lineHeight:""}},A={duration:.5,overwrite:!1,delay:0},w=1e8,T=1/w,S=2*Math.PI,L=S/4,_=0,x=Math.sqrt,k=Math.cos,P=Math.sin,I=function(t){return"string"==typeof t},R=function(t){return"function"==typeof t},O=function(t){return"number"==typeof t},D=function(t){return void 0===t},C=function(t){return"object"==typeof t},M=function(t){return!1!==t},N=function(){return"undefined"!=typeof window},F=function(t){return R(t)||I(t)},U="function"==typeof ArrayBuffer&&ArrayBuffer.isView||function(){},B=Array.isArray,$=/(?:-?\.?\d|\.)+/gi,j=/[-+=.]*\d+[.e\-+]*\d*[e\-+]*\d*/g,G=/[-+=.]*\d+[.e-]*\d*[a-z%]*/g,H=/[-+=.]*\d+\.?\d*(?:e-|e\+)?\d*/gi,V=/[+-]=-?[.\d]+/,K=/[^,'"\[\]\s]+/gi,Y=/^[+\-=e\s\d]*\d+[.\d]*([a-z]*|%)\s*$/i,q={},W={},z=function(t){return(W=Lt(t,q))&&xr},X=function(t,e){},Q=function(t,e){return!e&&void 0},J=function(t,e){return t&&(q[t]=e)&&W&&(W[t]=e)||q},Z=function(){return 0},tt={suppressEvents:!0,isStart:!0,kill:!1},et={suppressEvents:!0,kill:!1},rt={suppressEvents:!0},nt={},it=[],st={},ot={},at={},lt=30,ct=[],ut="",ht=function(t){var e,r,n=t[0];if(C(n)||R(n)||(t=[t]),!(e=(n._gsap||{}).harness)){for(r=ct.length;r--&&!ct[r].targetTest(n););e=ct[r]}for(r=t.length;r--;)t[r]&&(t[r]._gsap||(t[r]._gsap=new je(t[r],e)))||t.splice(r,1);return t},dt=function(t){return t._gsap||ht(ie(t))[0]._gsap},ft=function(t,e,r){return(r=t[e])&&R(r)?t[e]():D(r)&&t.getAttribute&&t.getAttribute(e)||r},pt=function(t,e){return(t=t.split(",")).forEach(e)||t},gt=function(t){return Math.round(1e5*t)/1e5||0},mt=function(t){return Math.round(1e7*t)/1e7||0},yt=function(t,e){var r=e.charAt(0),n=parseFloat(e.substr(2));return t=parseFloat(t),"+"===r?t+n:"-"===r?t-n:"*"===r?t*n:t/n},vt=function(t,e){for(var r=e.length,n=0;t.indexOf(e[n])<0&&++n<r;);return n<r},bt=function(){var t,e,r=it.length,n=it.slice(0);for(st={},it.length=0,t=0;t<r;t++)(e=n[t])&&e._lazy&&(e.render(e._lazy[0],e._lazy[1],!0)._lazy=0)},Et=function(t){return!!(t._initted||t._startAt||t.add)},At=function(t,e,r,n){it.length&&!o&&bt(),t.render(e,r,n||!!(o&&e<0&&Et(t))),it.length&&!o&&bt()},wt=function(t){var e=parseFloat(t);return(e||0===e)&&(t+"").match(K).length<2?e:I(t)?t.trim():t},Tt=function(t){return t},St=function(t,e){for(var r in e)r in t||(t[r]=e[r]);return t},Lt=function(t,e){for(var r in e)t[r]=e[r];return t},_t=function t(e,r){for(var n in r)"__proto__"!==n&&"constructor"!==n&&"prototype"!==n&&(e[n]=C(r[n])?t(e[n]||(e[n]={}),r[n]):r[n]);return e},xt=function(t,e){var r,n={};for(r in t)r in e||(n[r]=t[r]);return n},kt=function(t){var e,r=t.parent||l,n=t.keyframes?(e=B(t.keyframes),function(t,r){for(var n in r)n in t||"duration"===n&&e||"ease"===n||(t[n]=r[n])}):St;if(M(t.inherit))for(;r;)n(t,r.vars.defaults),r=r.parent||r._dp;return t},Pt=function(t,e,r,n,i){void 0===r&&(r="_first"),void 0===n&&(n="_last");var s,o=t[n];if(i)for(s=e[i];o&&o[i]>s;)o=o._prev;return o?(e._next=o._next,o._next=e):(e._next=t[r],t[r]=e),e._next?e._next._prev=e:t[n]=e,e._prev=o,e.parent=e._dp=t,e},It=function(t,e,r,n){void 0===r&&(r="_first"),void 0===n&&(n="_last");var i=e._prev,s=e._next;i?i._next=s:t[r]===e&&(t[r]=s),s?s._prev=i:t[n]===e&&(t[n]=i),e._next=e._prev=e.parent=null},Rt=function(t,e){t.parent&&(!e||t.parent.autoRemoveChildren)&&t.parent.remove&&t.parent.remove(t),t._act=0},Ot=function(t,e){if(t&&(!e||e._end>t._dur||e._start<0))for(var r=t;r;)r._dirty=1,r=r.parent;return t},Dt=function(t){for(var e=t.parent;e&&e.parent;)e._dirty=1,e.totalDuration(),e=e.parent;return t},Ct=function(t,e,r,n){return t._startAt&&(o?t._startAt.revert(et):t.vars.immediateRender&&!t.vars.autoRevert||t._startAt.render(e,!0,n))},Mt=function t(e){return!e||e._ts&&t(e.parent)},Nt=function(t){return t._repeat?Ft(t._tTime,t=t.duration()+t._rDelay)*t:0},Ft=function(t,e){var r=Math.floor(t=mt(t/e));return t&&r===t?r-1:r},Ut=function(t,e){return(t-e._start)*e._ts+(e._ts>=0?0:e._dirty?e.totalDuration():e._tDur)},Bt=function(t){return t._end=mt(t._start+(t._tDur/Math.abs(t._ts||t._rts||T)||0))},$t=function(t,e){var r=t._dp;return r&&r.smoothChildTiming&&t._ts&&(t._start=mt(r._time-(t._ts>0?e/t._ts:((t._dirty?t.totalDuration():t._tDur)-e)/-t._ts)),Bt(t),r._dirty||Ot(r,t)),t},jt=function(t,e){var r;if((e._time||!e._dur&&e._initted||e._start<t._time&&(e._dur||!e.add))&&(r=Ut(t.rawTime(),e),(!e._dur||Zt(0,e.totalDuration(),r)-e._tTime>T)&&e.render(r,!0)),Ot(t,e)._dp&&t._initted&&t._time>=t._dur&&t._ts){if(t._dur<t.duration())for(r=t;r._dp;)r.rawTime()>=0&&r.totalTime(r._tTime),r=r._dp;t._zTime=-T}},Gt=function(t,e,r,n){return e.parent&&Rt(e),e._start=mt((O(r)?r:r||t!==l?Xt(t,r,e):t._time)+e._delay),e._end=mt(e._start+(e.totalDuration()/Math.abs(e.timeScale())||0)),Pt(t,e,"_first","_last",t._sort?"_start":0),Yt(e)||(t._recent=e),n||jt(t,e),t._ts<0&&$t(t,t._tTime),t},Ht=function(t,e){return(q.ScrollTrigger||X("scrollTrigger",e))&&q.ScrollTrigger.create(e,t)},Vt=function(t,e,r,n,i){return ze(t,e,i),t._initted?!r&&t._pt&&!o&&(t._dur&&!1!==t.vars.lazy||!t._dur&&t.vars.lazy)&&f!==ke.frame?(it.push(t),t._lazy=[i,n],1):void 0:1},Kt=function t(e){var r=e.parent;return r&&r._ts&&r._initted&&!r._lock&&(r.rawTime()<0||t(r))},Yt=function(t){var e=t.data;return"isFromStart"===e||"isStart"===e},qt=function(t,e,r,n){var i=t._repeat,s=mt(e)||0,o=t._tTime/t._tDur;return o&&!n&&(t._time*=s/t._dur),t._dur=s,t._tDur=i?i<0?1e10:mt(s*(i+1)+t._rDelay*i):s,o>0&&!n&&$t(t,t._tTime=t._tDur*o),t.parent&&Bt(t),r||Ot(t.parent,t),t},Wt=function(t){return t instanceof He?Ot(t):qt(t,t._dur)},zt={_start:0,endTime:Z,totalDuration:Z},Xt=function t(e,r,n){var i,s,o,a=e.labels,l=e._recent||zt,c=e.duration()>=w?l.endTime(!1):e._dur;return I(r)&&(isNaN(r)||r in a)?(s=r.charAt(0),o="%"===r.substr(-1),i=r.indexOf("="),"<"===s||">"===s?(i>=0&&(r=r.replace(/=/,"")),("<"===s?l._start:l.endTime(l._repeat>=0))+(parseFloat(r.substr(1))||0)*(o?(i<0?l:n).totalDuration()/100:1)):i<0?(r in a||(a[r]=c),a[r]):(s=parseFloat(r.charAt(i-1)+r.substr(i+1)),o&&n&&(s=s/100*(B(n)?n[0]:n).totalDuration()),i>1?t(e,r.substr(0,i-1),n)+s:c+s)):null==r?c:+r},Qt=function(t,e,r){var n,i,s=O(e[1]),o=(s?2:1)+(t<2?0:1),a=e[o];if(s&&(a.duration=e[1]),a.parent=r,t){for(n=a,i=r;i&&!("immediateRender"in n);)n=i.vars.defaults||{},i=M(i.vars.inherit)&&i.parent;a.immediateRender=M(n.immediateRender),t<2?a.runBackwards=1:a.startAt=e[o-1]}return new tr(e[0],a,e[o+1])},Jt=function(t,e){return t||0===t?e(t):e},Zt=function(t,e,r){return r<t?t:r>e?e:r},te=function(t,e){return I(t)&&(e=Y.exec(t))?e[1]:""},ee=[].slice,re=function(t,e){return t&&C(t)&&"length"in t&&(!e&&!t.length||t.length-1 in t&&C(t[0]))&&!t.nodeType&&t!==c},ne=function(t,e,r){return void 0===r&&(r=[]),t.forEach((function(t){var n;return I(t)&&!e||re(t,1)?(n=r).push.apply(n,ie(t)):r.push(t)}))||r},ie=function(t,e,r){return a&&!e&&a.selector?a.selector(t):!I(t)||r||!u&&Pe()?B(t)?ne(t,r):re(t)?ee.call(t,0):t?[t]:[]:ee.call((e||h).querySelectorAll(t),0)},se=function(t){return t=ie(t)[0]||Q("Invalid scope")||{},function(e){var r=t.current||t.nativeElement||t;return ie(e,r.querySelectorAll?r:r===t?Q("Invalid scope")||h.createElement("div"):t)}},oe=function(t){return t.sort((function(){return.5-Math.random()}))},ae=function(t){if(R(t))return t;var e=C(t)?t:{each:t},r=Ne(e.ease),n=e.from||0,i=parseFloat(e.base)||0,s={},o=n>0&&n<1,a=isNaN(n)||o,l=e.axis,c=n,u=n;return I(n)?c=u={center:.5,edges:.5,end:1}[n]||0:!o&&a&&(c=n[0],u=n[1]),function(t,o,h){var d,f,p,g,m,y,v,b,E,A=(h||e).length,T=s[A];if(!T){if(!(E="auto"===e.grid?0:(e.grid||[1,w])[1])){for(v=-w;v<(v=h[E++].getBoundingClientRect().left)&&E<A;);E<A&&E--}for(T=s[A]=[],d=a?Math.min(E,A)*c-.5:n%E,f=E===w?0:a?A*u/E-.5:n/E|0,v=0,b=w,y=0;y<A;y++)p=y%E-d,g=f-(y/E|0),T[y]=m=l?Math.abs("y"===l?g:p):x(p*p+g*g),m>v&&(v=m),m<b&&(b=m);"random"===n&&oe(T),T.max=v-b,T.min=b,T.v=A=(parseFloat(e.amount)||parseFloat(e.each)*(E>A?A-1:l?"y"===l?A/E:E:Math.max(E,A/E))||0)*("edges"===n?-1:1),T.b=A<0?i-A:i,T.u=te(e.amount||e.each)||0,r=r&&A<0?Ce(r):r}return A=(T[t]-T.min)/T.max||0,mt(T.b+(r?r(A):A)*T.v)+T.u}},le=function(t){var e=Math.pow(10,((t+"").split(".")[1]||"").length);return function(r){var n=mt(Math.round(parseFloat(r)/t)*t*e);return(n-n%1)/e+(O(r)?0:te(r))}},ce=function(t,e){var r,n,i=B(t);return!i&&C(t)&&(r=i=t.radius||w,t.values?(t=ie(t.values),(n=!O(t[0]))&&(r*=r)):t=le(t.increment)),Jt(e,i?R(t)?function(e){return n=t(e),Math.abs(n-e)<=r?n:e}:function(e){for(var i,s,o=parseFloat(n?e.x:e),a=parseFloat(n?e.y:0),l=w,c=0,u=t.length;u--;)(i=n?(i=t[u].x-o)*i+(s=t[u].y-a)*s:Math.abs(t[u]-o))<l&&(l=i,c=u);return c=!r||l<=r?t[c]:e,n||c===e||O(e)?c:c+te(e)}:le(t))},ue=function(t,e,r,n){return Jt(B(t)?!e:!0===r?!!(r=0):!n,(function(){return B(t)?t[~~(Math.random()*t.length)]:(r=r||1e-5)&&(n=r<1?Math.pow(10,(r+"").length-2):1)&&Math.floor(Math.round((t-r/2+Math.random()*(e-t+.99*r))/r)*r*n)/n}))},he=function(t,e,r){return Jt(r,(function(r){return t[~~e(r)]}))},de=function(t){for(var e,r,n,i,s=0,o="";~(e=t.indexOf("random(",s));)n=t.indexOf(")",e),i="["===t.charAt(e+7),r=t.substr(e+7,n-e-7).match(i?K:$),o+=t.substr(s,e-s)+ue(i?r:+r[0],i?0:+r[1],+r[2]||1e-5),s=n+1;return o+t.substr(s,t.length-s)},fe=function(t,e,r,n,i){var s=e-t,o=n-r;return Jt(i,(function(e){return r+((e-t)/s*o||0)}))},pe=function(t,e,r){var n,i,s,o=t.labels,a=w;for(n in o)(i=o[n]-e)<0==!!r&&i&&a>(i=Math.abs(i))&&(s=n,a=i);return s},ge=function(t,e,r){var n,i,s,o=t.vars,l=o[e],c=a,u=t._ctx;if(l)return n=o[e+"Params"],i=o.callbackScope||t,r&&it.length&&bt(),u&&(a=u),s=n?l.apply(i,n):l.call(i),a=c,s},me=function(t){return Rt(t),t.scrollTrigger&&t.scrollTrigger.kill(!!o),t.progress()<1&&ge(t,"onInterrupt"),t},ye=[],ve=function(t){if(t)if(t=!t.name&&t.default||t,N()||t.headless){var e=t.name,r=R(t),n=e&&!r&&t.init?function(){this._props=[]}:t,i={init:Z,render:cr,add:qe,kill:hr,modifier:ur,rawVars:0},s={targetTest:0,get:0,getSetter:sr,aliases:{},register:0};if(Pe(),t!==n){if(ot[e])return;St(n,St(xt(t,i),s)),Lt(n.prototype,Lt(i,xt(t,s))),ot[n.prop=e]=n,t.targetTest&&(ct.push(n),nt[e]=1),e=("css"===e?"CSS":e.charAt(0).toUpperCase()+e.substr(1))+"Plugin"}J(e,n),t.register&&t.register(xr,n,pr)}else ye.push(t)},be=255,Ee={aqua:[0,be,be],lime:[0,be,0],silver:[192,192,192],black:[0,0,0],maroon:[128,0,0],teal:[0,128,128],blue:[0,0,be],navy:[0,0,128],white:[be,be,be],olive:[128,128,0],yellow:[be,be,0],orange:[be,165,0],gray:[128,128,128],purple:[128,0,128],green:[0,128,0],red:[be,0,0],pink:[be,192,203],cyan:[0,be,be],transparent:[be,be,be,0]},Ae=function(t,e,r){return(6*(t+=t<0?1:t>1?-1:0)<1?e+(r-e)*t*6:t<.5?r:3*t<2?e+(r-e)*(2/3-t)*6:e)*be+.5|0},we=function(t,e,r){var n,i,s,o,a,l,c,u,h,d,f=t?O(t)?[t>>16,t>>8&be,t&be]:0:Ee.black;if(!f){if(","===t.substr(-1)&&(t=t.substr(0,t.length-1)),Ee[t])f=Ee[t];else if("#"===t.charAt(0)){if(t.length<6&&(n=t.charAt(1),i=t.charAt(2),s=t.charAt(3),t="#"+n+n+i+i+s+s+(5===t.length?t.charAt(4)+t.charAt(4):"")),9===t.length)return[(f=parseInt(t.substr(1,6),16))>>16,f>>8&be,f&be,parseInt(t.substr(7),16)/255];f=[(t=parseInt(t.substr(1),16))>>16,t>>8&be,t&be]}else if("hsl"===t.substr(0,3))if(f=d=t.match($),e){if(~t.indexOf("="))return f=t.match(j),r&&f.length<4&&(f[3]=1),f}else o=+f[0]%360/360,a=+f[1]/100,n=2*(l=+f[2]/100)-(i=l<=.5?l*(a+1):l+a-l*a),f.length>3&&(f[3]*=1),f[0]=Ae(o+1/3,n,i),f[1]=Ae(o,n,i),f[2]=Ae(o-1/3,n,i);else f=t.match($)||Ee.transparent;f=f.map(Number)}return e&&!d&&(n=f[0]/be,i=f[1]/be,s=f[2]/be,l=((c=Math.max(n,i,s))+(u=Math.min(n,i,s)))/2,c===u?o=a=0:(h=c-u,a=l>.5?h/(2-c-u):h/(c+u),o=c===n?(i-s)/h+(i<s?6:0):c===i?(s-n)/h+2:(n-i)/h+4,o*=60),f[0]=~~(o+.5),f[1]=~~(100*a+.5),f[2]=~~(100*l+.5)),r&&f.length<4&&(f[3]=1),f},Te=function(t){var e=[],r=[],n=-1;return t.split(Le).forEach((function(t){var i=t.match(G)||[];e.push.apply(e,i),r.push(n+=i.length+1)})),e.c=r,e},Se=function(t,e,r){var n,i,s,o,a="",l=(t+a).match(Le),c=e?"hsla(":"rgba(",u=0;if(!l)return t;if(l=l.map((function(t){return(t=we(t,e,1))&&c+(e?t[0]+","+t[1]+"%,"+t[2]+"%,"+t[3]:t.join(","))+")"})),r&&(s=Te(t),(n=r.c).join(a)!==s.c.join(a)))for(o=(i=t.replace(Le,"1").split(G)).length-1;u<o;u++)a+=i[u]+(~n.indexOf(u)?l.shift()||c+"0,0,0,0)":(s.length?s:l.length?l:r).shift());if(!i)for(o=(i=t.split(Le)).length-1;u<o;u++)a+=i[u]+l[u];return a+i[o]},Le=function(){var t,e="(?:\\b(?:(?:rgb|rgba|hsl|hsla)\\(.+?\\))|\\B#(?:[0-9a-f]{3,4}){1,2}\\b";for(t in Ee)e+="|"+t+"\\b";return new RegExp(e+")","gi")}(),_e=/hsl[a]?\(/,xe=function(t){var e,r=t.join(" ");if(Le.lastIndex=0,Le.test(r))return e=_e.test(r),t[1]=Se(t[1],e),t[0]=Se(t[0],e,Te(t[1])),!0},ke=function(){var t,e,r,n,i,s,o=Date.now,a=500,l=33,f=o(),p=f,m=1e3/240,y=m,v=[],b=function r(c){var u,h,d,g,b=o()-p,E=!0===c;if((b>a||b<0)&&(f+=b-l),((u=(d=(p+=b)-f)-y)>0||E)&&(g=++n.frame,i=d-1e3*n.time,n.time=d/=1e3,y+=u+(u>=m?4:m-u),h=1),E||(t=e(r)),h)for(s=0;s<v.length;s++)v[s](d,i,g,c)};return n={time:0,frame:0,tick:function(){b(!0)},deltaRatio:function(t){return i/(1e3/(t||60))},wake:function(){d&&(!u&&N()&&(c=u=window,h=c.document||{},q.gsap=xr,(c.gsapVersions||(c.gsapVersions=[])).push(xr.version),z(W||c.GreenSockGlobals||!c.gsap&&c||{}),ye.forEach(ve)),r="undefined"!=typeof requestAnimationFrame&&requestAnimationFrame,t&&n.sleep(),e=r||function(t){return setTimeout(t,y-1e3*n.time+1|0)},g=1,b(2))},sleep:function(){(r?cancelAnimationFrame:clearTimeout)(t),g=0,e=Z},lagSmoothing:function(t,e){a=t||1/0,l=Math.min(e||33,a)},fps:function(t){m=1e3/(t||240),y=1e3*n.time+m},add:function(t,e,r){var i=e?function(e,r,s,o){t(e,r,s,o),n.remove(i)}:t;return n.remove(t),v[r?"unshift":"push"](i),Pe(),i},remove:function(t,e){~(e=v.indexOf(t))&&v.splice(e,1)&&s>=e&&s--},_listeners:v}}(),Pe=function(){return!g&&ke.wake()},Ie={},Re=/^[\d.\-M][\d.\-,\s]/,Oe=/["']/g,De=function(t){for(var e,r,n,i={},s=t.substr(1,t.length-3).split(":"),o=s[0],a=1,l=s.length;a<l;a++)r=s[a],e=a!==l-1?r.lastIndexOf(","):r.length,n=r.substr(0,e),i[o]=isNaN(n)?n.replace(Oe,"").trim():+n,o=r.substr(e+1).trim();return i},Ce=function(t){return function(e){return 1-t(1-e)}},Me=function t(e,r){for(var n,i=e._first;i;)i instanceof He?t(i,r):!i.vars.yoyoEase||i._yoyo&&i._repeat||i._yoyo===r||(i.timeline?t(i.timeline,r):(n=i._ease,i._ease=i._yEase,i._yEase=n,i._yoyo=r)),i=i._next},Ne=function(t,e){return t&&(R(t)?t:Ie[t]||function(t){var e,r,n,i,s=(t+"").split("("),o=Ie[s[0]];return o&&s.length>1&&o.config?o.config.apply(null,~t.indexOf("{")?[De(s[1])]:(e=t,r=e.indexOf("(")+1,n=e.indexOf(")"),i=e.indexOf("(",r),e.substring(r,~i&&i<n?e.indexOf(")",n+1):n)).split(",").map(wt)):Ie._CE&&Re.test(t)?Ie._CE("",t):o}(t))||e},Fe=function(t,e,r,n){void 0===r&&(r=function(t){return 1-e(1-t)}),void 0===n&&(n=function(t){return t<.5?e(2*t)/2:1-e(2*(1-t))/2});var i,s={easeIn:e,easeOut:r,easeInOut:n};return pt(t,(function(t){for(var e in Ie[t]=q[t]=s,Ie[i=t.toLowerCase()]=r,s)Ie[i+("easeIn"===e?".in":"easeOut"===e?".out":".inOut")]=Ie[t+"."+e]=s[e]})),s},Ue=function(t){return function(e){return e<.5?(1-t(1-2*e))/2:.5+t(2*(e-.5))/2}},Be=function t(e,r,n){var i=r>=1?r:1,s=(n||(e?.3:.45))/(r<1?r:1),o=s/S*(Math.asin(1/i)||0),a=function(t){return 1===t?1:i*Math.pow(2,-10*t)*P((t-o)*s)+1},l="out"===e?a:"in"===e?function(t){return 1-a(1-t)}:Ue(a);return s=S/s,l.config=function(r,n){return t(e,r,n)},l},$e=function t(e,r){void 0===r&&(r=1.70158);var n=function(t){return t?--t*t*((r+1)*t+r)+1:0},i="out"===e?n:"in"===e?function(t){return 1-n(1-t)}:Ue(n);return i.config=function(r){return t(e,r)},i};pt("Linear,Quad,Cubic,Quart,Quint,Strong",(function(t,e){var r=e<5?e+1:e;Fe(t+",Power"+(r-1),e?function(t){return Math.pow(t,r)}:function(t){return t},(function(t){return 1-Math.pow(1-t,r)}),(function(t){return t<.5?Math.pow(2*t,r)/2:1-Math.pow(2*(1-t),r)/2}))})),Ie.Linear.easeNone=Ie.none=Ie.Linear.easeIn,Fe("Elastic",Be("in"),Be("out"),Be()),m=7.5625,v=1/(y=2.75),Fe("Bounce",(function(t){return 1-b(1-t)}),b=function(t){return t<v?m*t*t:t<.7272727272727273?m*Math.pow(t-1.5/y,2)+.75:t<.9090909090909092?m*(t-=2.25/y)*t+.9375:m*Math.pow(t-2.625/y,2)+.984375}),Fe("Expo",(function(t){return Math.pow(2,10*(t-1))*t+t*t*t*t*t*t*(1-t)})),Fe("Circ",(function(t){return-(x(1-t*t)-1)})),Fe("Sine",(function(t){return 1===t?1:1-k(t*L)})),Fe("Back",$e("in"),$e("out"),$e()),Ie.SteppedEase=Ie.steps=q.SteppedEase={config:function(t,e){void 0===t&&(t=1);var r=1/t,n=t+(e?0:1),i=e?1:0,s=1-T;return function(t){return((n*Zt(0,s,t)|0)+i)*r}}},A.ease=Ie["quad.out"],pt("onComplete,onUpdate,onStart,onRepeat,onReverseComplete,onInterrupt",(function(t){return ut+=t+","+t+"Params,"}));var je=function(t,e){this.id=_++,t._gsap=this,this.target=t,this.harness=e,this.get=e?e.get:ft,this.set=e?e.getSetter:sr},Ge=function(){function t(t){this.vars=t,this._delay=+t.delay||0,(this._repeat=t.repeat===1/0?-2:t.repeat||0)&&(this._rDelay=t.repeatDelay||0,this._yoyo=!!t.yoyo||!!t.yoyoEase),this._ts=1,qt(this,+t.duration,1,1),this.data=t.data,a&&(this._ctx=a,a.data.push(this)),g||ke.wake()}var e=t.prototype;return e.delay=function(t){return t||0===t?(this.parent&&this.parent.smoothChildTiming&&this.startTime(this._start+t-this._delay),this._delay=t,this):this._delay},e.duration=function(t){return arguments.length?this.totalDuration(this._repeat>0?t+(t+this._rDelay)*this._repeat:t):this.totalDuration()&&this._dur},e.totalDuration=function(t){return arguments.length?(this._dirty=0,qt(this,this._repeat<0?t:(t-this._repeat*this._rDelay)/(this._repeat+1))):this._tDur},e.totalTime=function(t,e){if(Pe(),!arguments.length)return this._tTime;var r=this._dp;if(r&&r.smoothChildTiming&&this._ts){for($t(this,t),!r._dp||r.parent||jt(r,this);r&&r.parent;)r.parent._time!==r._start+(r._ts>=0?r._tTime/r._ts:(r.totalDuration()-r._tTime)/-r._ts)&&r.totalTime(r._tTime,!0),r=r.parent;!this.parent&&this._dp.autoRemoveChildren&&(this._ts>0&&t<this._tDur||this._ts<0&&t>0||!this._tDur&&!t)&&Gt(this._dp,this,this._start-this._delay)}return(this._tTime!==t||!this._dur&&!e||this._initted&&Math.abs(this._zTime)===T||!t&&!this._initted&&(this.add||this._ptLookup))&&(this._ts||(this._pTime=t),At(this,t,e)),this},e.time=function(t,e){return arguments.length?this.totalTime(Math.min(this.totalDuration(),t+Nt(this))%(this._dur+this._rDelay)||(t?this._dur:0),e):this._time},e.totalProgress=function(t,e){return arguments.length?this.totalTime(this.totalDuration()*t,e):this.totalDuration()?Math.min(1,this._tTime/this._tDur):this.rawTime()>=0&&this._initted?1:0},e.progress=function(t,e){return arguments.length?this.totalTime(this.duration()*(!this._yoyo||1&this.iteration()?t:1-t)+Nt(this),e):this.duration()?Math.min(1,this._time/this._dur):this.rawTime()>0?1:0},e.iteration=function(t,e){var r=this.duration()+this._rDelay;return arguments.length?this.totalTime(this._time+(t-1)*r,e):this._repeat?Ft(this._tTime,r)+1:1},e.timeScale=function(t,e){if(!arguments.length)return this._rts===-T?0:this._rts;if(this._rts===t)return this;var r=this.parent&&this._ts?Ut(this.parent._time,this):this._tTime;return this._rts=+t||0,this._ts=this._ps||t===-T?0:this._rts,this.totalTime(Zt(-Math.abs(this._delay),this.totalDuration(),r),!1!==e),Bt(this),Dt(this)},e.paused=function(t){return arguments.length?(this._ps!==t&&(this._ps=t,t?(this._pTime=this._tTime||Math.max(-this._delay,this.rawTime()),this._ts=this._act=0):(Pe(),this._ts=this._rts,this.totalTime(this.parent&&!this.parent.smoothChildTiming?this.rawTime():this._tTime||this._pTime,1===this.progress()&&Math.abs(this._zTime)!==T&&(this._tTime-=T)))),this):this._ps},e.startTime=function(t){if(arguments.length){this._start=t;var e=this.parent||this._dp;return e&&(e._sort||!this.parent)&&Gt(e,this,t-this._delay),this}return this._start},e.endTime=function(t){return this._start+(M(t)?this.totalDuration():this.duration())/Math.abs(this._ts||1)},e.rawTime=function(t){var e=this.parent||this._dp;return e?t&&(!this._ts||this._repeat&&this._time&&this.totalProgress()<1)?this._tTime%(this._dur+this._rDelay):this._ts?Ut(e.rawTime(t),this):this._tTime:this._tTime},e.revert=function(t){void 0===t&&(t=rt);var e=o;return o=t,Et(this)&&(this.timeline&&this.timeline.revert(t),this.totalTime(-.01,t.suppressEvents)),"nested"!==this.data&&!1!==t.kill&&this.kill(),o=e,this},e.globalTime=function(t){for(var e=this,r=arguments.length?t:e.rawTime();e;)r=e._start+r/(Math.abs(e._ts)||1),e=e._dp;return!this.parent&&this._sat?this._sat.globalTime(t):r},e.repeat=function(t){return arguments.length?(this._repeat=t===1/0?-2:t,Wt(this)):-2===this._repeat?1/0:this._repeat},e.repeatDelay=function(t){if(arguments.length){var e=this._time;return this._rDelay=t,Wt(this),e?this.time(e):this}return this._rDelay},e.yoyo=function(t){return arguments.length?(this._yoyo=t,this):this._yoyo},e.seek=function(t,e){return this.totalTime(Xt(this,t),M(e))},e.restart=function(t,e){return this.play().totalTime(t?-this._delay:0,M(e)),this._dur||(this._zTime=-T),this},e.play=function(t,e){return null!=t&&this.seek(t,e),this.reversed(!1).paused(!1)},e.reverse=function(t,e){return null!=t&&this.seek(t||this.totalDuration(),e),this.reversed(!0).paused(!1)},e.pause=function(t,e){return null!=t&&this.seek(t,e),this.paused(!0)},e.resume=function(){return this.paused(!1)},e.reversed=function(t){return arguments.length?(!!t!==this.reversed()&&this.timeScale(-this._rts||(t?-T:0)),this):this._rts<0},e.invalidate=function(){return this._initted=this._act=0,this._zTime=-T,this},e.isActive=function(){var t,e=this.parent||this._dp,r=this._start;return!(e&&!(this._ts&&this._initted&&e.isActive()&&(t=e.rawTime(!0))>=r&&t<this.endTime(!0)-T))},e.eventCallback=function(t,e,r){var n=this.vars;return arguments.length>1?(e?(n[t]=e,r&&(n[t+"Params"]=r),"onUpdate"===t&&(this._onUpdate=e)):delete n[t],this):n[t]},e.then=function(t){var e=this;return new Promise((function(r){var n=R(t)?t:Tt,i=function(){var t=e.then;e.then=null,R(n)&&(n=n(e))&&(n.then||n===e)&&(e.then=t),r(n),e.then=t};e._initted&&1===e.totalProgress()&&e._ts>=0||!e._tTime&&e._ts<0?i():e._prom=i}))},e.kill=function(){me(this)},t}();St(Ge.prototype,{_time:0,_start:0,_end:0,_tTime:0,_tDur:0,_dirty:0,_repeat:0,_yoyo:!1,parent:null,_initted:!1,_rDelay:0,_ts:1,_dp:0,ratio:0,_zTime:-T,_prom:0,_ps:!1,_rts:1});var He=function(t){function e(e,r){var i;return void 0===e&&(e={}),(i=t.call(this,e)||this).labels={},i.smoothChildTiming=!!e.smoothChildTiming,i.autoRemoveChildren=!!e.autoRemoveChildren,i._sort=M(e.sortChildren),l&&Gt(e.parent||l,n(i),r),e.reversed&&i.reverse(),e.paused&&i.paused(!0),e.scrollTrigger&&Ht(n(i),e.scrollTrigger),i}i(e,t);var r=e.prototype;return r.to=function(t,e,r){return Qt(0,arguments,this),this},r.from=function(t,e,r){return Qt(1,arguments,this),this},r.fromTo=function(t,e,r,n){return Qt(2,arguments,this),this},r.set=function(t,e,r){return e.duration=0,e.parent=this,kt(e).repeatDelay||(e.repeat=0),e.immediateRender=!!e.immediateRender,new tr(t,e,Xt(this,r),1),this},r.call=function(t,e,r){return Gt(this,tr.delayedCall(0,t,e),r)},r.staggerTo=function(t,e,r,n,i,s,o){return r.duration=e,r.stagger=r.stagger||n,r.onComplete=s,r.onCompleteParams=o,r.parent=this,new tr(t,r,Xt(this,i)),this},r.staggerFrom=function(t,e,r,n,i,s,o){return r.runBackwards=1,kt(r).immediateRender=M(r.immediateRender),this.staggerTo(t,e,r,n,i,s,o)},r.staggerFromTo=function(t,e,r,n,i,s,o,a){return n.startAt=r,kt(n).immediateRender=M(n.immediateRender),this.staggerTo(t,e,n,i,s,o,a)},r.render=function(t,e,r){var n,i,s,a,c,u,h,d,f,p,g,m,y=this._time,v=this._dirty?this.totalDuration():this._tDur,b=this._dur,E=t<=0?0:mt(t),A=this._zTime<0!=t<0&&(this._initted||!b);if(this!==l&&E>v&&t>=0&&(E=v),E!==this._tTime||r||A){if(y!==this._time&&b&&(E+=this._time-y,t+=this._time-y),n=E,f=this._start,u=!(d=this._ts),A&&(b||(y=this._zTime),(t||!e)&&(this._zTime=t)),this._repeat){if(g=this._yoyo,c=b+this._rDelay,this._repeat<-1&&t<0)return this.totalTime(100*c+t,e,r);if(n=mt(E%c),E===v?(a=this._repeat,n=b):((a=~~(p=mt(E/c)))&&a===p&&(n=b,a--),n>b&&(n=b)),p=Ft(this._tTime,c),!y&&this._tTime&&p!==a&&this._tTime-p*c-this._dur<=0&&(p=a),g&&1&a&&(n=b-n,m=1),a!==p&&!this._lock){var w=g&&1&p,S=w===(g&&1&a);if(a<p&&(w=!w),y=w?0:E%b?b:E,this._lock=1,this.render(y||(m?0:mt(a*c)),e,!b)._lock=0,this._tTime=E,!e&&this.parent&&ge(this,"onRepeat"),this.vars.repeatRefresh&&!m&&(this.invalidate()._lock=1),y&&y!==this._time||u!==!this._ts||this.vars.onRepeat&&!this.parent&&!this._act)return this;if(b=this._dur,v=this._tDur,S&&(this._lock=2,y=w?b:-1e-4,this.render(y,!0),this.vars.repeatRefresh&&!m&&this.invalidate()),this._lock=0,!this._ts&&!u)return this;Me(this,m)}}if(this._hasPause&&!this._forcing&&this._lock<2&&(h=function(t,e,r){var n;if(r>e)for(n=t._first;n&&n._start<=r;){if("isPause"===n.data&&n._start>e)return n;n=n._next}else for(n=t._last;n&&n._start>=r;){if("isPause"===n.data&&n._start<e)return n;n=n._prev}}(this,mt(y),mt(n)),h&&(E-=n-(n=h._start))),this._tTime=E,this._time=n,this._act=!d,this._initted||(this._onUpdate=this.vars.onUpdate,this._initted=1,this._zTime=t,y=0),!y&&E&&!e&&!p&&(ge(this,"onStart"),this._tTime!==E))return this;if(n>=y&&t>=0)for(i=this._first;i;){if(s=i._next,(i._act||n>=i._start)&&i._ts&&h!==i){if(i.parent!==this)return this.render(t,e,r);if(i.render(i._ts>0?(n-i._start)*i._ts:(i._dirty?i.totalDuration():i._tDur)+(n-i._start)*i._ts,e,r),n!==this._time||!this._ts&&!u){h=0,s&&(E+=this._zTime=-T);break}}i=s}else{i=this._last;for(var L=t<0?t:n;i;){if(s=i._prev,(i._act||L<=i._end)&&i._ts&&h!==i){if(i.parent!==this)return this.render(t,e,r);if(i.render(i._ts>0?(L-i._start)*i._ts:(i._dirty?i.totalDuration():i._tDur)+(L-i._start)*i._ts,e,r||o&&Et(i)),n!==this._time||!this._ts&&!u){h=0,s&&(E+=this._zTime=L?-T:T);break}}i=s}}if(h&&!e&&(this.pause(),h.render(n>=y?0:-T)._zTime=n>=y?1:-1,this._ts))return this._start=f,Bt(this),this.render(t,e,r);this._onUpdate&&!e&&ge(this,"onUpdate",!0),(E===v&&this._tTime>=this.totalDuration()||!E&&y)&&(f!==this._start&&Math.abs(d)===Math.abs(this._ts)||this._lock||((t||!b)&&(E===v&&this._ts>0||!E&&this._ts<0)&&Rt(this,1),e||t<0&&!y||!E&&!y&&v||(ge(this,E===v&&t>=0?"onComplete":"onReverseComplete",!0),this._prom&&!(E<v&&this.timeScale()>0)&&this._prom())))}return this},r.add=function(t,e){var r=this;if(O(e)||(e=Xt(this,e,t)),!(t instanceof Ge)){if(B(t))return t.forEach((function(t){return r.add(t,e)})),this;if(I(t))return this.addLabel(t,e);if(!R(t))return this;t=tr.delayedCall(0,t)}return this!==t?Gt(this,t,e):this},r.getChildren=function(t,e,r,n){void 0===t&&(t=!0),void 0===e&&(e=!0),void 0===r&&(r=!0),void 0===n&&(n=-w);for(var i=[],s=this._first;s;)s._start>=n&&(s instanceof tr?e&&i.push(s):(r&&i.push(s),t&&i.push.apply(i,s.getChildren(!0,e,r)))),s=s._next;return i},r.getById=function(t){for(var e=this.getChildren(1,1,1),r=e.length;r--;)if(e[r].vars.id===t)return e[r]},r.remove=function(t){return I(t)?this.removeLabel(t):R(t)?this.killTweensOf(t):(t.parent===this&&It(this,t),t===this._recent&&(this._recent=this._last),Ot(this))},r.totalTime=function(e,r){return arguments.length?(this._forcing=1,!this._dp&&this._ts&&(this._start=mt(ke.time-(this._ts>0?e/this._ts:(this.totalDuration()-e)/-this._ts))),t.prototype.totalTime.call(this,e,r),this._forcing=0,this):this._tTime},r.addLabel=function(t,e){return this.labels[t]=Xt(this,e),this},r.removeLabel=function(t){return delete this.labels[t],this},r.addPause=function(t,e,r){var n=tr.delayedCall(0,e||Z,r);return n.data="isPause",this._hasPause=1,Gt(this,n,Xt(this,t))},r.removePause=function(t){var e=this._first;for(t=Xt(this,t);e;)e._start===t&&"isPause"===e.data&&Rt(e),e=e._next},r.killTweensOf=function(t,e,r){for(var n=this.getTweensOf(t,r),i=n.length;i--;)Ve!==n[i]&&n[i].kill(t,e);return this},r.getTweensOf=function(t,e){for(var r,n=[],i=ie(t),s=this._first,o=O(e);s;)s instanceof tr?vt(s._targets,i)&&(o?(!Ve||s._initted&&s._ts)&&s.globalTime(0)<=e&&s.globalTime(s.totalDuration())>e:!e||s.isActive())&&n.push(s):(r=s.getTweensOf(i,e)).length&&n.push.apply(n,r),s=s._next;return n},r.tweenTo=function(t,e){e=e||{};var r,n=this,i=Xt(n,t),s=e,o=s.startAt,a=s.onStart,l=s.onStartParams,c=s.immediateRender,u=tr.to(n,St({ease:e.ease||"none",lazy:!1,immediateRender:!1,time:i,overwrite:"auto",duration:e.duration||Math.abs((i-(o&&"time"in o?o.time:n._time))/n.timeScale())||T,onStart:function(){if(n.pause(),!r){var t=e.duration||Math.abs((i-(o&&"time"in o?o.time:n._time))/n.timeScale());u._dur!==t&&qt(u,t,0,1).render(u._time,!0,!0),r=1}a&&a.apply(u,l||[])}},e));return c?u.render(0):u},r.tweenFromTo=function(t,e,r){return this.tweenTo(e,St({startAt:{time:Xt(this,t)}},r))},r.recent=function(){return this._recent},r.nextLabel=function(t){return void 0===t&&(t=this._time),pe(this,Xt(this,t))},r.previousLabel=function(t){return void 0===t&&(t=this._time),pe(this,Xt(this,t),1)},r.currentLabel=function(t){return arguments.length?this.seek(t,!0):this.previousLabel(this._time+T)},r.shiftChildren=function(t,e,r){void 0===r&&(r=0);for(var n,i=this._first,s=this.labels;i;)i._start>=r&&(i._start+=t,i._end+=t),i=i._next;if(e)for(n in s)s[n]>=r&&(s[n]+=t);return Ot(this)},r.invalidate=function(e){var r=this._first;for(this._lock=0;r;)r.invalidate(e),r=r._next;return t.prototype.invalidate.call(this,e)},r.clear=function(t){void 0===t&&(t=!0);for(var e,r=this._first;r;)e=r._next,this.remove(r),r=e;return this._dp&&(this._time=this._tTime=this._pTime=0),t&&(this.labels={}),Ot(this)},r.totalDuration=function(t){var e,r,n,i=0,s=this,o=s._last,a=w;if(arguments.length)return s.timeScale((s._repeat<0?s.duration():s.totalDuration())/(s.reversed()?-t:t));if(s._dirty){for(n=s.parent;o;)e=o._prev,o._dirty&&o.totalDuration(),(r=o._start)>a&&s._sort&&o._ts&&!s._lock?(s._lock=1,Gt(s,o,r-o._delay,1)._lock=0):a=r,r<0&&o._ts&&(i-=r,(!n&&!s._dp||n&&n.smoothChildTiming)&&(s._start+=r/s._ts,s._time-=r,s._tTime-=r),s.shiftChildren(-r,!1,-Infinity),a=0),o._end>i&&o._ts&&(i=o._end),o=e;qt(s,s===l&&s._time>i?s._time:i,1,1),s._dirty=0}return s._tDur},e.updateRoot=function(t){if(l._ts&&(At(l,Ut(t,l)),f=ke.frame),ke.frame>=lt){lt+=E.autoSleep||120;var e=l._first;if((!e||!e._ts)&&E.autoSleep&&ke._listeners.length<2){for(;e&&!e._ts;)e=e._next;e||ke.sleep()}}},e}(Ge);St(He.prototype,{_lock:0,_hasPause:0,_forcing:0});var Ve,Ke,Ye=function(t,e,r,n,i,s,o){var a,l,c,u,h,d,f,p,g=new pr(this._pt,t,e,0,1,lr,null,i),m=0,y=0;for(g.b=r,g.e=n,r+="",(f=~(n+="").indexOf("random("))&&(n=de(n)),s&&(s(p=[r,n],t,e),r=p[0],n=p[1]),l=r.match(H)||[];a=H.exec(n);)u=a[0],h=n.substring(m,a.index),c?c=(c+1)%5:"rgba("===h.substr(-5)&&(c=1),u!==l[y++]&&(d=parseFloat(l[y-1])||0,g._pt={_next:g._pt,p:h||1===y?h:",",s:d,c:"="===u.charAt(1)?yt(d,u)-d:parseFloat(u)-d,m:c&&c<4?Math.round:0},m=H.lastIndex);return g.c=m<n.length?n.substring(m,n.length):"",g.fp=o,(V.test(n)||f)&&(g.e=0),this._pt=g,g},qe=function(t,e,r,n,i,s,o,a,l,c){R(n)&&(n=n(i||0,t,s));var u,h=t[e],d="get"!==r?r:R(h)?l?t[e.indexOf("set")||!R(t["get"+e.substr(3)])?e:"get"+e.substr(3)](l):t[e]():h,f=R(h)?l?nr:rr:er;if(I(n)&&(~n.indexOf("random(")&&(n=de(n)),"="===n.charAt(1)&&((u=yt(d,n)+(te(d)||0))||0===u)&&(n=u)),!c||d!==n||Ke)return isNaN(d*n)||""===n?(!h&&!(e in t)&&X(e,n),Ye.call(this,t,e,d,n,f,a||E.stringFilter,l)):(u=new pr(this._pt,t,e,+d||0,n-(d||0),"boolean"==typeof h?ar:or,0,f),l&&(u.fp=l),o&&u.modifier(o,this,t),this._pt=u)},We=function(t,e,r,n,i,s){var o,a,l,c;if(ot[t]&&!1!==(o=new ot[t]).init(i,o.rawVars?e[t]:function(t,e,r,n,i){if(R(t)&&(t=Qe(t,i,e,r,n)),!C(t)||t.style&&t.nodeType||B(t)||U(t))return I(t)?Qe(t,i,e,r,n):t;var s,o={};for(s in t)o[s]=Qe(t[s],i,e,r,n);return o}(e[t],n,i,s,r),r,n,s)&&(r._pt=a=new pr(r._pt,i,t,0,1,o.render,o,0,o.priority),r!==p))for(l=r._ptLookup[r._targets.indexOf(i)],c=o._props.length;c--;)l[o._props[c]]=a;return o},ze=function t(e,r,n){var i,a,c,u,h,d,f,p,g,m,y,v,b,E=e.vars,S=E.ease,L=E.startAt,_=E.immediateRender,x=E.lazy,k=E.onUpdate,P=E.runBackwards,I=E.yoyoEase,R=E.keyframes,O=E.autoRevert,D=e._dur,C=e._startAt,N=e._targets,F=e.parent,U=F&&"nested"===F.data?F.vars.targets:N,B="auto"===e._overwrite&&!s,$=e.timeline;if($&&(!R||!S)&&(S="none"),e._ease=Ne(S,A.ease),e._yEase=I?Ce(Ne(!0===I?S:I,A.ease)):0,I&&e._yoyo&&!e._repeat&&(I=e._yEase,e._yEase=e._ease,e._ease=I),e._from=!$&&!!E.runBackwards,!$||R&&!E.stagger){if(v=(p=N[0]?dt(N[0]).harness:0)&&E[p.prop],i=xt(E,nt),C&&(C._zTime<0&&C.progress(1),r<0&&P&&_&&!O?C.render(-1,!0):C.revert(P&&D?et:tt),C._lazy=0),L){if(Rt(e._startAt=tr.set(N,St({data:"isStart",overwrite:!1,parent:F,immediateRender:!0,lazy:!C&&M(x),startAt:null,delay:0,onUpdate:k&&function(){return ge(e,"onUpdate")},stagger:0},L))),e._startAt._dp=0,e._startAt._sat=e,r<0&&(o||!_&&!O)&&e._startAt.revert(et),_&&D&&r<=0&&n<=0)return void(r&&(e._zTime=r))}else if(P&&D&&!C)if(r&&(_=!1),c=St({overwrite:!1,data:"isFromStart",lazy:_&&!C&&M(x),immediateRender:_,stagger:0,parent:F},i),v&&(c[p.prop]=v),Rt(e._startAt=tr.set(N,c)),e._startAt._dp=0,e._startAt._sat=e,r<0&&(o?e._startAt.revert(et):e._startAt.render(-1,!0)),e._zTime=r,_){if(!r)return}else t(e._startAt,T,T);for(e._pt=e._ptCache=0,x=D&&M(x)||x&&!D,a=0;a<N.length;a++){if(f=(h=N[a])._gsap||ht(N)[a]._gsap,e._ptLookup[a]=m={},st[f.id]&&it.length&&bt(),y=U===N?a:U.indexOf(h),p&&!1!==(g=new p).init(h,v||i,e,y,U)&&(e._pt=u=new pr(e._pt,h,g.name,0,1,g.render,g,0,g.priority),g._props.forEach((function(t){m[t]=u})),g.priority&&(d=1)),!p||v)for(c in i)ot[c]&&(g=We(c,i,e,y,h,U))?g.priority&&(d=1):m[c]=u=qe.call(e,h,c,"get",i[c],y,U,0,E.stringFilter);e._op&&e._op[a]&&e.kill(h,e._op[a]),B&&e._pt&&(Ve=e,l.killTweensOf(h,m,e.globalTime(r)),b=!e.parent,Ve=0),e._pt&&x&&(st[f.id]=1)}d&&fr(e),e._onInit&&e._onInit(e)}e._onUpdate=k,e._initted=(!e._op||e._pt)&&!b,R&&r<=0&&$.render(w,!0,!0)},Xe=function(t,e,r,n){var i,s,o=e.ease||n||"power1.inOut";if(B(e))s=r[t]||(r[t]=[]),e.forEach((function(t,r){return s.push({t:r/(e.length-1)*100,v:t,e:o})}));else for(i in e)s=r[i]||(r[i]=[]),"ease"===i||s.push({t:parseFloat(t),v:e[i],e:o})},Qe=function(t,e,r,n,i){return R(t)?t.call(e,r,n,i):I(t)&&~t.indexOf("random(")?de(t):t},Je=ut+"repeat,repeatDelay,yoyo,repeatRefresh,yoyoEase,autoRevert",Ze={};pt(Je+",id,stagger,delay,duration,paused,scrollTrigger",(function(t){return Ze[t]=1}));var tr=function(t){function e(e,r,i,o){var a;"number"==typeof r&&(i.duration=r,r=i,i=null);var c,u,h,d,f,p,g,m,y=(a=t.call(this,o?r:kt(r))||this).vars,v=y.duration,b=y.delay,A=y.immediateRender,w=y.stagger,S=y.overwrite,L=y.keyframes,_=y.defaults,x=y.scrollTrigger,k=y.yoyoEase,P=r.parent||l,I=(B(e)||U(e)?O(e[0]):"length"in r)?[e]:ie(e);if(a._targets=I.length?ht(I):Q("GSAP target "+e+" not found. https://gsap.com",!E.nullTargetWarn)||[],a._ptLookup=[],a._overwrite=S,L||w||F(v)||F(b)){if(r=a.vars,(c=a.timeline=new He({data:"nested",defaults:_||{},targets:P&&"nested"===P.data?P.vars.targets:I})).kill(),c.parent=c._dp=n(a),c._start=0,w||F(v)||F(b)){if(d=I.length,g=w&&ae(w),C(w))for(f in w)~Je.indexOf(f)&&(m||(m={}),m[f]=w[f]);for(u=0;u<d;u++)(h=xt(r,Ze)).stagger=0,k&&(h.yoyoEase=k),m&&Lt(h,m),p=I[u],h.duration=+Qe(v,n(a),u,p,I),h.delay=(+Qe(b,n(a),u,p,I)||0)-a._delay,!w&&1===d&&h.delay&&(a._delay=b=h.delay,a._start+=b,h.delay=0),c.to(p,h,g?g(u,p,I):0),c._ease=Ie.none;c.duration()?v=b=0:a.timeline=0}else if(L){kt(St(c.vars.defaults,{ease:"none"})),c._ease=Ne(L.ease||r.ease||"none");var R,D,N,$=0;if(B(L))L.forEach((function(t){return c.to(I,t,">")})),c.duration();else{for(f in h={},L)"ease"===f||"easeEach"===f||Xe(f,L[f],h,L.easeEach);for(f in h)for(R=h[f].sort((function(t,e){return t.t-e.t})),$=0,u=0;u<R.length;u++)(N={ease:(D=R[u]).e,duration:(D.t-(u?R[u-1].t:0))/100*v})[f]=D.v,c.to(I,N,$),$+=N.duration;c.duration()<v&&c.to({},{duration:v-c.duration()})}}v||a.duration(v=c.duration())}else a.timeline=0;return!0!==S||s||(Ve=n(a),l.killTweensOf(I),Ve=0),Gt(P,n(a),i),r.reversed&&a.reverse(),r.paused&&a.paused(!0),(A||!v&&!L&&a._start===mt(P._time)&&M(A)&&Mt(n(a))&&"nested"!==P.data)&&(a._tTime=-T,a.render(Math.max(0,-b)||0)),x&&Ht(n(a),x),a}i(e,t);var r=e.prototype;return r.render=function(t,e,r){var n,i,s,a,l,c,u,h,d,f=this._time,p=this._tDur,g=this._dur,m=t<0,y=t>p-T&&!m?p:t<T?0:t;if(g){if(y!==this._tTime||!t||r||!this._initted&&this._tTime||this._startAt&&this._zTime<0!==m||this._lazy){if(n=y,h=this.timeline,this._repeat){if(a=g+this._rDelay,this._repeat<-1&&m)return this.totalTime(100*a+t,e,r);if(n=mt(y%a),y===p?(s=this._repeat,n=g):(s=~~(l=mt(y/a)))&&s===l?(n=g,s--):n>g&&(n=g),(c=this._yoyo&&1&s)&&(d=this._yEase,n=g-n),l=Ft(this._tTime,a),n===f&&!r&&this._initted&&s===l)return this._tTime=y,this;s!==l&&(h&&this._yEase&&Me(h,c),this.vars.repeatRefresh&&!c&&!this._lock&&n!==a&&this._initted&&(this._lock=r=1,this.render(mt(a*s),!0).invalidate()._lock=0))}if(!this._initted){if(Vt(this,m?t:n,r,e,y))return this._tTime=0,this;if(!(f===this._time||r&&this.vars.repeatRefresh&&s!==l))return this;if(g!==this._dur)return this.render(t,e,r)}if(this._tTime=y,this._time=n,!this._act&&this._ts&&(this._act=1,this._lazy=0),this.ratio=u=(d||this._ease)(n/g),this._from&&(this.ratio=u=1-u),!f&&y&&!e&&!l&&(ge(this,"onStart"),this._tTime!==y))return this;for(i=this._pt;i;)i.r(u,i.d),i=i._next;h&&h.render(t<0?t:h._dur*h._ease(n/this._dur),e,r)||this._startAt&&(this._zTime=t),this._onUpdate&&!e&&(m&&Ct(this,t,0,r),ge(this,"onUpdate")),this._repeat&&s!==l&&this.vars.onRepeat&&!e&&this.parent&&ge(this,"onRepeat"),y!==this._tDur&&y||this._tTime!==y||(m&&!this._onUpdate&&Ct(this,t,0,!0),(t||!g)&&(y===this._tDur&&this._ts>0||!y&&this._ts<0)&&Rt(this,1),e||m&&!f||!(y||f||c)||(ge(this,y===p?"onComplete":"onReverseComplete",!0),this._prom&&!(y<p&&this.timeScale()>0)&&this._prom()))}}else!function(t,e,r,n){var i,s,a,l=t.ratio,c=e<0||!e&&(!t._start&&Kt(t)&&(t._initted||!Yt(t))||(t._ts<0||t._dp._ts<0)&&!Yt(t))?0:1,u=t._rDelay,h=0;if(u&&t._repeat&&(h=Zt(0,t._tDur,e),s=Ft(h,u),t._yoyo&&1&s&&(c=1-c),s!==Ft(t._tTime,u)&&(l=1-c,t.vars.repeatRefresh&&t._initted&&t.invalidate())),c!==l||o||n||t._zTime===T||!e&&t._zTime){if(!t._initted&&Vt(t,e,n,r,h))return;for(a=t._zTime,t._zTime=e||(r?T:0),r||(r=e&&!a),t.ratio=c,t._from&&(c=1-c),t._time=0,t._tTime=h,i=t._pt;i;)i.r(c,i.d),i=i._next;e<0&&Ct(t,e,0,!0),t._onUpdate&&!r&&ge(t,"onUpdate"),h&&t._repeat&&!r&&t.parent&&ge(t,"onRepeat"),(e>=t._tDur||e<0)&&t.ratio===c&&(c&&Rt(t,1),r||o||(ge(t,c?"onComplete":"onReverseComplete",!0),t._prom&&t._prom()))}else t._zTime||(t._zTime=e)}(this,t,e,r);return this},r.targets=function(){return this._targets},r.invalidate=function(e){return(!e||!this.vars.runBackwards)&&(this._startAt=0),this._pt=this._op=this._onUpdate=this._lazy=this.ratio=0,this._ptLookup=[],this.timeline&&this.timeline.invalidate(e),t.prototype.invalidate.call(this,e)},r.resetTo=function(t,e,r,n,i){g||ke.wake(),this._ts||this.play();var s=Math.min(this._dur,(this._dp._time-this._start)*this._ts);return this._initted||ze(this,s),function(t,e,r,n,i,s,o,a){var l,c,u,h,d=(t._pt&&t._ptCache||(t._ptCache={}))[e];if(!d)for(d=t._ptCache[e]=[],u=t._ptLookup,h=t._targets.length;h--;){if((l=u[h][e])&&l.d&&l.d._pt)for(l=l.d._pt;l&&l.p!==e&&l.fp!==e;)l=l._next;if(!l)return Ke=1,t.vars[e]="+=0",ze(t,o),Ke=0,a?Q(e+" not eligible for reset"):1;d.push(l)}for(h=d.length;h--;)(l=(c=d[h])._pt||c).s=!n&&0!==n||i?l.s+(n||0)+s*l.c:n,l.c=r-l.s,c.e&&(c.e=gt(r)+te(c.e)),c.b&&(c.b=l.s+te(c.b))}(this,t,e,r,n,this._ease(s/this._dur),s,i)?this.resetTo(t,e,r,n,1):($t(this,0),this.parent||Pt(this._dp,this,"_first","_last",this._dp._sort?"_start":0),this.render(0))},r.kill=function(t,e){if(void 0===e&&(e="all"),!(t||e&&"all"!==e))return this._lazy=this._pt=0,this.parent?me(this):this.scrollTrigger&&this.scrollTrigger.kill(!!o),this;if(this.timeline){var r=this.timeline.totalDuration();return this.timeline.killTweensOf(t,e,Ve&&!0!==Ve.vars.overwrite)._first||me(this),this.parent&&r!==this.timeline.totalDuration()&&qt(this,this._dur*this.timeline._tDur/r,0,1),this}var n,i,s,a,l,c,u,h=this._targets,d=t?ie(t):h,f=this._ptLookup,p=this._pt;if((!e||"all"===e)&&function(t,e){for(var r=t.length,n=r===e.length;n&&r--&&t[r]===e[r];);return r<0}(h,d))return"all"===e&&(this._pt=0),me(this);for(n=this._op=this._op||[],"all"!==e&&(I(e)&&(l={},pt(e,(function(t){return l[t]=1})),e=l),e=function(t,e){var r,n,i,s,o=t[0]?dt(t[0]).harness:0,a=o&&o.aliases;if(!a)return e;for(n in r=Lt({},e),a)if(n in r)for(i=(s=a[n].split(",")).length;i--;)r[s[i]]=r[n];return r}(h,e)),u=h.length;u--;)if(~d.indexOf(h[u]))for(l in i=f[u],"all"===e?(n[u]=e,a=i,s={}):(s=n[u]=n[u]||{},a=e),a)(c=i&&i[l])&&("kill"in c.d&&!0!==c.d.kill(l)||It(this,c,"_pt"),delete i[l]),"all"!==s&&(s[l]=1);return this._initted&&!this._pt&&p&&me(this),this},e.to=function(t,r){return new e(t,r,arguments[2])},e.from=function(t,e){return Qt(1,arguments)},e.delayedCall=function(t,r,n,i){return new e(r,0,{immediateRender:!1,lazy:!1,overwrite:!1,delay:t,onComplete:r,onReverseComplete:r,onCompleteParams:n,onReverseCompleteParams:n,callbackScope:i})},e.fromTo=function(t,e,r){return Qt(2,arguments)},e.set=function(t,r){return r.duration=0,r.repeatDelay||(r.repeat=0),new e(t,r)},e.killTweensOf=function(t,e,r){return l.killTweensOf(t,e,r)},e}(Ge);St(tr.prototype,{_targets:[],_lazy:0,_startAt:0,_op:0,_onInit:0}),pt("staggerTo,staggerFrom,staggerFromTo",(function(t){tr[t]=function(){var e=new He,r=ee.call(arguments,0);return r.splice("staggerFromTo"===t?5:4,0,0),e[t].apply(e,r)}}));var er=function(t,e,r){return t[e]=r},rr=function(t,e,r){return t[e](r)},nr=function(t,e,r,n){return t[e](n.fp,r)},ir=function(t,e,r){return t.setAttribute(e,r)},sr=function(t,e){return R(t[e])?rr:D(t[e])&&t.setAttribute?ir:er},or=function(t,e){return e.set(e.t,e.p,Math.round(1e6*(e.s+e.c*t))/1e6,e)},ar=function(t,e){return e.set(e.t,e.p,!!(e.s+e.c*t),e)},lr=function(t,e){var r=e._pt,n="";if(!t&&e.b)n=e.b;else if(1===t&&e.e)n=e.e;else{for(;r;)n=r.p+(r.m?r.m(r.s+r.c*t):Math.round(1e4*(r.s+r.c*t))/1e4)+n,r=r._next;n+=e.c}e.set(e.t,e.p,n,e)},cr=function(t,e){for(var r=e._pt;r;)r.r(t,r.d),r=r._next},ur=function(t,e,r,n){for(var i,s=this._pt;s;)i=s._next,s.p===n&&s.modifier(t,e,r),s=i},hr=function(t){for(var e,r,n=this._pt;n;)r=n._next,n.p===t&&!n.op||n.op===t?It(this,n,"_pt"):n.dep||(e=1),n=r;return!e},dr=function(t,e,r,n){n.mSet(t,e,n.m.call(n.tween,r,n.mt),n)},fr=function(t){for(var e,r,n,i,s=t._pt;s;){for(e=s._next,r=n;r&&r.pr>s.pr;)r=r._next;(s._prev=r?r._prev:i)?s._prev._next=s:n=s,(s._next=r)?r._prev=s:i=s,s=e}t._pt=n},pr=function(){function t(t,e,r,n,i,s,o,a,l){this.t=e,this.s=n,this.c=i,this.p=r,this.r=s||or,this.d=o||this,this.set=a||er,this.pr=l||0,this._next=t,t&&(t._prev=this)}return t.prototype.modifier=function(t,e,r){this.mSet=this.mSet||this.set,this.set=dr,this.m=t,this.mt=r,this.tween=e},t}();pt(ut+"parent,duration,ease,delay,overwrite,runBackwards,startAt,yoyo,immediateRender,repeat,repeatDelay,data,paused,reversed,lazy,callbackScope,stringFilter,id,yoyoEase,stagger,inherit,repeatRefresh,keyframes,autoRevert,scrollTrigger",(function(t){return nt[t]=1})),q.TweenMax=q.TweenLite=tr,q.TimelineLite=q.TimelineMax=He,l=new He({sortChildren:!1,defaults:A,autoRemoveChildren:!0,id:"root",smoothChildTiming:!0}),E.stringFilter=xe;var gr=[],mr={},yr=[],vr=0,br=0,Er=function(t){return(mr[t]||yr).map((function(t){return t()}))},Ar=function(){var t=Date.now(),e=[];t-vr>2&&(Er("matchMediaInit"),gr.forEach((function(t){var r,n,i,s,o=t.queries,a=t.conditions;for(n in o)(r=c.matchMedia(o[n]).matches)&&(i=1),r!==a[n]&&(a[n]=r,s=1);s&&(t.revert(),i&&e.push(t))})),Er("matchMediaRevert"),e.forEach((function(t){return t.onMatch(t,(function(e){return t.add(null,e)}))})),vr=t,Er("matchMedia"))},wr=function(){function t(t,e){this.selector=e&&se(e),this.data=[],this._r=[],this.isReverted=!1,this.id=br++,t&&this.add(t)}var e=t.prototype;return e.add=function(t,e,r){R(t)&&(r=e,e=t,t=R);var n=this,i=function(){var t,i=a,s=n.selector;return i&&i!==n&&i.data.push(n),r&&(n.selector=se(r)),a=n,t=e.apply(n,arguments),R(t)&&n._r.push(t),a=i,n.selector=s,n.isReverted=!1,t};return n.last=i,t===R?i(n,(function(t){return n.add(null,t)})):t?n[t]=i:i},e.ignore=function(t){var e=a;a=null,t(this),a=e},e.getTweens=function(){var e=[];return this.data.forEach((function(r){return r instanceof t?e.push.apply(e,r.getTweens()):r instanceof tr&&!(r.parent&&"nested"===r.parent.data)&&e.push(r)})),e},e.clear=function(){this._r.length=this.data.length=0},e.kill=function(t,e){var r=this;if(t?function(){for(var e,n=r.getTweens(),i=r.data.length;i--;)"isFlip"===(e=r.data[i]).data&&(e.revert(),e.getChildren(!0,!0,!1).forEach((function(t){return n.splice(n.indexOf(t),1)})));for(n.map((function(t){return{g:t._dur||t._delay||t._sat&&!t._sat.vars.immediateRender?t.globalTime(0):-1/0,t}})).sort((function(t,e){return e.g-t.g||-1/0})).forEach((function(e){return e.t.revert(t)})),i=r.data.length;i--;)(e=r.data[i])instanceof He?"nested"!==e.data&&(e.scrollTrigger&&e.scrollTrigger.revert(),e.kill()):!(e instanceof tr)&&e.revert&&e.revert(t);r._r.forEach((function(e){return e(t,r)})),r.isReverted=!0}():this.data.forEach((function(t){return t.kill&&t.kill()})),this.clear(),e)for(var n=gr.length;n--;)gr[n].id===this.id&&gr.splice(n,1)},e.revert=function(t){this.kill(t||{})},t}(),Tr=function(){function t(t){this.contexts=[],this.scope=t,a&&a.data.push(this)}var e=t.prototype;return e.add=function(t,e,r){C(t)||(t={matches:t});var n,i,s,o=new wr(0,r||this.scope),l=o.conditions={};for(i in a&&!o.selector&&(o.selector=a.selector),this.contexts.push(o),e=o.add("onMatch",e),o.queries=t,t)"all"===i?s=1:(n=c.matchMedia(t[i]))&&(gr.indexOf(o)<0&&gr.push(o),(l[i]=n.matches)&&(s=1),n.addListener?n.addListener(Ar):n.addEventListener("change",Ar));return s&&e(o,(function(t){return o.add(null,t)})),this},e.revert=function(t){this.kill(t||{})},e.kill=function(t){this.contexts.forEach((function(e){return e.kill(t,!0)}))},t}(),Sr={registerPlugin:function(){for(var t=arguments.length,e=new Array(t),r=0;r<t;r++)e[r]=arguments[r];e.forEach((function(t){return ve(t)}))},timeline:function(t){return new He(t)},getTweensOf:function(t,e){return l.getTweensOf(t,e)},getProperty:function(t,e,r,n){I(t)&&(t=ie(t)[0]);var i=dt(t||{}).get,s=r?Tt:wt;return"native"===r&&(r=""),t?e?s((ot[e]&&ot[e].get||i)(t,e,r,n)):function(e,r,n){return s((ot[e]&&ot[e].get||i)(t,e,r,n))}:t},quickSetter:function(t,e,r){if((t=ie(t)).length>1){var n=t.map((function(t){return xr.quickSetter(t,e,r)})),i=n.length;return function(t){for(var e=i;e--;)n[e](t)}}t=t[0]||{};var s=ot[e],o=dt(t),a=o.harness&&(o.harness.aliases||{})[e]||e,l=s?function(e){var n=new s;p._pt=0,n.init(t,r?e+r:e,p,0,[t]),n.render(1,n),p._pt&&cr(1,p)}:o.set(t,a);return s?l:function(e){return l(t,a,r?e+r:e,o,1)}},quickTo:function(t,e,r){var n,i=xr.to(t,St(((n={})[e]="+=0.1",n.paused=!0,n.stagger=0,n),r||{})),s=function(t,r,n){return i.resetTo(e,t,r,n)};return s.tween=i,s},isTweening:function(t){return l.getTweensOf(t,!0).length>0},defaults:function(t){return t&&t.ease&&(t.ease=Ne(t.ease,A.ease)),_t(A,t||{})},config:function(t){return _t(E,t||{})},registerEffect:function(t){var e=t.name,r=t.effect,n=t.plugins,i=t.defaults,s=t.extendTimeline;(n||"").split(",").forEach((function(t){return t&&!ot[t]&&!q[t]&&Q(e+" effect requires "+t+" plugin.")})),at[e]=function(t,e,n){return r(ie(t),St(e||{},i),n)},s&&(He.prototype[e]=function(t,r,n){return this.add(at[e](t,C(r)?r:(n=r)&&{},this),n)})},registerEase:function(t,e){Ie[t]=Ne(e)},parseEase:function(t,e){return arguments.length?Ne(t,e):Ie},getById:function(t){return l.getById(t)},exportRoot:function(t,e){void 0===t&&(t={});var r,n,i=new He(t);for(i.smoothChildTiming=M(t.smoothChildTiming),l.remove(i),i._dp=0,i._time=i._tTime=l._time,r=l._first;r;)n=r._next,!e&&!r._dur&&r instanceof tr&&r.vars.onComplete===r._targets[0]||Gt(i,r,r._start-r._delay),r=n;return Gt(l,i,0),i},context:function(t,e){return t?new wr(t,e):a},matchMedia:function(t){return new Tr(t)},matchMediaRefresh:function(){return gr.forEach((function(t){var e,r,n=t.conditions;for(r in n)n[r]&&(n[r]=!1,e=1);e&&t.revert()}))||Ar()},addEventListener:function(t,e){var r=mr[t]||(mr[t]=[]);~r.indexOf(e)||r.push(e)},removeEventListener:function(t,e){var r=mr[t],n=r&&r.indexOf(e);n>=0&&r.splice(n,1)},utils:{wrap:function t(e,r,n){var i=r-e;return B(e)?he(e,t(0,e.length),r):Jt(n,(function(t){return(i+(t-e)%i)%i+e}))},wrapYoyo:function t(e,r,n){var i=r-e,s=2*i;return B(e)?he(e,t(0,e.length-1),r):Jt(n,(function(t){return e+((t=(s+(t-e)%s)%s||0)>i?s-t:t)}))},distribute:ae,random:ue,snap:ce,normalize:function(t,e,r){return fe(t,e,0,1,r)},getUnit:te,clamp:function(t,e,r){return Jt(r,(function(r){return Zt(t,e,r)}))},splitColor:we,toArray:ie,selector:se,mapRange:fe,pipe:function(){for(var t=arguments.length,e=new Array(t),r=0;r<t;r++)e[r]=arguments[r];return function(t){return e.reduce((function(t,e){return e(t)}),t)}},unitize:function(t,e){return function(r){return t(parseFloat(r))+(e||te(r))}},interpolate:function t(e,r,n,i){var s=isNaN(e+r)?0:function(t){return(1-t)*e+t*r};if(!s){var o,a,l,c,u,h=I(e),d={};if(!0===n&&(i=1)&&(n=null),h)e={p:e},r={p:r};else if(B(e)&&!B(r)){for(l=[],c=e.length,u=c-2,a=1;a<c;a++)l.push(t(e[a-1],e[a]));c--,s=function(t){t*=c;var e=Math.min(u,~~t);return l[e](t-e)},n=r}else i||(e=Lt(B(e)?[]:{},e));if(!l){for(o in r)qe.call(d,e,o,"get",r[o]);s=function(t){return cr(t,d)||(h?e.p:e)}}}return Jt(n,s)},shuffle:oe},install:z,effects:at,ticker:ke,updateRoot:He.updateRoot,plugins:ot,globalTimeline:l,core:{PropTween:pr,globals:J,Tween:tr,Timeline:He,Animation:Ge,getCache:dt,_removeLinkedListItem:It,reverting:function(){return o},context:function(t){return t&&a&&(a.data.push(t),t._ctx=a),a},suppressOverwrites:function(t){return s=t}}};pt("to,from,fromTo,delayedCall,set,killTweensOf",(function(t){return Sr[t]=tr[t]})),ke.add(He.updateRoot),p=Sr.to({},{duration:0});var Lr=function(t,e){for(var r=t._pt;r&&r.p!==e&&r.op!==e&&r.fp!==e;)r=r._next;return r},_r=function(t,e){return{name:t,headless:1,rawVars:1,init:function(t,r,n){n._onInit=function(t){var n,i;if(I(r)&&(n={},pt(r,(function(t){return n[t]=1})),r=n),e){for(i in n={},r)n[i]=e(r[i]);r=n}!function(t,e){var r,n,i,s=t._targets;for(r in e)for(n=s.length;n--;)(i=t._ptLookup[n][r])&&(i=i.d)&&(i._pt&&(i=Lr(i,r)),i&&i.modifier&&i.modifier(e[r],t,s[n],r))}(t,r)}}}},xr=Sr.registerPlugin({name:"attr",init:function(t,e,r,n,i){var s,o,a;for(s in this.tween=r,e)a=t.getAttribute(s)||"",(o=this.add(t,"setAttribute",(a||0)+"",e[s],n,i,0,0,s)).op=s,o.b=a,this._props.push(s)},render:function(t,e){for(var r=e._pt;r;)o?r.set(r.t,r.p,r.b,r):r.r(t,r.d),r=r._next}},{name:"endArray",headless:1,init:function(t,e){for(var r=e.length;r--;)this.add(t,r,t[r]||0,e[r],0,0,0,0,0,1)}},_r("roundProps",le),_r("modifiers"),_r("snap",ce))||Sr;tr.version=He.version=xr.version="3.13.0",d=1,N()&&Pe();Ie.Power0,Ie.Power1,Ie.Power2,Ie.Power3,Ie.Power4,Ie.Linear,Ie.Quad,Ie.Cubic,Ie.Quart,Ie.Quint,Ie.Strong,Ie.Elastic,Ie.Back,Ie.SteppedEase,Ie.Bounce,Ie.Sine,Ie.Expo,Ie.Circ},738:(t,e,r)=>{"use strict";r.d(e,{Ay:()=>s,os:()=>s});var n=r(8607),i=r(2650),s=n.os.registerPlugin(i.H0)||n.os;s.core.Tween},6879:t=>{!function(e,r){var n=function(t,e,r){"use strict";var n,i;if(function(){var e,r={lazyClass:"lazyload",loadedClass:"lazyloaded",loadingClass:"lazyloading",preloadClass:"lazypreload",errorClass:"lazyerror",autosizesClass:"lazyautosizes",fastLoadedClass:"ls-is-cached",iframeLoadMode:0,srcAttr:"data-src",srcsetAttr:"data-srcset",sizesAttr:"data-sizes",minSize:40,customMedia:{},init:!0,expFactor:1.5,hFac:.8,loadMode:2,loadHidden:!0,ricTimeout:0,throttleDelay:125};for(e in i=t.lazySizesConfig||t.lazysizesConfig||{},r)e in i||(i[e]=r[e])}(),!e||!e.getElementsByClassName)return{init:function(){},cfg:i,noSupport:!0};var s=e.documentElement,o=t.HTMLPictureElement,a="addEventListener",l="getAttribute",c=t[a].bind(t),u=t.setTimeout,h=t.requestAnimationFrame||u,d=t.requestIdleCallback,f=/^picture$/i,p=["load","error","lazyincluded","_lazyloaded"],g={},m=Array.prototype.forEach,y=function(t,e){return g[e]||(g[e]=new RegExp("(\\s|^)"+e+"(\\s|$)")),g[e].test(t[l]("class")||"")&&g[e]},v=function(t,e){y(t,e)||t.setAttribute("class",(t[l]("class")||"").trim()+" "+e)},b=function(t,e){var r;(r=y(t,e))&&t.setAttribute("class",(t[l]("class")||"").replace(r," "))},E=function(t,e,r){var n=r?a:"removeEventListener";r&&E(t,e),p.forEach((function(r){t[n](r,e)}))},A=function(t,r,i,s,o){var a=e.createEvent("Event");return i||(i={}),i.instance=n,a.initEvent(r,!s,!o),a.detail=i,t.dispatchEvent(a),a},w=function(e,r){var n;!o&&(n=t.picturefill||i.pf)?(r&&r.src&&!e[l]("srcset")&&e.setAttribute("srcset",r.src),n({reevaluate:!0,elements:[e]})):r&&r.src&&(e.src=r.src)},T=function(t,e){return(getComputedStyle(t,null)||{})[e]},S=function(t,e,r){for(r=r||t.offsetWidth;r<i.minSize&&e&&!t._lazysizesWidth;)r=e.offsetWidth,e=e.parentNode;return r},L=(vt=[],bt=[],Et=vt,At=function(){var t=Et;for(Et=vt.length?bt:vt,mt=!0,yt=!1;t.length;)t.shift()();mt=!1},wt=function(t,r){mt&&!r?t.apply(this,arguments):(Et.push(t),yt||(yt=!0,(e.hidden?u:h)(At)))},wt._lsFlush=At,wt),_=function(t,e){return e?function(){L(t)}:function(){var e=this,r=arguments;L((function(){t.apply(e,r)}))}},x=function(t){var e,n=0,s=i.throttleDelay,o=i.ricTimeout,a=function(){e=!1,n=r.now(),t()},l=d&&o>49?function(){d(a,{timeout:o}),o!==i.ricTimeout&&(o=i.ricTimeout)}:_((function(){u(a)}),!0);return function(t){var i;(t=!0===t)&&(o=33),e||(e=!0,(i=s-(r.now()-n))<0&&(i=0),t||i<9?l():u(l,i))}},k=function(t){var e,n,i=99,s=function(){e=null,t()},o=function(){var t=r.now()-n;t<i?u(o,i-t):(d||s)(s)};return function(){n=r.now(),e||(e=u(o,i))}},P=(W=/^img$/i,z=/^iframe$/i,X="onscroll"in t&&!/(gle|ing)bot/.test(navigator.userAgent),Q=0,J=0,Z=0,tt=-1,et=function(t){Z--,(!t||Z<0||!t.target)&&(Z=0)},rt=function(t){return null==q&&(q="hidden"==T(e.body,"visibility")),q||!("hidden"==T(t.parentNode,"visibility")&&"hidden"==T(t,"visibility"))},nt=function(t,r){var n,i=t,o=rt(t);for(H-=r,Y+=r,V-=r,K+=r;o&&(i=i.offsetParent)&&i!=e.body&&i!=s;)(o=(T(i,"opacity")||1)>0)&&"visible"!=T(i,"overflow")&&(n=i.getBoundingClientRect(),o=K>n.left&&V<n.right&&Y>n.top-1&&H<n.bottom+1);return o},it=function(){var t,r,o,a,c,u,h,d,f,p,g,m,y=n.elements;if((B=i.loadMode)&&Z<8&&(t=y.length)){for(r=0,tt++;r<t;r++)if(y[r]&&!y[r]._lazyRace)if(!X||n.prematureUnveil&&n.prematureUnveil(y[r]))dt(y[r]);else if((d=y[r][l]("data-expand"))&&(u=1*d)||(u=J),p||(p=!i.expand||i.expand<1?s.clientHeight>500&&s.clientWidth>500?500:370:i.expand,n._defEx=p,g=p*i.expFactor,m=i.hFac,q=null,J<g&&Z<1&&tt>2&&B>2&&!e.hidden?(J=g,tt=0):J=B>1&&tt>1&&Z<6?p:Q),f!==u&&(j=innerWidth+u*m,G=innerHeight+u,h=-1*u,f=u),o=y[r].getBoundingClientRect(),(Y=o.bottom)>=h&&(H=o.top)<=G&&(K=o.right)>=h*m&&(V=o.left)<=j&&(Y||K||V||H)&&(i.loadHidden||rt(y[r]))&&(F&&Z<3&&!d&&(B<3||tt<4)||nt(y[r],u))){if(dt(y[r]),c=!0,Z>9)break}else!c&&F&&!a&&Z<4&&tt<4&&B>2&&(N[0]||i.preloadAfterLoad)&&(N[0]||!d&&(Y||K||V||H||"auto"!=y[r][l](i.sizesAttr)))&&(a=N[0]||y[r]);a&&!c&&dt(a)}},st=x(it),ot=function(t){var e=t.target;e._lazyCache?delete e._lazyCache:(et(t),v(e,i.loadedClass),b(e,i.loadingClass),E(e,lt),A(e,"lazyloaded"))},at=_(ot),lt=function(t){at({target:t.target})},ct=function(t,e){var r=t.getAttribute("data-load-mode")||i.iframeLoadMode;0==r?t.contentWindow.location.replace(e):1==r&&(t.src=e)},ut=function(t){var e,r=t[l](i.srcsetAttr);(e=i.customMedia[t[l]("data-media")||t[l]("media")])&&t.setAttribute("media",e),r&&t.setAttribute("srcset",r)},ht=_((function(t,e,r,n,s){var o,a,c,h,d,p;(d=A(t,"lazybeforeunveil",e)).defaultPrevented||(n&&(r?v(t,i.autosizesClass):t.setAttribute("sizes",n)),a=t[l](i.srcsetAttr),o=t[l](i.srcAttr),s&&(h=(c=t.parentNode)&&f.test(c.nodeName||"")),p=e.firesLoad||"src"in t&&(a||o||h),d={target:t},v(t,i.loadingClass),p&&(clearTimeout(U),U=u(et,2500),E(t,lt,!0)),h&&m.call(c.getElementsByTagName("source"),ut),a?t.setAttribute("srcset",a):o&&!h&&(z.test(t.nodeName)?ct(t,o):t.src=o),s&&(a||h)&&w(t,{src:o})),t._lazyRace&&delete t._lazyRace,b(t,i.lazyClass),L((function(){var e=t.complete&&t.naturalWidth>1;p&&!e||(e&&v(t,i.fastLoadedClass),ot(d),t._lazyCache=!0,u((function(){"_lazyCache"in t&&delete t._lazyCache}),9)),"lazy"==t.loading&&Z--}),!0)})),dt=function(t){if(!t._lazyRace){var e,r=W.test(t.nodeName),n=r&&(t[l](i.sizesAttr)||t[l]("sizes")),s="auto"==n;(!s&&F||!r||!t[l]("src")&&!t.srcset||t.complete||y(t,i.errorClass)||!y(t,i.lazyClass))&&(e=A(t,"lazyunveilread").detail,s&&I.updateElem(t,!0,t.offsetWidth),t._lazyRace=!0,Z++,ht(t,e,s,n,r))}},ft=k((function(){i.loadMode=3,st()})),pt=function(){3==i.loadMode&&(i.loadMode=2),ft()},gt=function(){F||(r.now()-$<999?u(gt,999):(F=!0,i.loadMode=3,st(),c("scroll",pt,!0)))},{_:function(){$=r.now(),n.elements=e.getElementsByClassName(i.lazyClass),N=e.getElementsByClassName(i.lazyClass+" "+i.preloadClass),c("scroll",st,!0),c("resize",st,!0),c("pageshow",(function(t){if(t.persisted){var r=e.querySelectorAll("."+i.loadingClass);r.length&&r.forEach&&h((function(){r.forEach((function(t){t.complete&&dt(t)}))}))}})),t.MutationObserver?new MutationObserver(st).observe(s,{childList:!0,subtree:!0,attributes:!0}):(s[a]("DOMNodeInserted",st,!0),s[a]("DOMAttrModified",st,!0),setInterval(st,999)),c("hashchange",st,!0),["focus","mouseover","click","load","transitionend","animationend"].forEach((function(t){e[a](t,st,!0)})),/d$|^c/.test(e.readyState)?gt():(c("load",gt),e[a]("DOMContentLoaded",st),u(gt,2e4)),n.elements.length?(it(),L._lsFlush()):st()},checkElems:st,unveil:dt,_aLSL:pt}),I=(D=_((function(t,e,r,n){var i,s,o;if(t._lazysizesWidth=n,n+="px",t.setAttribute("sizes",n),f.test(e.nodeName||""))for(s=0,o=(i=e.getElementsByTagName("source")).length;s<o;s++)i[s].setAttribute("sizes",n);r.detail.dataAttr||w(t,r.detail)})),C=function(t,e,r){var n,i=t.parentNode;i&&(r=S(t,i,r),(n=A(t,"lazybeforesizes",{width:r,dataAttr:!!e})).defaultPrevented||(r=n.detail.width)&&r!==t._lazysizesWidth&&D(t,i,n,r))},M=k((function(){var t,e=O.length;if(e)for(t=0;t<e;t++)C(O[t])})),{_:function(){O=e.getElementsByClassName(i.autosizesClass),c("resize",M)},checkElems:M,updateElem:C}),R=function(){!R.i&&e.getElementsByClassName&&(R.i=!0,I._(),P._())};var O,D,C,M;var N,F,U,B,$,j,G,H,V,K,Y,q,W,z,X,Q,J,Z,tt,et,rt,nt,it,st,ot,at,lt,ct,ut,ht,dt,ft,pt,gt;var mt,yt,vt,bt,Et,At,wt;return u((function(){i.init&&R()})),n={cfg:i,autoSizer:I,loader:P,init:R,uP:w,aC:v,rC:b,hC:y,fire:A,gW:S,rAF:L}}(e,e.document,Date);e.lazySizes=n,t.exports&&(t.exports=n)}("undefined"!=typeof window?window:{})},2552:(t,e,r)=>{var n,i,s;!function(o,a){if(o){a=a.bind(null,o,o.document),t.exports?a(r(6879)):(i=[r(6879)],void 0===(s="function"==typeof(n=a)?n.apply(e,i):n)||(t.exports=s))}}("undefined"!=typeof window?window:0,(function(t,e,r){"use strict";if(t.addEventListener){var n=/\s+(\d+)(w|h)\s+(\d+)(w|h)/,i=/parent-fit["']*\s*:\s*["']*(contain|cover|width)/,s=/parent-container["']*\s*:\s*["']*(.+?)(?=(\s|$|,|'|"|;))/,o=/^picture$/i,a=r.cfg,l={getParent:function(e,r){var n=e,i=e.parentNode;return r&&"prev"!=r||!i||!o.test(i.nodeName||"")||(i=i.parentNode),"self"!=r&&(n="prev"==r?e.previousElementSibling:r&&(i.closest||t.jQuery)&&(i.closest?i.closest(r):jQuery(i).closest(r)[0])||i),n},getFit:function(t){var e,r,n=getComputedStyle(t,null)||{},o=n.content||n.fontFamily,a={fit:t._lazysizesParentFit||t.getAttribute("data-parent-fit")};return!a.fit&&o&&(e=o.match(i))&&(a.fit=e[1]),a.fit?(!(r=t._lazysizesParentContainer||t.getAttribute("data-parent-container"))&&o&&(e=o.match(s))&&(r=e[1]),a.parent=l.getParent(t,r)):a.fit=n.objectFit,a},getImageRatio:function(e){var r,i,s,l,c,u,h,d=e.parentNode,f=d&&o.test(d.nodeName||"")?d.querySelectorAll("source, img"):[e];for(r=0;r<f.length;r++)if(i=(e=f[r]).getAttribute(a.srcsetAttr)||e.getAttribute("srcset")||e.getAttribute("data-pfsrcset")||e.getAttribute("data-risrcset")||"",s=e._lsMedia||e.getAttribute("media"),s=a.customMedia[e.getAttribute("data-media")||s]||s,i&&(!s||(t.matchMedia&&matchMedia(s)||{}).matches)){(l=parseFloat(e.getAttribute("data-aspectratio")))||((c=i.match(n))?"w"==c[2]?(u=c[1],h=c[3]):(u=c[3],h=c[1]):(u=e.getAttribute("width"),h=e.getAttribute("height")),l=u/h);break}return l},calculateSize:function(t,e){var r,n,i,s=this.getFit(t),o=s.fit,a=s.parent;return"width"==o||("contain"==o||"cover"==o)&&(n=this.getImageRatio(t))?(a?e=a.clientWidth:a=t,i=e,"width"==o?i=e:(r=e/a.clientHeight)&&("cover"==o&&r<n||"contain"==o&&r>n)&&(i=e*(n/r)),i):e}};r.parentFit=l,e.addEventListener("lazybeforesizes",(function(t){if(!t.defaultPrevented&&t.detail.instance==r){var e=t.target;t.detail.width=l.calculateSize(e,t.detail.width)}}))}}))},181:(t,e,r)=>{var n="Expected a function",i=NaN,s="[object Symbol]",o=/^\s+|\s+$/g,a=/^[-+]0x[0-9a-f]+$/i,l=/^0b[01]+$/i,c=/^0o[0-7]+$/i,u=parseInt,h="object"==typeof r.g&&r.g&&r.g.Object===Object&&r.g,d="object"==typeof self&&self&&self.Object===Object&&self,f=h||d||Function("return this")(),p=Object.prototype.toString,g=Math.max,m=Math.min,y=function(){return f.Date.now()};function v(t){var e=typeof t;return!!t&&("object"==e||"function"==e)}function b(t){if("number"==typeof t)return t;if(function(t){return"symbol"==typeof t||function(t){return!!t&&"object"==typeof t}(t)&&p.call(t)==s}(t))return i;if(v(t)){var e="function"==typeof t.valueOf?t.valueOf():t;t=v(e)?e+"":e}if("string"!=typeof t)return 0===t?t:+t;t=t.replace(o,"");var r=l.test(t);return r||c.test(t)?u(t.slice(2),r?2:8):a.test(t)?i:+t}t.exports=function(t,e,r){var i,s,o,a,l,c,u=0,h=!1,d=!1,f=!0;if("function"!=typeof t)throw new TypeError(n);function p(e){var r=i,n=s;return i=s=void 0,u=e,a=t.apply(n,r)}function E(t){var r=t-c;return void 0===c||r>=e||r<0||d&&t-u>=o}function A(){var t=y();if(E(t))return w(t);l=setTimeout(A,function(t){var r=e-(t-c);return d?m(r,o-(t-u)):r}(t))}function w(t){return l=void 0,f&&i?p(t):(i=s=void 0,a)}function T(){var t=y(),r=E(t);if(i=arguments,s=this,c=t,r){if(void 0===l)return function(t){return u=t,l=setTimeout(A,e),h?p(t):a}(c);if(d)return l=setTimeout(A,e),p(c)}return void 0===l&&(l=setTimeout(A,e)),a}return e=b(e)||0,v(r)&&(h=!!r.leading,o=(d="maxWait"in r)?g(b(r.maxWait)||0,e):o,f="trailing"in r?!!r.trailing:f),T.cancel=function(){void 0!==l&&clearTimeout(l),u=0,i=c=s=l=void 0},T.flush=function(){return void 0===l?a:w(y())},T}},5858:(t,e,r)=>{var n="Expected a function",i=NaN,s="[object Symbol]",o=/^\s+|\s+$/g,a=/^[-+]0x[0-9a-f]+$/i,l=/^0b[01]+$/i,c=/^0o[0-7]+$/i,u=parseInt,h="object"==typeof r.g&&r.g&&r.g.Object===Object&&r.g,d="object"==typeof self&&self&&self.Object===Object&&self,f=h||d||Function("return this")(),p=Object.prototype.toString,g=Math.max,m=Math.min,y=function(){return f.Date.now()};function v(t,e,r){var i,s,o,a,l,c,u=0,h=!1,d=!1,f=!0;if("function"!=typeof t)throw new TypeError(n);function p(e){var r=i,n=s;return i=s=void 0,u=e,a=t.apply(n,r)}function v(t){var r=t-c;return void 0===c||r>=e||r<0||d&&t-u>=o}function A(){var t=y();if(v(t))return w(t);l=setTimeout(A,function(t){var r=e-(t-c);return d?m(r,o-(t-u)):r}(t))}function w(t){return l=void 0,f&&i?p(t):(i=s=void 0,a)}function T(){var t=y(),r=v(t);if(i=arguments,s=this,c=t,r){if(void 0===l)return function(t){return u=t,l=setTimeout(A,e),h?p(t):a}(c);if(d)return l=setTimeout(A,e),p(c)}return void 0===l&&(l=setTimeout(A,e)),a}return e=E(e)||0,b(r)&&(h=!!r.leading,o=(d="maxWait"in r)?g(E(r.maxWait)||0,e):o,f="trailing"in r?!!r.trailing:f),T.cancel=function(){void 0!==l&&clearTimeout(l),u=0,i=c=s=l=void 0},T.flush=function(){return void 0===l?a:w(y())},T}function b(t){var e=typeof t;return!!t&&("object"==e||"function"==e)}function E(t){if("number"==typeof t)return t;if(function(t){return"symbol"==typeof t||function(t){return!!t&&"object"==typeof t}(t)&&p.call(t)==s}(t))return i;if(b(t)){var e="function"==typeof t.valueOf?t.valueOf():t;t=b(e)?e+"":e}if("string"!=typeof t)return 0===t?t:+t;t=t.replace(o,"");var r=l.test(t);return r||c.test(t)?u(t.slice(2),r?2:8):a.test(t)?i:+t}t.exports=function(t,e,r){var i=!0,s=!0;if("function"!=typeof t)throw new TypeError(n);return b(r)&&(i="leading"in r?!!r.leading:i,s="trailing"in r?!!r.trailing:s),v(t,e,{leading:i,maxWait:e,trailing:s})}},138:()=>{},6608:()=>{},5172:()=>{},204:()=>{},175:()=>{},4470:()=>{},4768:()=>{},601:()=>{},3739:()=>{},9855:()=>{},6398:()=>{},5966:()=>{},3168:()=>{},6111:()=>{},1261:()=>{},7183:()=>{},599:()=>{},5190:()=>{},9545:()=>{},3810:()=>{},441:()=>{},2072:()=>{},5666:()=>{},5464:()=>{},6344:()=>{},6900:()=>{},8665:()=>{},221:()=>{},1363:()=>{},1781:()=>{},4330:function(t,e,r){"object"==typeof navigator&&(t.exports=function(){"use strict";function t(t,e,r){return(e=function(t){var e=function(t,e){if("object"!=typeof t||null===t)return t;var r=t[Symbol.toPrimitive];if(void 0!==r){var n=r.call(t,e||"default");if("object"!=typeof n)return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return("string"===e?String:Number)(t)}(t,"string");return"symbol"==typeof e?e:String(e)}(e))in t?Object.defineProperty(t,e,{value:r,enumerable:!0,configurable:!0,writable:!0}):t[e]=r,t}function e(t,e){for(var r=0;r<e.length;r++){var n=e[r];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(t,n.key,n)}}function n(t,e,r){return e in t?Object.defineProperty(t,e,{value:r,enumerable:!0,configurable:!0,writable:!0}):t[e]=r,t}function i(t,e){var r=Object.keys(t);if(Object.getOwnPropertySymbols){var n=Object.getOwnPropertySymbols(t);e&&(n=n.filter((function(e){return Object.getOwnPropertyDescriptor(t,e).enumerable}))),r.push.apply(r,n)}return r}function s(t){for(var e=1;e<arguments.length;e++){var r=null!=arguments[e]?arguments[e]:{};e%2?i(Object(r),!0).forEach((function(e){n(t,e,r[e])})):Object.getOwnPropertyDescriptors?Object.defineProperties(t,Object.getOwnPropertyDescriptors(r)):i(Object(r)).forEach((function(e){Object.defineProperty(t,e,Object.getOwnPropertyDescriptor(r,e))}))}return t}var o={addCSS:!0,thumbWidth:15,watch:!0},a=function(t){return null!=t?t.constructor:null},l=function(t,e){return!!(t&&e&&t instanceof e)},c=function(t){return null==t},u=function(t){return a(t)===Object},h=function(t){return a(t)===String},d=function(t){return Array.isArray(t)},f=function(t){return l(t,NodeList)},p={nullOrUndefined:c,object:u,number:function(t){return a(t)===Number&&!Number.isNaN(t)},string:h,boolean:function(t){return a(t)===Boolean},function:function(t){return a(t)===Function},array:d,nodeList:f,element:function(t){return l(t,Element)},event:function(t){return l(t,Event)},empty:function(t){return c(t)||(h(t)||d(t)||f(t))&&!t.length||u(t)&&!Object.keys(t).length}};function g(t,e){if(1>e){var r=function(t){var e="".concat(t).match(/(?:\.(\d+))?(?:[eE]([+-]?\d+))?$/);return e?Math.max(0,(e[1]?e[1].length:0)-(e[2]?+e[2]:0)):0}(e);return parseFloat(t.toFixed(r))}return Math.round(t/e)*e}var m=function(){function t(e,r){(function(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")})(this,t),p.element(e)?this.element=e:p.string(e)&&(this.element=document.querySelector(e)),p.element(this.element)&&p.empty(this.element.rangeTouch)&&(this.config=s({},o,{},r),this.init())}return function(t,r,n){r&&e(t.prototype,r),n&&e(t,n)}(t,[{key:"init",value:function(){t.enabled&&(this.config.addCSS&&(this.element.style.userSelect="none",this.element.style.webKitUserSelect="none",this.element.style.touchAction="manipulation"),this.listeners(!0),this.element.rangeTouch=this)}},{key:"destroy",value:function(){t.enabled&&(this.config.addCSS&&(this.element.style.userSelect="",this.element.style.webKitUserSelect="",this.element.style.touchAction=""),this.listeners(!1),this.element.rangeTouch=null)}},{key:"listeners",value:function(t){var e=this,r=t?"addEventListener":"removeEventListener";["touchstart","touchmove","touchend"].forEach((function(t){e.element[r](t,(function(t){return e.set(t)}),!1)}))}},{key:"get",value:function(e){if(!t.enabled||!p.event(e))return null;var r,n=e.target,i=e.changedTouches[0],s=parseFloat(n.getAttribute("min"))||0,o=parseFloat(n.getAttribute("max"))||100,a=parseFloat(n.getAttribute("step"))||1,l=n.getBoundingClientRect(),c=100/l.width*(this.config.thumbWidth/2)/100;return 0>(r=100/l.width*(i.clientX-l.left))?r=0:100<r&&(r=100),50>r?r-=(100-2*r)*c:50<r&&(r+=2*(r-50)*c),s+g(r/100*(o-s),a)}},{key:"set",value:function(e){t.enabled&&p.event(e)&&!e.target.disabled&&(e.preventDefault(),e.target.value=this.get(e),function(t,e){if(t&&e){var r=new Event(e,{bubbles:!0});t.dispatchEvent(r)}}(e.target,"touchend"===e.type?"change":"input"))}}],[{key:"setup",value:function(e){var r=1<arguments.length&&void 0!==arguments[1]?arguments[1]:{},n=null;if(p.empty(e)||p.string(e)?n=Array.from(document.querySelectorAll(p.string(e)?e:'input[type="range"]')):p.element(e)?n=[e]:p.nodeList(e)?n=Array.from(e):p.array(e)&&(n=e.filter(p.element)),p.empty(n))return null;var i=s({},o,{},r);if(p.string(e)&&i.watch){var a=new MutationObserver((function(r){Array.from(r).forEach((function(r){Array.from(r.addedNodes).forEach((function(r){p.element(r)&&function(t,e){return function(){return Array.from(document.querySelectorAll(e)).includes(this)}.call(t,e)}(r,e)&&new t(r,i)}))}))}));a.observe(document.body,{childList:!0,subtree:!0})}return n.map((function(e){return new t(e,r)}))}},{key:"enabled",get:function(){return"ontouchstart"in document.documentElement}}]),t}();const y=t=>null!=t?t.constructor:null,v=(t,e)=>Boolean(t&&e&&t instanceof e),b=t=>null==t,E=t=>y(t)===Object,A=t=>y(t)===String,w=t=>"function"==typeof t,T=t=>Array.isArray(t),S=t=>v(t,NodeList),L=t=>b(t)||(A(t)||T(t)||S(t))&&!t.length||E(t)&&!Object.keys(t).length;var _={nullOrUndefined:b,object:E,number:t=>y(t)===Number&&!Number.isNaN(t),string:A,boolean:t=>y(t)===Boolean,function:w,array:T,weakMap:t=>v(t,WeakMap),nodeList:S,element:t=>null!==t&&"object"==typeof t&&1===t.nodeType&&"object"==typeof t.style&&"object"==typeof t.ownerDocument,textNode:t=>y(t)===Text,event:t=>v(t,Event),keyboardEvent:t=>v(t,KeyboardEvent),cue:t=>v(t,window.TextTrackCue)||v(t,window.VTTCue),track:t=>v(t,TextTrack)||!b(t)&&A(t.kind),promise:t=>v(t,Promise)&&w(t.then),url:t=>{if(v(t,window.URL))return!0;if(!A(t))return!1;let e=t;t.startsWith("http://")&&t.startsWith("https://")||(e=`http://${t}`);try{return!L(new URL(e).hostname)}catch(t){return!1}},empty:L};const x=(()=>{const t=document.createElement("span"),e={WebkitTransition:"webkitTransitionEnd",MozTransition:"transitionend",OTransition:"oTransitionEnd otransitionend",transition:"transitionend"},r=Object.keys(e).find((e=>void 0!==t.style[e]));return!!_.string(r)&&e[r]})();function k(t,e){setTimeout((()=>{try{t.hidden=!0,t.offsetHeight,t.hidden=!1}catch(t){}}),e)}var P={isIE:Boolean(window.document.documentMode),isEdge:/Edge/g.test(navigator.userAgent),isWebKit:"WebkitAppearance"in document.documentElement.style&&!/Edge/g.test(navigator.userAgent),isIPhone:/iPhone|iPod/gi.test(navigator.userAgent)&&navigator.maxTouchPoints>1,isIPadOS:"MacIntel"===navigator.platform&&navigator.maxTouchPoints>1,isIos:/iPad|iPhone|iPod/gi.test(navigator.userAgent)&&navigator.maxTouchPoints>1};function I(t,e){return e.split(".").reduce(((t,e)=>t&&t[e]),t)}function R(t={},...e){if(!e.length)return t;const r=e.shift();return _.object(r)?(Object.keys(r).forEach((e=>{_.object(r[e])?(Object.keys(t).includes(e)||Object.assign(t,{[e]:{}}),R(t[e],r[e])):Object.assign(t,{[e]:r[e]})})),R(t,...e)):t}function O(t,e){const r=t.length?t:[t];Array.from(r).reverse().forEach(((t,r)=>{const n=r>0?e.cloneNode(!0):e,i=t.parentNode,s=t.nextSibling;n.appendChild(t),s?i.insertBefore(n,s):i.appendChild(n)}))}function D(t,e){_.element(t)&&!_.empty(e)&&Object.entries(e).filter((([,t])=>!_.nullOrUndefined(t))).forEach((([e,r])=>t.setAttribute(e,r)))}function C(t,e,r){const n=document.createElement(t);return _.object(e)&&D(n,e),_.string(r)&&(n.innerText=r),n}function M(t,e,r,n){_.element(e)&&e.appendChild(C(t,r,n))}function N(t){_.nodeList(t)||_.array(t)?Array.from(t).forEach(N):_.element(t)&&_.element(t.parentNode)&&t.parentNode.removeChild(t)}function F(t){if(!_.element(t))return;let{length:e}=t.childNodes;for(;e>0;)t.removeChild(t.lastChild),e-=1}function U(t,e){return _.element(e)&&_.element(e.parentNode)&&_.element(t)?(e.parentNode.replaceChild(t,e),t):null}function B(t,e){if(!_.string(t)||_.empty(t))return{};const r={},n=R({},e);return t.split(",").forEach((t=>{const e=t.trim(),i=e.replace(".",""),s=e.replace(/[[\]]/g,"").split("="),[o]=s,a=s.length>1?s[1].replace(/["']/g,""):"";switch(e.charAt(0)){case".":_.string(n.class)?r.class=`${n.class} ${i}`:r.class=i;break;case"#":r.id=e.replace("#","");break;case"[":r[o]=a}})),R(n,r)}function $(t,e){if(!_.element(t))return;let r=e;_.boolean(r)||(r=!t.hidden),t.hidden=r}function j(t,e,r){if(_.nodeList(t))return Array.from(t).map((t=>j(t,e,r)));if(_.element(t)){let n="toggle";return void 0!==r&&(n=r?"add":"remove"),t.classList[n](e),t.classList.contains(e)}return!1}function G(t,e){return _.element(t)&&t.classList.contains(e)}function H(t,e){const{prototype:r}=Element;return(r.matches||r.webkitMatchesSelector||r.mozMatchesSelector||r.msMatchesSelector||function(){return Array.from(document.querySelectorAll(e)).includes(this)}).call(t,e)}function V(t){return this.elements.container.querySelectorAll(t)}function K(t){return this.elements.container.querySelector(t)}function Y(t=null,e=!1){_.element(t)&&t.focus({preventScroll:!0,focusVisible:e})}const q={"audio/ogg":"vorbis","audio/wav":"1","video/webm":"vp8, vorbis","video/mp4":"avc1.42E01E, mp4a.40.2","video/ogg":"theora"},W={audio:"canPlayType"in document.createElement("audio"),video:"canPlayType"in document.createElement("video"),check(t,e){const r=W[t]||"html5"!==e;return{api:r,ui:r&&W.rangeInput}},pip:!(P.isIPhone||!_.function(C("video").webkitSetPresentationMode)&&(!document.pictureInPictureEnabled||C("video").disablePictureInPicture)),airplay:_.function(window.WebKitPlaybackTargetAvailabilityEvent),playsinline:"playsInline"in document.createElement("video"),mime(t){if(_.empty(t))return!1;const[e]=t.split("/");let r=t;if(!this.isHTML5||e!==this.type)return!1;Object.keys(q).includes(r)&&(r+=`; codecs="${q[t]}"`);try{return Boolean(r&&this.media.canPlayType(r).replace(/no/,""))}catch(t){return!1}},textTracks:"textTracks"in document.createElement("video"),rangeInput:(()=>{const t=document.createElement("input");return t.type="range","range"===t.type})(),touch:"ontouchstart"in document.documentElement,transitions:!1!==x,reducedMotion:"matchMedia"in window&&window.matchMedia("(prefers-reduced-motion)").matches},z=(()=>{let t=!1;try{const e=Object.defineProperty({},"passive",{get:()=>(t=!0,null)});window.addEventListener("test",null,e),window.removeEventListener("test",null,e)}catch(t){}return t})();function X(t,e,r,n=!1,i=!0,s=!1){if(!t||!("addEventListener"in t)||_.empty(e)||!_.function(r))return;const o=e.split(" ");let a=s;z&&(a={passive:i,capture:s}),o.forEach((e=>{this&&this.eventListeners&&n&&this.eventListeners.push({element:t,type:e,callback:r,options:a}),t[n?"addEventListener":"removeEventListener"](e,r,a)}))}function Q(t,e="",r,n=!0,i=!1){X.call(this,t,e,r,!0,n,i)}function J(t,e="",r,n=!0,i=!1){X.call(this,t,e,r,!1,n,i)}function Z(t,e="",r,n=!0,i=!1){const s=(...o)=>{J(t,e,s,n,i),r.apply(this,o)};X.call(this,t,e,s,!0,n,i)}function tt(t,e="",r=!1,n={}){if(!_.element(t)||_.empty(e))return;const i=new CustomEvent(e,{bubbles:r,detail:{...n,plyr:this}});t.dispatchEvent(i)}function et(){this&&this.eventListeners&&(this.eventListeners.forEach((t=>{const{element:e,type:r,callback:n,options:i}=t;e.removeEventListener(r,n,i)})),this.eventListeners=[])}function rt(){return new Promise((t=>this.ready?setTimeout(t,0):Q.call(this,this.elements.container,"ready",t))).then((()=>{}))}function nt(t){_.promise(t)&&t.then(null,(()=>{}))}function it(t){return _.array(t)?t.filter(((e,r)=>t.indexOf(e)===r)):t}function st(t,e){return _.array(t)&&t.length?t.reduce(((t,r)=>Math.abs(r-e)<Math.abs(t-e)?r:t)):null}function ot(t){return!(!window||!window.CSS)&&window.CSS.supports(t)}const at=[[1,1],[4,3],[3,4],[5,4],[4,5],[3,2],[2,3],[16,10],[10,16],[16,9],[9,16],[21,9],[9,21],[32,9],[9,32]].reduce(((t,[e,r])=>({...t,[e/r]:[e,r]})),{});function lt(t){return!!(_.array(t)||_.string(t)&&t.includes(":"))&&(_.array(t)?t:t.split(":")).map(Number).every(_.number)}function ct(t){if(!_.array(t)||!t.every(_.number))return null;const[e,r]=t,n=(t,e)=>0===e?t:n(e,t%e),i=n(e,r);return[e/i,r/i]}function ut(t){const e=t=>lt(t)?t.split(":").map(Number):null;let r=e(t);if(null===r&&(r=e(this.config.ratio)),null===r&&!_.empty(this.embed)&&_.array(this.embed.ratio)&&({ratio:r}=this.embed),null===r&&this.isHTML5){const{videoWidth:t,videoHeight:e}=this.media;r=[t,e]}return ct(r)}function ht(t){if(!this.isVideo)return{};const{wrapper:e}=this.elements,r=ut.call(this,t);if(!_.array(r))return{};const[n,i]=ct(r),s=100/n*i;if(ot(`aspect-ratio: ${n}/${i}`)?e.style.aspectRatio=`${n}/${i}`:e.style.paddingBottom=`${s}%`,this.isVimeo&&!this.config.vimeo.premium&&this.supported.ui){const t=100/this.media.offsetWidth*parseInt(window.getComputedStyle(this.media).paddingBottom,10),r=(t-s)/(t/50);this.fullscreen.active?e.style.paddingBottom=null:this.media.style.transform=`translateY(-${r}%)`}else this.isHTML5&&e.classList.add(this.config.classNames.videoFixedRatio);return{padding:s,ratio:r}}function dt(t,e,r=.05){const n=t/e,i=st(Object.keys(at),n);return Math.abs(i-n)<=r?at[i]:[t,e]}const ft={getSources(){return this.isHTML5?Array.from(this.media.querySelectorAll("source")).filter((t=>{const e=t.getAttribute("type");return!!_.empty(e)||W.mime.call(this,e)})):[]},getQualityOptions(){return this.config.quality.forced?this.config.quality.options:ft.getSources.call(this).map((t=>Number(t.getAttribute("size")))).filter(Boolean)},setup(){if(!this.isHTML5)return;const t=this;t.options.speed=t.config.speed.options,_.empty(this.config.ratio)||ht.call(t),Object.defineProperty(t.media,"quality",{get(){const e=ft.getSources.call(t).find((e=>e.getAttribute("src")===t.source));return e&&Number(e.getAttribute("size"))},set(e){if(t.quality!==e){if(t.config.quality.forced&&_.function(t.config.quality.onChange))t.config.quality.onChange(e);else{const r=ft.getSources.call(t).find((t=>Number(t.getAttribute("size"))===e));if(!r)return;const{currentTime:n,paused:i,preload:s,readyState:o,playbackRate:a}=t.media;t.media.src=r.getAttribute("src"),("none"!==s||o)&&(t.once("loadedmetadata",(()=>{t.speed=a,t.currentTime=n,i||nt(t.play())})),t.media.load())}tt.call(t,t.media,"qualitychange",!1,{quality:e})}}})},cancelRequests(){this.isHTML5&&(N(ft.getSources.call(this)),this.media.setAttribute("src",this.config.blankVideo),this.media.load(),this.debug.log("Cancelled network requests"))}};function pt(t,...e){return _.empty(t)?t:t.toString().replace(/{(\d+)}/g,((t,r)=>e[r].toString()))}const gt=(t="",e="",r="")=>t.replace(new RegExp(e.toString().replace(/([.*+?^=!:${}()|[\]/\\])/g,"\\$1"),"g"),r.toString()),mt=(t="")=>t.toString().replace(/\w\S*/g,(t=>t.charAt(0).toUpperCase()+t.slice(1).toLowerCase()));function yt(t=""){let e=t.toString();return e=function(t=""){let e=t.toString();return e=gt(e,"-"," "),e=gt(e,"_"," "),e=mt(e),gt(e," ","")}(e),e.charAt(0).toLowerCase()+e.slice(1)}function vt(t){const e=document.createElement("div");return e.appendChild(t),e.innerHTML}const bt={pip:"PIP",airplay:"AirPlay",html5:"HTML5",vimeo:"Vimeo",youtube:"YouTube"},Et={get(t="",e={}){if(_.empty(t)||_.empty(e))return"";let r=I(e.i18n,t);if(_.empty(r))return Object.keys(bt).includes(t)?bt[t]:"";const n={"{seektime}":e.seekTime,"{title}":e.title};return Object.entries(n).forEach((([t,e])=>{r=gt(r,t,e)})),r}};class At{constructor(e){t(this,"get",(t=>{if(!At.supported||!this.enabled)return null;const e=window.localStorage.getItem(this.key);if(_.empty(e))return null;const r=JSON.parse(e);return _.string(t)&&t.length?r[t]:r})),t(this,"set",(t=>{if(!At.supported||!this.enabled)return;if(!_.object(t))return;let e=this.get();_.empty(e)&&(e={}),R(e,t);try{window.localStorage.setItem(this.key,JSON.stringify(e))}catch(t){}})),this.enabled=e.config.storage.enabled,this.key=e.config.storage.key}static get supported(){try{if(!("localStorage"in window))return!1;const t="___test";return window.localStorage.setItem(t,t),window.localStorage.removeItem(t),!0}catch(t){return!1}}}function wt(t,e="text"){return new Promise(((r,n)=>{try{const n=new XMLHttpRequest;if(!("withCredentials"in n))return;n.addEventListener("load",(()=>{if("text"===e)try{r(JSON.parse(n.responseText))}catch(t){r(n.responseText)}else r(n.response)})),n.addEventListener("error",(()=>{throw new Error(n.status)})),n.open("GET",t,!0),n.responseType=e,n.send()}catch(t){n(t)}}))}function Tt(t,e){if(!_.string(t))return;const r="cache",n=_.string(e);let i=!1;const s=()=>null!==document.getElementById(e),o=(t,e)=>{t.innerHTML=e,n&&s()||document.body.insertAdjacentElement("afterbegin",t)};if(!n||!s()){const s=At.supported,a=document.createElement("div");if(a.setAttribute("hidden",""),n&&a.setAttribute("id",e),s){const t=window.localStorage.getItem(`${r}-${e}`);if(i=null!==t,i){const e=JSON.parse(t);o(a,e.content)}}wt(t).then((t=>{if(!_.empty(t)){if(s)try{window.localStorage.setItem(`${r}-${e}`,JSON.stringify({content:t}))}catch(t){}o(a,t)}})).catch((()=>{}))}}const St=t=>Math.trunc(t/60/60%60,10),Lt=t=>Math.trunc(t/60%60,10),_t=t=>Math.trunc(t%60,10);function xt(t=0,e=!1,r=!1){if(!_.number(t))return xt(void 0,e,r);const n=t=>`0${t}`.slice(-2);let i=St(t);const s=Lt(t),o=_t(t);return i=e||i>0?`${i}:`:"",`${r&&t>0?"-":""}${i}${n(s)}:${n(o)}`}const kt={getIconUrl(){const t=new URL(this.config.iconUrl,window.location),e=window.location.host?window.location.host:window.top.location.host,r=t.host!==e||P.isIE&&!window.svg4everybody;return{url:this.config.iconUrl,cors:r}},findElements(){try{return this.elements.controls=K.call(this,this.config.selectors.controls.wrapper),this.elements.buttons={play:V.call(this,this.config.selectors.buttons.play),pause:K.call(this,this.config.selectors.buttons.pause),restart:K.call(this,this.config.selectors.buttons.restart),rewind:K.call(this,this.config.selectors.buttons.rewind),fastForward:K.call(this,this.config.selectors.buttons.fastForward),mute:K.call(this,this.config.selectors.buttons.mute),pip:K.call(this,this.config.selectors.buttons.pip),airplay:K.call(this,this.config.selectors.buttons.airplay),settings:K.call(this,this.config.selectors.buttons.settings),captions:K.call(this,this.config.selectors.buttons.captions),fullscreen:K.call(this,this.config.selectors.buttons.fullscreen)},this.elements.progress=K.call(this,this.config.selectors.progress),this.elements.inputs={seek:K.call(this,this.config.selectors.inputs.seek),volume:K.call(this,this.config.selectors.inputs.volume)},this.elements.display={buffer:K.call(this,this.config.selectors.display.buffer),currentTime:K.call(this,this.config.selectors.display.currentTime),duration:K.call(this,this.config.selectors.display.duration)},_.element(this.elements.progress)&&(this.elements.display.seekTooltip=this.elements.progress.querySelector(`.${this.config.classNames.tooltip}`)),!0}catch(t){return this.debug.warn("It looks like there is a problem with your custom controls HTML",t),this.toggleNativeControls(!0),!1}},createIcon(t,e){const r="http://www.w3.org/2000/svg",n=kt.getIconUrl.call(this),i=`${n.cors?"":n.url}#${this.config.iconPrefix}`,s=document.createElementNS(r,"svg");D(s,R(e,{"aria-hidden":"true",focusable:"false"}));const o=document.createElementNS(r,"use"),a=`${i}-${t}`;return"href"in o&&o.setAttributeNS("http://www.w3.org/1999/xlink","href",a),o.setAttributeNS("http://www.w3.org/1999/xlink","xlink:href",a),s.appendChild(o),s},createLabel(t,e={}){const r=Et.get(t,this.config);return C("span",{...e,class:[e.class,this.config.classNames.hidden].filter(Boolean).join(" ")},r)},createBadge(t){if(_.empty(t))return null;const e=C("span",{class:this.config.classNames.menu.value});return e.appendChild(C("span",{class:this.config.classNames.menu.badge},t)),e},createButton(t,e){const r=R({},e);let n=yt(t);const i={element:"button",toggle:!1,label:null,icon:null,labelPressed:null,iconPressed:null};switch(["element","icon","label"].forEach((t=>{Object.keys(r).includes(t)&&(i[t]=r[t],delete r[t])})),"button"!==i.element||Object.keys(r).includes("type")||(r.type="button"),Object.keys(r).includes("class")?r.class.split(" ").some((t=>t===this.config.classNames.control))||R(r,{class:`${r.class} ${this.config.classNames.control}`}):r.class=this.config.classNames.control,t){case"play":i.toggle=!0,i.label="play",i.labelPressed="pause",i.icon="play",i.iconPressed="pause";break;case"mute":i.toggle=!0,i.label="mute",i.labelPressed="unmute",i.icon="volume",i.iconPressed="muted";break;case"captions":i.toggle=!0,i.label="enableCaptions",i.labelPressed="disableCaptions",i.icon="captions-off",i.iconPressed="captions-on";break;case"fullscreen":i.toggle=!0,i.label="enterFullscreen",i.labelPressed="exitFullscreen",i.icon="enter-fullscreen",i.iconPressed="exit-fullscreen";break;case"play-large":r.class+=` ${this.config.classNames.control}--overlaid`,n="play",i.label="play",i.icon="play";break;default:_.empty(i.label)&&(i.label=n),_.empty(i.icon)&&(i.icon=t)}const s=C(i.element);return i.toggle?(s.appendChild(kt.createIcon.call(this,i.iconPressed,{class:"icon--pressed"})),s.appendChild(kt.createIcon.call(this,i.icon,{class:"icon--not-pressed"})),s.appendChild(kt.createLabel.call(this,i.labelPressed,{class:"label--pressed"})),s.appendChild(kt.createLabel.call(this,i.label,{class:"label--not-pressed"}))):(s.appendChild(kt.createIcon.call(this,i.icon)),s.appendChild(kt.createLabel.call(this,i.label))),R(r,B(this.config.selectors.buttons[n],r)),D(s,r),"play"===n?(_.array(this.elements.buttons[n])||(this.elements.buttons[n]=[]),this.elements.buttons[n].push(s)):this.elements.buttons[n]=s,s},createRange(t,e){const r=C("input",R(B(this.config.selectors.inputs[t]),{type:"range",min:0,max:100,step:.01,value:0,autocomplete:"off",role:"slider","aria-label":Et.get(t,this.config),"aria-valuemin":0,"aria-valuemax":100,"aria-valuenow":0},e));return this.elements.inputs[t]=r,kt.updateRangeFill.call(this,r),m.setup(r),r},createProgress(t,e){const r=C("progress",R(B(this.config.selectors.display[t]),{min:0,max:100,value:0,role:"progressbar","aria-hidden":!0},e));if("volume"!==t){r.appendChild(C("span",null,"0"));const e={played:"played",buffer:"buffered"}[t],n=e?Et.get(e,this.config):"";r.innerText=`% ${n.toLowerCase()}`}return this.elements.display[t]=r,r},createTime(t,e){const r=B(this.config.selectors.display[t],e),n=C("div",R(r,{class:`${r.class?r.class:""} ${this.config.classNames.display.time} `.trim(),"aria-label":Et.get(t,this.config),role:"timer"}),"00:00");return this.elements.display[t]=n,n},bindMenuItemShortcuts(t,e){Q.call(this,t,"keydown keyup",(r=>{if(![" ","ArrowUp","ArrowDown","ArrowRight"].includes(r.key))return;if(r.preventDefault(),r.stopPropagation(),"keydown"===r.type)return;const n=H(t,'[role="menuitemradio"]');if(!n&&[" ","ArrowRight"].includes(r.key))kt.showMenuPanel.call(this,e,!0);else{let e;" "!==r.key&&("ArrowDown"===r.key||n&&"ArrowRight"===r.key?(e=t.nextElementSibling,_.element(e)||(e=t.parentNode.firstElementChild)):(e=t.previousElementSibling,_.element(e)||(e=t.parentNode.lastElementChild)),Y.call(this,e,!0))}}),!1),Q.call(this,t,"keyup",(t=>{"Return"===t.key&&kt.focusFirstMenuItem.call(this,null,!0)}))},createMenuItem({value:t,list:e,type:r,title:n,badge:i=null,checked:s=!1}){const o=B(this.config.selectors.inputs[r]),a=C("button",R(o,{type:"button",role:"menuitemradio",class:`${this.config.classNames.control} ${o.class?o.class:""}`.trim(),"aria-checked":s,value:t})),l=C("span");l.innerHTML=n,_.element(i)&&l.appendChild(i),a.appendChild(l),Object.defineProperty(a,"checked",{enumerable:!0,get:()=>"true"===a.getAttribute("aria-checked"),set(t){t&&Array.from(a.parentNode.children).filter((t=>H(t,'[role="menuitemradio"]'))).forEach((t=>t.setAttribute("aria-checked","false"))),a.setAttribute("aria-checked",t?"true":"false")}}),this.listeners.bind(a,"click keyup",(e=>{if(!_.keyboardEvent(e)||" "===e.key){switch(e.preventDefault(),e.stopPropagation(),a.checked=!0,r){case"language":this.currentTrack=Number(t);break;case"quality":this.quality=t;break;case"speed":this.speed=parseFloat(t)}kt.showMenuPanel.call(this,"home",_.keyboardEvent(e))}}),r,!1),kt.bindMenuItemShortcuts.call(this,a,r),e.appendChild(a)},formatTime(t=0,e=!1){return _.number(t)?xt(t,St(this.duration)>0,e):t},updateTimeDisplay(t=null,e=0,r=!1){_.element(t)&&_.number(e)&&(t.innerText=kt.formatTime(e,r))},updateVolume(){this.supported.ui&&(_.element(this.elements.inputs.volume)&&kt.setRange.call(this,this.elements.inputs.volume,this.muted?0:this.volume),_.element(this.elements.buttons.mute)&&(this.elements.buttons.mute.pressed=this.muted||0===this.volume))},setRange(t,e=0){_.element(t)&&(t.value=e,kt.updateRangeFill.call(this,t))},updateProgress(t){if(!this.supported.ui||!_.event(t))return;let e=0;const r=(t,e)=>{const r=_.number(e)?e:0,n=_.element(t)?t:this.elements.display.buffer;if(_.element(n)){n.value=r;const t=n.getElementsByTagName("span")[0];_.element(t)&&(t.childNodes[0].nodeValue=r)}};if(t)switch(t.type){case"timeupdate":case"seeking":case"seeked":n=this.currentTime,i=this.duration,e=0===n||0===i||Number.isNaN(n)||Number.isNaN(i)?0:(n/i*100).toFixed(2),"timeupdate"===t.type&&kt.setRange.call(this,this.elements.inputs.seek,e);break;case"playing":case"progress":r(this.elements.display.buffer,100*this.buffered)}var n,i},updateRangeFill(t){const e=_.event(t)?t.target:t;if(_.element(e)&&"range"===e.getAttribute("type")){if(H(e,this.config.selectors.inputs.seek)){e.setAttribute("aria-valuenow",this.currentTime);const t=kt.formatTime(this.currentTime),r=kt.formatTime(this.duration),n=Et.get("seekLabel",this.config);e.setAttribute("aria-valuetext",n.replace("{currentTime}",t).replace("{duration}",r))}else if(H(e,this.config.selectors.inputs.volume)){const t=100*e.value;e.setAttribute("aria-valuenow",t),e.setAttribute("aria-valuetext",`${t.toFixed(1)}%`)}else e.setAttribute("aria-valuenow",e.value);(P.isWebKit||P.isIPadOS)&&e.style.setProperty("--value",e.value/e.max*100+"%")}},updateSeekTooltip(t){var e,r;if(!this.config.tooltips.seek||!_.element(this.elements.inputs.seek)||!_.element(this.elements.display.seekTooltip)||0===this.duration)return;const n=this.elements.display.seekTooltip,i=`${this.config.classNames.tooltip}--visible`,s=t=>j(n,i,t);if(this.touch)return void s(!1);let o=0;const a=this.elements.progress.getBoundingClientRect();if(_.event(t))o=100/a.width*(t.pageX-a.left);else{if(!G(n,i))return;o=parseFloat(n.style.left,10)}o<0?o=0:o>100&&(o=100);const l=this.duration/100*o;n.innerText=kt.formatTime(l);const c=null===(e=this.config.markers)||void 0===e||null===(r=e.points)||void 0===r?void 0:r.find((({time:t})=>t===Math.round(l)));c&&n.insertAdjacentHTML("afterbegin",`${c.label}<br>`),n.style.left=`${o}%`,_.event(t)&&["mouseenter","mouseleave"].includes(t.type)&&s("mouseenter"===t.type)},timeUpdate(t){const e=!_.element(this.elements.display.duration)&&this.config.invertTime;kt.updateTimeDisplay.call(this,this.elements.display.currentTime,e?this.duration-this.currentTime:this.currentTime,e),t&&"timeupdate"===t.type&&this.media.seeking||kt.updateProgress.call(this,t)},durationUpdate(){if(!this.supported.ui||!this.config.invertTime&&this.currentTime)return;if(this.duration>=2**32)return $(this.elements.display.currentTime,!0),void $(this.elements.progress,!0);_.element(this.elements.inputs.seek)&&this.elements.inputs.seek.setAttribute("aria-valuemax",this.duration);const t=_.element(this.elements.display.duration);!t&&this.config.displayDuration&&this.paused&&kt.updateTimeDisplay.call(this,this.elements.display.currentTime,this.duration),t&&kt.updateTimeDisplay.call(this,this.elements.display.duration,this.duration),this.config.markers.enabled&&kt.setMarkers.call(this),kt.updateSeekTooltip.call(this)},toggleMenuButton(t,e){$(this.elements.settings.buttons[t],!e)},updateSetting(t,e,r){const n=this.elements.settings.panels[t];let i=null,s=e;if("captions"===t)i=this.currentTrack;else{if(i=_.empty(r)?this[t]:r,_.empty(i)&&(i=this.config[t].default),!_.empty(this.options[t])&&!this.options[t].includes(i))return void this.debug.warn(`Unsupported value of '${i}' for ${t}`);if(!this.config[t].options.includes(i))return void this.debug.warn(`Disabled value of '${i}' for ${t}`)}if(_.element(s)||(s=n&&n.querySelector('[role="menu"]')),!_.element(s))return;this.elements.settings.buttons[t].querySelector(`.${this.config.classNames.menu.value}`).innerHTML=kt.getLabel.call(this,t,i);const o=s&&s.querySelector(`[value="${i}"]`);_.element(o)&&(o.checked=!0)},getLabel(t,e){switch(t){case"speed":return 1===e?Et.get("normal",this.config):`${e}&times;`;case"quality":if(_.number(e)){const t=Et.get(`qualityLabel.${e}`,this.config);return t.length?t:`${e}p`}return mt(e);case"captions":return Rt.getLabel.call(this);default:return null}},setQualityMenu(t){if(!_.element(this.elements.settings.panels.quality))return;const e="quality",r=this.elements.settings.panels.quality.querySelector('[role="menu"]');_.array(t)&&(this.options.quality=it(t).filter((t=>this.config.quality.options.includes(t))));const n=!_.empty(this.options.quality)&&this.options.quality.length>1;if(kt.toggleMenuButton.call(this,e,n),F(r),kt.checkMenu.call(this),!n)return;const i=t=>{const e=Et.get(`qualityBadge.${t}`,this.config);return e.length?kt.createBadge.call(this,e):null};this.options.quality.sort(((t,e)=>{const r=this.config.quality.options;return r.indexOf(t)>r.indexOf(e)?1:-1})).forEach((t=>{kt.createMenuItem.call(this,{value:t,list:r,type:e,title:kt.getLabel.call(this,"quality",t),badge:i(t)})})),kt.updateSetting.call(this,e,r)},setCaptionsMenu(){if(!_.element(this.elements.settings.panels.captions))return;const t="captions",e=this.elements.settings.panels.captions.querySelector('[role="menu"]'),r=Rt.getTracks.call(this),n=Boolean(r.length);if(kt.toggleMenuButton.call(this,t,n),F(e),kt.checkMenu.call(this),!n)return;const i=r.map(((t,r)=>({value:r,checked:this.captions.toggled&&this.currentTrack===r,title:Rt.getLabel.call(this,t),badge:t.language&&kt.createBadge.call(this,t.language.toUpperCase()),list:e,type:"language"})));i.unshift({value:-1,checked:!this.captions.toggled,title:Et.get("disabled",this.config),list:e,type:"language"}),i.forEach(kt.createMenuItem.bind(this)),kt.updateSetting.call(this,t,e)},setSpeedMenu(){if(!_.element(this.elements.settings.panels.speed))return;const t="speed",e=this.elements.settings.panels.speed.querySelector('[role="menu"]');this.options.speed=this.options.speed.filter((t=>t>=this.minimumSpeed&&t<=this.maximumSpeed));const r=!_.empty(this.options.speed)&&this.options.speed.length>1;kt.toggleMenuButton.call(this,t,r),F(e),kt.checkMenu.call(this),r&&(this.options.speed.forEach((r=>{kt.createMenuItem.call(this,{value:r,list:e,type:t,title:kt.getLabel.call(this,"speed",r)})})),kt.updateSetting.call(this,t,e))},checkMenu(){const{buttons:t}=this.elements.settings,e=!_.empty(t)&&Object.values(t).some((t=>!t.hidden));$(this.elements.settings.menu,!e)},focusFirstMenuItem(t,e=!1){if(this.elements.settings.popup.hidden)return;let r=t;_.element(r)||(r=Object.values(this.elements.settings.panels).find((t=>!t.hidden)));const n=r.querySelector('[role^="menuitem"]');Y.call(this,n,e)},toggleMenu(t){const{popup:e}=this.elements.settings,r=this.elements.buttons.settings;if(!_.element(e)||!_.element(r))return;const{hidden:n}=e;let i=n;if(_.boolean(t))i=t;else if(_.keyboardEvent(t)&&"Escape"===t.key)i=!1;else if(_.event(t)){const n=_.function(t.composedPath)?t.composedPath()[0]:t.target,s=e.contains(n);if(s||!s&&t.target!==r&&i)return}r.setAttribute("aria-expanded",i),$(e,!i),j(this.elements.container,this.config.classNames.menu.open,i),i&&_.keyboardEvent(t)?kt.focusFirstMenuItem.call(this,null,!0):i||n||Y.call(this,r,_.keyboardEvent(t))},getMenuSize(t){const e=t.cloneNode(!0);e.style.position="absolute",e.style.opacity=0,e.removeAttribute("hidden"),t.parentNode.appendChild(e);const r=e.scrollWidth,n=e.scrollHeight;return N(e),{width:r,height:n}},showMenuPanel(t="",e=!1){const r=this.elements.container.querySelector(`#plyr-settings-${this.id}-${t}`);if(!_.element(r))return;const n=r.parentNode,i=Array.from(n.children).find((t=>!t.hidden));if(W.transitions&&!W.reducedMotion){n.style.width=`${i.scrollWidth}px`,n.style.height=`${i.scrollHeight}px`;const t=kt.getMenuSize.call(this,r),e=t=>{t.target===n&&["width","height"].includes(t.propertyName)&&(n.style.width="",n.style.height="",J.call(this,n,x,e))};Q.call(this,n,x,e),n.style.width=`${t.width}px`,n.style.height=`${t.height}px`}$(i,!0),$(r,!1),kt.focusFirstMenuItem.call(this,r,e)},setDownloadUrl(){const t=this.elements.buttons.download;_.element(t)&&t.setAttribute("href",this.download)},create(t){const{bindMenuItemShortcuts:e,createButton:r,createProgress:n,createRange:i,createTime:s,setQualityMenu:o,setSpeedMenu:a,showMenuPanel:l}=kt;this.elements.controls=null,_.array(this.config.controls)&&this.config.controls.includes("play-large")&&this.elements.container.appendChild(r.call(this,"play-large"));const c=C("div",B(this.config.selectors.controls.wrapper));this.elements.controls=c;const u={class:"plyr__controls__item"};return it(_.array(this.config.controls)?this.config.controls:[]).forEach((o=>{if("restart"===o&&c.appendChild(r.call(this,"restart",u)),"rewind"===o&&c.appendChild(r.call(this,"rewind",u)),"play"===o&&c.appendChild(r.call(this,"play",u)),"fast-forward"===o&&c.appendChild(r.call(this,"fast-forward",u)),"progress"===o){const e=C("div",{class:`${u.class} plyr__progress__container`}),r=C("div",B(this.config.selectors.progress));if(r.appendChild(i.call(this,"seek",{id:`plyr-seek-${t.id}`})),r.appendChild(n.call(this,"buffer")),this.config.tooltips.seek){const t=C("span",{class:this.config.classNames.tooltip},"00:00");r.appendChild(t),this.elements.display.seekTooltip=t}this.elements.progress=r,e.appendChild(this.elements.progress),c.appendChild(e)}if("current-time"===o&&c.appendChild(s.call(this,"currentTime",u)),"duration"===o&&c.appendChild(s.call(this,"duration",u)),"mute"===o||"volume"===o){let{volume:e}=this.elements;if(_.element(e)&&c.contains(e)||(e=C("div",R({},u,{class:`${u.class} plyr__volume`.trim()})),this.elements.volume=e,c.appendChild(e)),"mute"===o&&e.appendChild(r.call(this,"mute")),"volume"===o&&!P.isIos&&!P.isIPadOS){const r={max:1,step:.05,value:this.config.volume};e.appendChild(i.call(this,"volume",R(r,{id:`plyr-volume-${t.id}`})))}}if("captions"===o&&c.appendChild(r.call(this,"captions",u)),"settings"===o&&!_.empty(this.config.settings)){const n=C("div",R({},u,{class:`${u.class} plyr__menu`.trim(),hidden:""}));n.appendChild(r.call(this,"settings",{"aria-haspopup":!0,"aria-controls":`plyr-settings-${t.id}`,"aria-expanded":!1}));const i=C("div",{class:"plyr__menu__container",id:`plyr-settings-${t.id}`,hidden:""}),s=C("div"),o=C("div",{id:`plyr-settings-${t.id}-home`}),a=C("div",{role:"menu"});o.appendChild(a),s.appendChild(o),this.elements.settings.panels.home=o,this.config.settings.forEach((r=>{const n=C("button",R(B(this.config.selectors.buttons.settings),{type:"button",class:`${this.config.classNames.control} ${this.config.classNames.control}--forward`,role:"menuitem","aria-haspopup":!0,hidden:""}));e.call(this,n,r),Q.call(this,n,"click",(()=>{l.call(this,r,!1)}));const i=C("span",null,Et.get(r,this.config)),o=C("span",{class:this.config.classNames.menu.value});o.innerHTML=t[r],i.appendChild(o),n.appendChild(i),a.appendChild(n);const c=C("div",{id:`plyr-settings-${t.id}-${r}`,hidden:""}),u=C("button",{type:"button",class:`${this.config.classNames.control} ${this.config.classNames.control}--back`});u.appendChild(C("span",{"aria-hidden":!0},Et.get(r,this.config))),u.appendChild(C("span",{class:this.config.classNames.hidden},Et.get("menuBack",this.config))),Q.call(this,c,"keydown",(t=>{"ArrowLeft"===t.key&&(t.preventDefault(),t.stopPropagation(),l.call(this,"home",!0))}),!1),Q.call(this,u,"click",(()=>{l.call(this,"home",!1)})),c.appendChild(u),c.appendChild(C("div",{role:"menu"})),s.appendChild(c),this.elements.settings.buttons[r]=n,this.elements.settings.panels[r]=c})),i.appendChild(s),n.appendChild(i),c.appendChild(n),this.elements.settings.popup=i,this.elements.settings.menu=n}if("pip"===o&&W.pip&&c.appendChild(r.call(this,"pip",u)),"airplay"===o&&W.airplay&&c.appendChild(r.call(this,"airplay",u)),"download"===o){const t=R({},u,{element:"a",href:this.download,target:"_blank"});this.isHTML5&&(t.download="");const{download:e}=this.config.urls;!_.url(e)&&this.isEmbed&&R(t,{icon:`logo-${this.provider}`,label:this.provider}),c.appendChild(r.call(this,"download",t))}"fullscreen"===o&&c.appendChild(r.call(this,"fullscreen",u))})),this.isHTML5&&o.call(this,ft.getQualityOptions.call(this)),a.call(this),c},inject(){if(this.config.loadSprite){const t=kt.getIconUrl.call(this);t.cors&&Tt(t.url,"sprite-plyr")}this.id=Math.floor(1e4*Math.random());let t=null;this.elements.controls=null;const e={id:this.id,seektime:this.config.seekTime,title:this.config.title};let r,n=!0;if(_.function(this.config.controls)&&(this.config.controls=this.config.controls.call(this,e)),this.config.controls||(this.config.controls=[]),_.element(this.config.controls)||_.string(this.config.controls)?t=this.config.controls:(t=kt.create.call(this,{id:this.id,seektime:this.config.seekTime,speed:this.speed,quality:this.quality,captions:Rt.getLabel.call(this)}),n=!1),n&&_.string(this.config.controls)&&(t=(t=>{let r=t;return Object.entries(e).forEach((([t,e])=>{r=gt(r,`{${t}}`,e)})),r})(t)),_.string(this.config.selectors.controls.container)&&(r=document.querySelector(this.config.selectors.controls.container)),_.element(r)||(r=this.elements.container),r[_.element(t)?"insertAdjacentElement":"insertAdjacentHTML"]("afterbegin",t),_.element(this.elements.controls)||kt.findElements.call(this),!_.empty(this.elements.buttons)){const t=t=>{const e=this.config.classNames.controlPressed;t.setAttribute("aria-pressed","false"),Object.defineProperty(t,"pressed",{configurable:!0,enumerable:!0,get:()=>G(t,e),set(r=!1){j(t,e,r),t.setAttribute("aria-pressed",r?"true":"false")}})};Object.values(this.elements.buttons).filter(Boolean).forEach((e=>{_.array(e)||_.nodeList(e)?Array.from(e).filter(Boolean).forEach(t):t(e)}))}if(P.isEdge&&k(r),this.config.tooltips.controls){const{classNames:t,selectors:e}=this.config,r=`${e.controls.wrapper} ${e.labels} .${t.hidden}`,n=V.call(this,r);Array.from(n).forEach((t=>{j(t,this.config.classNames.hidden,!1),j(t,this.config.classNames.tooltip,!0)}))}},setMediaMetadata(){try{"mediaSession"in navigator&&(navigator.mediaSession.metadata=new window.MediaMetadata({title:this.config.mediaMetadata.title,artist:this.config.mediaMetadata.artist,album:this.config.mediaMetadata.album,artwork:this.config.mediaMetadata.artwork}))}catch(t){}},setMarkers(){var t,e;if(!this.duration||this.elements.markers)return;const r=null===(t=this.config.markers)||void 0===t||null===(e=t.points)||void 0===e?void 0:e.filter((({time:t})=>t>0&&t<this.duration));if(null==r||!r.length)return;const n=document.createDocumentFragment(),i=document.createDocumentFragment();let s=null;const o=`${this.config.classNames.tooltip}--visible`,a=t=>j(s,o,t);r.forEach((t=>{const e=C("span",{class:this.config.classNames.marker},""),r=t.time/this.duration*100+"%";s&&(e.addEventListener("mouseenter",(()=>{t.label||(s.style.left=r,s.innerHTML=t.label,a(!0))})),e.addEventListener("mouseleave",(()=>{a(!1)}))),e.addEventListener("click",(()=>{this.currentTime=t.time})),e.style.left=r,i.appendChild(e)})),n.appendChild(i),this.config.tooltips.seek||(s=C("span",{class:this.config.classNames.tooltip},""),n.appendChild(s)),this.elements.markers={points:i,tip:s},this.elements.progress.appendChild(n)}};function Pt(t,e=!0){let r=t;if(e){const t=document.createElement("a");t.href=r,r=t.href}try{return new URL(r)}catch(t){return null}}function It(t){const e=new URLSearchParams;return _.object(t)&&Object.entries(t).forEach((([t,r])=>{e.set(t,r)})),e}const Rt={setup(){if(!this.supported.ui)return;if(!this.isVideo||this.isYouTube||this.isHTML5&&!W.textTracks)return void(_.array(this.config.controls)&&this.config.controls.includes("settings")&&this.config.settings.includes("captions")&&kt.setCaptionsMenu.call(this));var t,e;if(_.element(this.elements.captions)||(this.elements.captions=C("div",B(this.config.selectors.captions)),this.elements.captions.setAttribute("dir","auto"),t=this.elements.captions,e=this.elements.wrapper,_.element(t)&&_.element(e)&&e.parentNode.insertBefore(t,e.nextSibling)),P.isIE&&window.URL){const t=this.media.querySelectorAll("track");Array.from(t).forEach((t=>{const e=t.getAttribute("src"),r=Pt(e);null!==r&&r.hostname!==window.location.href.hostname&&["http:","https:"].includes(r.protocol)&&wt(e,"blob").then((e=>{t.setAttribute("src",window.URL.createObjectURL(e))})).catch((()=>{N(t)}))}))}const r=it((navigator.languages||[navigator.language||navigator.userLanguage||"en"]).map((t=>t.split("-")[0])));let n=(this.storage.get("language")||this.config.captions.language||"auto").toLowerCase();"auto"===n&&([n]=r);let i=this.storage.get("captions");if(_.boolean(i)||({active:i}=this.config.captions),Object.assign(this.captions,{toggled:!1,active:i,language:n,languages:r}),this.isHTML5){const t=this.config.captions.update?"addtrack removetrack":"removetrack";Q.call(this,this.media.textTracks,t,Rt.update.bind(this))}setTimeout(Rt.update.bind(this),0)},update(){const t=Rt.getTracks.call(this,!0),{active:e,language:r,meta:n,currentTrackNode:i}=this.captions,s=Boolean(t.find((t=>t.language===r)));this.isHTML5&&this.isVideo&&t.filter((t=>!n.get(t))).forEach((t=>{this.debug.log("Track added",t),n.set(t,{default:"showing"===t.mode}),"showing"===t.mode&&(t.mode="hidden"),Q.call(this,t,"cuechange",(()=>Rt.updateCues.call(this)))})),(s&&this.language!==r||!t.includes(i))&&(Rt.setLanguage.call(this,r),Rt.toggle.call(this,e&&s)),this.elements&&j(this.elements.container,this.config.classNames.captions.enabled,!_.empty(t)),_.array(this.config.controls)&&this.config.controls.includes("settings")&&this.config.settings.includes("captions")&&kt.setCaptionsMenu.call(this)},toggle(t,e=!0){if(!this.supported.ui)return;const{toggled:r}=this.captions,n=this.config.classNames.captions.active,i=_.nullOrUndefined(t)?!r:t;if(i!==r){if(e||(this.captions.active=i,this.storage.set({captions:i})),!this.language&&i&&!e){const t=Rt.getTracks.call(this),e=Rt.findTrack.call(this,[this.captions.language,...this.captions.languages],!0);return this.captions.language=e.language,void Rt.set.call(this,t.indexOf(e))}this.elements.buttons.captions&&(this.elements.buttons.captions.pressed=i),j(this.elements.container,n,i),this.captions.toggled=i,kt.updateSetting.call(this,"captions"),tt.call(this,this.media,i?"captionsenabled":"captionsdisabled")}setTimeout((()=>{i&&this.captions.toggled&&(this.captions.currentTrackNode.mode="hidden")}))},set(t,e=!0){const r=Rt.getTracks.call(this);if(-1!==t)if(_.number(t))if(t in r){if(this.captions.currentTrack!==t){this.captions.currentTrack=t;const n=r[t],{language:i}=n||{};this.captions.currentTrackNode=n,kt.updateSetting.call(this,"captions"),e||(this.captions.language=i,this.storage.set({language:i})),this.isVimeo&&this.embed.enableTextTrack(i),tt.call(this,this.media,"languagechange")}Rt.toggle.call(this,!0,e),this.isHTML5&&this.isVideo&&Rt.updateCues.call(this)}else this.debug.warn("Track not found",t);else this.debug.warn("Invalid caption argument",t);else Rt.toggle.call(this,!1,e)},setLanguage(t,e=!0){if(!_.string(t))return void this.debug.warn("Invalid language argument",t);const r=t.toLowerCase();this.captions.language=r;const n=Rt.getTracks.call(this),i=Rt.findTrack.call(this,[r]);Rt.set.call(this,n.indexOf(i),e)},getTracks(t=!1){return Array.from((this.media||{}).textTracks||[]).filter((e=>!this.isHTML5||t||this.captions.meta.has(e))).filter((t=>["captions","subtitles"].includes(t.kind)))},findTrack(t,e=!1){const r=Rt.getTracks.call(this),n=t=>Number((this.captions.meta.get(t)||{}).default),i=Array.from(r).sort(((t,e)=>n(e)-n(t)));let s;return t.every((t=>(s=i.find((e=>e.language===t)),!s))),s||(e?i[0]:void 0)},getCurrentTrack(){return Rt.getTracks.call(this)[this.currentTrack]},getLabel(t){let e=t;return!_.track(e)&&W.textTracks&&this.captions.toggled&&(e=Rt.getCurrentTrack.call(this)),_.track(e)?_.empty(e.label)?_.empty(e.language)?Et.get("enabled",this.config):t.language.toUpperCase():e.label:Et.get("disabled",this.config)},updateCues(t){if(!this.supported.ui)return;if(!_.element(this.elements.captions))return void this.debug.warn("No captions element to render to");if(!_.nullOrUndefined(t)&&!Array.isArray(t))return void this.debug.warn("updateCues: Invalid input",t);let e=t;if(!e){const t=Rt.getCurrentTrack.call(this);e=Array.from((t||{}).activeCues||[]).map((t=>t.getCueAsHTML())).map(vt)}const r=e.map((t=>t.trim())).join("\n");if(r!==this.elements.captions.innerHTML){F(this.elements.captions);const t=C("span",B(this.config.selectors.caption));t.innerHTML=r,this.elements.captions.appendChild(t),tt.call(this,this.media,"cuechange")}}},Ot={enabled:!0,title:"",debug:!1,autoplay:!1,autopause:!0,playsinline:!0,seekTime:10,volume:1,muted:!1,duration:null,displayDuration:!0,invertTime:!0,toggleInvert:!0,ratio:null,clickToPlay:!0,hideControls:!0,resetOnEnd:!1,disableContextMenu:!0,loadSprite:!0,iconPrefix:"plyr",iconUrl:"https://cdn.plyr.io/3.7.8/plyr.svg",blankVideo:"https://cdn.plyr.io/static/blank.mp4",quality:{default:576,options:[4320,2880,2160,1440,1080,720,576,480,360,240],forced:!1,onChange:null},loop:{active:!1},speed:{selected:1,options:[.5,.75,1,1.25,1.5,1.75,2,4]},keyboard:{focused:!0,global:!1},tooltips:{controls:!1,seek:!0},captions:{active:!1,language:"auto",update:!1},fullscreen:{enabled:!0,fallback:!0,iosNative:!1},storage:{enabled:!0,key:"plyr"},controls:["play-large","play","progress","current-time","mute","volume","captions","settings","pip","airplay","fullscreen"],settings:["captions","quality","speed"],i18n:{restart:"Restart",rewind:"Rewind {seektime}s",play:"Play",pause:"Pause",fastForward:"Forward {seektime}s",seek:"Seek",seekLabel:"{currentTime} of {duration}",played:"Played",buffered:"Buffered",currentTime:"Current time",duration:"Duration",volume:"Volume",mute:"Mute",unmute:"Unmute",enableCaptions:"Enable captions",disableCaptions:"Disable captions",download:"Download",enterFullscreen:"Enter fullscreen",exitFullscreen:"Exit fullscreen",frameTitle:"Player for {title}",captions:"Captions",settings:"Settings",pip:"PIP",menuBack:"Go back to previous menu",speed:"Speed",normal:"Normal",quality:"Quality",loop:"Loop",start:"Start",end:"End",all:"All",reset:"Reset",disabled:"Disabled",enabled:"Enabled",advertisement:"Ad",qualityBadge:{2160:"4K",1440:"HD",1080:"HD",720:"HD",576:"SD",480:"SD"}},urls:{download:null,vimeo:{sdk:"https://player.vimeo.com/api/player.js",iframe:"https://player.vimeo.com/video/{0}?{1}",api:"https://vimeo.com/api/oembed.json?url={0}"},youtube:{sdk:"https://www.youtube.com/iframe_api",api:"https://noembed.com/embed?url=https://www.youtube.com/watch?v={0}"},googleIMA:{sdk:"https://imasdk.googleapis.com/js/sdkloader/ima3.js"}},listeners:{seek:null,play:null,pause:null,restart:null,rewind:null,fastForward:null,mute:null,volume:null,captions:null,download:null,fullscreen:null,pip:null,airplay:null,speed:null,quality:null,loop:null,language:null},events:["ended","progress","stalled","playing","waiting","canplay","canplaythrough","loadstart","loadeddata","loadedmetadata","timeupdate","volumechange","play","pause","error","seeking","seeked","emptied","ratechange","cuechange","download","enterfullscreen","exitfullscreen","captionsenabled","captionsdisabled","languagechange","controlshidden","controlsshown","ready","statechange","qualitychange","adsloaded","adscontentpause","adscontentresume","adstarted","adsmidpoint","adscomplete","adsallcomplete","adsimpression","adsclick"],selectors:{editable:"input, textarea, select, [contenteditable]",container:".plyr",controls:{container:null,wrapper:".plyr__controls"},labels:"[data-plyr]",buttons:{play:'[data-plyr="play"]',pause:'[data-plyr="pause"]',restart:'[data-plyr="restart"]',rewind:'[data-plyr="rewind"]',fastForward:'[data-plyr="fast-forward"]',mute:'[data-plyr="mute"]',captions:'[data-plyr="captions"]',download:'[data-plyr="download"]',fullscreen:'[data-plyr="fullscreen"]',pip:'[data-plyr="pip"]',airplay:'[data-plyr="airplay"]',settings:'[data-plyr="settings"]',loop:'[data-plyr="loop"]'},inputs:{seek:'[data-plyr="seek"]',volume:'[data-plyr="volume"]',speed:'[data-plyr="speed"]',language:'[data-plyr="language"]',quality:'[data-plyr="quality"]'},display:{currentTime:".plyr__time--current",duration:".plyr__time--duration",buffer:".plyr__progress__buffer",loop:".plyr__progress__loop",volume:".plyr__volume--display"},progress:".plyr__progress",captions:".plyr__captions",caption:".plyr__caption"},classNames:{type:"plyr--{0}",provider:"plyr--{0}",video:"plyr__video-wrapper",embed:"plyr__video-embed",videoFixedRatio:"plyr__video-wrapper--fixed-ratio",embedContainer:"plyr__video-embed__container",poster:"plyr__poster",posterEnabled:"plyr__poster-enabled",ads:"plyr__ads",control:"plyr__control",controlPressed:"plyr__control--pressed",playing:"plyr--playing",paused:"plyr--paused",stopped:"plyr--stopped",loading:"plyr--loading",hover:"plyr--hover",tooltip:"plyr__tooltip",cues:"plyr__cues",marker:"plyr__progress__marker",hidden:"plyr__sr-only",hideControls:"plyr--hide-controls",isTouch:"plyr--is-touch",uiSupported:"plyr--full-ui",noTransition:"plyr--no-transition",display:{time:"plyr__time"},menu:{value:"plyr__menu__value",badge:"plyr__badge",open:"plyr--menu-open"},captions:{enabled:"plyr--captions-enabled",active:"plyr--captions-active"},fullscreen:{enabled:"plyr--fullscreen-enabled",fallback:"plyr--fullscreen-fallback"},pip:{supported:"plyr--pip-supported",active:"plyr--pip-active"},airplay:{supported:"plyr--airplay-supported",active:"plyr--airplay-active"},previewThumbnails:{thumbContainer:"plyr__preview-thumb",thumbContainerShown:"plyr__preview-thumb--is-shown",imageContainer:"plyr__preview-thumb__image-container",timeContainer:"plyr__preview-thumb__time-container",scrubbingContainer:"plyr__preview-scrubbing",scrubbingContainerShown:"plyr__preview-scrubbing--is-shown"}},attributes:{embed:{provider:"data-plyr-provider",id:"data-plyr-embed-id",hash:"data-plyr-embed-hash"}},ads:{enabled:!1,publisherId:"",tagUrl:""},previewThumbnails:{enabled:!1,src:""},vimeo:{byline:!1,portrait:!1,title:!1,speed:!0,transparent:!1,customControls:!0,referrerPolicy:null,premium:!1},youtube:{rel:0,showinfo:0,iv_load_policy:3,modestbranding:1,customControls:!0,noCookie:!1},mediaMetadata:{title:"",artist:"",album:"",artwork:[]},markers:{enabled:!1,points:[]}},Dt="picture-in-picture",Ct="inline",Mt={html5:"html5",youtube:"youtube",vimeo:"vimeo"},Nt="audio",Ft="video",Ut=()=>{};class Bt{constructor(t=!1){this.enabled=window.console&&t,this.enabled&&this.log("Debugging enabled")}get log(){return this.enabled?Function.prototype.bind.call(console.log,console):Ut}get warn(){return this.enabled?Function.prototype.bind.call(console.warn,console):Ut}get error(){return this.enabled?Function.prototype.bind.call(console.error,console):Ut}}class $t{constructor(e){t(this,"onChange",(()=>{if(!this.supported)return;const t=this.player.elements.buttons.fullscreen;_.element(t)&&(t.pressed=this.active);const e=this.target===this.player.media?this.target:this.player.elements.container;tt.call(this.player,e,this.active?"enterfullscreen":"exitfullscreen",!0)})),t(this,"toggleFallback",((t=!1)=>{if(t?this.scrollPosition={x:window.scrollX??0,y:window.scrollY??0}:window.scrollTo(this.scrollPosition.x,this.scrollPosition.y),document.body.style.overflow=t?"hidden":"",j(this.target,this.player.config.classNames.fullscreen.fallback,t),P.isIos){let e=document.head.querySelector('meta[name="viewport"]');const r="viewport-fit=cover";e||(e=document.createElement("meta"),e.setAttribute("name","viewport"));const n=_.string(e.content)&&e.content.includes(r);t?(this.cleanupViewport=!n,n||(e.content+=`,${r}`)):this.cleanupViewport&&(e.content=e.content.split(",").filter((t=>t.trim()!==r)).join(","))}this.onChange()})),t(this,"trapFocus",(t=>{if(P.isIos||P.isIPadOS||!this.active||"Tab"!==t.key)return;const e=document.activeElement,r=V.call(this.player,"a[href], button:not(:disabled), input:not(:disabled), [tabindex]"),[n]=r,i=r[r.length-1];e!==i||t.shiftKey?e===n&&t.shiftKey&&(i.focus(),t.preventDefault()):(n.focus(),t.preventDefault())})),t(this,"update",(()=>{if(this.supported){let t;t=this.forceFallback?"Fallback (forced)":$t.nativeSupported?"Native":"Fallback",this.player.debug.log(`${t} fullscreen enabled`)}else this.player.debug.log("Fullscreen not supported and fallback disabled");j(this.player.elements.container,this.player.config.classNames.fullscreen.enabled,this.supported)})),t(this,"enter",(()=>{this.supported&&(P.isIos&&this.player.config.fullscreen.iosNative?this.player.isVimeo?this.player.embed.requestFullscreen():this.target.webkitEnterFullscreen():!$t.nativeSupported||this.forceFallback?this.toggleFallback(!0):this.prefix?_.empty(this.prefix)||this.target[`${this.prefix}Request${this.property}`]():this.target.requestFullscreen({navigationUI:"hide"}))})),t(this,"exit",(()=>{if(this.supported)if(P.isIos&&this.player.config.fullscreen.iosNative)this.player.isVimeo?this.player.embed.exitFullscreen():this.target.webkitEnterFullscreen(),nt(this.player.play());else if(!$t.nativeSupported||this.forceFallback)this.toggleFallback(!1);else if(this.prefix){if(!_.empty(this.prefix)){const t="moz"===this.prefix?"Cancel":"Exit";document[`${this.prefix}${t}${this.property}`]()}}else(document.cancelFullScreen||document.exitFullscreen).call(document)})),t(this,"toggle",(()=>{this.active?this.exit():this.enter()})),this.player=e,this.prefix=$t.prefix,this.property=$t.property,this.scrollPosition={x:0,y:0},this.forceFallback="force"===e.config.fullscreen.fallback,this.player.elements.fullscreen=e.config.fullscreen.container&&function(t,e){const{prototype:r}=Element;return(r.closest||function(){let t=this;do{if(H.matches(t,e))return t;t=t.parentElement||t.parentNode}while(null!==t&&1===t.nodeType);return null}).call(t,e)}(this.player.elements.container,e.config.fullscreen.container),Q.call(this.player,document,"ms"===this.prefix?"MSFullscreenChange":`${this.prefix}fullscreenchange`,(()=>{this.onChange()})),Q.call(this.player,this.player.elements.container,"dblclick",(t=>{_.element(this.player.elements.controls)&&this.player.elements.controls.contains(t.target)||this.player.listeners.proxy(t,this.toggle,"fullscreen")})),Q.call(this,this.player.elements.container,"keydown",(t=>this.trapFocus(t))),this.update()}static get nativeSupported(){return!!(document.fullscreenEnabled||document.webkitFullscreenEnabled||document.mozFullScreenEnabled||document.msFullscreenEnabled)}get useNative(){return $t.nativeSupported&&!this.forceFallback}static get prefix(){if(_.function(document.exitFullscreen))return"";let t="";return["webkit","moz","ms"].some((e=>!(!_.function(document[`${e}ExitFullscreen`])&&!_.function(document[`${e}CancelFullScreen`])||(t=e,0)))),t}static get property(){return"moz"===this.prefix?"FullScreen":"Fullscreen"}get supported(){return[this.player.config.fullscreen.enabled,this.player.isVideo,$t.nativeSupported||this.player.config.fullscreen.fallback,!this.player.isYouTube||$t.nativeSupported||!P.isIos||this.player.config.playsinline&&!this.player.config.fullscreen.iosNative].every(Boolean)}get active(){if(!this.supported)return!1;if(!$t.nativeSupported||this.forceFallback)return G(this.target,this.player.config.classNames.fullscreen.fallback);const t=this.prefix?this.target.getRootNode()[`${this.prefix}${this.property}Element`]:this.target.getRootNode().fullscreenElement;return t&&t.shadowRoot?t===this.target.getRootNode().host:t===this.target}get target(){return P.isIos&&this.player.config.fullscreen.iosNative?this.player.media:this.player.elements.fullscreen??this.player.elements.container}}function jt(t,e=1){return new Promise(((r,n)=>{const i=new Image,s=()=>{delete i.onload,delete i.onerror,(i.naturalWidth>=e?r:n)(i)};Object.assign(i,{onload:s,onerror:s,src:t})}))}const Gt={addStyleHook(){j(this.elements.container,this.config.selectors.container.replace(".",""),!0),j(this.elements.container,this.config.classNames.uiSupported,this.supported.ui)},toggleNativeControls(t=!1){t&&this.isHTML5?this.media.setAttribute("controls",""):this.media.removeAttribute("controls")},build(){if(this.listeners.media(),!this.supported.ui)return this.debug.warn(`Basic support only for ${this.provider} ${this.type}`),void Gt.toggleNativeControls.call(this,!0);_.element(this.elements.controls)||(kt.inject.call(this),this.listeners.controls()),Gt.toggleNativeControls.call(this),this.isHTML5&&Rt.setup.call(this),this.volume=null,this.muted=null,this.loop=null,this.quality=null,this.speed=null,kt.updateVolume.call(this),kt.timeUpdate.call(this),kt.durationUpdate.call(this),Gt.checkPlaying.call(this),j(this.elements.container,this.config.classNames.pip.supported,W.pip&&this.isHTML5&&this.isVideo),j(this.elements.container,this.config.classNames.airplay.supported,W.airplay&&this.isHTML5),j(this.elements.container,this.config.classNames.isTouch,this.touch),this.ready=!0,setTimeout((()=>{tt.call(this,this.media,"ready")}),0),Gt.setTitle.call(this),this.poster&&Gt.setPoster.call(this,this.poster,!1).catch((()=>{})),this.config.duration&&kt.durationUpdate.call(this),this.config.mediaMetadata&&kt.setMediaMetadata.call(this)},setTitle(){let t=Et.get("play",this.config);if(_.string(this.config.title)&&!_.empty(this.config.title)&&(t+=`, ${this.config.title}`),Array.from(this.elements.buttons.play||[]).forEach((e=>{e.setAttribute("aria-label",t)})),this.isEmbed){const t=K.call(this,"iframe");if(!_.element(t))return;const e=_.empty(this.config.title)?"video":this.config.title,r=Et.get("frameTitle",this.config);t.setAttribute("title",r.replace("{title}",e))}},togglePoster(t){j(this.elements.container,this.config.classNames.posterEnabled,t)},setPoster(t,e=!0){return e&&this.poster?Promise.reject(new Error("Poster already set")):(this.media.setAttribute("data-poster",t),this.elements.poster.removeAttribute("hidden"),rt.call(this).then((()=>jt(t))).catch((e=>{throw t===this.poster&&Gt.togglePoster.call(this,!1),e})).then((()=>{if(t!==this.poster)throw new Error("setPoster cancelled by later call to setPoster")})).then((()=>(Object.assign(this.elements.poster.style,{backgroundImage:`url('${t}')`,backgroundSize:""}),Gt.togglePoster.call(this,!0),t))))},checkPlaying(t){j(this.elements.container,this.config.classNames.playing,this.playing),j(this.elements.container,this.config.classNames.paused,this.paused),j(this.elements.container,this.config.classNames.stopped,this.stopped),Array.from(this.elements.buttons.play||[]).forEach((t=>{Object.assign(t,{pressed:this.playing}),t.setAttribute("aria-label",Et.get(this.playing?"pause":"play",this.config))})),_.event(t)&&"timeupdate"===t.type||Gt.toggleControls.call(this)},checkLoading(t){this.loading=["stalled","waiting"].includes(t.type),clearTimeout(this.timers.loading),this.timers.loading=setTimeout((()=>{j(this.elements.container,this.config.classNames.loading,this.loading),Gt.toggleControls.call(this)}),this.loading?250:0)},toggleControls(t){const{controls:e}=this.elements;if(e&&this.config.hideControls){const r=this.touch&&this.lastSeekTime+2e3>Date.now();this.toggleControls(Boolean(t||this.loading||this.paused||e.pressed||e.hover||r))}},migrateStyles(){Object.values({...this.media.style}).filter((t=>!_.empty(t)&&_.string(t)&&t.startsWith("--plyr"))).forEach((t=>{this.elements.container.style.setProperty(t,this.media.style.getPropertyValue(t)),this.media.style.removeProperty(t)})),_.empty(this.media.style)&&this.media.removeAttribute("style")}};class Ht{constructor(e){t(this,"firstTouch",(()=>{const{player:t}=this,{elements:e}=t;t.touch=!0,j(e.container,t.config.classNames.isTouch,!0)})),t(this,"global",((t=!0)=>{const{player:e}=this;e.config.keyboard.global&&X.call(e,window,"keydown keyup",this.handleKey,t,!1),X.call(e,document.body,"click",this.toggleMenu,t),Z.call(e,document.body,"touchstart",this.firstTouch)})),t(this,"container",(()=>{const{player:t}=this,{config:e,elements:r,timers:n}=t;!e.keyboard.global&&e.keyboard.focused&&Q.call(t,r.container,"keydown keyup",this.handleKey,!1),Q.call(t,r.container,"mousemove mouseleave touchstart touchmove enterfullscreen exitfullscreen",(e=>{const{controls:i}=r;i&&"enterfullscreen"===e.type&&(i.pressed=!1,i.hover=!1);let s=0;["touchstart","touchmove","mousemove"].includes(e.type)&&(Gt.toggleControls.call(t,!0),s=t.touch?3e3:2e3),clearTimeout(n.controls),n.controls=setTimeout((()=>Gt.toggleControls.call(t,!1)),s)}));const i=()=>{if(!t.isVimeo||t.config.vimeo.premium)return;const e=r.wrapper,{active:n}=t.fullscreen,[i,s]=ut.call(t),o=ot(`aspect-ratio: ${i} / ${s}`);if(!n)return void(o?(e.style.width=null,e.style.height=null):(e.style.maxWidth=null,e.style.margin=null));const[a,l]=[Math.max(document.documentElement.clientWidth||0,window.innerWidth||0),Math.max(document.documentElement.clientHeight||0,window.innerHeight||0)],c=a/l>i/s;o?(e.style.width=c?"auto":"100%",e.style.height=c?"100%":"auto"):(e.style.maxWidth=c?l/s*i+"px":null,e.style.margin=c?"0 auto":null)},s=()=>{clearTimeout(n.resized),n.resized=setTimeout(i,50)};Q.call(t,r.container,"enterfullscreen exitfullscreen",(e=>{const{target:n}=t.fullscreen;n===r.container&&(!t.isEmbed&&_.empty(t.config.ratio)||(i(),("enterfullscreen"===e.type?Q:J).call(t,window,"resize",s)))}))})),t(this,"media",(()=>{const{player:t}=this,{elements:e}=t;if(Q.call(t,t.media,"timeupdate seeking seeked",(e=>kt.timeUpdate.call(t,e))),Q.call(t,t.media,"durationchange loadeddata loadedmetadata",(e=>kt.durationUpdate.call(t,e))),Q.call(t,t.media,"ended",(()=>{t.isHTML5&&t.isVideo&&t.config.resetOnEnd&&(t.restart(),t.pause())})),Q.call(t,t.media,"progress playing seeking seeked",(e=>kt.updateProgress.call(t,e))),Q.call(t,t.media,"volumechange",(e=>kt.updateVolume.call(t,e))),Q.call(t,t.media,"playing play pause ended emptied timeupdate",(e=>Gt.checkPlaying.call(t,e))),Q.call(t,t.media,"waiting canplay seeked playing",(e=>Gt.checkLoading.call(t,e))),t.supported.ui&&t.config.clickToPlay&&!t.isAudio){const r=K.call(t,`.${t.config.classNames.video}`);if(!_.element(r))return;Q.call(t,e.container,"click",(n=>{([e.container,r].includes(n.target)||r.contains(n.target))&&(t.touch&&t.config.hideControls||(t.ended?(this.proxy(n,t.restart,"restart"),this.proxy(n,(()=>{nt(t.play())}),"play")):this.proxy(n,(()=>{nt(t.togglePlay())}),"play")))}))}t.supported.ui&&t.config.disableContextMenu&&Q.call(t,e.wrapper,"contextmenu",(t=>{t.preventDefault()}),!1),Q.call(t,t.media,"volumechange",(()=>{t.storage.set({volume:t.volume,muted:t.muted})})),Q.call(t,t.media,"ratechange",(()=>{kt.updateSetting.call(t,"speed"),t.storage.set({speed:t.speed})})),Q.call(t,t.media,"qualitychange",(e=>{kt.updateSetting.call(t,"quality",null,e.detail.quality)})),Q.call(t,t.media,"ready qualitychange",(()=>{kt.setDownloadUrl.call(t)}));const r=t.config.events.concat(["keyup","keydown"]).join(" ");Q.call(t,t.media,r,(r=>{let{detail:n={}}=r;"error"===r.type&&(n=t.media.error),tt.call(t,e.container,r.type,!0,n)}))})),t(this,"proxy",((t,e,r)=>{const{player:n}=this,i=n.config.listeners[r];let s=!0;_.function(i)&&(s=i.call(n,t)),!1!==s&&_.function(e)&&e.call(n,t)})),t(this,"bind",((t,e,r,n,i=!0)=>{const{player:s}=this,o=s.config.listeners[n],a=_.function(o);Q.call(s,t,e,(t=>this.proxy(t,r,n)),i&&!a)})),t(this,"controls",(()=>{const{player:t}=this,{elements:e}=t,r=P.isIE?"change":"input";if(e.buttons.play&&Array.from(e.buttons.play).forEach((e=>{this.bind(e,"click",(()=>{nt(t.togglePlay())}),"play")})),this.bind(e.buttons.restart,"click",t.restart,"restart"),this.bind(e.buttons.rewind,"click",(()=>{t.lastSeekTime=Date.now(),t.rewind()}),"rewind"),this.bind(e.buttons.fastForward,"click",(()=>{t.lastSeekTime=Date.now(),t.forward()}),"fastForward"),this.bind(e.buttons.mute,"click",(()=>{t.muted=!t.muted}),"mute"),this.bind(e.buttons.captions,"click",(()=>t.toggleCaptions())),this.bind(e.buttons.download,"click",(()=>{tt.call(t,t.media,"download")}),"download"),this.bind(e.buttons.fullscreen,"click",(()=>{t.fullscreen.toggle()}),"fullscreen"),this.bind(e.buttons.pip,"click",(()=>{t.pip="toggle"}),"pip"),this.bind(e.buttons.airplay,"click",t.airplay,"airplay"),this.bind(e.buttons.settings,"click",(e=>{e.stopPropagation(),e.preventDefault(),kt.toggleMenu.call(t,e)}),null,!1),this.bind(e.buttons.settings,"keyup",(e=>{[" ","Enter"].includes(e.key)&&("Enter"!==e.key?(e.preventDefault(),e.stopPropagation(),kt.toggleMenu.call(t,e)):kt.focusFirstMenuItem.call(t,null,!0))}),null,!1),this.bind(e.settings.menu,"keydown",(e=>{"Escape"===e.key&&kt.toggleMenu.call(t,e)})),this.bind(e.inputs.seek,"mousedown mousemove",(t=>{const r=e.progress.getBoundingClientRect(),n=100/r.width*(t.pageX-r.left);t.currentTarget.setAttribute("seek-value",n)})),this.bind(e.inputs.seek,"mousedown mouseup keydown keyup touchstart touchend",(e=>{const r=e.currentTarget,n="play-on-seeked";if(_.keyboardEvent(e)&&!["ArrowLeft","ArrowRight"].includes(e.key))return;t.lastSeekTime=Date.now();const i=r.hasAttribute(n),s=["mouseup","touchend","keyup"].includes(e.type);i&&s?(r.removeAttribute(n),nt(t.play())):!s&&t.playing&&(r.setAttribute(n,""),t.pause())})),P.isIos){const e=V.call(t,'input[type="range"]');Array.from(e).forEach((t=>this.bind(t,r,(t=>k(t.target)))))}this.bind(e.inputs.seek,r,(e=>{const r=e.currentTarget;let n=r.getAttribute("seek-value");_.empty(n)&&(n=r.value),r.removeAttribute("seek-value"),t.currentTime=n/r.max*t.duration}),"seek"),this.bind(e.progress,"mouseenter mouseleave mousemove",(e=>kt.updateSeekTooltip.call(t,e))),this.bind(e.progress,"mousemove touchmove",(e=>{const{previewThumbnails:r}=t;r&&r.loaded&&r.startMove(e)})),this.bind(e.progress,"mouseleave touchend click",(()=>{const{previewThumbnails:e}=t;e&&e.loaded&&e.endMove(!1,!0)})),this.bind(e.progress,"mousedown touchstart",(e=>{const{previewThumbnails:r}=t;r&&r.loaded&&r.startScrubbing(e)})),this.bind(e.progress,"mouseup touchend",(e=>{const{previewThumbnails:r}=t;r&&r.loaded&&r.endScrubbing(e)})),P.isWebKit&&Array.from(V.call(t,'input[type="range"]')).forEach((e=>{this.bind(e,"input",(e=>kt.updateRangeFill.call(t,e.target)))})),t.config.toggleInvert&&!_.element(e.display.duration)&&this.bind(e.display.currentTime,"click",(()=>{0!==t.currentTime&&(t.config.invertTime=!t.config.invertTime,kt.timeUpdate.call(t))})),this.bind(e.inputs.volume,r,(e=>{t.volume=e.target.value}),"volume"),this.bind(e.controls,"mouseenter mouseleave",(r=>{e.controls.hover=!t.touch&&"mouseenter"===r.type})),e.fullscreen&&Array.from(e.fullscreen.children).filter((t=>!t.contains(e.container))).forEach((r=>{this.bind(r,"mouseenter mouseleave",(r=>{e.controls&&(e.controls.hover=!t.touch&&"mouseenter"===r.type)}))})),this.bind(e.controls,"mousedown mouseup touchstart touchend touchcancel",(t=>{e.controls.pressed=["mousedown","touchstart"].includes(t.type)})),this.bind(e.controls,"focusin",(()=>{const{config:r,timers:n}=t;j(e.controls,r.classNames.noTransition,!0),Gt.toggleControls.call(t,!0),setTimeout((()=>{j(e.controls,r.classNames.noTransition,!1)}),0);const i=this.touch?3e3:4e3;clearTimeout(n.controls),n.controls=setTimeout((()=>Gt.toggleControls.call(t,!1)),i)})),this.bind(e.inputs.volume,"wheel",(e=>{const r=e.webkitDirectionInvertedFromDevice,[n,i]=[e.deltaX,-e.deltaY].map((t=>r?-t:t)),s=Math.sign(Math.abs(n)>Math.abs(i)?n:i);t.increaseVolume(s/50);const{volume:o}=t.media;(1===s&&o<1||-1===s&&o>0)&&e.preventDefault()}),"volume",!1)})),this.player=e,this.lastKey=null,this.focusTimer=null,this.lastKeyDown=null,this.handleKey=this.handleKey.bind(this),this.toggleMenu=this.toggleMenu.bind(this),this.firstTouch=this.firstTouch.bind(this)}handleKey(t){const{player:e}=this,{elements:r}=e,{key:n,type:i,altKey:s,ctrlKey:o,metaKey:a,shiftKey:l}=t,c="keydown"===i,u=c&&n===this.lastKey;var h;if(!(s||o||a||l)&&n)if(c){const i=document.activeElement;if(_.element(i)){const{editable:n}=e.config.selectors,{seek:s}=r.inputs;if(i!==s&&H(i,n))return;if(" "===t.key&&H(i,'button, [role^="menuitem"]'))return}switch([" ","ArrowLeft","ArrowUp","ArrowRight","ArrowDown","0","1","2","3","4","5","6","7","8","9","c","f","k","l","m"].includes(n)&&(t.preventDefault(),t.stopPropagation()),n){case"0":case"1":case"2":case"3":case"4":case"5":case"6":case"7":case"8":case"9":u||(h=parseInt(n,10),e.currentTime=e.duration/10*h);break;case" ":case"k":u||nt(e.togglePlay());break;case"ArrowUp":e.increaseVolume(.1);break;case"ArrowDown":e.decreaseVolume(.1);break;case"m":u||(e.muted=!e.muted);break;case"ArrowRight":e.forward();break;case"ArrowLeft":e.rewind();break;case"f":e.fullscreen.toggle();break;case"c":u||e.toggleCaptions();break;case"l":e.loop=!e.loop}"Escape"===n&&!e.fullscreen.usingNative&&e.fullscreen.active&&e.fullscreen.toggle(),this.lastKey=n}else this.lastKey=null}toggleMenu(t){kt.toggleMenu.call(this.player,t)}}"undefined"!=typeof globalThis?globalThis:"undefined"!=typeof window?window:void 0!==r.g?r.g:"undefined"!=typeof self&&self;var Vt=function(t,e){return t(e={exports:{}},e.exports),e.exports}((function(t,e){t.exports=function(){var t=function(){},e={},r={},n={};function i(t,e){t=t.push?t:[t];var i,s,o,a=[],l=t.length,c=l;for(i=function(t,r){r.length&&a.push(t),--c||e(a)};l--;)s=t[l],(o=r[s])?i(s,o):(n[s]=n[s]||[]).push(i)}function s(t,e){if(t){var i=n[t];if(r[t]=e,i)for(;i.length;)i[0](t,e),i.splice(0,1)}}function o(e,r){e.call&&(e={success:e}),r.length?(e.error||t)(r):(e.success||t)(e)}function a(e,r,n,i){var s,o,l=document,c=n.async,u=(n.numRetries||0)+1,h=n.before||t,d=e.replace(/[\?|#].*$/,""),f=e.replace(/^(css|img)!/,"");i=i||0,/(^css!|\.css$)/.test(d)?((o=l.createElement("link")).rel="stylesheet",o.href=f,(s="hideFocus"in o)&&o.relList&&(s=0,o.rel="preload",o.as="style")):/(^img!|\.(png|gif|jpg|svg|webp)$)/.test(d)?(o=l.createElement("img")).src=f:((o=l.createElement("script")).src=e,o.async=void 0===c||c),o.onload=o.onerror=o.onbeforeload=function(t){var l=t.type[0];if(s)try{o.sheet.cssText.length||(l="e")}catch(t){18!=t.code&&(l="e")}if("e"==l){if((i+=1)<u)return a(e,r,n,i)}else if("preload"==o.rel&&"style"==o.as)return o.rel="stylesheet";r(e,l,t.defaultPrevented)},!1!==h(e,o)&&l.head.appendChild(o)}function l(t,e,r){var n,i,s=(t=t.push?t:[t]).length,o=s,l=[];for(n=function(t,r,n){if("e"==r&&l.push(t),"b"==r){if(!n)return;l.push(t)}--s||e(l)},i=0;i<o;i++)a(t[i],n,r)}function c(t,r,n){var i,a;if(r&&r.trim&&(i=r),a=(i?n:r)||{},i){if(i in e)throw"LoadJS";e[i]=!0}function c(e,r){l(t,(function(t){o(a,t),e&&o({success:e,error:r},t),s(i,t)}),a)}if(a.returnPromise)return new Promise(c);c()}return c.ready=function(t,e){return i(t,(function(t){o(e,t)})),c},c.done=function(t){s(t,[])},c.reset=function(){e={},r={},n={}},c.isDefined=function(t){return t in e},c}()}));function Kt(t){return new Promise(((e,r)=>{Vt(t,{success:e,error:r})}))}function Yt(t){t&&!this.embed.hasPlayed&&(this.embed.hasPlayed=!0),this.media.paused===t&&(this.media.paused=!t,tt.call(this,this.media,t?"play":"pause"))}const qt={setup(){const t=this;j(t.elements.wrapper,t.config.classNames.embed,!0),t.options.speed=t.config.speed.options,ht.call(t),_.object(window.Vimeo)?qt.ready.call(t):Kt(t.config.urls.vimeo.sdk).then((()=>{qt.ready.call(t)})).catch((e=>{t.debug.warn("Vimeo SDK (player.js) failed to load",e)}))},ready(){const t=this,e=t.config.vimeo,{premium:r,referrerPolicy:n,...i}=e;let s=t.media.getAttribute("src"),o="";_.empty(s)?(s=t.media.getAttribute(t.config.attributes.embed.id),o=t.media.getAttribute(t.config.attributes.embed.hash)):o=function(t){const e=t.match(/^.*(vimeo.com\/|video\/)(\d+)(\?.*&*h=|\/)+([\d,a-f]+)/);return e&&5===e.length?e[4]:null}(s);const a=o?{h:o}:{};r&&Object.assign(i,{controls:!1,sidedock:!1});const l=It({loop:t.config.loop.active,autoplay:t.autoplay,muted:t.muted,gesture:"media",playsinline:t.config.playsinline,...a,...i}),c=(u=s,_.empty(u)?null:_.number(Number(u))?u:u.match(/^.*(vimeo.com\/|video\/)(\d+).*/)?RegExp.$2:u);var u;const h=C("iframe"),d=pt(t.config.urls.vimeo.iframe,c,l);if(h.setAttribute("src",d),h.setAttribute("allowfullscreen",""),h.setAttribute("allow",["autoplay","fullscreen","picture-in-picture","encrypted-media","accelerometer","gyroscope"].join("; ")),_.empty(n)||h.setAttribute("referrerPolicy",n),r||!e.customControls)h.setAttribute("data-poster",t.poster),t.media=U(h,t.media);else{const e=C("div",{class:t.config.classNames.embedContainer,"data-poster":t.poster});e.appendChild(h),t.media=U(e,t.media)}e.customControls||wt(pt(t.config.urls.vimeo.api,d)).then((e=>{!_.empty(e)&&e.thumbnail_url&&Gt.setPoster.call(t,e.thumbnail_url).catch((()=>{}))})),t.embed=new window.Vimeo.Player(h,{autopause:t.config.autopause,muted:t.muted}),t.media.paused=!0,t.media.currentTime=0,t.supported.ui&&t.embed.disableTextTrack(),t.media.play=()=>(Yt.call(t,!0),t.embed.play()),t.media.pause=()=>(Yt.call(t,!1),t.embed.pause()),t.media.stop=()=>{t.pause(),t.currentTime=0};let{currentTime:f}=t.media;Object.defineProperty(t.media,"currentTime",{get:()=>f,set(e){const{embed:r,media:n,paused:i,volume:s}=t,o=i&&!r.hasPlayed;n.seeking=!0,tt.call(t,n,"seeking"),Promise.resolve(o&&r.setVolume(0)).then((()=>r.setCurrentTime(e))).then((()=>o&&r.pause())).then((()=>o&&r.setVolume(s))).catch((()=>{}))}});let p=t.config.speed.selected;Object.defineProperty(t.media,"playbackRate",{get:()=>p,set(e){t.embed.setPlaybackRate(e).then((()=>{p=e,tt.call(t,t.media,"ratechange")})).catch((()=>{t.options.speed=[1]}))}});let{volume:g}=t.config;Object.defineProperty(t.media,"volume",{get:()=>g,set(e){t.embed.setVolume(e).then((()=>{g=e,tt.call(t,t.media,"volumechange")}))}});let{muted:m}=t.config;Object.defineProperty(t.media,"muted",{get:()=>m,set(e){const r=!!_.boolean(e)&&e;t.embed.setMuted(!!r||t.config.muted).then((()=>{m=r,tt.call(t,t.media,"volumechange")}))}});let y,{loop:v}=t.config;Object.defineProperty(t.media,"loop",{get:()=>v,set(e){const r=_.boolean(e)?e:t.config.loop.active;t.embed.setLoop(r).then((()=>{v=r}))}}),t.embed.getVideoUrl().then((e=>{y=e,kt.setDownloadUrl.call(t)})).catch((t=>{this.debug.warn(t)})),Object.defineProperty(t.media,"currentSrc",{get:()=>y}),Object.defineProperty(t.media,"ended",{get:()=>t.currentTime===t.duration}),Promise.all([t.embed.getVideoWidth(),t.embed.getVideoHeight()]).then((e=>{const[r,n]=e;t.embed.ratio=dt(r,n),ht.call(this)})),t.embed.setAutopause(t.config.autopause).then((e=>{t.config.autopause=e})),t.embed.getVideoTitle().then((e=>{t.config.title=e,Gt.setTitle.call(this)})),t.embed.getCurrentTime().then((e=>{f=e,tt.call(t,t.media,"timeupdate")})),t.embed.getDuration().then((e=>{t.media.duration=e,tt.call(t,t.media,"durationchange")})),t.embed.getTextTracks().then((e=>{t.media.textTracks=e,Rt.setup.call(t)})),t.embed.on("cuechange",(({cues:e=[]})=>{const r=e.map((t=>function(t){const e=document.createDocumentFragment(),r=document.createElement("div");return e.appendChild(r),r.innerHTML=t,e.firstChild.innerText}(t.text)));Rt.updateCues.call(t,r)})),t.embed.on("loaded",(()=>{t.embed.getPaused().then((e=>{Yt.call(t,!e),e||tt.call(t,t.media,"playing")})),_.element(t.embed.element)&&t.supported.ui&&t.embed.element.setAttribute("tabindex",-1)})),t.embed.on("bufferstart",(()=>{tt.call(t,t.media,"waiting")})),t.embed.on("bufferend",(()=>{tt.call(t,t.media,"playing")})),t.embed.on("play",(()=>{Yt.call(t,!0),tt.call(t,t.media,"playing")})),t.embed.on("pause",(()=>{Yt.call(t,!1)})),t.embed.on("timeupdate",(e=>{t.media.seeking=!1,f=e.seconds,tt.call(t,t.media,"timeupdate")})),t.embed.on("progress",(e=>{t.media.buffered=e.percent,tt.call(t,t.media,"progress"),1===parseInt(e.percent,10)&&tt.call(t,t.media,"canplaythrough"),t.embed.getDuration().then((e=>{e!==t.media.duration&&(t.media.duration=e,tt.call(t,t.media,"durationchange"))}))})),t.embed.on("seeked",(()=>{t.media.seeking=!1,tt.call(t,t.media,"seeked")})),t.embed.on("ended",(()=>{t.media.paused=!0,tt.call(t,t.media,"ended")})),t.embed.on("error",(e=>{t.media.error=e,tt.call(t,t.media,"error")})),e.customControls&&setTimeout((()=>Gt.build.call(t)),0)}};function Wt(t){t&&!this.embed.hasPlayed&&(this.embed.hasPlayed=!0),this.media.paused===t&&(this.media.paused=!t,tt.call(this,this.media,t?"play":"pause"))}function zt(t){return t.noCookie?"https://www.youtube-nocookie.com":"http:"===window.location.protocol?"http://www.youtube.com":void 0}const Xt={setup(){if(j(this.elements.wrapper,this.config.classNames.embed,!0),_.object(window.YT)&&_.function(window.YT.Player))Xt.ready.call(this);else{const t=window.onYouTubeIframeAPIReady;window.onYouTubeIframeAPIReady=()=>{_.function(t)&&t(),Xt.ready.call(this)},Kt(this.config.urls.youtube.sdk).catch((t=>{this.debug.warn("YouTube API failed to load",t)}))}},getTitle(t){wt(pt(this.config.urls.youtube.api,t)).then((t=>{if(_.object(t)){const{title:e,height:r,width:n}=t;this.config.title=e,Gt.setTitle.call(this),this.embed.ratio=dt(n,r)}ht.call(this)})).catch((()=>{ht.call(this)}))},ready(){const t=this,e=t.config.youtube,r=t.media&&t.media.getAttribute("id");if(!_.empty(r)&&r.startsWith("youtube-"))return;let n=t.media.getAttribute("src");_.empty(n)&&(n=t.media.getAttribute(this.config.attributes.embed.id));const i=(s=n,_.empty(s)?null:s.match(/^.*(youtu.be\/|v\/|u\/\w\/|embed\/|watch\?v=|&v=)([^#&?]*).*/)?RegExp.$2:s);var s;const o=C("div",{id:`${t.provider}-${Math.floor(1e4*Math.random())}`,"data-poster":e.customControls?t.poster:void 0});if(t.media=U(o,t.media),e.customControls){const e=t=>`https://i.ytimg.com/vi/${i}/${t}default.jpg`;jt(e("maxres"),121).catch((()=>jt(e("sd"),121))).catch((()=>jt(e("hq")))).then((e=>Gt.setPoster.call(t,e.src))).then((e=>{e.includes("maxres")||(t.elements.poster.style.backgroundSize="cover")})).catch((()=>{}))}t.embed=new window.YT.Player(t.media,{videoId:i,host:zt(e),playerVars:R({},{autoplay:t.config.autoplay?1:0,hl:t.config.hl,controls:t.supported.ui&&e.customControls?0:1,disablekb:1,playsinline:t.config.playsinline&&!t.config.fullscreen.iosNative?1:0,cc_load_policy:t.captions.active?1:0,cc_lang_pref:t.config.captions.language,widget_referrer:window?window.location.href:null},e),events:{onError(e){if(!t.media.error){const r=e.data,n={2:"The request contains an invalid parameter value. For example, this error occurs if you specify a video ID that does not have 11 characters, or if the video ID contains invalid characters, such as exclamation points or asterisks.",5:"The requested content cannot be played in an HTML5 player or another error related to the HTML5 player has occurred.",100:"The video requested was not found. This error occurs when a video has been removed (for any reason) or has been marked as private.",101:"The owner of the requested video does not allow it to be played in embedded players.",150:"The owner of the requested video does not allow it to be played in embedded players."}[r]||"An unknown error occurred";t.media.error={code:r,message:n},tt.call(t,t.media,"error")}},onPlaybackRateChange(e){const r=e.target;t.media.playbackRate=r.getPlaybackRate(),tt.call(t,t.media,"ratechange")},onReady(r){if(_.function(t.media.play))return;const n=r.target;Xt.getTitle.call(t,i),t.media.play=()=>{Wt.call(t,!0),n.playVideo()},t.media.pause=()=>{Wt.call(t,!1),n.pauseVideo()},t.media.stop=()=>{n.stopVideo()},t.media.duration=n.getDuration(),t.media.paused=!0,t.media.currentTime=0,Object.defineProperty(t.media,"currentTime",{get:()=>Number(n.getCurrentTime()),set(e){t.paused&&!t.embed.hasPlayed&&t.embed.mute(),t.media.seeking=!0,tt.call(t,t.media,"seeking"),n.seekTo(e)}}),Object.defineProperty(t.media,"playbackRate",{get:()=>n.getPlaybackRate(),set(t){n.setPlaybackRate(t)}});let{volume:s}=t.config;Object.defineProperty(t.media,"volume",{get:()=>s,set(e){s=e,n.setVolume(100*s),tt.call(t,t.media,"volumechange")}});let{muted:o}=t.config;Object.defineProperty(t.media,"muted",{get:()=>o,set(e){const r=_.boolean(e)?e:o;o=r,n[r?"mute":"unMute"](),n.setVolume(100*s),tt.call(t,t.media,"volumechange")}}),Object.defineProperty(t.media,"currentSrc",{get:()=>n.getVideoUrl()}),Object.defineProperty(t.media,"ended",{get:()=>t.currentTime===t.duration});const a=n.getAvailablePlaybackRates();t.options.speed=a.filter((e=>t.config.speed.options.includes(e))),t.supported.ui&&e.customControls&&t.media.setAttribute("tabindex",-1),tt.call(t,t.media,"timeupdate"),tt.call(t,t.media,"durationchange"),clearInterval(t.timers.buffering),t.timers.buffering=setInterval((()=>{t.media.buffered=n.getVideoLoadedFraction(),(null===t.media.lastBuffered||t.media.lastBuffered<t.media.buffered)&&tt.call(t,t.media,"progress"),t.media.lastBuffered=t.media.buffered,1===t.media.buffered&&(clearInterval(t.timers.buffering),tt.call(t,t.media,"canplaythrough"))}),200),e.customControls&&setTimeout((()=>Gt.build.call(t)),50)},onStateChange(r){const n=r.target;switch(clearInterval(t.timers.playing),t.media.seeking&&[1,2].includes(r.data)&&(t.media.seeking=!1,tt.call(t,t.media,"seeked")),r.data){case-1:tt.call(t,t.media,"timeupdate"),t.media.buffered=n.getVideoLoadedFraction(),tt.call(t,t.media,"progress");break;case 0:Wt.call(t,!1),t.media.loop?(n.stopVideo(),n.playVideo()):tt.call(t,t.media,"ended");break;case 1:e.customControls&&!t.config.autoplay&&t.media.paused&&!t.embed.hasPlayed?t.media.pause():(Wt.call(t,!0),tt.call(t,t.media,"playing"),t.timers.playing=setInterval((()=>{tt.call(t,t.media,"timeupdate")}),50),t.media.duration!==n.getDuration()&&(t.media.duration=n.getDuration(),tt.call(t,t.media,"durationchange")));break;case 2:t.muted||t.embed.unMute(),Wt.call(t,!1);break;case 3:tt.call(t,t.media,"waiting")}tt.call(t,t.elements.container,"statechange",!1,{code:r.data})}}})}},Qt={setup(){this.media?(j(this.elements.container,this.config.classNames.type.replace("{0}",this.type),!0),j(this.elements.container,this.config.classNames.provider.replace("{0}",this.provider),!0),this.isEmbed&&j(this.elements.container,this.config.classNames.type.replace("{0}","video"),!0),this.isVideo&&(this.elements.wrapper=C("div",{class:this.config.classNames.video}),O(this.media,this.elements.wrapper),this.elements.poster=C("div",{class:this.config.classNames.poster}),this.elements.wrapper.appendChild(this.elements.poster)),this.isHTML5?ft.setup.call(this):this.isYouTube?Xt.setup.call(this):this.isVimeo&&qt.setup.call(this)):this.debug.warn("No media element found!")}};class Jt{constructor(e){t(this,"load",(()=>{this.enabled&&(_.object(window.google)&&_.object(window.google.ima)?this.ready():Kt(this.player.config.urls.googleIMA.sdk).then((()=>{this.ready()})).catch((()=>{this.trigger("error",new Error("Google IMA SDK failed to load"))})))})),t(this,"ready",(()=>{var t;this.enabled||((t=this).manager&&t.manager.destroy(),t.elements.displayContainer&&t.elements.displayContainer.destroy(),t.elements.container.remove()),this.startSafetyTimer(12e3,"ready()"),this.managerPromise.then((()=>{this.clearSafetyTimer("onAdsManagerLoaded()")})),this.listeners(),this.setupIMA()})),t(this,"setupIMA",(()=>{this.elements.container=C("div",{class:this.player.config.classNames.ads}),this.player.elements.container.appendChild(this.elements.container),google.ima.settings.setVpaidMode(google.ima.ImaSdkSettings.VpaidMode.ENABLED),google.ima.settings.setLocale(this.player.config.ads.language),google.ima.settings.setDisableCustomPlaybackForIOS10Plus(this.player.config.playsinline),this.elements.displayContainer=new google.ima.AdDisplayContainer(this.elements.container,this.player.media),this.loader=new google.ima.AdsLoader(this.elements.displayContainer),this.loader.addEventListener(google.ima.AdsManagerLoadedEvent.Type.ADS_MANAGER_LOADED,(t=>this.onAdsManagerLoaded(t)),!1),this.loader.addEventListener(google.ima.AdErrorEvent.Type.AD_ERROR,(t=>this.onAdError(t)),!1),this.requestAds()})),t(this,"requestAds",(()=>{const{container:t}=this.player.elements;try{const e=new google.ima.AdsRequest;e.adTagUrl=this.tagUrl,e.linearAdSlotWidth=t.offsetWidth,e.linearAdSlotHeight=t.offsetHeight,e.nonLinearAdSlotWidth=t.offsetWidth,e.nonLinearAdSlotHeight=t.offsetHeight,e.forceNonLinearFullSlot=!1,e.setAdWillPlayMuted(!this.player.muted),this.loader.requestAds(e)}catch(t){this.onAdError(t)}})),t(this,"pollCountdown",((t=!1)=>{if(!t)return clearInterval(this.countdownTimer),void this.elements.container.removeAttribute("data-badge-text");this.countdownTimer=setInterval((()=>{const t=xt(Math.max(this.manager.getRemainingTime(),0)),e=`${Et.get("advertisement",this.player.config)} - ${t}`;this.elements.container.setAttribute("data-badge-text",e)}),100)})),t(this,"onAdsManagerLoaded",(t=>{if(!this.enabled)return;const e=new google.ima.AdsRenderingSettings;e.restoreCustomPlaybackStateOnAdBreakComplete=!0,e.enablePreloading=!0,this.manager=t.getAdsManager(this.player,e),this.cuePoints=this.manager.getCuePoints(),this.manager.addEventListener(google.ima.AdErrorEvent.Type.AD_ERROR,(t=>this.onAdError(t))),Object.keys(google.ima.AdEvent.Type).forEach((t=>{this.manager.addEventListener(google.ima.AdEvent.Type[t],(t=>this.onAdEvent(t)))})),this.trigger("loaded")})),t(this,"addCuePoints",(()=>{_.empty(this.cuePoints)||this.cuePoints.forEach((t=>{if(0!==t&&-1!==t&&t<this.player.duration){const e=this.player.elements.progress;if(_.element(e)){const r=100/this.player.duration*t,n=C("span",{class:this.player.config.classNames.cues});n.style.left=`${r.toString()}%`,e.appendChild(n)}}}))})),t(this,"onAdEvent",(t=>{const{container:e}=this.player.elements,r=t.getAd(),n=t.getAdData();switch((t=>{tt.call(this.player,this.player.media,`ads${t.replace(/_/g,"").toLowerCase()}`)})(t.type),t.type){case google.ima.AdEvent.Type.LOADED:this.trigger("loaded"),this.pollCountdown(!0),r.isLinear()||(r.width=e.offsetWidth,r.height=e.offsetHeight);break;case google.ima.AdEvent.Type.STARTED:this.manager.setVolume(this.player.volume);break;case google.ima.AdEvent.Type.ALL_ADS_COMPLETED:this.player.ended?this.loadAds():this.loader.contentComplete();break;case google.ima.AdEvent.Type.CONTENT_PAUSE_REQUESTED:this.pauseContent();break;case google.ima.AdEvent.Type.CONTENT_RESUME_REQUESTED:this.pollCountdown(),this.resumeContent();break;case google.ima.AdEvent.Type.LOG:n.adError&&this.player.debug.warn(`Non-fatal ad error: ${n.adError.getMessage()}`)}})),t(this,"onAdError",(t=>{this.cancel(),this.player.debug.warn("Ads error",t)})),t(this,"listeners",(()=>{const{container:t}=this.player.elements;let e;this.player.on("canplay",(()=>{this.addCuePoints()})),this.player.on("ended",(()=>{this.loader.contentComplete()})),this.player.on("timeupdate",(()=>{e=this.player.currentTime})),this.player.on("seeked",(()=>{const t=this.player.currentTime;_.empty(this.cuePoints)||this.cuePoints.forEach(((r,n)=>{e<r&&r<t&&(this.manager.discardAdBreak(),this.cuePoints.splice(n,1))}))})),window.addEventListener("resize",(()=>{this.manager&&this.manager.resize(t.offsetWidth,t.offsetHeight,google.ima.ViewMode.NORMAL)}))})),t(this,"play",(()=>{const{container:t}=this.player.elements;this.managerPromise||this.resumeContent(),this.managerPromise.then((()=>{this.manager.setVolume(this.player.volume),this.elements.displayContainer.initialize();try{this.initialized||(this.manager.init(t.offsetWidth,t.offsetHeight,google.ima.ViewMode.NORMAL),this.manager.start()),this.initialized=!0}catch(t){this.onAdError(t)}})).catch((()=>{}))})),t(this,"resumeContent",(()=>{this.elements.container.style.zIndex="",this.playing=!1,nt(this.player.media.play())})),t(this,"pauseContent",(()=>{this.elements.container.style.zIndex=3,this.playing=!0,this.player.media.pause()})),t(this,"cancel",(()=>{this.initialized&&this.resumeContent(),this.trigger("error"),this.loadAds()})),t(this,"loadAds",(()=>{this.managerPromise.then((()=>{this.manager&&this.manager.destroy(),this.managerPromise=new Promise((t=>{this.on("loaded",t),this.player.debug.log(this.manager)})),this.initialized=!1,this.requestAds()})).catch((()=>{}))})),t(this,"trigger",((t,...e)=>{const r=this.events[t];_.array(r)&&r.forEach((t=>{_.function(t)&&t.apply(this,e)}))})),t(this,"on",((t,e)=>(_.array(this.events[t])||(this.events[t]=[]),this.events[t].push(e),this))),t(this,"startSafetyTimer",((t,e)=>{this.player.debug.log(`Safety timer invoked from: ${e}`),this.safetyTimer=setTimeout((()=>{this.cancel(),this.clearSafetyTimer("startSafetyTimer()")}),t)})),t(this,"clearSafetyTimer",(t=>{_.nullOrUndefined(this.safetyTimer)||(this.player.debug.log(`Safety timer cleared from: ${t}`),clearTimeout(this.safetyTimer),this.safetyTimer=null)})),this.player=e,this.config=e.config.ads,this.playing=!1,this.initialized=!1,this.elements={container:null,displayContainer:null},this.manager=null,this.loader=null,this.cuePoints=null,this.events={},this.safetyTimer=null,this.countdownTimer=null,this.managerPromise=new Promise(((t,e)=>{this.on("loaded",t),this.on("error",e)})),this.load()}get enabled(){const{config:t}=this;return this.player.isHTML5&&this.player.isVideo&&t.enabled&&(!_.empty(t.publisherId)||_.url(t.tagUrl))}get tagUrl(){const{config:t}=this;return _.url(t.tagUrl)?t.tagUrl:`https://go.aniview.com/api/adserver6/vast/?${It({AV_PUBLISHERID:"58c25bb0073ef448b1087ad6",AV_CHANNELID:"5a0458dc28a06145e4519d21",AV_URL:window.location.hostname,cb:Date.now(),AV_WIDTH:640,AV_HEIGHT:480,AV_CDIM2:t.publisherId})}`}}function Zt(t=0,e=0,r=255){return Math.min(Math.max(t,e),r)}const te=t=>{const e=[];return t.split(/\r\n\r\n|\n\n|\r\r/).forEach((t=>{const r={};t.split(/\r\n|\n|\r/).forEach((t=>{if(_.number(r.startTime)){if(!_.empty(t.trim())&&_.empty(r.text)){const e=t.trim().split("#xywh=");[r.text]=e,e[1]&&([r.x,r.y,r.w,r.h]=e[1].split(","))}}else{const e=t.match(/([0-9]{2})?:?([0-9]{2}):([0-9]{2}).([0-9]{2,3})( ?--> ?)([0-9]{2})?:?([0-9]{2}):([0-9]{2}).([0-9]{2,3})/);e&&(r.startTime=60*Number(e[1]||0)*60+60*Number(e[2])+Number(e[3])+Number(`0.${e[4]}`),r.endTime=60*Number(e[6]||0)*60+60*Number(e[7])+Number(e[8])+Number(`0.${e[9]}`))}})),r.text&&e.push(r)})),e},ee=(t,e)=>{const r={};return t>e.width/e.height?(r.width=e.width,r.height=1/t*e.width):(r.height=e.height,r.width=t*e.height),r};class re{constructor(e){t(this,"load",(()=>{this.player.elements.display.seekTooltip&&(this.player.elements.display.seekTooltip.hidden=this.enabled),this.enabled&&this.getThumbnails().then((()=>{this.enabled&&(this.render(),this.determineContainerAutoSizing(),this.listeners(),this.loaded=!0)}))})),t(this,"getThumbnails",(()=>new Promise((t=>{const{src:e}=this.player.config.previewThumbnails;if(_.empty(e))throw new Error("Missing previewThumbnails.src config attribute");const r=()=>{this.thumbnails.sort(((t,e)=>t.height-e.height)),this.player.debug.log("Preview thumbnails",this.thumbnails),t()};if(_.function(e))e((t=>{this.thumbnails=t,r()}));else{const t=(_.string(e)?[e]:e).map((t=>this.getThumbnail(t)));Promise.all(t).then(r)}})))),t(this,"getThumbnail",(t=>new Promise((e=>{wt(t).then((r=>{const n={frames:te(r),height:null,urlPrefix:""};n.frames[0].text.startsWith("/")||n.frames[0].text.startsWith("http://")||n.frames[0].text.startsWith("https://")||(n.urlPrefix=t.substring(0,t.lastIndexOf("/")+1));const i=new Image;i.onload=()=>{n.height=i.naturalHeight,n.width=i.naturalWidth,this.thumbnails.push(n),e()},i.src=n.urlPrefix+n.frames[0].text}))})))),t(this,"startMove",(t=>{if(this.loaded&&_.event(t)&&["touchmove","mousemove"].includes(t.type)&&this.player.media.duration){if("touchmove"===t.type)this.seekTime=this.player.media.duration*(this.player.elements.inputs.seek.value/100);else{var e,r;const n=this.player.elements.progress.getBoundingClientRect(),i=100/n.width*(t.pageX-n.left);this.seekTime=this.player.media.duration*(i/100),this.seekTime<0&&(this.seekTime=0),this.seekTime>this.player.media.duration-1&&(this.seekTime=this.player.media.duration-1),this.mousePosX=t.pageX,this.elements.thumb.time.innerText=xt(this.seekTime);const s=null===(e=this.player.config.markers)||void 0===e||null===(r=e.points)||void 0===r?void 0:r.find((({time:t})=>t===Math.round(this.seekTime)));s&&this.elements.thumb.time.insertAdjacentHTML("afterbegin",`${s.label}<br>`)}this.showImageAtCurrentTime()}})),t(this,"endMove",(()=>{this.toggleThumbContainer(!1,!0)})),t(this,"startScrubbing",(t=>{(_.nullOrUndefined(t.button)||!1===t.button||0===t.button)&&(this.mouseDown=!0,this.player.media.duration&&(this.toggleScrubbingContainer(!0),this.toggleThumbContainer(!1,!0),this.showImageAtCurrentTime()))})),t(this,"endScrubbing",(()=>{this.mouseDown=!1,Math.ceil(this.lastTime)===Math.ceil(this.player.media.currentTime)?this.toggleScrubbingContainer(!1):Z.call(this.player,this.player.media,"timeupdate",(()=>{this.mouseDown||this.toggleScrubbingContainer(!1)}))})),t(this,"listeners",(()=>{this.player.on("play",(()=>{this.toggleThumbContainer(!1,!0)})),this.player.on("seeked",(()=>{this.toggleThumbContainer(!1)})),this.player.on("timeupdate",(()=>{this.lastTime=this.player.media.currentTime}))})),t(this,"render",(()=>{this.elements.thumb.container=C("div",{class:this.player.config.classNames.previewThumbnails.thumbContainer}),this.elements.thumb.imageContainer=C("div",{class:this.player.config.classNames.previewThumbnails.imageContainer}),this.elements.thumb.container.appendChild(this.elements.thumb.imageContainer);const t=C("div",{class:this.player.config.classNames.previewThumbnails.timeContainer});this.elements.thumb.time=C("span",{},"00:00"),t.appendChild(this.elements.thumb.time),this.elements.thumb.imageContainer.appendChild(t),_.element(this.player.elements.progress)&&this.player.elements.progress.appendChild(this.elements.thumb.container),this.elements.scrubbing.container=C("div",{class:this.player.config.classNames.previewThumbnails.scrubbingContainer}),this.player.elements.wrapper.appendChild(this.elements.scrubbing.container)})),t(this,"destroy",(()=>{this.elements.thumb.container&&this.elements.thumb.container.remove(),this.elements.scrubbing.container&&this.elements.scrubbing.container.remove()})),t(this,"showImageAtCurrentTime",(()=>{this.mouseDown?this.setScrubbingContainerSize():this.setThumbContainerSizeAndPos();const t=this.thumbnails[0].frames.findIndex((t=>this.seekTime>=t.startTime&&this.seekTime<=t.endTime)),e=t>=0;let r=0;this.mouseDown||this.toggleThumbContainer(e),e&&(this.thumbnails.forEach(((e,n)=>{this.loadedImages.includes(e.frames[t].text)&&(r=n)})),t!==this.showingThumb&&(this.showingThumb=t,this.loadImage(r)))})),t(this,"loadImage",((t=0)=>{const e=this.showingThumb,r=this.thumbnails[t],{urlPrefix:n}=r,i=r.frames[e],s=r.frames[e].text,o=n+s;if(this.currentImageElement&&this.currentImageElement.dataset.filename===s)this.showImage(this.currentImageElement,i,t,e,s,!1),this.currentImageElement.dataset.index=e,this.removeOldImages(this.currentImageElement);else{this.loadingImage&&this.usingSprites&&(this.loadingImage.onload=null);const r=new Image;r.src=o,r.dataset.index=e,r.dataset.filename=s,this.showingThumbFilename=s,this.player.debug.log(`Loading image: ${o}`),r.onload=()=>this.showImage(r,i,t,e,s,!0),this.loadingImage=r,this.removeOldImages(r)}})),t(this,"showImage",((t,e,r,n,i,s=!0)=>{this.player.debug.log(`Showing thumb: ${i}. num: ${n}. qual: ${r}. newimg: ${s}`),this.setImageSizeAndOffset(t,e),s&&(this.currentImageContainer.appendChild(t),this.currentImageElement=t,this.loadedImages.includes(i)||this.loadedImages.push(i)),this.preloadNearby(n,!0).then(this.preloadNearby(n,!1)).then(this.getHigherQuality(r,t,e,i))})),t(this,"removeOldImages",(t=>{Array.from(this.currentImageContainer.children).forEach((e=>{if("img"!==e.tagName.toLowerCase())return;const r=this.usingSprites?500:1e3;if(e.dataset.index!==t.dataset.index&&!e.dataset.deleting){e.dataset.deleting=!0;const{currentImageContainer:t}=this;setTimeout((()=>{t.removeChild(e),this.player.debug.log(`Removing thumb: ${e.dataset.filename}`)}),r)}}))})),t(this,"preloadNearby",((t,e=!0)=>new Promise((r=>{setTimeout((()=>{const n=this.thumbnails[0].frames[t].text;if(this.showingThumbFilename===n){let i;i=e?this.thumbnails[0].frames.slice(t):this.thumbnails[0].frames.slice(0,t).reverse();let s=!1;i.forEach((t=>{const e=t.text;if(e!==n&&!this.loadedImages.includes(e)){s=!0,this.player.debug.log(`Preloading thumb filename: ${e}`);const{urlPrefix:t}=this.thumbnails[0],n=t+e,i=new Image;i.src=n,i.onload=()=>{this.player.debug.log(`Preloaded thumb filename: ${e}`),this.loadedImages.includes(e)||this.loadedImages.push(e),r()}}})),s||r()}}),300)})))),t(this,"getHigherQuality",((t,e,r,n)=>{if(t<this.thumbnails.length-1){let i=e.naturalHeight;this.usingSprites&&(i=r.h),i<this.thumbContainerHeight&&setTimeout((()=>{this.showingThumbFilename===n&&(this.player.debug.log(`Showing higher quality thumb for: ${n}`),this.loadImage(t+1))}),300)}})),t(this,"toggleThumbContainer",((t=!1,e=!1)=>{const r=this.player.config.classNames.previewThumbnails.thumbContainerShown;this.elements.thumb.container.classList.toggle(r,t),!t&&e&&(this.showingThumb=null,this.showingThumbFilename=null)})),t(this,"toggleScrubbingContainer",((t=!1)=>{const e=this.player.config.classNames.previewThumbnails.scrubbingContainerShown;this.elements.scrubbing.container.classList.toggle(e,t),t||(this.showingThumb=null,this.showingThumbFilename=null)})),t(this,"determineContainerAutoSizing",(()=>{(this.elements.thumb.imageContainer.clientHeight>20||this.elements.thumb.imageContainer.clientWidth>20)&&(this.sizeSpecifiedInCSS=!0)})),t(this,"setThumbContainerSizeAndPos",(()=>{const{imageContainer:t}=this.elements.thumb;if(this.sizeSpecifiedInCSS){if(t.clientHeight>20&&t.clientWidth<20){const e=Math.floor(t.clientHeight*this.thumbAspectRatio);t.style.width=`${e}px`}else if(t.clientHeight<20&&t.clientWidth>20){const e=Math.floor(t.clientWidth/this.thumbAspectRatio);t.style.height=`${e}px`}}else{const e=Math.floor(this.thumbContainerHeight*this.thumbAspectRatio);t.style.height=`${this.thumbContainerHeight}px`,t.style.width=`${e}px`}this.setThumbContainerPos()})),t(this,"setThumbContainerPos",(()=>{const t=this.player.elements.progress.getBoundingClientRect(),e=this.player.elements.container.getBoundingClientRect(),{container:r}=this.elements.thumb,n=e.left-t.left+10,i=e.right-t.left-r.clientWidth-10,s=this.mousePosX-t.left-r.clientWidth/2,o=Zt(s,n,i);r.style.left=`${o}px`,r.style.setProperty("--preview-arrow-offset",s-o+"px")})),t(this,"setScrubbingContainerSize",(()=>{const{width:t,height:e}=ee(this.thumbAspectRatio,{width:this.player.media.clientWidth,height:this.player.media.clientHeight});this.elements.scrubbing.container.style.width=`${t}px`,this.elements.scrubbing.container.style.height=`${e}px`})),t(this,"setImageSizeAndOffset",((t,e)=>{if(!this.usingSprites)return;const r=this.thumbContainerHeight/e.h;t.style.height=t.naturalHeight*r+"px",t.style.width=t.naturalWidth*r+"px",t.style.left=`-${e.x*r}px`,t.style.top=`-${e.y*r}px`})),this.player=e,this.thumbnails=[],this.loaded=!1,this.lastMouseMoveTime=Date.now(),this.mouseDown=!1,this.loadedImages=[],this.elements={thumb:{},scrubbing:{}},this.load()}get enabled(){return this.player.isHTML5&&this.player.isVideo&&this.player.config.previewThumbnails.enabled}get currentImageContainer(){return this.mouseDown?this.elements.scrubbing.container:this.elements.thumb.imageContainer}get usingSprites(){return Object.keys(this.thumbnails[0].frames[0]).includes("w")}get thumbAspectRatio(){return this.usingSprites?this.thumbnails[0].frames[0].w/this.thumbnails[0].frames[0].h:this.thumbnails[0].width/this.thumbnails[0].height}get thumbContainerHeight(){if(this.mouseDown){const{height:t}=ee(this.thumbAspectRatio,{width:this.player.media.clientWidth,height:this.player.media.clientHeight});return t}return this.sizeSpecifiedInCSS?this.elements.thumb.imageContainer.clientHeight:Math.floor(this.player.media.clientWidth/this.thumbAspectRatio/4)}get currentImageElement(){return this.mouseDown?this.currentScrubbingImageElement:this.currentThumbnailImageElement}set currentImageElement(t){this.mouseDown?this.currentScrubbingImageElement=t:this.currentThumbnailImageElement=t}}const ne={insertElements(t,e){_.string(e)?M(t,this.media,{src:e}):_.array(e)&&e.forEach((e=>{M(t,this.media,e)}))},change(t){I(t,"sources.length")?(ft.cancelRequests.call(this),this.destroy.call(this,(()=>{this.options.quality=[],N(this.media),this.media=null,_.element(this.elements.container)&&this.elements.container.removeAttribute("class");const{sources:e,type:r}=t,[{provider:n=Mt.html5,src:i}]=e,s="html5"===n?r:"div",o="html5"===n?{}:{src:i};Object.assign(this,{provider:n,type:r,supported:W.check(r,n,this.config.playsinline),media:C(s,o)}),this.elements.container.appendChild(this.media),_.boolean(t.autoplay)&&(this.config.autoplay=t.autoplay),this.isHTML5&&(this.config.crossorigin&&this.media.setAttribute("crossorigin",""),this.config.autoplay&&this.media.setAttribute("autoplay",""),_.empty(t.poster)||(this.poster=t.poster),this.config.loop.active&&this.media.setAttribute("loop",""),this.config.muted&&this.media.setAttribute("muted",""),this.config.playsinline&&this.media.setAttribute("playsinline","")),Gt.addStyleHook.call(this),this.isHTML5&&ne.insertElements.call(this,"source",e),this.config.title=t.title,Qt.setup.call(this),this.isHTML5&&Object.keys(t).includes("tracks")&&ne.insertElements.call(this,"track",t.tracks),(this.isHTML5||this.isEmbed&&!this.supported.ui)&&Gt.build.call(this),this.isHTML5&&this.media.load(),_.empty(t.previewThumbnails)||(Object.assign(this.config.previewThumbnails,t.previewThumbnails),this.previewThumbnails&&this.previewThumbnails.loaded&&(this.previewThumbnails.destroy(),this.previewThumbnails=null),this.config.previewThumbnails.enabled&&(this.previewThumbnails=new re(this))),this.fullscreen.update()}),!0)):this.debug.warn("Invalid source format")}};class ie{constructor(e,r){if(t(this,"play",(()=>_.function(this.media.play)?(this.ads&&this.ads.enabled&&this.ads.managerPromise.then((()=>this.ads.play())).catch((()=>nt(this.media.play()))),this.media.play()):null)),t(this,"pause",(()=>this.playing&&_.function(this.media.pause)?this.media.pause():null)),t(this,"togglePlay",(t=>(_.boolean(t)?t:!this.playing)?this.play():this.pause())),t(this,"stop",(()=>{this.isHTML5?(this.pause(),this.restart()):_.function(this.media.stop)&&this.media.stop()})),t(this,"restart",(()=>{this.currentTime=0})),t(this,"rewind",(t=>{this.currentTime-=_.number(t)?t:this.config.seekTime})),t(this,"forward",(t=>{this.currentTime+=_.number(t)?t:this.config.seekTime})),t(this,"increaseVolume",(t=>{const e=this.media.muted?0:this.volume;this.volume=e+(_.number(t)?t:0)})),t(this,"decreaseVolume",(t=>{this.increaseVolume(-t)})),t(this,"airplay",(()=>{W.airplay&&this.media.webkitShowPlaybackTargetPicker()})),t(this,"toggleControls",(t=>{if(this.supported.ui&&!this.isAudio){const e=G(this.elements.container,this.config.classNames.hideControls),r=void 0===t?void 0:!t,n=j(this.elements.container,this.config.classNames.hideControls,r);if(n&&_.array(this.config.controls)&&this.config.controls.includes("settings")&&!_.empty(this.config.settings)&&kt.toggleMenu.call(this,!1),n!==e){const t=n?"controlshidden":"controlsshown";tt.call(this,this.media,t)}return!n}return!1})),t(this,"on",((t,e)=>{Q.call(this,this.elements.container,t,e)})),t(this,"once",((t,e)=>{Z.call(this,this.elements.container,t,e)})),t(this,"off",((t,e)=>{J(this.elements.container,t,e)})),t(this,"destroy",((t,e=!1)=>{if(!this.ready)return;const r=()=>{document.body.style.overflow="",this.embed=null,e?(Object.keys(this.elements).length&&(N(this.elements.buttons.play),N(this.elements.captions),N(this.elements.controls),N(this.elements.wrapper),this.elements.buttons.play=null,this.elements.captions=null,this.elements.controls=null,this.elements.wrapper=null),_.function(t)&&t()):(et.call(this),ft.cancelRequests.call(this),U(this.elements.original,this.elements.container),tt.call(this,this.elements.original,"destroyed",!0),_.function(t)&&t.call(this.elements.original),this.ready=!1,setTimeout((()=>{this.elements=null,this.media=null}),200))};this.stop(),clearTimeout(this.timers.loading),clearTimeout(this.timers.controls),clearTimeout(this.timers.resized),this.isHTML5?(Gt.toggleNativeControls.call(this,!0),r()):this.isYouTube?(clearInterval(this.timers.buffering),clearInterval(this.timers.playing),null!==this.embed&&_.function(this.embed.destroy)&&this.embed.destroy(),r()):this.isVimeo&&(null!==this.embed&&this.embed.unload().then(r),setTimeout(r,200))})),t(this,"supports",(t=>W.mime.call(this,t))),this.timers={},this.ready=!1,this.loading=!1,this.failed=!1,this.touch=W.touch,this.media=e,_.string(this.media)&&(this.media=document.querySelectorAll(this.media)),(window.jQuery&&this.media instanceof jQuery||_.nodeList(this.media)||_.array(this.media))&&(this.media=this.media[0]),this.config=R({},Ot,ie.defaults,r||{},(()=>{try{return JSON.parse(this.media.getAttribute("data-plyr-config"))}catch(t){return{}}})()),this.elements={container:null,fullscreen:null,captions:null,buttons:{},display:{},progress:{},inputs:{},settings:{popup:null,menu:null,panels:{},buttons:{}}},this.captions={active:null,currentTrack:-1,meta:new WeakMap},this.fullscreen={active:!1},this.options={speed:[],quality:[]},this.debug=new Bt(this.config.debug),this.debug.log("Config",this.config),this.debug.log("Support",W),_.nullOrUndefined(this.media)||!_.element(this.media))return void this.debug.error("Setup failed: no suitable element passed");if(this.media.plyr)return void this.debug.warn("Target already setup");if(!this.config.enabled)return void this.debug.error("Setup failed: disabled by config");if(!W.check().api)return void this.debug.error("Setup failed: no support");const n=this.media.cloneNode(!0);n.autoplay=!1,this.elements.original=n;const i=this.media.tagName.toLowerCase();let s=null,o=null;switch(i){case"div":if(s=this.media.querySelector("iframe"),_.element(s)){if(o=Pt(s.getAttribute("src")),this.provider=function(t){return/^(https?:\/\/)?(www\.)?(youtube\.com|youtube-nocookie\.com|youtu\.?be)\/.+$/.test(t)?Mt.youtube:/^https?:\/\/player.vimeo.com\/video\/\d{0,9}(?=\b|\/)/.test(t)?Mt.vimeo:null}(o.toString()),this.elements.container=this.media,this.media=s,this.elements.container.className="",o.search.length){const t=["1","true"];t.includes(o.searchParams.get("autoplay"))&&(this.config.autoplay=!0),t.includes(o.searchParams.get("loop"))&&(this.config.loop.active=!0),this.isYouTube?(this.config.playsinline=t.includes(o.searchParams.get("playsinline")),this.config.youtube.hl=o.searchParams.get("hl")):this.config.playsinline=!0}}else this.provider=this.media.getAttribute(this.config.attributes.embed.provider),this.media.removeAttribute(this.config.attributes.embed.provider);if(_.empty(this.provider)||!Object.values(Mt).includes(this.provider))return void this.debug.error("Setup failed: Invalid provider");this.type=Ft;break;case"video":case"audio":this.type=i,this.provider=Mt.html5,this.media.hasAttribute("crossorigin")&&(this.config.crossorigin=!0),this.media.hasAttribute("autoplay")&&(this.config.autoplay=!0),(this.media.hasAttribute("playsinline")||this.media.hasAttribute("webkit-playsinline"))&&(this.config.playsinline=!0),this.media.hasAttribute("muted")&&(this.config.muted=!0),this.media.hasAttribute("loop")&&(this.config.loop.active=!0);break;default:return void this.debug.error("Setup failed: unsupported type")}this.supported=W.check(this.type,this.provider),this.supported.api?(this.eventListeners=[],this.listeners=new Ht(this),this.storage=new At(this),this.media.plyr=this,_.element(this.elements.container)||(this.elements.container=C("div"),O(this.media,this.elements.container)),Gt.migrateStyles.call(this),Gt.addStyleHook.call(this),Qt.setup.call(this),this.config.debug&&Q.call(this,this.elements.container,this.config.events.join(" "),(t=>{this.debug.log(`event: ${t.type}`)})),this.fullscreen=new $t(this),(this.isHTML5||this.isEmbed&&!this.supported.ui)&&Gt.build.call(this),this.listeners.container(),this.listeners.global(),this.config.ads.enabled&&(this.ads=new Jt(this)),this.isHTML5&&this.config.autoplay&&this.once("canplay",(()=>nt(this.play()))),this.lastSeekTime=0,this.config.previewThumbnails.enabled&&(this.previewThumbnails=new re(this))):this.debug.error("Setup failed: no support")}get isHTML5(){return this.provider===Mt.html5}get isEmbed(){return this.isYouTube||this.isVimeo}get isYouTube(){return this.provider===Mt.youtube}get isVimeo(){return this.provider===Mt.vimeo}get isVideo(){return this.type===Ft}get isAudio(){return this.type===Nt}get playing(){return Boolean(this.ready&&!this.paused&&!this.ended)}get paused(){return Boolean(this.media.paused)}get stopped(){return Boolean(this.paused&&0===this.currentTime)}get ended(){return Boolean(this.media.ended)}set currentTime(t){if(!this.duration)return;const e=_.number(t)&&t>0;this.media.currentTime=e?Math.min(t,this.duration):0,this.debug.log(`Seeking to ${this.currentTime} seconds`)}get currentTime(){return Number(this.media.currentTime)}get buffered(){const{buffered:t}=this.media;return _.number(t)?t:t&&t.length&&this.duration>0?t.end(0)/this.duration:0}get seeking(){return Boolean(this.media.seeking)}get duration(){const t=parseFloat(this.config.duration),e=(this.media||{}).duration,r=_.number(e)&&e!==1/0?e:0;return t||r}set volume(t){let e=t;_.string(e)&&(e=Number(e)),_.number(e)||(e=this.storage.get("volume")),_.number(e)||({volume:e}=this.config),e>1&&(e=1),e<0&&(e=0),this.config.volume=e,this.media.volume=e,!_.empty(t)&&this.muted&&e>0&&(this.muted=!1)}get volume(){return Number(this.media.volume)}set muted(t){let e=t;_.boolean(e)||(e=this.storage.get("muted")),_.boolean(e)||(e=this.config.muted),this.config.muted=e,this.media.muted=e}get muted(){return Boolean(this.media.muted)}get hasAudio(){return!this.isHTML5||!!this.isAudio||Boolean(this.media.mozHasAudio)||Boolean(this.media.webkitAudioDecodedByteCount)||Boolean(this.media.audioTracks&&this.media.audioTracks.length)}set speed(t){let e=null;_.number(t)&&(e=t),_.number(e)||(e=this.storage.get("speed")),_.number(e)||(e=this.config.speed.selected);const{minimumSpeed:r,maximumSpeed:n}=this;e=Zt(e,r,n),this.config.speed.selected=e,setTimeout((()=>{this.media&&(this.media.playbackRate=e)}),0)}get speed(){return Number(this.media.playbackRate)}get minimumSpeed(){return this.isYouTube?Math.min(...this.options.speed):this.isVimeo?.5:.0625}get maximumSpeed(){return this.isYouTube?Math.max(...this.options.speed):this.isVimeo?2:16}set quality(t){const e=this.config.quality,r=this.options.quality;if(!r.length)return;let n=[!_.empty(t)&&Number(t),this.storage.get("quality"),e.selected,e.default].find(_.number),i=!0;if(!r.includes(n)){const t=st(r,n);this.debug.warn(`Unsupported quality option: ${n}, using ${t} instead`),n=t,i=!1}e.selected=n,this.media.quality=n,i&&this.storage.set({quality:n})}get quality(){return this.media.quality}set loop(t){const e=_.boolean(t)?t:this.config.loop.active;this.config.loop.active=e,this.media.loop=e}get loop(){return Boolean(this.media.loop)}set source(t){ne.change.call(this,t)}get source(){return this.media.currentSrc}get download(){const{download:t}=this.config.urls;return _.url(t)?t:this.source}set download(t){_.url(t)&&(this.config.urls.download=t,kt.setDownloadUrl.call(this))}set poster(t){this.isVideo?Gt.setPoster.call(this,t,!1).catch((()=>{})):this.debug.warn("Poster can only be set for video")}get poster(){return this.isVideo?this.media.getAttribute("poster")||this.media.getAttribute("data-poster"):null}get ratio(){if(!this.isVideo)return null;const t=ct(ut.call(this));return _.array(t)?t.join(":"):t}set ratio(t){this.isVideo?_.string(t)&&lt(t)?(this.config.ratio=ct(t),ht.call(this)):this.debug.error(`Invalid aspect ratio specified (${t})`):this.debug.warn("Aspect ratio can only be set for video")}set autoplay(t){this.config.autoplay=_.boolean(t)?t:this.config.autoplay}get autoplay(){return Boolean(this.config.autoplay)}toggleCaptions(t){Rt.toggle.call(this,t,!1)}set currentTrack(t){Rt.set.call(this,t,!1),Rt.setup.call(this)}get currentTrack(){const{toggled:t,currentTrack:e}=this.captions;return t?e:-1}set language(t){Rt.setLanguage.call(this,t,!1)}get language(){return(Rt.getCurrentTrack.call(this)||{}).language}set pip(t){if(!W.pip)return;const e=_.boolean(t)?t:!this.pip;_.function(this.media.webkitSetPresentationMode)&&this.media.webkitSetPresentationMode(e?Dt:Ct),_.function(this.media.requestPictureInPicture)&&(!this.pip&&e?this.media.requestPictureInPicture():this.pip&&!e&&document.exitPictureInPicture())}get pip(){return W.pip?_.empty(this.media.webkitPresentationMode)?this.media===document.pictureInPictureElement:this.media.webkitPresentationMode===Dt:null}setPreviewThumbnails(t){this.previewThumbnails&&this.previewThumbnails.loaded&&(this.previewThumbnails.destroy(),this.previewThumbnails=null),Object.assign(this.config.previewThumbnails,t),this.config.previewThumbnails.enabled&&(this.previewThumbnails=new re(this))}static supported(t,e){return W.check(t,e)}static loadSprite(t,e){return Tt(t,e)}static setup(t,e={}){let r=null;return _.string(t)?r=Array.from(document.querySelectorAll(t)):_.nodeList(t)?r=Array.from(t):_.array(t)&&(r=t.filter(_.element)),_.empty(r)?null:r.map((t=>new ie(t,e)))}}var se;return ie.defaults=(se=Ot,JSON.parse(JSON.stringify(se))),ie}())},4816:function(t){t.exports=function(){"use strict";function t(t,e){for(var r=0;r<e.length;r++){var n=e[r];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(t,n.key,n)}}function e(t,e,r){return e in t?Object.defineProperty(t,e,{value:r,enumerable:!0,configurable:!0,writable:!0}):t[e]=r,t}function r(t,e){var r=Object.keys(t);if(Object.getOwnPropertySymbols){var n=Object.getOwnPropertySymbols(t);e&&(n=n.filter((function(e){return Object.getOwnPropertyDescriptor(t,e).enumerable}))),r.push.apply(r,n)}return r}function n(t){for(var n=1;n<arguments.length;n++){var i=null!=arguments[n]?arguments[n]:{};n%2?r(Object(i),!0).forEach((function(r){e(t,r,i[r])})):Object.getOwnPropertyDescriptors?Object.defineProperties(t,Object.getOwnPropertyDescriptors(i)):r(Object(i)).forEach((function(e){Object.defineProperty(t,e,Object.getOwnPropertyDescriptor(i,e))}))}return t}var i={addCSS:!0,thumbWidth:15,watch:!0};function s(t,e){return function(){return Array.from(document.querySelectorAll(e)).includes(this)}.call(t,e)}var o=function(t){return null!=t?t.constructor:null},a=function(t,e){return!!(t&&e&&t instanceof e)},l=function(t){return null==t},c=function(t){return o(t)===Object},u=function(t){return o(t)===String},h=function(t){return Array.isArray(t)},d=function(t){return a(t,NodeList)},f=u,p=h,g=d,m=function(t){return a(t,Element)},y=function(t){return a(t,Event)},v=function(t){return l(t)||(u(t)||h(t)||d(t))&&!t.length||c(t)&&!Object.keys(t).length};function b(t,e){if(1>e){var r=function(t){var e="".concat(t).match(/(?:\.(\d+))?(?:[eE]([+-]?\d+))?$/);return e?Math.max(0,(e[1]?e[1].length:0)-(e[2]?+e[2]:0)):0}(e);return parseFloat(t.toFixed(r))}return Math.round(t/e)*e}return function(){function e(t,r){(function(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")})(this,e),m(t)?this.element=t:f(t)&&(this.element=document.querySelector(t)),m(this.element)&&v(this.element.rangeTouch)&&(this.config=n({},i,{},r),this.init())}return r=e,a=[{key:"setup",value:function(t){var r=1<arguments.length&&void 0!==arguments[1]?arguments[1]:{},o=null;if(v(t)||f(t)?o=Array.from(document.querySelectorAll(f(t)?t:'input[type="range"]')):m(t)?o=[t]:g(t)?o=Array.from(t):p(t)&&(o=t.filter(m)),v(o))return null;var a=n({},i,{},r);if(f(t)&&a.watch){var l=new MutationObserver((function(r){Array.from(r).forEach((function(r){Array.from(r.addedNodes).forEach((function(r){m(r)&&s(r,t)&&new e(r,a)}))}))}));l.observe(document.body,{childList:!0,subtree:!0})}return o.map((function(t){return new e(t,r)}))}},{key:"enabled",get:function(){return"ontouchstart"in document.documentElement}}],(o=[{key:"init",value:function(){e.enabled&&(this.config.addCSS&&(this.element.style.userSelect="none",this.element.style.webKitUserSelect="none",this.element.style.touchAction="manipulation"),this.listeners(!0),this.element.rangeTouch=this)}},{key:"destroy",value:function(){e.enabled&&(this.config.addCSS&&(this.element.style.userSelect="",this.element.style.webKitUserSelect="",this.element.style.touchAction=""),this.listeners(!1),this.element.rangeTouch=null)}},{key:"listeners",value:function(t){var e=this,r=t?"addEventListener":"removeEventListener";["touchstart","touchmove","touchend"].forEach((function(t){e.element[r](t,(function(t){return e.set(t)}),!1)}))}},{key:"get",value:function(t){if(!e.enabled||!y(t))return null;var r,n=t.target,i=t.changedTouches[0],s=parseFloat(n.getAttribute("min"))||0,o=parseFloat(n.getAttribute("max"))||100,a=parseFloat(n.getAttribute("step"))||1,l=n.getBoundingClientRect(),c=100/l.width*(this.config.thumbWidth/2)/100;return 0>(r=100/l.width*(i.clientX-l.left))?r=0:100<r&&(r=100),50>r?r-=(100-2*r)*c:50<r&&(r+=2*(r-50)*c),s+b(r/100*(o-s),a)}},{key:"set",value:function(t){e.enabled&&y(t)&&!t.target.disabled&&(t.preventDefault(),t.target.value=this.get(t),function(t,e){if(t&&e){var r=new Event(e,{bubbles:!0});t.dispatchEvent(r)}}(t.target,"touchend"===t.type?"change":"input"))}}])&&t(r.prototype,o),a&&t(r,a),e;var r,o,a}()}()},9130:function(t){var e;e=function(){return function(t){var e={};function r(n){if(e[n])return e[n].exports;var i=e[n]={i:n,l:!1,exports:{}};return t[n].call(i.exports,i,i.exports,r),i.l=!0,i.exports}return r.m=t,r.c=e,r.d=function(t,e,n){r.o(t,e)||Object.defineProperty(t,e,{enumerable:!0,get:n})},r.r=function(t){"undefined"!=typeof Symbol&&Symbol.toStringTag&&Object.defineProperty(t,Symbol.toStringTag,{value:"Module"}),Object.defineProperty(t,"__esModule",{value:!0})},r.t=function(t,e){if(1&e&&(t=r(t)),8&e)return t;if(4&e&&"object"==typeof t&&t&&t.__esModule)return t;var n=Object.create(null);if(r.r(n),Object.defineProperty(n,"default",{enumerable:!0,value:t}),2&e&&"string"!=typeof t)for(var i in t)r.d(n,i,function(e){return t[e]}.bind(null,i));return n},r.n=function(t){var e=t&&t.__esModule?function(){return t.default}:function(){return t};return r.d(e,"a",e),e},r.o=function(t,e){return Object.prototype.hasOwnProperty.call(t,e)},r.p="",r(r.s=0)}([function(t,e,r){"use strict";r.r(e);var n=function(t){return Array.isArray(t)?t:[t]},i=function(t){return t instanceof Node},s=function(t,e){if(t&&e){t=function(t){return t instanceof NodeList}(t)?t:[t];for(var r=0;r<t.length&&!0!==e(t[r],r,t.length);r++);}},o=function(t){if(Array.isArray(t))return t.join(", ")},a=function(t){var e=[];return s(t,(function(t){return e.push(t)})),e},l=function(t,e){var r=arguments.length>3&&void 0!==arguments[3]?arguments[3]:document;if((!(arguments.length>2&&void 0!==arguments[2])||arguments[2])&&-1!==a(r.querySelectorAll(e)).indexOf(t))return t;for(;(t=t.parentElement)&&-1===a(r.querySelectorAll(e)).indexOf(t););return t},c=function(t,e){var r=arguments.length>2&&void 0!==arguments[2]?arguments[2]:document;return-1!==a(r.querySelectorAll(e)).indexOf(t)},u=function(t){if(t)return"hidden"===getComputedStyle(t).overflow},h=function(t){if(t)return!!u(t)||t.scrollTop<=0},d=function(t){if(t){if(u(t))return!0;var e=t.scrollTop,r=t.scrollHeight;return e+t.offsetHeight>=r}},f=function(t){if(t)return!!u(t)||t.scrollLeft<=0},p=function(t){if(t){if(u(t))return!0;var e=t.scrollLeft,r=t.scrollWidth;return e+t.offsetWidth>=r}},g=function(t){return c(t,'textarea, [contenteditable="true"]')},m=function(t){return c(t,'input[type="range"]')};function y(t,e,r){return e in t?Object.defineProperty(t,e,{value:r,enumerable:!0,configurable:!0,writable:!0}):t[e]=r,t}r.d(e,"disablePageScroll",(function(){return E})),r.d(e,"enablePageScroll",(function(){return A})),r.d(e,"getScrollState",(function(){return w})),r.d(e,"clearQueueScrollLocks",(function(){return T})),r.d(e,"getTargetScrollBarWidth",(function(){return S})),r.d(e,"getCurrentTargetScrollBarWidth",(function(){return L})),r.d(e,"getPageScrollBarWidth",(function(){return _})),r.d(e,"getCurrentPageScrollBarWidth",(function(){return x})),r.d(e,"addScrollableTarget",(function(){return k})),r.d(e,"removeScrollableTarget",(function(){return P})),r.d(e,"addScrollableSelector",(function(){return I})),r.d(e,"removeScrollableSelector",(function(){return R})),r.d(e,"addLockableTarget",(function(){return O})),r.d(e,"addLockableSelector",(function(){return D})),r.d(e,"setFillGapMethod",(function(){return C})),r.d(e,"addFillGapTarget",(function(){return M})),r.d(e,"removeFillGapTarget",(function(){return N})),r.d(e,"addFillGapSelector",(function(){return F})),r.d(e,"removeFillGapSelector",(function(){return U})),r.d(e,"refillGaps",(function(){return B}));var v=["padding","margin","width","max-width","none"],b={scroll:!0,queue:0,scrollableSelectors:["[data-scroll-lock-scrollable]"],lockableSelectors:["body","[data-scroll-lock-lockable]"],fillGapSelectors:["body","[data-scroll-lock-fill-gap]","[data-scroll-lock-lockable]"],fillGapMethod:v[0],startTouchY:0,startTouchX:0},E=function(t){b.queue<=0&&(b.scroll=!1,$(),Y()),k(t),b.queue++},A=function(t){b.queue>0&&b.queue--,b.queue<=0&&(b.scroll=!0,j(),q()),P(t)},w=function(){return b.scroll},T=function(){b.queue=0},S=function(t){var e=arguments.length>1&&void 0!==arguments[1]&&arguments[1];if(i(t)){var r=t.style.overflowY;e?w()||(t.style.overflowY=t.getAttribute("data-scroll-lock-saved-overflow-y-property")):t.style.overflowY="scroll";var n=L(t);return t.style.overflowY=r,n}return 0},L=function(t){if(i(t)){if(t===document.body){var e=document.documentElement.clientWidth;return window.innerWidth-e}var r=t.style.borderLeftWidth,n=t.style.borderRightWidth;t.style.borderLeftWidth="0px",t.style.borderRightWidth="0px";var s=t.offsetWidth-t.clientWidth;return t.style.borderLeftWidth=r,t.style.borderRightWidth=n,s}return 0},_=function(){var t=arguments.length>0&&void 0!==arguments[0]&&arguments[0];return S(document.body,t)},x=function(){return L(document.body)},k=function(t){t&&n(t).map((function(t){s(t,(function(t){i(t)?t.setAttribute("data-scroll-lock-scrollable",""):'"'.concat(t,'" is not a Element.')}))}))},P=function(t){t&&n(t).map((function(t){s(t,(function(t){i(t)?t.removeAttribute("data-scroll-lock-scrollable"):'"'.concat(t,'" is not a Element.')}))}))},I=function(t){t&&n(t).map((function(t){b.scrollableSelectors.push(t)}))},R=function(t){t&&n(t).map((function(t){b.scrollableSelectors=b.scrollableSelectors.filter((function(e){return e!==t}))}))},O=function(t){t&&(n(t).map((function(t){s(t,(function(t){i(t)?t.setAttribute("data-scroll-lock-lockable",""):'"'.concat(t,'" is not a Element.')}))})),w()||$())},D=function(t){t&&(n(t).map((function(t){b.lockableSelectors.push(t)})),w()||$(),F(t))},C=function(t){if(t)if(-1!==v.indexOf(t))b.fillGapMethod=t,B();else{var e=v.join(", ");'"'.concat(t,'" method is not available!\nAvailable fill gap methods: ').concat(e,".")}},M=function(t){t&&n(t).map((function(t){s(t,(function(t){i(t)?(t.setAttribute("data-scroll-lock-fill-gap",""),b.scroll||z(t)):'"'.concat(t,'" is not a Element.')}))}))},N=function(t){t&&n(t).map((function(t){s(t,(function(t){i(t)?(t.removeAttribute("data-scroll-lock-fill-gap"),b.scroll||Q(t)):'"'.concat(t,'" is not a Element.')}))}))},F=function(t){t&&n(t).map((function(t){-1===b.fillGapSelectors.indexOf(t)&&(b.fillGapSelectors.push(t),b.scroll||W(t))}))},U=function(t){t&&n(t).map((function(t){b.fillGapSelectors=b.fillGapSelectors.filter((function(e){return e!==t})),b.scroll||X(t)}))},B=function(){b.scroll||Y()},$=function(){var t=o(b.lockableSelectors);G(t)},j=function(){var t=o(b.lockableSelectors);H(t)},G=function(t){var e=document.querySelectorAll(t);s(e,(function(t){V(t)}))},H=function(t){var e=document.querySelectorAll(t);s(e,(function(t){K(t)}))},V=function(t){if(i(t)&&"true"!==t.getAttribute("data-scroll-lock-locked")){var e=window.getComputedStyle(t);t.setAttribute("data-scroll-lock-saved-overflow-y-property",e.overflowY),t.setAttribute("data-scroll-lock-saved-inline-overflow-property",t.style.overflow),t.setAttribute("data-scroll-lock-saved-inline-overflow-y-property",t.style.overflowY),t.style.overflow="hidden",t.setAttribute("data-scroll-lock-locked","true")}},K=function(t){i(t)&&"true"===t.getAttribute("data-scroll-lock-locked")&&(t.style.overflow=t.getAttribute("data-scroll-lock-saved-inline-overflow-property"),t.style.overflowY=t.getAttribute("data-scroll-lock-saved-inline-overflow-y-property"),t.removeAttribute("data-scroll-lock-saved-overflow-property"),t.removeAttribute("data-scroll-lock-saved-inline-overflow-property"),t.removeAttribute("data-scroll-lock-saved-inline-overflow-y-property"),t.removeAttribute("data-scroll-lock-locked"))},Y=function(){b.fillGapSelectors.map((function(t){W(t)}))},q=function(){b.fillGapSelectors.map((function(t){X(t)}))},W=function(t){var e=document.querySelectorAll(t),r=-1!==b.lockableSelectors.indexOf(t);s(e,(function(t){z(t,r)}))},z=function(t){var e=arguments.length>1&&void 0!==arguments[1]&&arguments[1];if(i(t)){var r;if(""===t.getAttribute("data-scroll-lock-lockable")||e)r=S(t,!0);else{var n=l(t,o(b.lockableSelectors));r=S(n,!0)}"true"===t.getAttribute("data-scroll-lock-filled-gap")&&Q(t);var s=window.getComputedStyle(t);if(t.setAttribute("data-scroll-lock-filled-gap","true"),t.setAttribute("data-scroll-lock-current-fill-gap-method",b.fillGapMethod),"margin"===b.fillGapMethod){var a=parseFloat(s.marginRight);t.style.marginRight="".concat(a+r,"px")}else if("width"===b.fillGapMethod)t.style.width="calc(100% - ".concat(r,"px)");else if("max-width"===b.fillGapMethod)t.style.maxWidth="calc(100% - ".concat(r,"px)");else if("padding"===b.fillGapMethod){var c=parseFloat(s.paddingRight);t.style.paddingRight="".concat(c+r,"px")}}},X=function(t){var e=document.querySelectorAll(t);s(e,(function(t){Q(t)}))},Q=function(t){if(i(t)&&"true"===t.getAttribute("data-scroll-lock-filled-gap")){var e=t.getAttribute("data-scroll-lock-current-fill-gap-method");t.removeAttribute("data-scroll-lock-filled-gap"),t.removeAttribute("data-scroll-lock-current-fill-gap-method"),"margin"===e?t.style.marginRight="":"width"===e?t.style.width="":"max-width"===e?t.style.maxWidth="":"padding"===e&&(t.style.paddingRight="")}};"undefined"!=typeof window&&window.addEventListener("resize",(function(t){B()})),"undefined"!=typeof document&&(document.addEventListener("touchstart",(function(t){b.scroll||(b.startTouchY=t.touches[0].clientY,b.startTouchX=t.touches[0].clientX)})),document.addEventListener("touchmove",(function(t){if(!b.scroll){var e=b.startTouchY,r=b.startTouchX,n=t.touches[0].clientY,i=t.touches[0].clientX;if(t.touches.length<2){var s=o(b.scrollableSelectors),a={up:e<n,down:e>n,left:r<i,right:r>i},u={up:e+3<n,down:e-3>n,left:r+3<i,right:r-3>i};!function e(r){var n=arguments.length>1&&void 0!==arguments[1]&&arguments[1];if(r){var i=l(r,s,!1);if(m(r))return!1;if(n||g(r)&&l(r,s)||c(r,s)){var o=!1;f(r)&&p(r)?(a.up&&h(r)||a.down&&d(r))&&(o=!0):h(r)&&d(r)?(a.left&&f(r)||a.right&&p(r))&&(o=!0):(u.up&&h(r)||u.down&&d(r)||u.left&&f(r)||u.right&&p(r))&&(o=!0),o&&(i?e(i,!0):t.cancelable&&t.preventDefault())}else e(i)}else t.cancelable&&t.preventDefault()}(t.target)}}}),{passive:!1}),document.addEventListener("touchend",(function(t){b.scroll||(b.startTouchY=0,b.startTouchX=0)})));var J={hide:function(t){E(t)},show:function(t){A(t)},toggle:function(t){w()?E():A(t)},getState:function(){return w()},getWidth:function(){return _()},getCurrentWidth:function(){return x()},setScrollableTargets:function(t){k(t)},setFillGapSelectors:function(t){F(t)},setFillGapTargets:function(t){M(t)},clearQueue:function(){T()}},Z=function(t){for(var e=1;e<arguments.length;e++){var r=null!=arguments[e]?arguments[e]:{},n=Object.keys(r);"function"==typeof Object.getOwnPropertySymbols&&(n=n.concat(Object.getOwnPropertySymbols(r).filter((function(t){return Object.getOwnPropertyDescriptor(r,t).enumerable})))),n.forEach((function(e){y(t,e,r[e])}))}return t}({disablePageScroll:E,enablePageScroll:A,getScrollState:w,clearQueueScrollLocks:T,getTargetScrollBarWidth:S,getCurrentTargetScrollBarWidth:L,getPageScrollBarWidth:_,getCurrentPageScrollBarWidth:x,addScrollableSelector:I,removeScrollableSelector:R,addScrollableTarget:k,removeScrollableTarget:P,addLockableSelector:D,addLockableTarget:O,addFillGapSelector:F,removeFillGapSelector:U,addFillGapTarget:M,removeFillGapTarget:N,setFillGapMethod:C,refillGaps:B,_state:b},J);e.default=Z}]).default},t.exports=e()},4062:(t,e,r)=>{"use strict";function n(t){if(null==t)return window;if("[object Window]"!==t.toString()){var e=t.ownerDocument;return e&&e.defaultView||window}return t}function i(t){return t instanceof n(t).Element||t instanceof Element}function s(t){return t instanceof n(t).HTMLElement||t instanceof HTMLElement}function o(t){return"undefined"!=typeof ShadowRoot&&(t instanceof n(t).ShadowRoot||t instanceof ShadowRoot)}r.d(e,{Ay:()=>fe});var a=Math.max,l=Math.min,c=Math.round;function u(){var t=navigator.userAgentData;return null!=t&&t.brands?t.brands.map((function(t){return t.brand+"/"+t.version})).join(" "):navigator.userAgent}function h(){return!/^((?!chrome|android).)*safari/i.test(u())}function d(t,e,r){void 0===e&&(e=!1),void 0===r&&(r=!1);var o=t.getBoundingClientRect(),a=1,l=1;e&&s(t)&&(a=t.offsetWidth>0&&c(o.width)/t.offsetWidth||1,l=t.offsetHeight>0&&c(o.height)/t.offsetHeight||1);var u=(i(t)?n(t):window).visualViewport,d=!h()&&r,f=(o.left+(d&&u?u.offsetLeft:0))/a,p=(o.top+(d&&u?u.offsetTop:0))/l,g=o.width/a,m=o.height/l;return{width:g,height:m,top:p,right:f+g,bottom:p+m,left:f,x:f,y:p}}function f(t){var e=n(t);return{scrollLeft:e.pageXOffset,scrollTop:e.pageYOffset}}function p(t){return t?(t.nodeName||"").toLowerCase():null}function g(t){return((i(t)?t.ownerDocument:t.document)||window.document).documentElement}function m(t){return d(g(t)).left+f(t).scrollLeft}function y(t){return n(t).getComputedStyle(t)}function v(t){var e=y(t),r=e.overflow,n=e.overflowX,i=e.overflowY;return/auto|scroll|overlay|hidden/.test(r+i+n)}function b(t,e,r){void 0===r&&(r=!1);var i,o,a=s(e),l=s(e)&&function(t){var e=t.getBoundingClientRect(),r=c(e.width)/t.offsetWidth||1,n=c(e.height)/t.offsetHeight||1;return 1!==r||1!==n}(e),u=g(e),h=d(t,l,r),y={scrollLeft:0,scrollTop:0},b={x:0,y:0};return(a||!a&&!r)&&(("body"!==p(e)||v(u))&&(y=(i=e)!==n(i)&&s(i)?{scrollLeft:(o=i).scrollLeft,scrollTop:o.scrollTop}:f(i)),s(e)?((b=d(e,!0)).x+=e.clientLeft,b.y+=e.clientTop):u&&(b.x=m(u))),{x:h.left+y.scrollLeft-b.x,y:h.top+y.scrollTop-b.y,width:h.width,height:h.height}}function E(t){var e=d(t),r=t.offsetWidth,n=t.offsetHeight;return Math.abs(e.width-r)<=1&&(r=e.width),Math.abs(e.height-n)<=1&&(n=e.height),{x:t.offsetLeft,y:t.offsetTop,width:r,height:n}}function A(t){return"html"===p(t)?t:t.assignedSlot||t.parentNode||(o(t)?t.host:null)||g(t)}function w(t){return["html","body","#document"].indexOf(p(t))>=0?t.ownerDocument.body:s(t)&&v(t)?t:w(A(t))}function T(t,e){var r;void 0===e&&(e=[]);var i=w(t),s=i===(null==(r=t.ownerDocument)?void 0:r.body),o=n(i),a=s?[o].concat(o.visualViewport||[],v(i)?i:[]):i,l=e.concat(a);return s?l:l.concat(T(A(a)))}function S(t){return["table","td","th"].indexOf(p(t))>=0}function L(t){return s(t)&&"fixed"!==y(t).position?t.offsetParent:null}function _(t){for(var e=n(t),r=L(t);r&&S(r)&&"static"===y(r).position;)r=L(r);return r&&("html"===p(r)||"body"===p(r)&&"static"===y(r).position)?e:r||function(t){var e=/firefox/i.test(u());if(/Trident/i.test(u())&&s(t)&&"fixed"===y(t).position)return null;var r=A(t);for(o(r)&&(r=r.host);s(r)&&["html","body"].indexOf(p(r))<0;){var n=y(r);if("none"!==n.transform||"none"!==n.perspective||"paint"===n.contain||-1!==["transform","perspective"].indexOf(n.willChange)||e&&"filter"===n.willChange||e&&n.filter&&"none"!==n.filter)return r;r=r.parentNode}return null}(t)||e}var x="top",k="bottom",P="right",I="left",R="auto",O=[x,k,P,I],D="start",C="end",M="clippingParents",N="viewport",F="popper",U="reference",B=O.reduce((function(t,e){return t.concat([e+"-"+D,e+"-"+C])}),[]),$=[].concat(O,[R]).reduce((function(t,e){return t.concat([e,e+"-"+D,e+"-"+C])}),[]),j=["beforeRead","read","afterRead","beforeMain","main","afterMain","beforeWrite","write","afterWrite"];function G(t){var e=new Map,r=new Set,n=[];function i(t){r.add(t.name),[].concat(t.requires||[],t.requiresIfExists||[]).forEach((function(t){if(!r.has(t)){var n=e.get(t);n&&i(n)}})),n.push(t)}return t.forEach((function(t){e.set(t.name,t)})),t.forEach((function(t){r.has(t.name)||i(t)})),n}var H={placement:"bottom",modifiers:[],strategy:"absolute"};function V(){for(var t=arguments.length,e=new Array(t),r=0;r<t;r++)e[r]=arguments[r];return!e.some((function(t){return!(t&&"function"==typeof t.getBoundingClientRect)}))}function K(t){void 0===t&&(t={});var e=t,r=e.defaultModifiers,n=void 0===r?[]:r,s=e.defaultOptions,o=void 0===s?H:s;return function(t,e,r){void 0===r&&(r=o);var s,a,l={placement:"bottom",orderedModifiers:[],options:Object.assign({},H,o),modifiersData:{},elements:{reference:t,popper:e},attributes:{},styles:{}},c=[],u=!1,h={state:l,setOptions:function(r){var s="function"==typeof r?r(l.options):r;d(),l.options=Object.assign({},o,l.options,s),l.scrollParents={reference:i(t)?T(t):t.contextElement?T(t.contextElement):[],popper:T(e)};var a=function(t){var e=G(t);return j.reduce((function(t,r){return t.concat(e.filter((function(t){return t.phase===r})))}),[])}(function(t){var e=t.reduce((function(t,e){var r=t[e.name];return t[e.name]=r?Object.assign({},r,e,{options:Object.assign({},r.options,e.options),data:Object.assign({},r.data,e.data)}):e,t}),{});return Object.keys(e).map((function(t){return e[t]}))}([].concat(n,l.options.modifiers)));return l.orderedModifiers=a.filter((function(t){return t.enabled})),l.orderedModifiers.forEach((function(t){var e=t.name,r=t.options,n=void 0===r?{}:r,i=t.effect;if("function"==typeof i){var s=i({state:l,name:e,instance:h,options:n}),o=function(){};c.push(s||o)}})),h.update()},forceUpdate:function(){if(!u){var t=l.elements,e=t.reference,r=t.popper;if(V(e,r)){l.rects={reference:b(e,_(r),"fixed"===l.options.strategy),popper:E(r)},l.reset=!1,l.placement=l.options.placement,l.orderedModifiers.forEach((function(t){return l.modifiersData[t.name]=Object.assign({},t.data)}));for(var n=0;n<l.orderedModifiers.length;n++)if(!0!==l.reset){var i=l.orderedModifiers[n],s=i.fn,o=i.options,a=void 0===o?{}:o,c=i.name;"function"==typeof s&&(l=s({state:l,options:a,name:c,instance:h})||l)}else l.reset=!1,n=-1}}},update:(s=function(){return new Promise((function(t){h.forceUpdate(),t(l)}))},function(){return a||(a=new Promise((function(t){Promise.resolve().then((function(){a=void 0,t(s())}))}))),a}),destroy:function(){d(),u=!0}};if(!V(t,e))return h;function d(){c.forEach((function(t){return t()})),c=[]}return h.setOptions(r).then((function(t){!u&&r.onFirstUpdate&&r.onFirstUpdate(t)})),h}}var Y={passive:!0};function q(t){return t.split("-")[0]}function W(t){return t.split("-")[1]}function z(t){return["top","bottom"].indexOf(t)>=0?"x":"y"}function X(t){var e,r=t.reference,n=t.element,i=t.placement,s=i?q(i):null,o=i?W(i):null,a=r.x+r.width/2-n.width/2,l=r.y+r.height/2-n.height/2;switch(s){case x:e={x:a,y:r.y-n.height};break;case k:e={x:a,y:r.y+r.height};break;case P:e={x:r.x+r.width,y:l};break;case I:e={x:r.x-n.width,y:l};break;default:e={x:r.x,y:r.y}}var c=s?z(s):null;if(null!=c){var u="y"===c?"height":"width";switch(o){case D:e[c]=e[c]-(r[u]/2-n[u]/2);break;case C:e[c]=e[c]+(r[u]/2-n[u]/2)}}return e}var Q={top:"auto",right:"auto",bottom:"auto",left:"auto"};function J(t){var e,r=t.popper,i=t.popperRect,s=t.placement,o=t.variation,a=t.offsets,l=t.position,u=t.gpuAcceleration,h=t.adaptive,d=t.roundOffsets,f=t.isFixed,p=a.x,m=void 0===p?0:p,v=a.y,b=void 0===v?0:v,E="function"==typeof d?d({x:m,y:b}):{x:m,y:b};m=E.x,b=E.y;var A=a.hasOwnProperty("x"),w=a.hasOwnProperty("y"),T=I,S=x,L=window;if(h){var R=_(r),O="clientHeight",D="clientWidth";if(R===n(r)&&"static"!==y(R=g(r)).position&&"absolute"===l&&(O="scrollHeight",D="scrollWidth"),s===x||(s===I||s===P)&&o===C)S=k,b-=(f&&R===L&&L.visualViewport?L.visualViewport.height:R[O])-i.height,b*=u?1:-1;if(s===I||(s===x||s===k)&&o===C)T=P,m-=(f&&R===L&&L.visualViewport?L.visualViewport.width:R[D])-i.width,m*=u?1:-1}var M,N=Object.assign({position:l},h&&Q),F=!0===d?function(t){var e=t.x,r=t.y,n=window.devicePixelRatio||1;return{x:c(e*n)/n||0,y:c(r*n)/n||0}}({x:m,y:b}):{x:m,y:b};return m=F.x,b=F.y,u?Object.assign({},N,((M={})[S]=w?"0":"",M[T]=A?"0":"",M.transform=(L.devicePixelRatio||1)<=1?"translate("+m+"px, "+b+"px)":"translate3d("+m+"px, "+b+"px, 0)",M)):Object.assign({},N,((e={})[S]=w?b+"px":"",e[T]=A?m+"px":"",e.transform="",e))}const Z={name:"applyStyles",enabled:!0,phase:"write",fn:function(t){var e=t.state;Object.keys(e.elements).forEach((function(t){var r=e.styles[t]||{},n=e.attributes[t]||{},i=e.elements[t];s(i)&&p(i)&&(Object.assign(i.style,r),Object.keys(n).forEach((function(t){var e=n[t];!1===e?i.removeAttribute(t):i.setAttribute(t,!0===e?"":e)})))}))},effect:function(t){var e=t.state,r={popper:{position:e.options.strategy,left:"0",top:"0",margin:"0"},arrow:{position:"absolute"},reference:{}};return Object.assign(e.elements.popper.style,r.popper),e.styles=r,e.elements.arrow&&Object.assign(e.elements.arrow.style,r.arrow),function(){Object.keys(e.elements).forEach((function(t){var n=e.elements[t],i=e.attributes[t]||{},o=Object.keys(e.styles.hasOwnProperty(t)?e.styles[t]:r[t]).reduce((function(t,e){return t[e]="",t}),{});s(n)&&p(n)&&(Object.assign(n.style,o),Object.keys(i).forEach((function(t){n.removeAttribute(t)})))}))}},requires:["computeStyles"]};const tt={name:"offset",enabled:!0,phase:"main",requires:["popperOffsets"],fn:function(t){var e=t.state,r=t.options,n=t.name,i=r.offset,s=void 0===i?[0,0]:i,o=$.reduce((function(t,r){return t[r]=function(t,e,r){var n=q(t),i=[I,x].indexOf(n)>=0?-1:1,s="function"==typeof r?r(Object.assign({},e,{placement:t})):r,o=s[0],a=s[1];return o=o||0,a=(a||0)*i,[I,P].indexOf(n)>=0?{x:a,y:o}:{x:o,y:a}}(r,e.rects,s),t}),{}),a=o[e.placement],l=a.x,c=a.y;null!=e.modifiersData.popperOffsets&&(e.modifiersData.popperOffsets.x+=l,e.modifiersData.popperOffsets.y+=c),e.modifiersData[n]=o}};var et={left:"right",right:"left",bottom:"top",top:"bottom"};function rt(t){return t.replace(/left|right|bottom|top/g,(function(t){return et[t]}))}var nt={start:"end",end:"start"};function it(t){return t.replace(/start|end/g,(function(t){return nt[t]}))}function st(t,e){var r=e.getRootNode&&e.getRootNode();if(t.contains(e))return!0;if(r&&o(r)){var n=e;do{if(n&&t.isSameNode(n))return!0;n=n.parentNode||n.host}while(n)}return!1}function ot(t){return Object.assign({},t,{left:t.x,top:t.y,right:t.x+t.width,bottom:t.y+t.height})}function at(t,e,r){return e===N?ot(function(t,e){var r=n(t),i=g(t),s=r.visualViewport,o=i.clientWidth,a=i.clientHeight,l=0,c=0;if(s){o=s.width,a=s.height;var u=h();(u||!u&&"fixed"===e)&&(l=s.offsetLeft,c=s.offsetTop)}return{width:o,height:a,x:l+m(t),y:c}}(t,r)):i(e)?function(t,e){var r=d(t,!1,"fixed"===e);return r.top=r.top+t.clientTop,r.left=r.left+t.clientLeft,r.bottom=r.top+t.clientHeight,r.right=r.left+t.clientWidth,r.width=t.clientWidth,r.height=t.clientHeight,r.x=r.left,r.y=r.top,r}(e,r):ot(function(t){var e,r=g(t),n=f(t),i=null==(e=t.ownerDocument)?void 0:e.body,s=a(r.scrollWidth,r.clientWidth,i?i.scrollWidth:0,i?i.clientWidth:0),o=a(r.scrollHeight,r.clientHeight,i?i.scrollHeight:0,i?i.clientHeight:0),l=-n.scrollLeft+m(t),c=-n.scrollTop;return"rtl"===y(i||r).direction&&(l+=a(r.clientWidth,i?i.clientWidth:0)-s),{width:s,height:o,x:l,y:c}}(g(t)))}function lt(t,e,r,n){var o="clippingParents"===e?function(t){var e=T(A(t)),r=["absolute","fixed"].indexOf(y(t).position)>=0&&s(t)?_(t):t;return i(r)?e.filter((function(t){return i(t)&&st(t,r)&&"body"!==p(t)})):[]}(t):[].concat(e),c=[].concat(o,[r]),u=c[0],h=c.reduce((function(e,r){var i=at(t,r,n);return e.top=a(i.top,e.top),e.right=l(i.right,e.right),e.bottom=l(i.bottom,e.bottom),e.left=a(i.left,e.left),e}),at(t,u,n));return h.width=h.right-h.left,h.height=h.bottom-h.top,h.x=h.left,h.y=h.top,h}function ct(t){return Object.assign({},{top:0,right:0,bottom:0,left:0},t)}function ut(t,e){return e.reduce((function(e,r){return e[r]=t,e}),{})}function ht(t,e){void 0===e&&(e={});var r=e,n=r.placement,s=void 0===n?t.placement:n,o=r.strategy,a=void 0===o?t.strategy:o,l=r.boundary,c=void 0===l?M:l,u=r.rootBoundary,h=void 0===u?N:u,f=r.elementContext,p=void 0===f?F:f,m=r.altBoundary,y=void 0!==m&&m,v=r.padding,b=void 0===v?0:v,E=ct("number"!=typeof b?b:ut(b,O)),A=p===F?U:F,w=t.rects.popper,T=t.elements[y?A:p],S=lt(i(T)?T:T.contextElement||g(t.elements.popper),c,h,a),L=d(t.elements.reference),_=X({reference:L,element:w,strategy:"absolute",placement:s}),I=ot(Object.assign({},w,_)),R=p===F?I:L,D={top:S.top-R.top+E.top,bottom:R.bottom-S.bottom+E.bottom,left:S.left-R.left+E.left,right:R.right-S.right+E.right},C=t.modifiersData.offset;if(p===F&&C){var B=C[s];Object.keys(D).forEach((function(t){var e=[P,k].indexOf(t)>=0?1:-1,r=[x,k].indexOf(t)>=0?"y":"x";D[t]+=B[r]*e}))}return D}function dt(t,e,r){return a(t,l(e,r))}const ft={name:"preventOverflow",enabled:!0,phase:"main",fn:function(t){var e=t.state,r=t.options,n=t.name,i=r.mainAxis,s=void 0===i||i,o=r.altAxis,c=void 0!==o&&o,u=r.boundary,h=r.rootBoundary,d=r.altBoundary,f=r.padding,p=r.tether,g=void 0===p||p,m=r.tetherOffset,y=void 0===m?0:m,v=ht(e,{boundary:u,rootBoundary:h,padding:f,altBoundary:d}),b=q(e.placement),A=W(e.placement),w=!A,T=z(b),S="x"===T?"y":"x",L=e.modifiersData.popperOffsets,R=e.rects.reference,O=e.rects.popper,C="function"==typeof y?y(Object.assign({},e.rects,{placement:e.placement})):y,M="number"==typeof C?{mainAxis:C,altAxis:C}:Object.assign({mainAxis:0,altAxis:0},C),N=e.modifiersData.offset?e.modifiersData.offset[e.placement]:null,F={x:0,y:0};if(L){if(s){var U,B="y"===T?x:I,$="y"===T?k:P,j="y"===T?"height":"width",G=L[T],H=G+v[B],V=G-v[$],K=g?-O[j]/2:0,Y=A===D?R[j]:O[j],X=A===D?-O[j]:-R[j],Q=e.elements.arrow,J=g&&Q?E(Q):{width:0,height:0},Z=e.modifiersData["arrow#persistent"]?e.modifiersData["arrow#persistent"].padding:{top:0,right:0,bottom:0,left:0},tt=Z[B],et=Z[$],rt=dt(0,R[j],J[j]),nt=w?R[j]/2-K-rt-tt-M.mainAxis:Y-rt-tt-M.mainAxis,it=w?-R[j]/2+K+rt+et+M.mainAxis:X+rt+et+M.mainAxis,st=e.elements.arrow&&_(e.elements.arrow),ot=st?"y"===T?st.clientTop||0:st.clientLeft||0:0,at=null!=(U=null==N?void 0:N[T])?U:0,lt=G+it-at,ct=dt(g?l(H,G+nt-at-ot):H,G,g?a(V,lt):V);L[T]=ct,F[T]=ct-G}if(c){var ut,ft="x"===T?x:I,pt="x"===T?k:P,gt=L[S],mt="y"===S?"height":"width",yt=gt+v[ft],vt=gt-v[pt],bt=-1!==[x,I].indexOf(b),Et=null!=(ut=null==N?void 0:N[S])?ut:0,At=bt?yt:gt-R[mt]-O[mt]-Et+M.altAxis,wt=bt?gt+R[mt]+O[mt]-Et-M.altAxis:vt,Tt=g&&bt?function(t,e,r){var n=dt(t,e,r);return n>r?r:n}(At,gt,wt):dt(g?At:yt,gt,g?wt:vt);L[S]=Tt,F[S]=Tt-gt}e.modifiersData[n]=F}},requiresIfExists:["offset"]};var pt=function(t,e){return ct("number"!=typeof(t="function"==typeof t?t(Object.assign({},e.rects,{placement:e.placement})):t)?t:ut(t,O))};const gt={name:"arrow",enabled:!0,phase:"main",fn:function(t){var e,r=t.state,n=t.name,i=t.options,s=r.elements.arrow,o=r.modifiersData.popperOffsets,a=q(r.placement),l=z(a),c=[I,P].indexOf(a)>=0?"height":"width";if(s&&o){var u=pt(i.padding,r),h=E(s),d="y"===l?x:I,f="y"===l?k:P,p=r.rects.reference[c]+r.rects.reference[l]-o[l]-r.rects.popper[c],g=o[l]-r.rects.reference[l],m=_(s),y=m?"y"===l?m.clientHeight||0:m.clientWidth||0:0,v=p/2-g/2,b=u[d],A=y-h[c]-u[f],w=y/2-h[c]/2+v,T=dt(b,w,A),S=l;r.modifiersData[n]=((e={})[S]=T,e.centerOffset=T-w,e)}},effect:function(t){var e=t.state,r=t.options.element,n=void 0===r?"[data-popper-arrow]":r;null!=n&&("string"!=typeof n||(n=e.elements.popper.querySelector(n)))&&st(e.elements.popper,n)&&(e.elements.arrow=n)},requires:["popperOffsets"],requiresIfExists:["preventOverflow"]};function mt(t,e,r){return void 0===r&&(r={x:0,y:0}),{top:t.top-e.height-r.y,right:t.right-e.width+r.x,bottom:t.bottom-e.height+r.y,left:t.left-e.width-r.x}}function yt(t){return[x,P,k,I].some((function(e){return t[e]>=0}))}var vt=K({defaultModifiers:[{name:"eventListeners",enabled:!0,phase:"write",fn:function(){},effect:function(t){var e=t.state,r=t.instance,i=t.options,s=i.scroll,o=void 0===s||s,a=i.resize,l=void 0===a||a,c=n(e.elements.popper),u=[].concat(e.scrollParents.reference,e.scrollParents.popper);return o&&u.forEach((function(t){t.addEventListener("scroll",r.update,Y)})),l&&c.addEventListener("resize",r.update,Y),function(){o&&u.forEach((function(t){t.removeEventListener("scroll",r.update,Y)})),l&&c.removeEventListener("resize",r.update,Y)}},data:{}},{name:"popperOffsets",enabled:!0,phase:"read",fn:function(t){var e=t.state,r=t.name;e.modifiersData[r]=X({reference:e.rects.reference,element:e.rects.popper,strategy:"absolute",placement:e.placement})},data:{}},{name:"computeStyles",enabled:!0,phase:"beforeWrite",fn:function(t){var e=t.state,r=t.options,n=r.gpuAcceleration,i=void 0===n||n,s=r.adaptive,o=void 0===s||s,a=r.roundOffsets,l=void 0===a||a,c={placement:q(e.placement),variation:W(e.placement),popper:e.elements.popper,popperRect:e.rects.popper,gpuAcceleration:i,isFixed:"fixed"===e.options.strategy};null!=e.modifiersData.popperOffsets&&(e.styles.popper=Object.assign({},e.styles.popper,J(Object.assign({},c,{offsets:e.modifiersData.popperOffsets,position:e.options.strategy,adaptive:o,roundOffsets:l})))),null!=e.modifiersData.arrow&&(e.styles.arrow=Object.assign({},e.styles.arrow,J(Object.assign({},c,{offsets:e.modifiersData.arrow,position:"absolute",adaptive:!1,roundOffsets:l})))),e.attributes.popper=Object.assign({},e.attributes.popper,{"data-popper-placement":e.placement})},data:{}},Z,tt,{name:"flip",enabled:!0,phase:"main",fn:function(t){var e=t.state,r=t.options,n=t.name;if(!e.modifiersData[n]._skip){for(var i=r.mainAxis,s=void 0===i||i,o=r.altAxis,a=void 0===o||o,l=r.fallbackPlacements,c=r.padding,u=r.boundary,h=r.rootBoundary,d=r.altBoundary,f=r.flipVariations,p=void 0===f||f,g=r.allowedAutoPlacements,m=e.options.placement,y=q(m),v=l||(y===m||!p?[rt(m)]:function(t){if(q(t)===R)return[];var e=rt(t);return[it(t),e,it(e)]}(m)),b=[m].concat(v).reduce((function(t,r){return t.concat(q(r)===R?function(t,e){void 0===e&&(e={});var r=e,n=r.placement,i=r.boundary,s=r.rootBoundary,o=r.padding,a=r.flipVariations,l=r.allowedAutoPlacements,c=void 0===l?$:l,u=W(n),h=u?a?B:B.filter((function(t){return W(t)===u})):O,d=h.filter((function(t){return c.indexOf(t)>=0}));0===d.length&&(d=h);var f=d.reduce((function(e,r){return e[r]=ht(t,{placement:r,boundary:i,rootBoundary:s,padding:o})[q(r)],e}),{});return Object.keys(f).sort((function(t,e){return f[t]-f[e]}))}(e,{placement:r,boundary:u,rootBoundary:h,padding:c,flipVariations:p,allowedAutoPlacements:g}):r)}),[]),E=e.rects.reference,A=e.rects.popper,w=new Map,T=!0,S=b[0],L=0;L<b.length;L++){var _=b[L],C=q(_),M=W(_)===D,N=[x,k].indexOf(C)>=0,F=N?"width":"height",U=ht(e,{placement:_,boundary:u,rootBoundary:h,altBoundary:d,padding:c}),j=N?M?P:I:M?k:x;E[F]>A[F]&&(j=rt(j));var G=rt(j),H=[];if(s&&H.push(U[C]<=0),a&&H.push(U[j]<=0,U[G]<=0),H.every((function(t){return t}))){S=_,T=!1;break}w.set(_,H)}if(T)for(var V=function(t){var e=b.find((function(e){var r=w.get(e);if(r)return r.slice(0,t).every((function(t){return t}))}));if(e)return S=e,"break"},K=p?3:1;K>0;K--){if("break"===V(K))break}e.placement!==S&&(e.modifiersData[n]._skip=!0,e.placement=S,e.reset=!0)}},requiresIfExists:["offset"],data:{_skip:!1}},ft,gt,{name:"hide",enabled:!0,phase:"main",requiresIfExists:["preventOverflow"],fn:function(t){var e=t.state,r=t.name,n=e.rects.reference,i=e.rects.popper,s=e.modifiersData.preventOverflow,o=ht(e,{elementContext:"reference"}),a=ht(e,{altBoundary:!0}),l=mt(o,n),c=mt(a,i,s),u=yt(l),h=yt(c);e.modifiersData[r]={referenceClippingOffsets:l,popperEscapeOffsets:c,isReferenceHidden:u,hasPopperEscaped:h},e.attributes.popper=Object.assign({},e.attributes.popper,{"data-popper-reference-hidden":u,"data-popper-escaped":h})}}]}),bt="tippy-box",Et="tippy-content",At="tippy-backdrop",wt="tippy-arrow",Tt="tippy-svg-arrow",St={passive:!0,capture:!0},Lt=function(){return document.body};function _t(t,e,r){if(Array.isArray(t)){var n=t[e];return null==n?Array.isArray(r)?r[e]:r:n}return t}function xt(t,e){var r={}.toString.call(t);return 0===r.indexOf("[object")&&r.indexOf(e+"]")>-1}function kt(t,e){return"function"==typeof t?t.apply(void 0,e):t}function Pt(t,e){return 0===e?t:function(n){clearTimeout(r),r=setTimeout((function(){t(n)}),e)};var r}function It(t){return[].concat(t)}function Rt(t,e){-1===t.indexOf(e)&&t.push(e)}function Ot(t){return t.split("-")[0]}function Dt(t){return[].slice.call(t)}function Ct(t){return Object.keys(t).reduce((function(e,r){return void 0!==t[r]&&(e[r]=t[r]),e}),{})}function Mt(){return document.createElement("div")}function Nt(t){return["Element","Fragment"].some((function(e){return xt(t,e)}))}function Ft(t){return xt(t,"MouseEvent")}function Ut(t){return!(!t||!t._tippy||t._tippy.reference!==t)}function Bt(t){return Nt(t)?[t]:function(t){return xt(t,"NodeList")}(t)?Dt(t):Array.isArray(t)?t:Dt(document.querySelectorAll(t))}function $t(t,e){t.forEach((function(t){t&&(t.style.transitionDuration=e+"ms")}))}function jt(t,e){t.forEach((function(t){t&&t.setAttribute("data-state",e)}))}function Gt(t){var e,r=It(t)[0];return null!=r&&null!=(e=r.ownerDocument)&&e.body?r.ownerDocument:document}function Ht(t,e,r){var n=e+"EventListener";["transitionend","webkitTransitionEnd"].forEach((function(e){t[n](e,r)}))}function Vt(t,e){for(var r=e;r;){var n;if(t.contains(r))return!0;r=null==r.getRootNode||null==(n=r.getRootNode())?void 0:n.host}return!1}var Kt={isTouch:!1},Yt=0;function qt(){Kt.isTouch||(Kt.isTouch=!0,window.performance&&document.addEventListener("mousemove",Wt))}function Wt(){var t=performance.now();t-Yt<20&&(Kt.isTouch=!1,document.removeEventListener("mousemove",Wt)),Yt=t}function zt(){var t=document.activeElement;if(Ut(t)){var e=t._tippy;t.blur&&!e.state.isVisible&&t.blur()}}var Xt=!!("undefined"!=typeof window&&"undefined"!=typeof document)&&!!window.msCrypto;var Qt={animateFill:!1,followCursor:!1,inlinePositioning:!1,sticky:!1},Jt=Object.assign({appendTo:Lt,aria:{content:"auto",expanded:"auto"},delay:0,duration:[300,250],getReferenceClientRect:null,hideOnClick:!0,ignoreAttributes:!1,interactive:!1,interactiveBorder:2,interactiveDebounce:0,moveTransition:"",offset:[0,10],onAfterUpdate:function(){},onBeforeUpdate:function(){},onCreate:function(){},onDestroy:function(){},onHidden:function(){},onHide:function(){},onMount:function(){},onShow:function(){},onShown:function(){},onTrigger:function(){},onUntrigger:function(){},onClickOutside:function(){},placement:"top",plugins:[],popperOptions:{},render:null,showOnCreate:!1,touch:!0,trigger:"mouseenter focus",triggerTarget:null},Qt,{allowHTML:!1,animation:"fade",arrow:!0,content:"",inertia:!1,maxWidth:350,role:"tooltip",theme:"",zIndex:9999}),Zt=Object.keys(Jt);function te(t){var e=(t.plugins||[]).reduce((function(e,r){var n,i=r.name,s=r.defaultValue;i&&(e[i]=void 0!==t[i]?t[i]:null!=(n=Jt[i])?n:s);return e}),{});return Object.assign({},t,e)}function ee(t,e){var r=Object.assign({},e,{content:kt(e.content,[t])},e.ignoreAttributes?{}:function(t,e){return(e?Object.keys(te(Object.assign({},Jt,{plugins:e}))):Zt).reduce((function(e,r){var n=(t.getAttribute("data-tippy-"+r)||"").trim();if(!n)return e;if("content"===r)e[r]=n;else try{e[r]=JSON.parse(n)}catch(t){e[r]=n}return e}),{})}(t,e.plugins));return r.aria=Object.assign({},Jt.aria,r.aria),r.aria={expanded:"auto"===r.aria.expanded?e.interactive:r.aria.expanded,content:"auto"===r.aria.content?e.interactive?null:"describedby":r.aria.content},r}var re=function(){return"innerHTML"};function ne(t,e){t[re()]=e}function ie(t){var e=Mt();return!0===t?e.className=wt:(e.className=Tt,Nt(t)?e.appendChild(t):ne(e,t)),e}function se(t,e){Nt(e.content)?(ne(t,""),t.appendChild(e.content)):"function"!=typeof e.content&&(e.allowHTML?ne(t,e.content):t.textContent=e.content)}function oe(t){var e=t.firstElementChild,r=Dt(e.children);return{box:e,content:r.find((function(t){return t.classList.contains(Et)})),arrow:r.find((function(t){return t.classList.contains(wt)||t.classList.contains(Tt)})),backdrop:r.find((function(t){return t.classList.contains(At)}))}}function ae(t){var e=Mt(),r=Mt();r.className=bt,r.setAttribute("data-state","hidden"),r.setAttribute("tabindex","-1");var n=Mt();function i(r,n){var i=oe(e),s=i.box,o=i.content,a=i.arrow;n.theme?s.setAttribute("data-theme",n.theme):s.removeAttribute("data-theme"),"string"==typeof n.animation?s.setAttribute("data-animation",n.animation):s.removeAttribute("data-animation"),n.inertia?s.setAttribute("data-inertia",""):s.removeAttribute("data-inertia"),s.style.maxWidth="number"==typeof n.maxWidth?n.maxWidth+"px":n.maxWidth,n.role?s.setAttribute("role",n.role):s.removeAttribute("role"),r.content===n.content&&r.allowHTML===n.allowHTML||se(o,t.props),n.arrow?a?r.arrow!==n.arrow&&(s.removeChild(a),s.appendChild(ie(n.arrow))):s.appendChild(ie(n.arrow)):a&&s.removeChild(a)}return n.className=Et,n.setAttribute("data-state","hidden"),se(n,t.props),e.appendChild(r),r.appendChild(n),i(t.props,t.props),{popper:e,onUpdate:i}}ae.$$tippy=!0;var le=1,ce=[],ue=[];function he(t,e){var r,n,i,s,o,a,l,c,u=ee(t,Object.assign({},Jt,te(Ct(e)))),h=!1,d=!1,f=!1,p=!1,g=[],m=Pt(q,u.interactiveDebounce),y=le++,v=(c=u.plugins).filter((function(t,e){return c.indexOf(t)===e})),b={id:y,reference:t,popper:Mt(),popperInstance:null,props:u,state:{isEnabled:!0,isVisible:!1,isDestroyed:!1,isMounted:!1,isShown:!1},plugins:v,clearDelayTimeouts:function(){clearTimeout(r),clearTimeout(n),cancelAnimationFrame(i)},setProps:function(e){0;if(b.state.isDestroyed)return;D("onBeforeUpdate",[b,e]),K();var r=b.props,n=ee(t,Object.assign({},r,Ct(e),{ignoreAttributes:!0}));b.props=n,V(),r.interactiveDebounce!==n.interactiveDebounce&&(N(),m=Pt(q,n.interactiveDebounce));r.triggerTarget&&!n.triggerTarget?It(r.triggerTarget).forEach((function(t){t.removeAttribute("aria-expanded")})):n.triggerTarget&&t.removeAttribute("aria-expanded");M(),O(),w&&w(r,n);b.popperInstance&&(Q(),Z().forEach((function(t){requestAnimationFrame(t._tippy.popperInstance.forceUpdate)})));D("onAfterUpdate",[b,e])},setContent:function(t){b.setProps({content:t})},show:function(){0;var t=b.state.isVisible,e=b.state.isDestroyed,r=!b.state.isEnabled,n=Kt.isTouch&&!b.props.touch,i=_t(b.props.duration,0,Jt.duration);if(t||e||r||n)return;if(k().hasAttribute("disabled"))return;if(D("onShow",[b],!1),!1===b.props.onShow(b))return;b.state.isVisible=!0,x()&&(A.style.visibility="visible");O(),$(),b.state.isMounted||(A.style.transition="none");if(x()){var s=I();$t([s.box,s.content],0)}a=function(){var t;if(b.state.isVisible&&!p){if(p=!0,A.offsetHeight,A.style.transition=b.props.moveTransition,x()&&b.props.animation){var e=I(),r=e.box,n=e.content;$t([r,n],i),jt([r,n],"visible")}C(),M(),Rt(ue,b),null==(t=b.popperInstance)||t.forceUpdate(),D("onMount",[b]),b.props.animation&&x()&&function(t,e){G(t,e)}(i,(function(){b.state.isShown=!0,D("onShown",[b])}))}},function(){var t,e=b.props.appendTo,r=k();t=b.props.interactive&&e===Lt||"parent"===e?r.parentNode:kt(e,[r]);t.contains(A)||t.appendChild(A);b.state.isMounted=!0,Q(),!1}()},hide:function(){0;var t=!b.state.isVisible,e=b.state.isDestroyed,r=!b.state.isEnabled,n=_t(b.props.duration,1,Jt.duration);if(t||e||r)return;if(D("onHide",[b],!1),!1===b.props.onHide(b))return;b.state.isVisible=!1,b.state.isShown=!1,p=!1,h=!1,x()&&(A.style.visibility="hidden");if(N(),j(),O(!0),x()){var i=I(),s=i.box,o=i.content;b.props.animation&&($t([s,o],n),jt([s,o],"hidden"))}C(),M(),b.props.animation?x()&&function(t,e){G(t,(function(){!b.state.isVisible&&A.parentNode&&A.parentNode.contains(A)&&e()}))}(n,b.unmount):b.unmount()},hideWithInteractivity:function(t){0;P().addEventListener("mousemove",m),Rt(ce,m),m(t)},enable:function(){b.state.isEnabled=!0},disable:function(){b.hide(),b.state.isEnabled=!1},unmount:function(){0;b.state.isVisible&&b.hide();if(!b.state.isMounted)return;J(),Z().forEach((function(t){t._tippy.unmount()})),A.parentNode&&A.parentNode.removeChild(A);ue=ue.filter((function(t){return t!==b})),b.state.isMounted=!1,D("onHidden",[b])},destroy:function(){0;if(b.state.isDestroyed)return;b.clearDelayTimeouts(),b.unmount(),K(),delete t._tippy,b.state.isDestroyed=!0,D("onDestroy",[b])}};if(!u.render)return b;var E=u.render(b),A=E.popper,w=E.onUpdate;A.setAttribute("data-tippy-root",""),A.id="tippy-"+b.id,b.popper=A,t._tippy=b,A._tippy=b;var T=v.map((function(t){return t.fn(b)})),S=t.hasAttribute("aria-expanded");return V(),M(),O(),D("onCreate",[b]),u.showOnCreate&&tt(),A.addEventListener("mouseenter",(function(){b.props.interactive&&b.state.isVisible&&b.clearDelayTimeouts()})),A.addEventListener("mouseleave",(function(){b.props.interactive&&b.props.trigger.indexOf("mouseenter")>=0&&P().addEventListener("mousemove",m)})),b;function L(){var t=b.props.touch;return Array.isArray(t)?t:[t,0]}function _(){return"hold"===L()[0]}function x(){var t;return!(null==(t=b.props.render)||!t.$$tippy)}function k(){return l||t}function P(){var t=k().parentNode;return t?Gt(t):document}function I(){return oe(A)}function R(t){return b.state.isMounted&&!b.state.isVisible||Kt.isTouch||s&&"focus"===s.type?0:_t(b.props.delay,t?0:1,Jt.delay)}function O(t){void 0===t&&(t=!1),A.style.pointerEvents=b.props.interactive&&!t?"":"none",A.style.zIndex=""+b.props.zIndex}function D(t,e,r){var n;(void 0===r&&(r=!0),T.forEach((function(r){r[t]&&r[t].apply(r,e)})),r)&&(n=b.props)[t].apply(n,e)}function C(){var e=b.props.aria;if(e.content){var r="aria-"+e.content,n=A.id;It(b.props.triggerTarget||t).forEach((function(t){var e=t.getAttribute(r);if(b.state.isVisible)t.setAttribute(r,e?e+" "+n:n);else{var i=e&&e.replace(n,"").trim();i?t.setAttribute(r,i):t.removeAttribute(r)}}))}}function M(){!S&&b.props.aria.expanded&&It(b.props.triggerTarget||t).forEach((function(t){b.props.interactive?t.setAttribute("aria-expanded",b.state.isVisible&&t===k()?"true":"false"):t.removeAttribute("aria-expanded")}))}function N(){P().removeEventListener("mousemove",m),ce=ce.filter((function(t){return t!==m}))}function F(e){if(!Kt.isTouch||!f&&"mousedown"!==e.type){var r=e.composedPath&&e.composedPath()[0]||e.target;if(!b.props.interactive||!Vt(A,r)){if(It(b.props.triggerTarget||t).some((function(t){return Vt(t,r)}))){if(Kt.isTouch)return;if(b.state.isVisible&&b.props.trigger.indexOf("click")>=0)return}else D("onClickOutside",[b,e]);!0===b.props.hideOnClick&&(b.clearDelayTimeouts(),b.hide(),d=!0,setTimeout((function(){d=!1})),b.state.isMounted||j())}}}function U(){f=!0}function B(){f=!1}function $(){var t=P();t.addEventListener("mousedown",F,!0),t.addEventListener("touchend",F,St),t.addEventListener("touchstart",B,St),t.addEventListener("touchmove",U,St)}function j(){var t=P();t.removeEventListener("mousedown",F,!0),t.removeEventListener("touchend",F,St),t.removeEventListener("touchstart",B,St),t.removeEventListener("touchmove",U,St)}function G(t,e){var r=I().box;function n(t){t.target===r&&(Ht(r,"remove",n),e())}if(0===t)return e();Ht(r,"remove",o),Ht(r,"add",n),o=n}function H(e,r,n){void 0===n&&(n=!1),It(b.props.triggerTarget||t).forEach((function(t){t.addEventListener(e,r,n),g.push({node:t,eventType:e,handler:r,options:n})}))}function V(){var t;_()&&(H("touchstart",Y,{passive:!0}),H("touchend",W,{passive:!0})),(t=b.props.trigger,t.split(/\s+/).filter(Boolean)).forEach((function(t){if("manual"!==t)switch(H(t,Y),t){case"mouseenter":H("mouseleave",W);break;case"focus":H(Xt?"focusout":"blur",z);break;case"focusin":H("focusout",z)}}))}function K(){g.forEach((function(t){var e=t.node,r=t.eventType,n=t.handler,i=t.options;e.removeEventListener(r,n,i)})),g=[]}function Y(t){var e,r=!1;if(b.state.isEnabled&&!X(t)&&!d){var n="focus"===(null==(e=s)?void 0:e.type);s=t,l=t.currentTarget,M(),!b.state.isVisible&&Ft(t)&&ce.forEach((function(e){return e(t)})),"click"===t.type&&(b.props.trigger.indexOf("mouseenter")<0||h)&&!1!==b.props.hideOnClick&&b.state.isVisible?r=!0:tt(t),"click"===t.type&&(h=!r),r&&!n&&et(t)}}function q(t){var e=t.target,r=k().contains(e)||A.contains(e);if("mousemove"!==t.type||!r){var n=Z().concat(A).map((function(t){var e,r=null==(e=t._tippy.popperInstance)?void 0:e.state;return r?{popperRect:t.getBoundingClientRect(),popperState:r,props:u}:null})).filter(Boolean);(function(t,e){var r=e.clientX,n=e.clientY;return t.every((function(t){var e=t.popperRect,i=t.popperState,s=t.props.interactiveBorder,o=Ot(i.placement),a=i.modifiersData.offset;if(!a)return!0;var l="bottom"===o?a.top.y:0,c="top"===o?a.bottom.y:0,u="right"===o?a.left.x:0,h="left"===o?a.right.x:0,d=e.top-n+l>s,f=n-e.bottom-c>s,p=e.left-r+u>s,g=r-e.right-h>s;return d||f||p||g}))})(n,t)&&(N(),et(t))}}function W(t){X(t)||b.props.trigger.indexOf("click")>=0&&h||(b.props.interactive?b.hideWithInteractivity(t):et(t))}function z(t){b.props.trigger.indexOf("focusin")<0&&t.target!==k()||b.props.interactive&&t.relatedTarget&&A.contains(t.relatedTarget)||et(t)}function X(t){return!!Kt.isTouch&&_()!==t.type.indexOf("touch")>=0}function Q(){J();var e=b.props,r=e.popperOptions,n=e.placement,i=e.offset,s=e.getReferenceClientRect,o=e.moveTransition,l=x()?oe(A).arrow:null,c=s?{getBoundingClientRect:s,contextElement:s.contextElement||k()}:t,u={name:"$$tippy",enabled:!0,phase:"beforeWrite",requires:["computeStyles"],fn:function(t){var e=t.state;if(x()){var r=I().box;["placement","reference-hidden","escaped"].forEach((function(t){"placement"===t?r.setAttribute("data-placement",e.placement):e.attributes.popper["data-popper-"+t]?r.setAttribute("data-"+t,""):r.removeAttribute("data-"+t)})),e.attributes.popper={}}}},h=[{name:"offset",options:{offset:i}},{name:"preventOverflow",options:{padding:{top:2,bottom:2,left:5,right:5}}},{name:"flip",options:{padding:5}},{name:"computeStyles",options:{adaptive:!o}},u];x()&&l&&h.push({name:"arrow",options:{element:l,padding:3}}),h.push.apply(h,(null==r?void 0:r.modifiers)||[]),b.popperInstance=vt(c,A,Object.assign({},r,{placement:n,onFirstUpdate:a,modifiers:h}))}function J(){b.popperInstance&&(b.popperInstance.destroy(),b.popperInstance=null)}function Z(){return Dt(A.querySelectorAll("[data-tippy-root]"))}function tt(t){b.clearDelayTimeouts(),t&&D("onTrigger",[b,t]),$();var e=R(!0),n=L(),i=n[0],s=n[1];Kt.isTouch&&"hold"===i&&s&&(e=s),e?r=setTimeout((function(){b.show()}),e):b.show()}function et(t){if(b.clearDelayTimeouts(),D("onUntrigger",[b,t]),b.state.isVisible){if(!(b.props.trigger.indexOf("mouseenter")>=0&&b.props.trigger.indexOf("click")>=0&&["mouseleave","mousemove"].indexOf(t.type)>=0&&h)){var e=R(!1);e?n=setTimeout((function(){b.state.isVisible&&b.hide()}),e):i=requestAnimationFrame((function(){b.hide()}))}}else j()}}function de(t,e){void 0===e&&(e={});var r=Jt.plugins.concat(e.plugins||[]);document.addEventListener("touchstart",qt,St),window.addEventListener("blur",zt);var n=Object.assign({},e,{plugins:r}),i=Bt(t).reduce((function(t,e){var r=e&&he(e,n);return r&&t.push(r),t}),[]);return Nt(t)?i[0]:i}de.defaultProps=Jt,de.setDefaultProps=function(t){Object.keys(t).forEach((function(e){Jt[e]=t[e]}))},de.currentInput=Kt;Object.assign({},Z,{effect:function(t){var e=t.state,r={popper:{position:e.options.strategy,left:"0",top:"0",margin:"0"},arrow:{position:"absolute"},reference:{}};Object.assign(e.elements.popper.style,r.popper),e.styles=r,e.elements.arrow&&Object.assign(e.elements.arrow.style,r.arrow)}});de.setDefaultProps({render:ae});const fe=de},6426:t=>{t.exports=function(){var t=document.getSelection();if(!t.rangeCount)return function(){};for(var e=document.activeElement,r=[],n=0;n<t.rangeCount;n++)r.push(t.getRangeAt(n));switch(e.tagName.toUpperCase()){case"INPUT":case"TEXTAREA":e.blur();break;default:e=null}return t.removeAllRanges(),function(){"Caret"===t.type&&t.removeAllRanges(),t.rangeCount||r.forEach((function(e){t.addRange(e)})),e&&e.focus()}}},4945:(t,e,r)=>{"use strict";r.d(e,{Ay:()=>Ga});const n=Number.isFinite||function(t){return"number"==typeof t&&isFinite(t)},i=Number.isSafeInteger||function(t){return"number"==typeof t&&Math.abs(t)<=s},s=Number.MAX_SAFE_INTEGER||9007199254740991;let o=function(t){return t.NETWORK_ERROR="networkError",t.MEDIA_ERROR="mediaError",t.KEY_SYSTEM_ERROR="keySystemError",t.MUX_ERROR="muxError",t.OTHER_ERROR="otherError",t}({}),a=function(t){return t.KEY_SYSTEM_NO_KEYS="keySystemNoKeys",t.KEY_SYSTEM_NO_ACCESS="keySystemNoAccess",t.KEY_SYSTEM_NO_SESSION="keySystemNoSession",t.KEY_SYSTEM_NO_CONFIGURED_LICENSE="keySystemNoConfiguredLicense",t.KEY_SYSTEM_LICENSE_REQUEST_FAILED="keySystemLicenseRequestFailed",t.KEY_SYSTEM_SERVER_CERTIFICATE_REQUEST_FAILED="keySystemServerCertificateRequestFailed",t.KEY_SYSTEM_SERVER_CERTIFICATE_UPDATE_FAILED="keySystemServerCertificateUpdateFailed",t.KEY_SYSTEM_SESSION_UPDATE_FAILED="keySystemSessionUpdateFailed",t.KEY_SYSTEM_STATUS_OUTPUT_RESTRICTED="keySystemStatusOutputRestricted",t.KEY_SYSTEM_STATUS_INTERNAL_ERROR="keySystemStatusInternalError",t.KEY_SYSTEM_DESTROY_MEDIA_KEYS_ERROR="keySystemDestroyMediaKeysError",t.KEY_SYSTEM_DESTROY_CLOSE_SESSION_ERROR="keySystemDestroyCloseSessionError",t.KEY_SYSTEM_DESTROY_REMOVE_SESSION_ERROR="keySystemDestroyRemoveSessionError",t.MANIFEST_LOAD_ERROR="manifestLoadError",t.MANIFEST_LOAD_TIMEOUT="manifestLoadTimeOut",t.MANIFEST_PARSING_ERROR="manifestParsingError",t.MANIFEST_INCOMPATIBLE_CODECS_ERROR="manifestIncompatibleCodecsError",t.LEVEL_EMPTY_ERROR="levelEmptyError",t.LEVEL_LOAD_ERROR="levelLoadError",t.LEVEL_LOAD_TIMEOUT="levelLoadTimeOut",t.LEVEL_PARSING_ERROR="levelParsingError",t.LEVEL_SWITCH_ERROR="levelSwitchError",t.AUDIO_TRACK_LOAD_ERROR="audioTrackLoadError",t.AUDIO_TRACK_LOAD_TIMEOUT="audioTrackLoadTimeOut",t.SUBTITLE_LOAD_ERROR="subtitleTrackLoadError",t.SUBTITLE_TRACK_LOAD_TIMEOUT="subtitleTrackLoadTimeOut",t.FRAG_LOAD_ERROR="fragLoadError",t.FRAG_LOAD_TIMEOUT="fragLoadTimeOut",t.FRAG_DECRYPT_ERROR="fragDecryptError",t.FRAG_PARSING_ERROR="fragParsingError",t.FRAG_GAP="fragGap",t.REMUX_ALLOC_ERROR="remuxAllocError",t.KEY_LOAD_ERROR="keyLoadError",t.KEY_LOAD_TIMEOUT="keyLoadTimeOut",t.BUFFER_ADD_CODEC_ERROR="bufferAddCodecError",t.BUFFER_INCOMPATIBLE_CODECS_ERROR="bufferIncompatibleCodecsError",t.BUFFER_APPEND_ERROR="bufferAppendError",t.BUFFER_APPENDING_ERROR="bufferAppendingError",t.BUFFER_STALLED_ERROR="bufferStalledError",t.BUFFER_FULL_ERROR="bufferFullError",t.BUFFER_SEEK_OVER_HOLE="bufferSeekOverHole",t.BUFFER_NUDGE_ON_STALL="bufferNudgeOnStall",t.ASSET_LIST_LOAD_ERROR="assetListLoadError",t.ASSET_LIST_LOAD_TIMEOUT="assetListLoadTimeout",t.ASSET_LIST_PARSING_ERROR="assetListParsingError",t.INTERSTITIAL_ASSET_ITEM_ERROR="interstitialAssetItemError",t.INTERNAL_EXCEPTION="internalException",t.INTERNAL_ABORTED="aborted",t.ATTACH_MEDIA_ERROR="attachMediaError",t.UNKNOWN="unknown",t}({}),l=function(t){return t.MEDIA_ATTACHING="hlsMediaAttaching",t.MEDIA_ATTACHED="hlsMediaAttached",t.MEDIA_DETACHING="hlsMediaDetaching",t.MEDIA_DETACHED="hlsMediaDetached",t.MEDIA_ENDED="hlsMediaEnded",t.STALL_RESOLVED="hlsStallResolved",t.BUFFER_RESET="hlsBufferReset",t.BUFFER_CODECS="hlsBufferCodecs",t.BUFFER_CREATED="hlsBufferCreated",t.BUFFER_APPENDING="hlsBufferAppending",t.BUFFER_APPENDED="hlsBufferAppended",t.BUFFER_EOS="hlsBufferEos",t.BUFFERED_TO_END="hlsBufferedToEnd",t.BUFFER_FLUSHING="hlsBufferFlushing",t.BUFFER_FLUSHED="hlsBufferFlushed",t.MANIFEST_LOADING="hlsManifestLoading",t.MANIFEST_LOADED="hlsManifestLoaded",t.MANIFEST_PARSED="hlsManifestParsed",t.LEVEL_SWITCHING="hlsLevelSwitching",t.LEVEL_SWITCHED="hlsLevelSwitched",t.LEVEL_LOADING="hlsLevelLoading",t.LEVEL_LOADED="hlsLevelLoaded",t.LEVEL_UPDATED="hlsLevelUpdated",t.LEVEL_PTS_UPDATED="hlsLevelPtsUpdated",t.LEVELS_UPDATED="hlsLevelsUpdated",t.AUDIO_TRACKS_UPDATED="hlsAudioTracksUpdated",t.AUDIO_TRACK_SWITCHING="hlsAudioTrackSwitching",t.AUDIO_TRACK_SWITCHED="hlsAudioTrackSwitched",t.AUDIO_TRACK_LOADING="hlsAudioTrackLoading",t.AUDIO_TRACK_LOADED="hlsAudioTrackLoaded",t.AUDIO_TRACK_UPDATED="hlsAudioTrackUpdated",t.SUBTITLE_TRACKS_UPDATED="hlsSubtitleTracksUpdated",t.SUBTITLE_TRACKS_CLEARED="hlsSubtitleTracksCleared",t.SUBTITLE_TRACK_SWITCH="hlsSubtitleTrackSwitch",t.SUBTITLE_TRACK_LOADING="hlsSubtitleTrackLoading",t.SUBTITLE_TRACK_LOADED="hlsSubtitleTrackLoaded",t.SUBTITLE_TRACK_UPDATED="hlsSubtitleTrackUpdated",t.SUBTITLE_FRAG_PROCESSED="hlsSubtitleFragProcessed",t.CUES_PARSED="hlsCuesParsed",t.NON_NATIVE_TEXT_TRACKS_FOUND="hlsNonNativeTextTracksFound",t.INIT_PTS_FOUND="hlsInitPtsFound",t.FRAG_LOADING="hlsFragLoading",t.FRAG_LOAD_EMERGENCY_ABORTED="hlsFragLoadEmergencyAborted",t.FRAG_LOADED="hlsFragLoaded",t.FRAG_DECRYPTED="hlsFragDecrypted",t.FRAG_PARSING_INIT_SEGMENT="hlsFragParsingInitSegment",t.FRAG_PARSING_USERDATA="hlsFragParsingUserdata",t.FRAG_PARSING_METADATA="hlsFragParsingMetadata",t.FRAG_PARSED="hlsFragParsed",t.FRAG_BUFFERED="hlsFragBuffered",t.FRAG_CHANGED="hlsFragChanged",t.FPS_DROP="hlsFpsDrop",t.FPS_DROP_LEVEL_CAPPING="hlsFpsDropLevelCapping",t.MAX_AUTO_LEVEL_UPDATED="hlsMaxAutoLevelUpdated",t.ERROR="hlsError",t.DESTROYING="hlsDestroying",t.KEY_LOADING="hlsKeyLoading",t.KEY_LOADED="hlsKeyLoaded",t.LIVE_BACK_BUFFER_REACHED="hlsLiveBackBufferReached",t.BACK_BUFFER_REACHED="hlsBackBufferReached",t.STEERING_MANIFEST_LOADED="hlsSteeringManifestLoaded",t.ASSET_LIST_LOADING="hlsAssetListLoading",t.ASSET_LIST_LOADED="hlsAssetListLoaded",t.INTERSTITIALS_UPDATED="hlsInterstitialsUpdated",t.INTERSTITIALS_BUFFERED_TO_BOUNDARY="hlsInterstitialsBufferedToBoundary",t.INTERSTITIAL_ASSET_PLAYER_CREATED="hlsInterstitialAssetPlayerCreated",t.INTERSTITIAL_STARTED="hlsInterstitialStarted",t.INTERSTITIAL_ASSET_STARTED="hlsInterstitialAssetStarted",t.INTERSTITIAL_ASSET_ENDED="hlsInterstitialAssetEnded",t.INTERSTITIAL_ASSET_ERROR="hlsInterstitialAssetError",t.INTERSTITIAL_ENDED="hlsInterstitialEnded",t.INTERSTITIALS_PRIMARY_RESUMED="hlsInterstitialsPrimaryResumed",t.PLAYOUT_LIMIT_REACHED="hlsPlayoutLimitReached",t.EVENT_CUE_ENTER="hlsEventCueEnter",t}({});var c={MANIFEST:"manifest",LEVEL:"level",AUDIO_TRACK:"audioTrack",SUBTITLE_TRACK:"subtitleTrack"},u={MAIN:"main",AUDIO:"audio",SUBTITLE:"subtitle"};class h{constructor(t,e=0,r=0){this.halfLife=void 0,this.alpha_=void 0,this.estimate_=void 0,this.totalWeight_=void 0,this.halfLife=t,this.alpha_=t?Math.exp(Math.log(.5)/t):0,this.estimate_=e,this.totalWeight_=r}sample(t,e){const r=Math.pow(this.alpha_,t);this.estimate_=e*(1-r)+r*this.estimate_,this.totalWeight_+=t}getTotalWeight(){return this.totalWeight_}getEstimate(){if(this.alpha_){const t=1-Math.pow(this.alpha_,this.totalWeight_);if(t)return this.estimate_/t}return this.estimate_}}class d{constructor(t,e,r,n=100){this.defaultEstimate_=void 0,this.minWeight_=void 0,this.minDelayMs_=void 0,this.slow_=void 0,this.fast_=void 0,this.defaultTTFB_=void 0,this.ttfb_=void 0,this.defaultEstimate_=r,this.minWeight_=.001,this.minDelayMs_=50,this.slow_=new h(t),this.fast_=new h(e),this.defaultTTFB_=n,this.ttfb_=new h(t)}update(t,e){const{slow_:r,fast_:n,ttfb_:i}=this;r.halfLife!==t&&(this.slow_=new h(t,r.getEstimate(),r.getTotalWeight())),n.halfLife!==e&&(this.fast_=new h(e,n.getEstimate(),n.getTotalWeight())),i.halfLife!==t&&(this.ttfb_=new h(t,i.getEstimate(),i.getTotalWeight()))}sample(t,e){const r=(t=Math.max(t,this.minDelayMs_))/1e3,n=8*e/r;this.fast_.sample(r,n),this.slow_.sample(r,n)}sampleTTFB(t){const e=t/1e3,r=Math.sqrt(2)*Math.exp(-Math.pow(e,2)/2);this.ttfb_.sample(r,Math.max(t,5))}canEstimate(){return this.fast_.getTotalWeight()>=this.minWeight_}getEstimate(){return this.canEstimate()?Math.min(this.fast_.getEstimate(),this.slow_.getEstimate()):this.defaultEstimate_}getEstimateTTFB(){return this.ttfb_.getTotalWeight()>=this.minWeight_?this.ttfb_.getEstimate():this.defaultTTFB_}get defaultEstimate(){return this.defaultEstimate_}destroy(){}}function f(t,e,r){return(e=function(t){var e=function(t,e){if("object"!=typeof t||!t)return t;var r=t[Symbol.toPrimitive];if(void 0!==r){var n=r.call(t,e);if("object"!=typeof n)return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return("string"===e?String:Number)(t)}(t,"string");return"symbol"==typeof e?e:e+""}(e))in t?Object.defineProperty(t,e,{value:r,enumerable:!0,configurable:!0,writable:!0}):t[e]=r,t}function p(){return p=Object.assign?Object.assign.bind():function(t){for(var e=1;e<arguments.length;e++){var r=arguments[e];for(var n in r)({}).hasOwnProperty.call(r,n)&&(t[n]=r[n])}return t},p.apply(null,arguments)}function g(t,e){var r=Object.keys(t);if(Object.getOwnPropertySymbols){var n=Object.getOwnPropertySymbols(t);e&&(n=n.filter((function(e){return Object.getOwnPropertyDescriptor(t,e).enumerable}))),r.push.apply(r,n)}return r}function m(t){for(var e=1;e<arguments.length;e++){var r=null!=arguments[e]?arguments[e]:{};e%2?g(Object(r),!0).forEach((function(e){f(t,e,r[e])})):Object.getOwnPropertyDescriptors?Object.defineProperties(t,Object.getOwnPropertyDescriptors(r)):g(Object(r)).forEach((function(e){Object.defineProperty(t,e,Object.getOwnPropertyDescriptor(r,e))}))}return t}class y{constructor(t,e){this.trace=void 0,this.debug=void 0,this.log=void 0,this.warn=void 0,this.info=void 0,this.error=void 0;const r=`[${t}]:`;this.trace=v,this.debug=e.debug.bind(null,r),this.log=e.log.bind(null,r),this.warn=e.warn.bind(null,r),this.info=e.info.bind(null,r),this.error=e.error.bind(null,r)}}const v=function(){},b={trace:v,debug:v,log:v,warn:v,info:v,error:v};function E(){return p({},b)}function A(t,e,r){return e[t]?e[t].bind(e):function(t,e){const r=self.console[t];return r?r.bind(self.console,`${e?"["+e+"] ":""}[${t}] >`):v}(t,r)}const w=E();const T=w;function S(t=!0){if("undefined"==typeof self)return;return(t||!self.MediaSource)&&self.ManagedMediaSource||self.MediaSource||self.WebKitMediaSource}function L(t,e){const r=Object.keys(t),n=Object.keys(e),i=r.length,s=n.length;return!i||!s||i===s&&!r.some((t=>-1===n.indexOf(t)))}function _(t,e=!1){if("undefined"!=typeof TextDecoder){const r=new TextDecoder("utf-8").decode(t);if(e){const t=r.indexOf("\0");return-1!==t?r.substring(0,t):r}return r.replace(/\0/g,"")}const r=t.length;let n,i,s,o="",a=0;for(;a<r;){if(n=t[a++],0===n&&e)return o;if(0!==n&&3!==n)switch(n>>4){case 0:case 1:case 2:case 3:case 4:case 5:case 6:case 7:o+=String.fromCharCode(n);break;case 12:case 13:i=t[a++],o+=String.fromCharCode((31&n)<<6|63&i);break;case 14:i=t[a++],s=t[a++],o+=String.fromCharCode((15&n)<<12|(63&i)<<6|(63&s)<<0)}}return o}function x(t){let e="";for(let r=0;r<t.length;r++){let n=t[r].toString(16);n.length<2&&(n="0"+n),e+=n}return e}function k(t){return Uint8Array.from(t.replace(/^0x/,"").replace(/([\da-fA-F]{2}) ?/g,"0x$1 ").replace(/ +$/,"").split(" ")).buffer}function P(t){return t&&t.__esModule&&Object.prototype.hasOwnProperty.call(t,"default")?t.default:t}var I,R={exports:{}};var O,D,C,M,N,F=(I||(I=1,O=/^(?=((?:[a-zA-Z0-9+\-.]+:)?))\1(?=((?:\/\/[^\/?#]*)?))\2(?=((?:(?:[^?#\/]*\/)*[^;?#\/]*)?))\3((?:;[^?#]*)?)(\?[^#]*)?(#[^]*)?$/,D=/^(?=([^\/?#]*))\1([^]*)$/,C=/(?:\/|^)\.(?=\/)/g,M=/(?:\/|^)\.\.\/(?!\.\.\/)[^\/]*(?=\/)/g,N={buildAbsoluteURL:function(t,e,r){if(r=r||{},t=t.trim(),!(e=e.trim())){if(!r.alwaysNormalize)return t;var n=N.parseURL(t);if(!n)throw new Error("Error trying to parse base URL.");return n.path=N.normalizePath(n.path),N.buildURLFromParts(n)}var i=N.parseURL(e);if(!i)throw new Error("Error trying to parse relative URL.");if(i.scheme)return r.alwaysNormalize?(i.path=N.normalizePath(i.path),N.buildURLFromParts(i)):e;var s=N.parseURL(t);if(!s)throw new Error("Error trying to parse base URL.");if(!s.netLoc&&s.path&&"/"!==s.path[0]){var o=D.exec(s.path);s.netLoc=o[1],s.path=o[2]}s.netLoc&&!s.path&&(s.path="/");var a={scheme:s.scheme,netLoc:i.netLoc,path:null,params:i.params,query:i.query,fragment:i.fragment};if(!i.netLoc&&(a.netLoc=s.netLoc,"/"!==i.path[0]))if(i.path){var l=s.path,c=l.substring(0,l.lastIndexOf("/")+1)+i.path;a.path=N.normalizePath(c)}else a.path=s.path,i.params||(a.params=s.params,i.query||(a.query=s.query));return null===a.path&&(a.path=r.alwaysNormalize?N.normalizePath(i.path):i.path),N.buildURLFromParts(a)},parseURL:function(t){var e=O.exec(t);return e?{scheme:e[1]||"",netLoc:e[2]||"",path:e[3]||"",params:e[4]||"",query:e[5]||"",fragment:e[6]||""}:null},normalizePath:function(t){for(t=t.split("").reverse().join("").replace(C,"");t.length!==(t=t.replace(M,"")).length;);return t.split("").reverse().join("")},buildURLFromParts:function(t){return t.scheme+t.netLoc+t.path+t.params+t.query+t.fragment}},R.exports=N),R.exports);class U{constructor(){this.aborted=!1,this.loaded=0,this.retry=0,this.total=0,this.chunkCount=0,this.bwEstimate=0,this.loading={start:0,first:0,end:0},this.parsing={start:0,end:0},this.buffering={start:0,first:0,end:0}}}var B={AUDIO:"audio",VIDEO:"video",AUDIOVIDEO:"audiovideo"};class ${constructor(t){this._byteRange=null,this._url=null,this._stats=null,this._streams=null,this.base=void 0,this.relurl=void 0,"string"==typeof t&&(t={url:t}),this.base=t,function(t,e){const r=V(t,e);r&&(r.enumerable=!0,Object.defineProperty(t,e,r))}(this,"stats")}setByteRange(t,e){const r=t.split("@",2);let n;n=1===r.length?(null==e?void 0:e.byteRangeEndOffset)||0:parseInt(r[1]),this._byteRange=[n,parseInt(r[0])+n]}get baseurl(){return this.base.url}get byteRange(){return null===this._byteRange?[]:this._byteRange}get byteRangeStartOffset(){return this.byteRange[0]}get byteRangeEndOffset(){return this.byteRange[1]}get elementaryStreams(){return null===this._streams&&(this._streams={[B.AUDIO]:null,[B.VIDEO]:null,[B.AUDIOVIDEO]:null}),this._streams}set elementaryStreams(t){this._streams=t}get hasStats(){return null!==this._stats}get hasStreams(){return null!==this._streams}get stats(){return null===this._stats&&(this._stats=new U),this._stats}set stats(t){this._stats=t}get url(){return!this._url&&this.baseurl&&this.relurl&&(this._url=F.buildAbsoluteURL(this.baseurl,this.relurl,{alwaysNormalize:!0})),this._url||""}set url(t){this._url=t}clearElementaryStreamInfo(){const{elementaryStreams:t}=this;t[B.AUDIO]=null,t[B.VIDEO]=null,t[B.AUDIOVIDEO]=null}}function j(t){return"initSegment"!==t.sn}class G extends ${constructor(t,e){super(e),this._decryptdata=null,this._programDateTime=null,this._ref=null,this._bitrate=void 0,this.rawProgramDateTime=null,this.tagList=[],this.duration=0,this.sn=0,this.levelkeys=void 0,this.type=void 0,this.loader=null,this.keyLoader=null,this.level=-1,this.cc=0,this.startPTS=void 0,this.endPTS=void 0,this.startDTS=void 0,this.endDTS=void 0,this.start=0,this.playlistOffset=0,this.deltaPTS=void 0,this.maxStartPTS=void 0,this.minEndPTS=void 0,this.data=void 0,this.bitrateTest=!1,this.title=null,this.initSegment=null,this.endList=void 0,this.gap=void 0,this.urlId=0,this.type=t}get byteLength(){if(this.hasStats){const t=this.stats.total;if(t)return t}if(this.byteRange.length){const t=this.byteRange[0],e=this.byteRange[1];if(n(t)&&n(e))return e-t}return null}get bitrate(){return this.byteLength?8*this.byteLength/this.duration:this._bitrate?this._bitrate:null}set bitrate(t){this._bitrate=t}get decryptdata(){const{levelkeys:t}=this;if(!t&&!this._decryptdata)return null;if(!this._decryptdata&&this.levelkeys&&!this.levelkeys.NONE){const t=this.levelkeys.identity;if(t)this._decryptdata=t.getDecryptData(this.sn);else{const t=Object.keys(this.levelkeys);if(1===t.length){const e=this._decryptdata=this.levelkeys[t[0]]||null;if(e)return e.getDecryptData(this.sn)}}}return this._decryptdata}get end(){return this.start+this.duration}get endProgramDateTime(){if(null===this.programDateTime)return null;const t=n(this.duration)?this.duration:0;return this.programDateTime+1e3*t}get encrypted(){var t;if(null!=(t=this._decryptdata)&&t.encrypted)return!0;if(this.levelkeys){var e;const t=Object.keys(this.levelkeys),r=t.length;if(r>1||1===r&&null!=(e=this.levelkeys[t[0]])&&e.encrypted)return!0}return!1}get programDateTime(){return null===this._programDateTime&&this.rawProgramDateTime&&(this.programDateTime=Date.parse(this.rawProgramDateTime)),this._programDateTime}set programDateTime(t){n(t)?this._programDateTime=t:this._programDateTime=this.rawProgramDateTime=null}get ref(){return j(this)?(this._ref||(this._ref={base:this.base,start:this.start,duration:this.duration,sn:this.sn,programDateTime:this.programDateTime}),this._ref):null}addStart(t){this.setStart(this.start+t)}setStart(t){this.start=t,this._ref&&(this._ref.start=t)}setDuration(t){this.duration=t,this._ref&&(this._ref.duration=t)}setKeyFormat(t){if(this.levelkeys){const e=this.levelkeys[t];e&&!this._decryptdata&&(this._decryptdata=e.getDecryptData(this.sn))}}abortRequests(){var t,e;null==(t=this.loader)||t.abort(),null==(e=this.keyLoader)||e.abort()}setElementaryStreamInfo(t,e,r,n,i,s=!1){const{elementaryStreams:o}=this,a=o[t];a?(a.startPTS=Math.min(a.startPTS,e),a.endPTS=Math.max(a.endPTS,r),a.startDTS=Math.min(a.startDTS,n),a.endDTS=Math.max(a.endDTS,i)):o[t]={startPTS:e,endPTS:r,startDTS:n,endDTS:i,partial:s}}}class H extends ${constructor(t,e,r,n,i){super(r),this.fragOffset=0,this.duration=0,this.gap=!1,this.independent=!1,this.relurl=void 0,this.fragment=void 0,this.index=void 0,this.duration=t.decimalFloatingPoint("DURATION"),this.gap=t.bool("GAP"),this.independent=t.bool("INDEPENDENT"),this.relurl=t.enumeratedString("URI"),this.fragment=e,this.index=n;const s=t.enumeratedString("BYTERANGE");s&&this.setByteRange(s,i),i&&(this.fragOffset=i.fragOffset+i.duration)}get start(){return this.fragment.start+this.fragOffset}get end(){return this.start+this.duration}get loaded(){const{elementaryStreams:t}=this;return!!(t.audio||t.video||t.audiovideo)}}function V(t,e){const r=Object.getPrototypeOf(t);if(r){const t=Object.getOwnPropertyDescriptor(r,e);return t||V(r,e)}}const K=Math.pow(2,32)-1,Y=[].push,q={video:1,audio:2,id3:3,text:4};function W(t){return String.fromCharCode.apply(null,t)}function z(t,e){const r=t[e]<<8|t[e+1];return r<0?65536+r:r}function X(t,e){const r=J(t,e);return r<0?4294967296+r:r}function Q(t,e){let r=X(t,e);return r*=Math.pow(2,32),r+=X(t,e+4),r}function J(t,e){return t[e]<<24|t[e+1]<<16|t[e+2]<<8|t[e+3]}function Z(t,e){const r=[];if(!e.length)return r;const n=t.byteLength;for(let i=0;i<n;){const s=X(t,i),o=s>1?i+s:n;if(W(t.subarray(i+4,i+8))===e[0])if(1===e.length)r.push(t.subarray(i+8,o));else{const n=Z(t.subarray(i+8,o),e.slice(1));n.length&&Y.apply(r,n)}i=o}return r}function tt(t){const e=[],r=t[0];let n=8;const i=X(t,n);n+=4;let s=0,o=0;0===r?(s=X(t,n),o=X(t,n+4),n+=8):(s=Q(t,n),o=Q(t,n+8),n+=16),n+=2;let a=t.length+o;const l=z(t,n);n+=2;for(let r=0;r<l;r++){let r=n;const s=X(t,r);r+=4;const o=2147483647&s;if(1===(2147483648&s)>>>31)return T.warn("SIDX has hierarchical references (not supported)"),null;const l=X(t,r);r+=4,e.push({referenceSize:o,subsegmentDuration:l,info:{duration:l/i,start:a,end:a+o-1}}),a+=o,r+=4,n=r}return{earliestPresentationTime:s,timescale:i,version:r,referencesCount:l,references:e}}function et(t){const e=[],r=Z(t,["moov","trak"]);for(let t=0;t<r.length;t++){const n=r[t],i=Z(n,["tkhd"])[0];if(i){let t=i[0];const r=X(i,0===t?12:20),s=Z(n,["mdia","mdhd"])[0];if(s){t=s[0];const i=X(s,0===t?12:20),o=Z(n,["mdia","hdlr"])[0];if(o){const t=W(o.subarray(8,12)),s={soun:B.AUDIO,vide:B.VIDEO}[t],a=rt(Z(n,["mdia","minf","stbl","stsd"])[0]);s?(e[r]={timescale:i,type:s,stsd:a},e[s]=m({timescale:i,id:r},a)):e[r]={timescale:i,type:t,stsd:a}}}}}return Z(t,["moov","mvex","trex"]).forEach((t=>{const r=X(t,4),n=e[r];n&&(n.default={duration:X(t,12),flags:X(t,20)})})),e}function rt(t){const e=t.subarray(8),r=e.subarray(86),n=W(e.subarray(4,8));let i,s=n;const o="enca"===n||"encv"===n;if(o){const t=Z(e,[n])[0];Z(t.subarray("enca"===n?28:78),["sinf"]).forEach((t=>{const e=Z(t,["schm"])[0];if(e){const r=W(e.subarray(4,8));if("cbcs"===r||"cenc"===r){const e=Z(t,["frma"])[0];e&&(s=W(e))}}}))}const a=s;switch(s){case"avc1":case"avc2":case"avc3":case"avc4":{const t=Z(r,["avcC"])[0];t&&t.length>3&&(s+="."+st(t[1])+st(t[2])+st(t[3]),i=nt("avc1"===a?"dva1":"dvav",r));break}case"mp4a":{const t=Z(e,[n])[0],r=Z(t.subarray(28),["esds"])[0];if(r&&r.length>7){let t=4;if(3!==r[t++])break;t=it(r,t),t+=2;const e=r[t++];if(128&e&&(t+=2),64&e&&(t+=r[t++]),4!==r[t++])break;t=it(r,t);const n=r[t++];if(64!==n)break;if(s+="."+st(n),t+=12,5!==r[t++])break;t=it(r,t);const i=r[t++];let o=(248&i)>>3;31===o&&(o+=1+((7&i)<<3)+((224&r[t])>>5)),s+="."+o}break}case"hvc1":case"hev1":{const t=Z(r,["hvcC"])[0];if(t&&t.length>12){const e=t[1],r=["","A","B","C"][e>>6],n=31&e,i=X(t,2),o=(32&e)>>5?"H":"L",a=t[12],l=t.subarray(6,12);s+="."+r+n,s+="."+function(t){let e=0;for(let r=0;r<32;r++)e|=(t>>r&1)<<31-r;return e>>>0}(i).toString(16).toUpperCase(),s+="."+o+a;let c="";for(let t=l.length;t--;){const e=l[t];if(e||c){c="."+e.toString(16).toUpperCase()+c}}s+=c}i=nt("hev1"==a?"dvhe":"dvh1",r);break}case"dvh1":case"dvhe":case"dvav":case"dva1":case"dav1":s=nt(s,r)||s;break;case"vp09":{const t=Z(r,["vpcC"])[0];if(t&&t.length>6){const e=t[4],r=t[5],n=t[6]>>4&15;s+="."+ot(e)+"."+ot(r)+"."+ot(n)}break}case"av01":{const t=Z(r,["av1C"])[0];if(t&&t.length>2){const e=t[1]>>>5,n=31&t[1],o=t[2]>>>7?"H":"M",a=(64&t[2])>>6,l=(32&t[2])>>5,c=2===e&&a?l?12:10:a?10:8,u=(16&t[2])>>4,h=(8&t[2])>>3,d=(4&t[2])>>2,f=3&t[2],p=1,g=1,m=1,y=0;s+="."+e+"."+ot(n)+o+"."+ot(c)+"."+u+"."+h+d+f+"."+ot(p)+"."+ot(g)+"."+ot(m)+"."+y,i=nt("dav1",r)}break}}return{codec:s,encrypted:o,supplemental:i}}function nt(t,e){const r=Z(e,["dvvC"]),n=r.length?r[0]:Z(e,["dvcC"])[0];if(n){const e=n[2]>>1&127,r=n[2]<<5&32|n[3]>>3&31;return t+"."+ot(e)+"."+ot(r)}}function it(t,e){const r=e+5;for(;128&t[e++]&&e<r;);return e}function st(t){return("0"+t.toString(16).toUpperCase()).slice(-2)}function ot(t){return(t<10?"0":"")+t}function at(t){const e=Z(t,["schm"])[0];if(e){const r=W(e.subarray(4,8));if("cbcs"===r||"cenc"===r)return Z(t,["schi","tenc"])[0]}return null}function lt(t,e){const r=new Uint8Array(t.length+e.length);return r.set(t),r.set(e,t.length),r}function ct(t,e){const r=[],n=e.samples,i=e.timescale,s=e.id;let o=!1;return Z(n,["moof"]).map((a=>{const l=a.byteOffset-8;Z(a,["traf"]).map((a=>{const c=Z(a,["tfdt"]).map((t=>{const e=t[0];let r=X(t,4);return 1===e&&(r*=Math.pow(2,32),r+=X(t,8)),r/i}))[0];return void 0!==c&&(t=c),Z(a,["tfhd"]).map((c=>{const u=X(c,4),h=16777215&X(c,0);let d=0;const f=0!=(16&h);let p=0;const g=0!=(32&h);let m=8;u===s&&(0!=(1&h)&&(m+=8),0!=(2&h)&&(m+=4),0!=(8&h)&&(d=X(c,m),m+=4),f&&(p=X(c,m),m+=4),g&&(m+=4),"video"===e.type&&(o=ut(e.codec)),Z(a,["trun"]).map((s=>{const a=s[0],c=16777215&X(s,0),u=0!=(1&c);let h=0;const f=0!=(4&c),g=0!=(256&c);let m=0;const y=0!=(512&c);let v=0;const b=0!=(1024&c),E=0!=(2048&c);let A=0;const w=X(s,4);let T=8;u&&(h=X(s,T),T+=4),f&&(T+=4);let S=h+l;for(let l=0;l<w;l++){if(g?(m=X(s,T),T+=4):m=d,y?(v=X(s,T),T+=4):v=p,b&&(T+=4),E&&(A=0===a?X(s,T):J(s,T),T+=4),e.type===B.VIDEO){let e=0;for(;e<v;){const s=X(n,S);if(S+=4,ht(o,n[S])){dt(n.subarray(S,S+s),o?2:1,t+A/i,r)}S+=s,e+=s+4}}t+=m/i}})))}))}))})),r}function ut(t){if(!t)return!1;const e=t.substring(0,4);return"hvc1"===e||"hev1"===e||"dvh1"===e||"dvhe"===e}function ht(t,e){if(t){const t=e>>1&63;return 39===t||40===t}return 6===(31&e)}function dt(t,e,r,n){const i=ft(t);let s=0;s+=e;let o=0,a=0,l=0;for(;s<i.length;){o=0;do{if(s>=i.length)break;l=i[s++],o+=l}while(255===l);a=0;do{if(s>=i.length)break;l=i[s++],a+=l}while(255===l);const t=i.length-s;let e=s;if(a<t)s+=a;else if(a>t){T.error(`Malformed SEI payload. ${a} is too small, only ${t} bytes left to parse.`);break}if(4===o){if(181===i[e++]){const t=z(i,e);if(e+=2,49===t){const t=X(i,e);if(e+=4,1195456820===t){const t=i[e++];if(3===t){const s=i[e++],a=64&s,l=a?2+3*(31&s):0,c=new Uint8Array(l);if(a){c[0]=s;for(let t=1;t<l;t++)c[t]=i[e++]}n.push({type:t,payloadType:o,pts:r,bytes:c})}}}}}else if(5===o&&a>16){const t=[];for(let r=0;r<16;r++){const n=i[e++].toString(16);t.push(1==n.length?"0"+n:n),3!==r&&5!==r&&7!==r&&9!==r||t.push("-")}const s=a-16,l=new Uint8Array(s);for(let t=0;t<s;t++)l[t]=i[e++];n.push({payloadType:o,pts:r,uuid:t.join(""),userData:_(l),userDataBytes:l})}}}function ft(t){const e=t.byteLength,r=[];let n=1;for(;n<e-2;)0===t[n]&&0===t[n+1]&&3===t[n+2]?(r.push(n+2),n+=2):n++;if(0===r.length)return t;const i=e-r.length,s=new Uint8Array(i);let o=0;for(n=0;n<i;o++,n++)o===r[0]&&(o++,r.shift()),s[n]=t[o];return s}function pt(t,e,r){if(16!==t.byteLength)throw new RangeError("Invalid system id");let n,i,s;n=0,i=new Uint8Array,s=new Uint8Array;const o=new Uint8Array(4);return r.byteLength>0&&new DataView(o.buffer).setUint32(0,r.byteLength,!1),function(t,...e){const r=e.length;let n=8,i=r;for(;i--;)n+=e[i].byteLength;const s=new Uint8Array(n);for(s[0]=n>>24&255,s[1]=n>>16&255,s[2]=n>>8&255,s[3]=255&n,s.set(t,4),i=0,n=8;i<r;i++)s.set(e[i],n),n+=e[i].byteLength;return s}([112,115,115,104],new Uint8Array([0,0,0,0]),t,s,i,o,r)}const gt=()=>/\(Windows.+Firefox\//i.test(navigator.userAgent),mt={audio:{a3ds:1,"ac-3":.95,"ac-4":1,alac:.9,alaw:1,dra1:1,"dts+":1,"dts-":1,dtsc:1,dtse:1,dtsh:1,"ec-3":.9,enca:1,fLaC:.9,flac:.9,FLAC:.9,g719:1,g726:1,m4ae:1,mha1:1,mha2:1,mhm1:1,mhm2:1,mlpa:1,mp4a:1,"raw ":1,Opus:1,opus:1,samr:1,sawb:1,sawp:1,sevc:1,sqcp:1,ssmv:1,twos:1,ulaw:1},video:{avc1:1,avc2:1,avc3:1,avc4:1,avcp:1,av01:.8,dav1:.8,drac:1,dva1:1,dvav:1,dvh1:.7,dvhe:.7,encv:1,hev1:.75,hvc1:.75,mjp2:1,mp4v:1,mvc1:1,mvc2:1,mvc3:1,mvc4:1,resv:1,rv60:1,s263:1,svc1:1,svc2:1,"vc-1":1,vp08:1,vp09:.9},text:{stpp:1,wvtt:1}};function yt(t,e){const r=mt[e];return!!r&&!!r[t.slice(0,4)]}function vt(t,e,r=!0){return!t.split(",").some((t=>!bt(t,e,r)))}function bt(t,e,r=!0){var n;const i=S(r);return null!=(n=null==i?void 0:i.isTypeSupported(Et(t,e)))&&n}function Et(t,e){return`${e}/mp4;codecs=${t}`}function At(t){if(t){const e=t.substring(0,4);return mt.video[e]}return 2}function wt(t){const e=gt();return t.split(",").reduce(((t,r)=>{const n=e&&ut(r)?9:mt.video[r];return n?(2*n+t)/(t?3:2):(mt.audio[r]+t)/(t?2:1)}),0)}const Tt={};const St=/flac|opus|mp4a\.40\.34/i;function Lt(t,e=!0){return t.replace(St,(t=>function(t,e=!0){if(Tt[t])return Tt[t];const r={flac:["flac","fLaC","FLAC"],opus:["opus","Opus"],"mp4a.40.34":["mp3"]}[t];for(let i=0;i<r.length;i++){var n;if(bt(r[i],"audio",e))return Tt[t]=r[i],r[i];if("mp3"===r[i]&&null!=(n=S(e))&&n.isTypeSupported("audio/mpeg"))return""}return t}(t.toLowerCase(),e)))}function _t(t,e){if(t&&(t.length>4||-1!==["ac-3","ec-3","alac","fLaC","Opus"].indexOf(t))&&(xt(t,"audio")||xt(t,"video")))return t;if(e){const r=e.split(",");if(r.length>1){if(t)for(let e=r.length;e--;)if(r[e].substring(0,4)===t.substring(0,4))return r[e];return r[0]}}return e||t}function xt(t,e){return yt(t,e)&&bt(t,e)}function kt(t){if(t.startsWith("av01.")){const e=t.split("."),r=["0","111","01","01","01","0"];for(let t=e.length;t>4&&t<10;t++)e[t]=r[t-4];return e.join(".")}return t}function Pt(t){const e=S(t)||{isTypeSupported:()=>!1};return{mpeg:e.isTypeSupported("audio/mpeg"),mp3:e.isTypeSupported('audio/mp4; codecs="mp3"'),ac3:e.isTypeSupported('audio/mp4; codecs="ac-3"')}}function It(t){return t.replace(/^.+codecs=["']?([^"']+).*$/,"$1")}const Rt={supported:!1,smooth:!1,powerEfficient:!1},Ot={supported:!0,configurations:[],decodingInfoResults:[{supported:!0,powerEfficient:!0,smooth:!0}]};function Dt(t,e){return{supported:!1,configurations:e,decodingInfoResults:[Rt],error:t}}function Ct(t,e,r,i,s,o){const a=t.videoCodec,l=t.audioCodec?t.audioGroups:null,c=null==o?void 0:o.audioCodec,u=null==o?void 0:o.channels,h=u?parseInt(u):c?1/0:2;let d=null;if(null!=l&&l.length)try{d=1===l.length&&l[0]?e.groups[l[0]].channels:l.reduce(((t,r)=>{if(r){const n=e.groups[r];if(!n)throw new Error(`Audio track group ${r} not found`);Object.keys(n.channels).forEach((e=>{t[e]=(t[e]||0)+n.channels[e]}))}return t}),{2:0})}catch(t){return!0}return void 0!==a&&(a.split(",").some((t=>ut(t)))||t.width>1920&&t.height>1088||t.height>1920&&t.width>1088||t.frameRate>Math.max(i,30)||"SDR"!==t.videoRange&&t.videoRange!==r||t.bitrate>Math.max(s,8e6))||!!d&&n(h)&&Object.keys(d).some((t=>parseInt(t)>h))}function Mt(t,e,r,n={}){const i=t.videoCodec;if(!i&&!t.audioCodec||!r)return Promise.resolve(Ot);const s=[],o=function(t){var e;const r=null==(e=t.videoCodec)?void 0:e.split(","),n=Ft(t),i=t.width||640,s=t.height||480,o=t.frameRate||30,a=t.videoRange.toLowerCase();return r?r.map((t=>{const e={contentType:Et(kt(t),"video"),width:i,height:s,bitrate:n,framerate:o};return"sdr"!==a&&(e.transferFunction=a),e})):[]}(t),a=o.length,l=function(t,e,r){var n;const i=null==(n=t.audioCodec)?void 0:n.split(","),s=Ft(t);if(i&&t.audioGroups)return t.audioGroups.reduce(((t,n)=>{var o;const a=n?null==(o=e.groups[n])?void 0:o.tracks:null;return a?a.reduce(((t,e)=>{if(e.groupId===n){const n=parseFloat(e.channels||"");i.forEach((e=>{const i={contentType:Et(e,"audio"),bitrate:r?Nt(e,s):s};n&&(i.channels=""+n),t.push(i)}))}return t}),t):t}),[]);return[]}(t,e,a>0),c=l.length;for(let t=a||1*c||1;t--;){const e={type:"media-source"};if(a&&(e.video=o[t%a]),c){e.audio=l[t%c];const r=e.audio.bitrate;e.video&&r&&(e.video.bitrate-=r)}s.push(e)}if(i){const t=navigator.userAgent;if(i.split(",").some((t=>ut(t)))&&gt())return Promise.resolve(Dt(new Error(`Overriding Windows Firefox HEVC MediaCapabilities result based on user-agent string: (${t})`),s))}return Promise.all(s.map((t=>{const e=function(t){let e="";const{audio:r,video:n}=t;if(n){e+=`${It(n.contentType)}_r${n.height}x${n.width}f${Math.ceil(n.framerate)}${n.transferFunction||"sd"}_${Math.ceil(n.bitrate/1e5)}`}if(r){e+=`${n?"_":""}${It(r.contentType)}_c${r.channels}`}return e}(t);return n[e]||(n[e]=r.decodingInfo(t))}))).then((t=>({supported:!t.some((t=>!t.supported)),configurations:s,decodingInfoResults:t}))).catch((t=>({supported:!1,configurations:s,decodingInfoResults:[],error:t})))}function Nt(t,e){if(e<=1)return 1;let r=128e3;return"ec-3"===t?r=768e3:"ac-3"===t&&(r=64e4),Math.min(e/2,r)}function Ft(t){return 1e3*Math.ceil(Math.max(.9*t.bitrate,t.averageBitrate)/1e3)||1}const Ut=["NONE","TYPE-0","TYPE-1",null];const Bt=["SDR","PQ","HLG"];var $t={No:"",Yes:"YES",v2:"v2"};function jt(t){const{canSkipUntil:e,canSkipDateRanges:r,age:n}=t;return e&&n<e/2?r?$t.v2:$t.Yes:$t.No}class Gt{constructor(t,e,r){this.msn=void 0,this.part=void 0,this.skip=void 0,this.msn=t,this.part=e,this.skip=r}addDirectives(t){const e=new self.URL(t);return void 0!==this.msn&&e.searchParams.set("_HLS_msn",this.msn.toString()),void 0!==this.part&&e.searchParams.set("_HLS_part",this.part.toString()),this.skip&&e.searchParams.set("_HLS_skip",this.skip),e.href}}class Ht{constructor(t){if(this._attrs=void 0,this.audioCodec=void 0,this.bitrate=void 0,this.codecSet=void 0,this.url=void 0,this.frameRate=void 0,this.height=void 0,this.id=void 0,this.name=void 0,this.supplemental=void 0,this.videoCodec=void 0,this.width=void 0,this.details=void 0,this.fragmentError=0,this.loadError=0,this.loaded=void 0,this.realBitrate=0,this.supportedPromise=void 0,this.supportedResult=void 0,this._avgBitrate=0,this._audioGroups=void 0,this._subtitleGroups=void 0,this._urlId=0,this.url=[t.url],this._attrs=[t.attrs],this.bitrate=t.bitrate,t.details&&(this.details=t.details),this.id=t.id||0,this.name=t.name,this.width=t.width||0,this.height=t.height||0,this.frameRate=t.attrs.optionalFloat("FRAME-RATE",0),this._avgBitrate=t.attrs.decimalInteger("AVERAGE-BANDWIDTH"),this.audioCodec=t.audioCodec,this.videoCodec=t.videoCodec,this.codecSet=[t.videoCodec,t.audioCodec].filter((t=>!!t)).map((t=>t.substring(0,4))).join(","),"supplemental"in t){var e;this.supplemental=t.supplemental;const r=null==(e=t.supplemental)?void 0:e.videoCodec;r&&r!==t.videoCodec&&(this.codecSet+=`,${r.substring(0,4)}`)}this.addGroupId("audio",t.attrs.AUDIO),this.addGroupId("text",t.attrs.SUBTITLES)}get maxBitrate(){return Math.max(this.realBitrate,this.bitrate)}get averageBitrate(){return this._avgBitrate||this.realBitrate||this.bitrate}get attrs(){return this._attrs[0]}get codecs(){return this.attrs.CODECS||""}get pathwayId(){return this.attrs["PATHWAY-ID"]||"."}get videoRange(){return this.attrs["VIDEO-RANGE"]||"SDR"}get score(){return this.attrs.optionalFloat("SCORE",0)}get uri(){return this.url[0]||""}hasAudioGroup(t){return Vt(this._audioGroups,t)}hasSubtitleGroup(t){return Vt(this._subtitleGroups,t)}get audioGroups(){return this._audioGroups}get subtitleGroups(){return this._subtitleGroups}addGroupId(t,e){if(e)if("audio"===t){let t=this._audioGroups;t||(t=this._audioGroups=[]),-1===t.indexOf(e)&&t.push(e)}else if("text"===t){let t=this._subtitleGroups;t||(t=this._subtitleGroups=[]),-1===t.indexOf(e)&&t.push(e)}}get urlId(){return 0}set urlId(t){}get audioGroupIds(){return this.audioGroups?[this.audioGroupId]:void 0}get textGroupIds(){return this.subtitleGroups?[this.textGroupId]:void 0}get audioGroupId(){var t;return null==(t=this.audioGroups)?void 0:t[0]}get textGroupId(){var t;return null==(t=this.subtitleGroups)?void 0:t[0]}addFallback(){}}function Vt(t,e){return!(!e||!t)&&-1!==t.indexOf(e)}function Kt(t,e){let r=!1,n=[];if(t&&(r="SDR"!==t,n=[t]),e){n=e.allowedVideoRanges||Bt.slice(0);const t="SDR"!==n.join("")&&!e.videoCodec;r=void 0!==e.preferHDR?e.preferHDR:t&&function(){if("function"==typeof matchMedia){const t=matchMedia("(dynamic-range: high)"),e=matchMedia("bad query");if(t.media!==e.media)return!0===t.matches}return!1}(),r||(n=["SDR"])}return{preferHDR:r,allowedVideoRanges:n}}const Yt=(t,e)=>JSON.stringify(t,(t=>{const e=new WeakSet;return(r,n)=>{if(t&&(n=t(r,n)),"object"==typeof n&&null!==n){if(e.has(n))return;e.add(n)}return n}})(e));function qt(t,e){T.log(`[abr] start candidates with "${t}" ignored because ${e}`)}function Wt(t){return t.reduce(((t,e)=>{let r=t.groups[e.groupId];r||(r=t.groups[e.groupId]={tracks:[],channels:{2:0},hasDefault:!1,hasAutoSelect:!1}),r.tracks.push(e);const n=e.channels||"2";return r.channels[n]=(r.channels[n]||0)+1,r.hasDefault=r.hasDefault||e.default,r.hasAutoSelect=r.hasAutoSelect||e.autoselect,r.hasDefault&&(t.hasDefaultAudio=!0),r.hasAutoSelect&&(t.hasAutoSelectAudio=!0),t}),{hasDefaultAudio:!1,hasAutoSelectAudio:!1,groups:{}})}function zt(t){if(!t)return t;const{lang:e,assocLang:r,characteristics:n,channels:i,audioCodec:s}=t;return{lang:e,assocLang:r,characteristics:n,channels:i,audioCodec:s}}function Xt(t,e,r){if("attrs"in t){const r=e.indexOf(t);if(-1!==r)return r}for(let n=0;n<e.length;n++){if(Qt(t,e[n],r))return n}return-1}function Qt(t,e,r){const{groupId:n,name:i,lang:s,assocLang:o,default:a}=t,l=t.forced;return(void 0===n||e.groupId===n)&&(void 0===i||e.name===i)&&(void 0===s||function(t,e="--"){if(t.length===e.length)return t===e;return t.startsWith(e)||e.startsWith(t)}(s,e.lang))&&(void 0===s||e.assocLang===o)&&(void 0===a||e.default===a)&&(void 0===l||e.forced===l)&&(!("characteristics"in t)||function(t,e=""){const r=t.split(","),n=e.split(",");return r.length===n.length&&!r.some((t=>-1===n.indexOf(t)))}(t.characteristics||"",e.characteristics))&&(void 0===r||r(t,e))}function Jt(t,e){const{audioCodec:r,channels:n}=t;return!(void 0!==r&&(e.audioCodec||"").substring(0,4)!==r.substring(0,4)||void 0!==n&&n!==(e.channels||"2"))}function Zt(t,e,r){for(let n=e;n>-1;n--)if(r(t[n]))return n;for(let n=e+1;n<t.length;n++)if(r(t[n]))return n;return-1}function te(t,e){var r;return!!t&&t!==(null==(r=e.loadLevelObj)?void 0:r.uri)}const ee={search:function(t,e){let r=0,n=t.length-1,i=null,s=null;for(;r<=n;){i=(r+n)/2|0,s=t[i];const o=e(s);if(o>0)r=i+1;else{if(!(o<0))return s;n=i-1}}return null}};function re(t,e,r=0,n=0,i=.005){let s=null;if(t){s=e[1+t.sn-e[0].sn]||null;const n=t.endDTS-r;n>0&&n<15e-7&&(r+=15e-7),s&&t.level!==s.level&&s.end<=t.end&&(s=e[2+t.sn-e[0].sn]||null)}else 0===r&&0===e[0].start&&(s=e[0]);if(s&&((!t||t.level===s.level)&&0===ne(r,n,s)||function(t,e,r){if(e&&0===e.start&&e.level<t.level&&(e.endPTS||0)>0){const n=e.tagList.reduce(((t,e)=>("INF"===e[0]&&(t+=parseFloat(e[1])),t)),r);return t.start<=n}return!1}(s,t,Math.min(i,n))))return s;const o=ee.search(e,ne.bind(null,r,n));return!o||o===t&&s?s:o}function ne(t=0,e=0,r){if(r.start<=t&&r.start+r.duration>t)return 0;const n=Math.min(e,r.duration+(r.deltaPTS?r.deltaPTS:0));return r.start+r.duration-n<=t?1:r.start-n>t&&r.start?-1:0}function ie(t,e,r){const n=1e3*Math.min(e,r.duration+(r.deltaPTS?r.deltaPTS:0));return(r.endProgramDateTime||0)-n>t}function se(t,e,r){if(t&&t.startCC<=e&&t.endCC>=e){let n=t.fragments;const{fragmentHint:i}=t;let s;return i&&(n=n.concat(i)),ee.search(n,(t=>t.cc<e?1:t.cc>e?-1:(s=t,t.end<=r?1:t.start>r?-1:0))),s||null}return null}function oe(t){switch(t.details){case a.FRAG_LOAD_TIMEOUT:case a.KEY_LOAD_TIMEOUT:case a.LEVEL_LOAD_TIMEOUT:case a.MANIFEST_LOAD_TIMEOUT:return!0}return!1}function ae(t,e){const r=oe(e);return t.default[(r?"timeout":"error")+"Retry"]}function le(t,e){const r="linear"===t.backoff?1:Math.pow(2,e);return Math.min(r*t.retryDelayMs,t.maxRetryDelayMs)}function ce(t){return m(m({},t),{errorRetry:null,timeoutRetry:null})}function ue(t,e,r,n){if(!t)return!1;const i=null==n?void 0:n.code,s=e<t.maxNumRetry&&(function(t){return he(t)||!!t&&(t<400||t>499)}(i)||!!r);return t.shouldRetry?t.shouldRetry(t,e,r,n,s):s}function he(t){return 0===t&&!1===navigator.onLine}var de={DoNothing:0,SendEndCallback:1,SendAlternateToPenaltyBox:2,RemoveAlternatePermanently:3,InsertDiscontinuity:4,RetryRequest:5},fe={None:0,MoveAllAlternatesMatchingHost:1,MoveAllAlternatesMatchingHDCP:2,MoveAllAlternatesMatchingKey:4,SwitchToSDR:8};function pe(t){const e={action:de.DoNothing,flags:fe.None};return t&&(e.resolved=!0),e}var ge="NOT_LOADED",me="APPENDING",ye="PARTIAL",ve="OK";class be{constructor(t){this.activePartLists=Object.create(null),this.endListFragments=Object.create(null),this.fragments=Object.create(null),this.timeRanges=Object.create(null),this.bufferPadding=.2,this.hls=void 0,this.hasGaps=!1,this.hls=t,this._registerListeners()}_registerListeners(){const{hls:t}=this;t&&(t.on(l.MANIFEST_LOADING,this.onManifestLoading,this),t.on(l.BUFFER_APPENDED,this.onBufferAppended,this),t.on(l.FRAG_BUFFERED,this.onFragBuffered,this),t.on(l.FRAG_LOADED,this.onFragLoaded,this))}_unregisterListeners(){const{hls:t}=this;t&&(t.off(l.MANIFEST_LOADING,this.onManifestLoading,this),t.off(l.BUFFER_APPENDED,this.onBufferAppended,this),t.off(l.FRAG_BUFFERED,this.onFragBuffered,this),t.off(l.FRAG_LOADED,this.onFragLoaded,this))}destroy(){this._unregisterListeners(),this.hls=this.fragments=this.activePartLists=this.endListFragments=this.timeRanges=null}getAppendedFrag(t,e){const r=this.activePartLists[e];if(r)for(let e=r.length;e--;){const n=r[e];if(!n)break;if(n.start<=t&&t<=n.end&&n.loaded)return n}return this.getBufferedFrag(t,e)}getBufferedFrag(t,e){return this.getFragAtPos(t,e,!0)}getFragAtPos(t,e,r){const{fragments:n}=this,i=Object.keys(n);for(let s=i.length;s--;){const o=n[i[s]];if((null==o?void 0:o.body.type)===e&&(!r||o.buffered)){const e=o.body;if(e.start<=t&&t<=e.end)return e}}return null}detectEvictedFragments(t,e,r,n,i){this.timeRanges&&(this.timeRanges[t]=e);const s=(null==n?void 0:n.fragment.sn)||-1;Object.keys(this.fragments).forEach((n=>{const o=this.fragments[n];if(!o)return;if(s>=o.body.sn)return;if(!o.buffered&&(!o.loaded||i))return void(o.body.type===r&&this.removeFragment(o.body));const a=o.range[t];a&&(0!==a.time.length?a.time.some((t=>{const r=!this.isTimeBuffered(t.startPTS,t.endPTS,e);return r&&this.removeFragment(o.body),r})):this.removeFragment(o.body))}))}detectPartialFragments(t){const e=this.timeRanges;if(!e||"initSegment"===t.frag.sn)return;const r=t.frag,n=Ae(r),i=this.fragments[n];if(!i||i.buffered&&r.gap)return;const s=!r.relurl;if(Object.keys(e).forEach((n=>{const o=r.elementaryStreams[n];if(!o)return;const a=e[n],l=s||!0===o.partial;i.range[n]=this.getBufferedTimes(r,t.part,l,a)})),i.loaded=null,Object.keys(i.range).length){i.buffered=!0;(i.body.endList=r.endList||i.body.endList)&&(this.endListFragments[i.body.type]=i),Ee(i)||this.removeParts(r.sn-1,r.type)}else this.removeFragment(i.body)}removeParts(t,e){const r=this.activePartLists[e];r&&(this.activePartLists[e]=we(r,(e=>e.fragment.sn>=t)))}fragBuffered(t,e){const r=Ae(t);let n=this.fragments[r];!n&&e&&(n=this.fragments[r]={body:t,appendedPTS:null,loaded:null,buffered:!1,range:Object.create(null)},t.gap&&(this.hasGaps=!0)),n&&(n.loaded=null,n.buffered=!0)}getBufferedTimes(t,e,r,n){const i={time:[],partial:r},s=t.start,o=t.end,a=t.minEndPTS||o,l=t.maxStartPTS||s;for(let t=0;t<n.length;t++){const e=n.start(t)-this.bufferPadding,r=n.end(t)+this.bufferPadding;if(l>=e&&a<=r){i.time.push({startPTS:Math.max(s,n.start(t)),endPTS:Math.min(o,n.end(t))});break}if(s<r&&o>e){const e=Math.max(s,n.start(t)),r=Math.min(o,n.end(t));r>e&&(i.partial=!0,i.time.push({startPTS:e,endPTS:r}))}else if(o<=e)break}return i}getPartialFragment(t){let e,r,n,i=null,s=0;const{bufferPadding:o,fragments:a}=this;return Object.keys(a).forEach((l=>{const c=a[l];c&&Ee(c)&&(r=c.body.start-o,n=c.body.end+o,t>=r&&t<=n&&(e=Math.min(t-r,n-t),s<=e&&(i=c.body,s=e)))})),i}isEndListAppended(t){const e=this.endListFragments[t];return void 0!==e&&(e.buffered||Ee(e))}getState(t){const e=Ae(t),r=this.fragments[e];return r?r.buffered?Ee(r)?ye:ve:me:ge}isTimeBuffered(t,e,r){let n,i;for(let s=0;s<r.length;s++){if(n=r.start(s)-this.bufferPadding,i=r.end(s)+this.bufferPadding,t>=n&&e<=i)return!0;if(e<=n)return!1}return!1}onManifestLoading(){this.removeAllFragments()}onFragLoaded(t,e){if("initSegment"===e.frag.sn||e.frag.bitrateTest)return;const r=e.frag,n=e.part?null:e,i=Ae(r);this.fragments[i]={body:r,appendedPTS:null,loaded:n,buffered:!1,range:Object.create(null)}}onBufferAppended(t,e){const{frag:r,part:n,timeRanges:i,type:s}=e;if("initSegment"===r.sn)return;const o=r.type;if(n){let t=this.activePartLists[o];t||(this.activePartLists[o]=t=[]),t.push(n)}this.timeRanges=i;const a=i[s];this.detectEvictedFragments(s,a,o,n)}onFragBuffered(t,e){this.detectPartialFragments(e)}hasFragment(t){const e=Ae(t);return!!this.fragments[e]}hasFragments(t){const{fragments:e}=this,r=Object.keys(e);if(!t)return r.length>0;for(let n=r.length;n--;){const i=e[r[n]];if((null==i?void 0:i.body.type)===t)return!0}return!1}hasParts(t){var e;return!(null==(e=this.activePartLists[t])||!e.length)}removeFragmentsInRange(t,e,r,n,i){n&&!this.hasGaps||Object.keys(this.fragments).forEach((s=>{const o=this.fragments[s];if(!o)return;const a=o.body;a.type!==r||n&&!a.gap||a.start<e&&a.end>t&&(o.buffered||i)&&this.removeFragment(a)}))}removeFragment(t){const e=Ae(t);t.clearElementaryStreamInfo();const r=this.activePartLists[t.type];if(r){const e=t.sn;this.activePartLists[t.type]=we(r,(t=>t.fragment.sn!==e))}delete this.fragments[e],t.endList&&delete this.endListFragments[t.type]}removeAllFragments(){var t;this.fragments=Object.create(null),this.endListFragments=Object.create(null),this.activePartLists=Object.create(null),this.hasGaps=!1;const e=null==(t=this.hls)||null==(t=t.latestLevelDetails)?void 0:t.partList;e&&e.forEach((t=>t.clearElementaryStreamInfo()))}}function Ee(t){var e,r,n;return t.buffered&&!!(t.body.gap||null!=(e=t.range.video)&&e.partial||null!=(r=t.range.audio)&&r.partial||null!=(n=t.range.audiovideo)&&n.partial)}function Ae(t){return`${t.type}_${t.level}_${t.sn}`}function we(t,e){return t.filter((t=>{const r=e(t);return r||t.clearElementaryStreamInfo(),r}))}var Te={cbc:0,ctr:1};class Se{constructor(t,e,r){this.subtle=void 0,this.aesIV=void 0,this.aesMode=void 0,this.subtle=t,this.aesIV=e,this.aesMode=r}decrypt(t,e){switch(this.aesMode){case Te.cbc:return this.subtle.decrypt({name:"AES-CBC",iv:this.aesIV},e,t);case Te.ctr:return this.subtle.decrypt({name:"AES-CTR",counter:this.aesIV,length:64},e,t);default:throw new Error(`[AESCrypto] invalid aes mode ${this.aesMode}`)}}}class Le{constructor(){this.rcon=[0,1,2,4,8,16,32,64,128,27,54],this.subMix=[new Uint32Array(256),new Uint32Array(256),new Uint32Array(256),new Uint32Array(256)],this.invSubMix=[new Uint32Array(256),new Uint32Array(256),new Uint32Array(256),new Uint32Array(256)],this.sBox=new Uint32Array(256),this.invSBox=new Uint32Array(256),this.key=new Uint32Array(0),this.ksRows=0,this.keySize=0,this.keySchedule=void 0,this.invKeySchedule=void 0,this.initTable()}uint8ArrayToUint32Array_(t){const e=new DataView(t),r=new Uint32Array(4);for(let t=0;t<4;t++)r[t]=e.getUint32(4*t);return r}initTable(){const t=this.sBox,e=this.invSBox,r=this.subMix,n=r[0],i=r[1],s=r[2],o=r[3],a=this.invSubMix,l=a[0],c=a[1],u=a[2],h=a[3],d=new Uint32Array(256);let f=0,p=0,g=0;for(g=0;g<256;g++)d[g]=g<128?g<<1:g<<1^283;for(g=0;g<256;g++){let r=p^p<<1^p<<2^p<<3^p<<4;r=r>>>8^255&r^99,t[f]=r,e[r]=f;const a=d[f],g=d[a],m=d[g];let y=257*d[r]^16843008*r;n[f]=y<<24|y>>>8,i[f]=y<<16|y>>>16,s[f]=y<<8|y>>>24,o[f]=y,y=16843009*m^65537*g^257*a^16843008*f,l[r]=y<<24|y>>>8,c[r]=y<<16|y>>>16,u[r]=y<<8|y>>>24,h[r]=y,f?(f=a^d[d[d[m^a]]],p^=d[d[p]]):f=p=1}}expandKey(t){const e=this.uint8ArrayToUint32Array_(t);let r=!0,n=0;for(;n<e.length&&r;)r=e[n]===this.key[n],n++;if(r)return;this.key=e;const i=this.keySize=e.length;if(4!==i&&6!==i&&8!==i)throw new Error("Invalid aes key size="+i);const s=this.ksRows=4*(i+6+1);let o,a;const l=this.keySchedule=new Uint32Array(s),c=this.invKeySchedule=new Uint32Array(s),u=this.sBox,h=this.rcon,d=this.invSubMix,f=d[0],p=d[1],g=d[2],m=d[3];let y,v;for(o=0;o<s;o++)o<i?y=l[o]=e[o]:(v=y,o%i==0?(v=v<<8|v>>>24,v=u[v>>>24]<<24|u[v>>>16&255]<<16|u[v>>>8&255]<<8|u[255&v],v^=h[o/i|0]<<24):i>6&&o%i==4&&(v=u[v>>>24]<<24|u[v>>>16&255]<<16|u[v>>>8&255]<<8|u[255&v]),l[o]=y=(l[o-i]^v)>>>0);for(a=0;a<s;a++)o=s-a,v=3&a?l[o]:l[o-4],c[a]=a<4||o<=4?v:f[u[v>>>24]]^p[u[v>>>16&255]]^g[u[v>>>8&255]]^m[u[255&v]],c[a]=c[a]>>>0}networkToHostOrderSwap(t){return t<<24|(65280&t)<<8|(16711680&t)>>8|t>>>24}decrypt(t,e,r){const n=this.keySize+6,i=this.invKeySchedule,s=this.invSBox,o=this.invSubMix,a=o[0],l=o[1],c=o[2],u=o[3],h=this.uint8ArrayToUint32Array_(r);let d=h[0],f=h[1],p=h[2],g=h[3];const m=new Int32Array(t),y=new Int32Array(m.length);let v,b,E,A,w,T,S,L,_,x,k,P,I,R;const O=this.networkToHostOrderSwap;for(;e<m.length;){for(_=O(m[e]),x=O(m[e+1]),k=O(m[e+2]),P=O(m[e+3]),w=_^i[0],T=P^i[1],S=k^i[2],L=x^i[3],I=4,R=1;R<n;R++)v=a[w>>>24]^l[T>>16&255]^c[S>>8&255]^u[255&L]^i[I],b=a[T>>>24]^l[S>>16&255]^c[L>>8&255]^u[255&w]^i[I+1],E=a[S>>>24]^l[L>>16&255]^c[w>>8&255]^u[255&T]^i[I+2],A=a[L>>>24]^l[w>>16&255]^c[T>>8&255]^u[255&S]^i[I+3],w=v,T=b,S=E,L=A,I+=4;v=s[w>>>24]<<24^s[T>>16&255]<<16^s[S>>8&255]<<8^s[255&L]^i[I],b=s[T>>>24]<<24^s[S>>16&255]<<16^s[L>>8&255]<<8^s[255&w]^i[I+1],E=s[S>>>24]<<24^s[L>>16&255]<<16^s[w>>8&255]<<8^s[255&T]^i[I+2],A=s[L>>>24]<<24^s[w>>16&255]<<16^s[T>>8&255]<<8^s[255&S]^i[I+3],y[e]=O(v^d),y[e+1]=O(A^f),y[e+2]=O(E^p),y[e+3]=O(b^g),d=_,f=x,p=k,g=P,e+=4}return y.buffer}}class _e{constructor(t,e,r){this.subtle=void 0,this.key=void 0,this.aesMode=void 0,this.subtle=t,this.key=e,this.aesMode=r}expandKey(){const t=function(t){switch(t){case Te.cbc:return"AES-CBC";case Te.ctr:return"AES-CTR";default:throw new Error(`[FastAESKey] invalid aes mode ${t}`)}}(this.aesMode);return this.subtle.importKey("raw",this.key,{name:t},!1,["encrypt","decrypt"])}}class xe{constructor(t,{removePKCS7Padding:e=!0}={}){if(this.logEnabled=!0,this.removePKCS7Padding=void 0,this.subtle=null,this.softwareDecrypter=null,this.key=null,this.fastAesKey=null,this.remainderData=null,this.currentIV=null,this.currentResult=null,this.useSoftware=void 0,this.enableSoftwareAES=void 0,this.enableSoftwareAES=t.enableSoftwareAES,this.removePKCS7Padding=e,e)try{const t=self.crypto;t&&(this.subtle=t.subtle||t.webkitSubtle)}catch(t){}this.useSoftware=!this.subtle}destroy(){this.subtle=null,this.softwareDecrypter=null,this.key=null,this.fastAesKey=null,this.remainderData=null,this.currentIV=null,this.currentResult=null}isSync(){return this.useSoftware}flush(){const{currentResult:t,remainderData:e}=this;if(!t||e)return this.reset(),null;const r=new Uint8Array(t);return this.reset(),this.removePKCS7Padding?function(t){const e=t.byteLength,r=e&&new DataView(t.buffer).getUint8(e-1);return r?t.slice(0,e-r):t}(r):r}reset(){this.currentResult=null,this.currentIV=null,this.remainderData=null,this.softwareDecrypter&&(this.softwareDecrypter=null)}decrypt(t,e,r,n){return this.useSoftware?new Promise(((i,s)=>{const o=ArrayBuffer.isView(t)?t:new Uint8Array(t);this.softwareDecrypt(o,e,r,n);const a=this.flush();a?i(a.buffer):s(new Error("[softwareDecrypt] Failed to decrypt data"))})):this.webCryptoDecrypt(new Uint8Array(t),e,r,n)}softwareDecrypt(t,e,r,n){const{currentIV:i,currentResult:s,remainderData:o}=this;if(n!==Te.cbc||16!==e.byteLength)return T.warn("SoftwareDecrypt: can only handle AES-128-CBC"),null;this.logOnce("JS AES decrypt"),o&&(t=lt(o,t),this.remainderData=null);const a=this.getValidChunk(t);if(!a.length)return null;i&&(r=i);let l=this.softwareDecrypter;l||(l=this.softwareDecrypter=new Le),l.expandKey(e);const c=s;return this.currentResult=l.decrypt(a.buffer,0,r),this.currentIV=a.slice(-16).buffer,c||null}webCryptoDecrypt(t,e,r,n){if(this.key!==e||!this.fastAesKey){if(!this.subtle)return Promise.resolve(this.onWebCryptoError(t,e,r,n));this.key=e,this.fastAesKey=new _e(this.subtle,e,n)}return this.fastAesKey.expandKey().then((e=>{if(!this.subtle)return Promise.reject(new Error("web crypto not initialized"));this.logOnce("WebCrypto AES decrypt");return new Se(this.subtle,new Uint8Array(r),n).decrypt(t.buffer,e)})).catch((i=>(T.warn(`[decrypter]: WebCrypto Error, disable WebCrypto API, ${i.name}: ${i.message}`),this.onWebCryptoError(t,e,r,n))))}onWebCryptoError(t,e,r,n){const i=this.enableSoftwareAES;if(i){this.useSoftware=!0,this.logEnabled=!0,this.softwareDecrypt(t,e,r,n);const i=this.flush();if(i)return i.buffer}throw new Error("WebCrypto"+(i?" and softwareDecrypt":"")+": failed to decrypt data")}getValidChunk(t){let e=t;const r=t.length-t.length%16;return r!==t.length&&(e=t.slice(0,r),this.remainderData=t.slice(r)),e}logOnce(t){this.logEnabled&&(T.log(`[decrypter]: ${t}`),this.logEnabled=!1)}}const ke=Math.pow(2,17);class Pe{constructor(t){this.config=void 0,this.loader=null,this.partLoadTimeout=-1,this.config=t}destroy(){this.loader&&(this.loader.destroy(),this.loader=null)}abort(){this.loader&&this.loader.abort()}load(t,e){const r=t.url;if(!r)return Promise.reject(new Oe({type:o.NETWORK_ERROR,details:a.FRAG_LOAD_ERROR,fatal:!1,frag:t,error:new Error("Fragment does not have a "+(r?"part list":"url")),networkDetails:null}));this.abort();const n=this.config,i=n.fLoader,s=n.loader;return new Promise(((l,c)=>{if(this.loader&&this.loader.destroy(),t.gap){if(t.tagList.some((t=>"GAP"===t[0])))return void c(Re(t));t.gap=!1}const u=this.loader=i?new i(n):new s(n),h=Ie(t);t.loader=u;const d=ce(n.fragLoadPolicy.default),f={loadPolicy:d,timeout:d.maxLoadTimeMs,maxRetry:0,retryDelay:0,maxRetryDelay:0,highWaterMark:"initSegment"===t.sn?1/0:ke};t.stats=u.stats;const p={onSuccess:(e,r,n,i)=>{this.resetLoader(t,u);let s=e.data;n.resetIV&&t.decryptdata&&(t.decryptdata.iv=new Uint8Array(s.slice(0,16)),s=s.slice(16)),l({frag:t,part:null,payload:s,networkDetails:i})},onError:(e,n,i,s)=>{this.resetLoader(t,u),c(new Oe({type:o.NETWORK_ERROR,details:a.FRAG_LOAD_ERROR,fatal:!1,frag:t,response:m({url:r,data:void 0},e),error:new Error(`HTTP Error ${e.code} ${e.text}`),networkDetails:i,stats:s}))},onAbort:(e,r,n)=>{this.resetLoader(t,u),c(new Oe({type:o.NETWORK_ERROR,details:a.INTERNAL_ABORTED,fatal:!1,frag:t,error:new Error("Aborted"),networkDetails:n,stats:e}))},onTimeout:(e,r,n)=>{this.resetLoader(t,u),c(new Oe({type:o.NETWORK_ERROR,details:a.FRAG_LOAD_TIMEOUT,fatal:!1,frag:t,error:new Error(`Timeout after ${f.timeout}ms`),networkDetails:n,stats:e}))}};e&&(p.onProgress=(r,n,i,s)=>e({frag:t,part:null,payload:i,networkDetails:s})),u.load(h,f,p)}))}loadPart(t,e,r){this.abort();const n=this.config,i=n.fLoader,s=n.loader;return new Promise(((l,c)=>{if(this.loader&&this.loader.destroy(),t.gap||e.gap)return void c(Re(t,e));const u=this.loader=i?new i(n):new s(n),h=Ie(t,e);t.loader=u;const d=ce(n.fragLoadPolicy.default),f={loadPolicy:d,timeout:d.maxLoadTimeMs,maxRetry:0,retryDelay:0,maxRetryDelay:0,highWaterMark:ke};e.stats=u.stats,u.load(h,f,{onSuccess:(n,i,s,o)=>{this.resetLoader(t,u),this.updateStatsFromPart(t,e);const a={frag:t,part:e,payload:n.data,networkDetails:o};r(a),l(a)},onError:(r,n,i,s)=>{this.resetLoader(t,u),c(new Oe({type:o.NETWORK_ERROR,details:a.FRAG_LOAD_ERROR,fatal:!1,frag:t,part:e,response:m({url:h.url,data:void 0},r),error:new Error(`HTTP Error ${r.code} ${r.text}`),networkDetails:i,stats:s}))},onAbort:(r,n,i)=>{t.stats.aborted=e.stats.aborted,this.resetLoader(t,u),c(new Oe({type:o.NETWORK_ERROR,details:a.INTERNAL_ABORTED,fatal:!1,frag:t,part:e,error:new Error("Aborted"),networkDetails:i,stats:r}))},onTimeout:(r,n,i)=>{this.resetLoader(t,u),c(new Oe({type:o.NETWORK_ERROR,details:a.FRAG_LOAD_TIMEOUT,fatal:!1,frag:t,part:e,error:new Error(`Timeout after ${f.timeout}ms`),networkDetails:i,stats:r}))}})}))}updateStatsFromPart(t,e){const r=t.stats,n=e.stats,i=n.total;if(r.loaded+=n.loaded,i){const n=Math.round(t.duration/e.duration),s=Math.min(Math.round(r.loaded/i),n),o=(n-s)*Math.round(r.loaded/s);r.total=r.loaded+o}else r.total=Math.max(r.loaded,r.total);const s=r.loading,o=n.loading;s.start?s.first+=o.first-o.start:(s.start=o.start,s.first=o.first),s.end=o.end}resetLoader(t,e){t.loader=null,this.loader===e&&(self.clearTimeout(this.partLoadTimeout),this.loader=null),e.destroy()}}function Ie(t,e=null){const r=e||t,i={frag:t,part:e,responseType:"arraybuffer",url:r.url,headers:{},rangeStart:0,rangeEnd:0},s=r.byteRangeStartOffset,o=r.byteRangeEndOffset;if(n(s)&&n(o)){var a;let e=s,r=o;if("initSegment"===t.sn&&("AES-128"===(l=null==(a=t.decryptdata)?void 0:a.method)||"AES-256"===l)){const t=o-s;t%16&&(r=o+(16-t%16)),0!==s&&(i.resetIV=!0,e=s-16)}i.rangeStart=e,i.rangeEnd=r}var l;return i}function Re(t,e){const r=new Error(`GAP ${t.gap?"tag":"attribute"} found`),n={type:o.MEDIA_ERROR,details:a.FRAG_GAP,fatal:!1,frag:t,error:r,networkDetails:null};return e&&(n.part=e),(e||t).stats.aborted=!0,new Oe(n)}class Oe extends Error{constructor(t){super(t.error.message),this.data=void 0,this.data=t}}class De extends y{constructor(t,e){super(t,e),this._boundTick=void 0,this._tickTimer=null,this._tickInterval=null,this._tickCallCount=0,this._boundTick=this.tick.bind(this)}destroy(){this.onHandlerDestroying(),this.onHandlerDestroyed()}onHandlerDestroying(){this.clearNextTick(),this.clearInterval()}onHandlerDestroyed(){}hasInterval(){return!!this._tickInterval}hasNextTick(){return!!this._tickTimer}setInterval(t){return!this._tickInterval&&(this._tickCallCount=0,this._tickInterval=self.setInterval(this._boundTick,t),!0)}clearInterval(){return!!this._tickInterval&&(self.clearInterval(this._tickInterval),this._tickInterval=null,!0)}clearNextTick(){return!!this._tickTimer&&(self.clearTimeout(this._tickTimer),this._tickTimer=null,!0)}tick(){this._tickCallCount++,1===this._tickCallCount&&(this.doTick(),this._tickCallCount>1&&this.tickImmediate(),this._tickCallCount=0)}tickImmediate(){this.clearNextTick(),this._tickTimer=self.setTimeout(this._boundTick,0)}doTick(){}}class Ce{constructor(t,e,r,n=0,i=-1,s=!1){this.level=void 0,this.sn=void 0,this.part=void 0,this.id=void 0,this.size=void 0,this.partial=void 0,this.transmuxing={start:0,executeStart:0,executeEnd:0,end:0},this.buffering={audio:{start:0,executeStart:0,executeEnd:0,end:0},video:{start:0,executeStart:0,executeEnd:0,end:0},audiovideo:{start:0,executeStart:0,executeEnd:0,end:0}},this.level=t,this.sn=e,this.id=r,this.size=n,this.part=i,this.partial=s}}const Me={length:0,start:()=>0,end:()=>0};class Ne{static isBuffered(t,e){if(t){const r=Ne.getBuffered(t);for(let t=r.length;t--;)if(e>=r.start(t)&&e<=r.end(t))return!0}return!1}static bufferedRanges(t){if(t){const e=Ne.getBuffered(t);return Ne.timeRangesToArray(e)}return[]}static timeRangesToArray(t){const e=[];for(let r=0;r<t.length;r++)e.push({start:t.start(r),end:t.end(r)});return e}static bufferInfo(t,e,r){if(t){const n=Ne.bufferedRanges(t);if(n.length)return Ne.bufferedInfo(n,e,r)}return{len:0,start:e,end:e,bufferedIndex:-1}}static bufferedInfo(t,e,r){e=Math.max(0,e),t.length>1&&t.sort(((t,e)=>t.start-e.start||e.end-t.end));let n=-1,i=[];if(r)for(let s=0;s<t.length;s++){e>=t[s].start&&e<=t[s].end&&(n=s);const o=i.length;if(o){const e=i[o-1].end;t[s].start-e<r?t[s].end>e&&(i[o-1].end=t[s].end):i.push(t[s])}else i.push(t[s])}else i=t;let s,o=0,a=e,l=e;for(let t=0;t<i.length;t++){const c=i[t].start,u=i[t].end;if(-1===n&&e>=c&&e<=u&&(n=t),e+r>=c&&e<u)a=c,l=u,o=l-e;else if(e+r<c){s=c;break}}return{len:o,start:a||0,end:l||0,nextStart:s,buffered:t,bufferedIndex:n}}static getBuffered(t){try{return t.buffered||Me}catch(t){return T.log("failed to get media.buffered",t),Me}}}const Fe=/\{\$([a-zA-Z0-9-_]+)\}/g;function Ue(t){return Fe.test(t)}function Be(t,e){if(null!==t.variableList||t.hasVariableRefs){const r=t.variableList;return e.replace(Fe,(e=>{const n=e.substring(2,e.length-1),i=null==r?void 0:r[n];return void 0===i?(t.playlistParsingError||(t.playlistParsingError=new Error(`Missing preceding EXT-X-DEFINE tag for Variable Reference: "${n}"`)),e):i}))}return e}function $e(t,e,r){let n,i,s=t.variableList;if(s||(t.variableList=s={}),"QUERYPARAM"in e){n=e.QUERYPARAM;try{const t=new self.URL(r).searchParams;if(!t.has(n))throw new Error(`"${n}" does not match any query parameter in URI: "${r}"`);i=t.get(n)}catch(e){t.playlistParsingError||(t.playlistParsingError=new Error(`EXT-X-DEFINE QUERYPARAM: ${e.message}`))}}else n=e.NAME,i=e.VALUE;n in s?t.playlistParsingError||(t.playlistParsingError=new Error(`EXT-X-DEFINE duplicate Variable Name declarations: "${n}"`)):s[n]=i||""}function je(t,e,r){const n=e.IMPORT;if(r&&n in r){let e=t.variableList;e||(t.variableList=e={}),e[n]=r[n]}else t.playlistParsingError||(t.playlistParsingError=new Error(`EXT-X-DEFINE IMPORT attribute not found in Multivariant Playlist: "${n}"`))}const Ge=/^(\d+)x(\d+)$/,He=/(.+?)=(".*?"|.*?)(?:,|$)/g;class Ve{constructor(t,e){"string"==typeof t&&(t=Ve.parseAttrList(t,e)),p(this,t)}get clientAttrs(){return Object.keys(this).filter((t=>"X-"===t.substring(0,2)))}decimalInteger(t){const e=parseInt(this[t],10);return e>Number.MAX_SAFE_INTEGER?1/0:e}hexadecimalInteger(t){if(this[t]){let e=(this[t]||"0x").slice(2);e=(1&e.length?"0":"")+e;const r=new Uint8Array(e.length/2);for(let t=0;t<e.length/2;t++)r[t]=parseInt(e.slice(2*t,2*t+2),16);return r}return null}hexadecimalIntegerAsNumber(t){const e=parseInt(this[t],16);return e>Number.MAX_SAFE_INTEGER?1/0:e}decimalFloatingPoint(t){return parseFloat(this[t])}optionalFloat(t,e){const r=this[t];return r?parseFloat(r):e}enumeratedString(t){return this[t]}enumeratedStringList(t,e){const r=this[t];return(r?r.split(/[ ,]+/):[]).reduce(((t,e)=>(t[e.toLowerCase()]=!0,t)),e)}bool(t){return"YES"===this[t]}decimalResolution(t){const e=Ge.exec(this[t]);if(null!==e)return{width:parseInt(e[1],10),height:parseInt(e[2],10)}}static parseAttrList(t,e){let r;const n={};for(He.lastIndex=0;null!==(r=He.exec(t));){const i=r[1].trim();let s=r[2];const o=0===s.indexOf('"')&&s.lastIndexOf('"')===s.length-1;let a=!1;if(o)s=s.slice(1,-1);else switch(i){case"IV":case"SCTE35-CMD":case"SCTE35-IN":case"SCTE35-OUT":a=!0}if(e&&(o||a))s=Be(e,s);else if(!a&&!o)switch(i){case"CLOSED-CAPTIONS":if("NONE"===s)break;case"ALLOWED-CPC":case"CLASS":case"ASSOC-LANGUAGE":case"AUDIO":case"BYTERANGE":case"CHANNELS":case"CHARACTERISTICS":case"CODECS":case"DATA-ID":case"END-DATE":case"GROUP-ID":case"ID":case"IMPORT":case"INSTREAM-ID":case"KEYFORMAT":case"KEYFORMATVERSIONS":case"LANGUAGE":case"NAME":case"PATHWAY-ID":case"QUERYPARAM":case"RECENTLY-REMOVED-DATERANGES":case"SERVER-URI":case"STABLE-RENDITION-ID":case"STABLE-VARIANT-ID":case"START-DATE":case"SUBTITLES":case"SUPPLEMENTAL-CODECS":case"URI":case"VALUE":case"VIDEO":case"X-ASSET-LIST":case"X-ASSET-URI":T.warn(`${t}: attribute ${i} is missing quotes`)}n[i]=s}return n}}function Ke(t){return"SCTE35-OUT"===t||"SCTE35-IN"===t||"SCTE35-CMD"===t}class Ye{constructor(t,e,r=0){var i;if(this.attr=void 0,this.tagAnchor=void 0,this.tagOrder=void 0,this._startDate=void 0,this._endDate=void 0,this._dateAtEnd=void 0,this._cue=void 0,this._badValueForSameId=void 0,this.tagAnchor=(null==e?void 0:e.tagAnchor)||null,this.tagOrder=null!=(i=null==e?void 0:e.tagOrder)?i:r,e){const r=e.attr;for(const e in r)if(Object.prototype.hasOwnProperty.call(t,e)&&t[e]!==r[e]){T.warn(`DATERANGE tag attribute: "${e}" does not match for tags with ID: "${t.ID}"`),this._badValueForSameId=e;break}t=p(new Ve({}),r,t)}if(this.attr=t,e?(this._startDate=e._startDate,this._cue=e._cue,this._endDate=e._endDate,this._dateAtEnd=e._dateAtEnd):this._startDate=new Date(t["START-DATE"]),"END-DATE"in this.attr){const t=(null==e?void 0:e.endDate)||new Date(this.attr["END-DATE"]);n(t.getTime())&&(this._endDate=t)}}get id(){return this.attr.ID}get class(){return this.attr.CLASS}get cue(){const t=this._cue;return void 0===t?this._cue=this.attr.enumeratedStringList(this.attr.CUE?"CUE":"X-CUE",{pre:!1,post:!1,once:!1}):t}get startTime(){const{tagAnchor:t}=this;return null===t||null===t.programDateTime?(T.warn(`Expected tagAnchor Fragment with PDT set for DateRange "${this.id}": ${t}`),NaN):t.start+(this.startDate.getTime()-t.programDateTime)/1e3}get startDate(){return this._startDate}get endDate(){const t=this._endDate||this._dateAtEnd;if(t)return t;const e=this.duration;return null!==e?this._dateAtEnd=new Date(this._startDate.getTime()+1e3*e):null}get duration(){if("DURATION"in this.attr){const t=this.attr.decimalFloatingPoint("DURATION");if(n(t))return t}else if(this._endDate)return(this._endDate.getTime()-this._startDate.getTime())/1e3;return null}get plannedDuration(){return"PLANNED-DURATION"in this.attr?this.attr.decimalFloatingPoint("PLANNED-DURATION"):null}get endOnNext(){return this.attr.bool("END-ON-NEXT")}get isInterstitial(){return"com.apple.hls.interstitial"===this.class}get isValid(){return!!this.id&&!this._badValueForSameId&&n(this.startDate.getTime())&&(null===this.duration||this.duration>=0)&&(!this.endOnNext||!!this.class)&&(!this.attr.CUE||!this.cue.pre&&!this.cue.post||this.cue.pre!==this.cue.post)&&(!this.isInterstitial||"X-ASSET-URI"in this.attr||"X-ASSET-LIST"in this.attr)}}class qe{constructor(t){this.PTSKnown=!1,this.alignedSliding=!1,this.averagetargetduration=void 0,this.endCC=0,this.endSN=0,this.fragments=void 0,this.fragmentHint=void 0,this.partList=null,this.dateRanges=void 0,this.dateRangeTagCount=0,this.live=!0,this.requestScheduled=-1,this.ageHeader=0,this.advancedDateTime=void 0,this.updated=!0,this.advanced=!0,this.misses=0,this.startCC=0,this.startSN=0,this.startTimeOffset=null,this.targetduration=0,this.totalduration=0,this.type=null,this.url=void 0,this.m3u8="",this.version=null,this.canBlockReload=!1,this.canSkipUntil=0,this.canSkipDateRanges=!1,this.skippedSegments=0,this.recentlyRemovedDateranges=void 0,this.partHoldBack=0,this.holdBack=0,this.partTarget=0,this.preloadHint=void 0,this.renditionReports=void 0,this.tuneInGoal=0,this.deltaUpdateFailed=void 0,this.driftStartTime=0,this.driftEndTime=0,this.driftStart=0,this.driftEnd=0,this.encryptedFragments=void 0,this.playlistParsingError=null,this.variableList=null,this.hasVariableRefs=!1,this.appliedTimelineOffset=void 0,this.fragments=[],this.encryptedFragments=[],this.dateRanges={},this.url=t}reloaded(t){if(!t)return this.advanced=!0,void(this.updated=!0);const e=this.lastPartSn-t.lastPartSn,r=this.lastPartIndex-t.lastPartIndex;this.updated=this.endSN!==t.endSN||!!r||!!e||!this.live,this.advanced=this.endSN>t.endSN||e>0||0===e&&r>0,this.updated||this.advanced?this.misses=Math.floor(.6*t.misses):this.misses=t.misses+1}hasKey(t){return this.encryptedFragments.some((e=>{let r=e.decryptdata;return r||(e.setKeyFormat(t.keyFormat),r=e.decryptdata),!!r&&t.matches(r)}))}get hasProgramDateTime(){return!!this.fragments.length&&n(this.fragments[this.fragments.length-1].programDateTime)}get levelTargetDuration(){return this.averagetargetduration||this.targetduration||10}get drift(){const t=this.driftEndTime-this.driftStartTime;if(t>0){return 1e3*(this.driftEnd-this.driftStart)/t}return 1}get edge(){return this.partEnd||this.fragmentEnd}get partEnd(){var t;return null!=(t=this.partList)&&t.length?this.partList[this.partList.length-1].end:this.fragmentEnd}get fragmentEnd(){return this.fragments.length?this.fragments[this.fragments.length-1].end:0}get fragmentStart(){return this.fragments.length?this.fragments[0].start:0}get age(){return this.advancedDateTime?Math.max(Date.now()-this.advancedDateTime,0)/1e3:0}get lastPartIndex(){var t;return null!=(t=this.partList)&&t.length?this.partList[this.partList.length-1].index:-1}get maxPartIndex(){const t=this.partList;if(t){const e=this.lastPartIndex;if(-1!==e){for(let r=t.length;r--;)if(t[r].index>e)return t[r].index;return e}}return 0}get lastPartSn(){var t;return null!=(t=this.partList)&&t.length?this.partList[this.partList.length-1].fragment.sn:this.endSN}get expired(){if(this.live&&this.age&&this.misses<3){const t=this.partEnd-this.fragmentStart;return this.age>Math.max(t,this.totalduration)+this.levelTargetDuration}return!1}}function We(t,e){return t.length===e.length&&!t.some(((t,r)=>t!==e[r]))}function ze(t,e){return!t&&!e||!(!t||!e)&&We(t,e)}function Xe(t){return"AES-128"===t||"AES-256"===t||"AES-256-CTR"===t}function Qe(t){switch(t){case"AES-128":case"AES-256":return Te.cbc;case"AES-256-CTR":return Te.ctr;default:throw new Error(`invalid full segment method ${t}`)}}function Je(t){return Uint8Array.from(atob(t),(t=>t.charCodeAt(0)))}function Ze(t){return Uint8Array.from(unescape(encodeURIComponent(t)),(t=>t.charCodeAt(0)))}function tr(t){const e=t.split(":");let r=null;if("data"===e[0]&&2===e.length){const t=e[1].split(";"),n=t[t.length-1].split(",");if(2===n.length){const e="base64"===n[0],i=n[1];e?(t.splice(-1,1),r=Je(i)):r=function(t){const e=Ze(t).subarray(0,16),r=new Uint8Array(16);return r.set(e,16-e.length),r}(i)}}return r}const er="undefined"!=typeof self?self:void 0;var rr={CLEARKEY:"org.w3.clearkey",FAIRPLAY:"com.apple.fps",PLAYREADY:"com.microsoft.playready",WIDEVINE:"com.widevine.alpha"},nr={CLEARKEY:"org.w3.clearkey",FAIRPLAY:"com.apple.streamingkeydelivery",PLAYREADY:"com.microsoft.playready",WIDEVINE:"urn:uuid:edef8ba9-79d6-4ace-a3c8-27dcd51d21ed"};function ir(t){switch(t){case nr.FAIRPLAY:return rr.FAIRPLAY;case nr.PLAYREADY:return rr.PLAYREADY;case nr.WIDEVINE:return rr.WIDEVINE;case nr.CLEARKEY:return rr.CLEARKEY}}function sr(t){switch(t){case rr.FAIRPLAY:return nr.FAIRPLAY;case rr.PLAYREADY:return nr.PLAYREADY;case rr.WIDEVINE:return nr.WIDEVINE;case rr.CLEARKEY:return nr.CLEARKEY}}function or(t){const{drmSystems:e,widevineLicenseUrl:r}=t,n=e?[rr.FAIRPLAY,rr.WIDEVINE,rr.PLAYREADY,rr.CLEARKEY].filter((t=>!!e[t])):[];return!n[rr.WIDEVINE]&&r&&n.push(rr.WIDEVINE),n}const ar=null!=er&&null!=(lr=er.navigator)&&lr.requestMediaKeySystemAccess?self.navigator.requestMediaKeySystemAccess.bind(self.navigator):null;var lr;let cr={};class ur{static clearKeyUriToKeyIdMap(){cr={}}constructor(t,e,r,n=[1],i=null,s){this.uri=void 0,this.method=void 0,this.keyFormat=void 0,this.keyFormatVersions=void 0,this.encrypted=void 0,this.isCommonEncryption=void 0,this.iv=null,this.key=null,this.keyId=null,this.pssh=null,this.method=t,this.uri=e,this.keyFormat=r,this.keyFormatVersions=n,this.iv=i,this.encrypted=!!t&&"NONE"!==t,this.isCommonEncryption=this.encrypted&&!Xe(t),null!=s&&s.startsWith("0x")&&(this.keyId=new Uint8Array(k(s)))}matches(t){return t.uri===this.uri&&t.method===this.method&&t.encrypted===this.encrypted&&t.keyFormat===this.keyFormat&&We(t.keyFormatVersions,this.keyFormatVersions)&&ze(t.iv,this.iv)&&ze(t.keyId,this.keyId)}isSupported(){if(this.method){if(Xe(this.method)||"NONE"===this.method)return!0;if("identity"===this.keyFormat)return"SAMPLE-AES"===this.method;switch(this.keyFormat){case nr.FAIRPLAY:case nr.WIDEVINE:case nr.PLAYREADY:case nr.CLEARKEY:return-1!==["SAMPLE-AES","SAMPLE-AES-CENC","SAMPLE-AES-CTR"].indexOf(this.method)}}return!1}getDecryptData(t){if(!this.encrypted||!this.uri)return null;if(Xe(this.method)&&this.uri&&!this.iv){"number"!=typeof t&&(T.warn(`missing IV for initialization segment with method="${this.method}" - compliance issue`),t=0);const e=function(t){const e=new Uint8Array(16);for(let r=12;r<16;r++)e[r]=t>>8*(15-r)&255;return e}(t);return new ur(this.method,this.uri,"identity",this.keyFormatVersions,e)}if(this.pssh&&this.keyId)return this;const e=tr(this.uri);if(e)switch(this.keyFormat){case nr.WIDEVINE:if(this.pssh=e,!this.keyId&&e.length>=22){const t=e.length-22;this.keyId=e.subarray(t,t+16)}break;case nr.PLAYREADY:{const t=new Uint8Array([154,4,240,121,152,64,66,134,171,146,230,91,224,136,95,149]);this.pssh=pt(t,0,e),this.keyId=function(t){const e=new Uint16Array(t.buffer,t.byteOffset,t.byteLength/2),r=String.fromCharCode.apply(null,Array.from(e)),n=r.substring(r.indexOf("<"),r.length),i=(new DOMParser).parseFromString(n,"text/xml").getElementsByTagName("KID")[0];if(i){const t=i.childNodes[0]?i.childNodes[0].nodeValue:i.getAttribute("VALUE");if(t){const e=Je(t).subarray(0,16);return function(t){const e=function(t,e,r){const n=t[e];t[e]=t[r],t[r]=n};e(t,0,3),e(t,1,2),e(t,4,5),e(t,6,7)}(e),e}}return null}(e);break}default:{let t=e.subarray(0,16);if(16!==t.length){const e=new Uint8Array(16);e.set(t,16-t.length),t=e}this.keyId=t;break}}if(!this.keyId||16!==this.keyId.byteLength){let t=cr[this.uri];if(!t){const e=Object.keys(cr).length%Number.MAX_SAFE_INTEGER;t=new Uint8Array(16);new DataView(t.buffer,12,4).setUint32(0,e),cr[this.uri]=t}this.keyId=t}return this}}const hr=/#EXT-X-STREAM-INF:([^\r\n]*)(?:[\r\n](?:#[^\r\n]*)?)*([^\r\n]+)|#EXT-X-(SESSION-DATA|SESSION-KEY|DEFINE|CONTENT-STEERING|START):([^\r\n]*)[\r\n]+/g,dr=/#EXT-X-MEDIA:(.*)/g,fr=/^#EXT(?:INF|-X-TARGETDURATION):/m,pr=new RegExp([/#EXTINF:\s*(\d*(?:\.\d+)?)(?:,(.*)\s+)?/.source,/(?!#) *(\S[^\r\n]*)/.source,/#.*/.source].join("|"),"g"),gr=new RegExp([/#EXT-X-(PROGRAM-DATE-TIME|BYTERANGE|DATERANGE|DEFINE|KEY|MAP|PART|PART-INF|PLAYLIST-TYPE|PRELOAD-HINT|RENDITION-REPORT|SERVER-CONTROL|SKIP|START):(.+)/.source,/#EXT-X-(BITRATE|DISCONTINUITY-SEQUENCE|MEDIA-SEQUENCE|TARGETDURATION|VERSION): *(\d+)/.source,/#EXT-X-(DISCONTINUITY|ENDLIST|GAP|INDEPENDENT-SEGMENTS)/.source,/(#)([^:]*):(.*)/.source,/(#)(.*)(?:.*)\r?\n?/.source].join("|"));class mr{static findGroup(t,e){for(let r=0;r<t.length;r++){const n=t[r];if(n.id===e)return n}}static resolve(t,e){return F.buildAbsoluteURL(e,t,{alwaysNormalize:!0})}static isMediaPlaylist(t){return fr.test(t)}static parseMasterPlaylist(t,e){const r={contentSteering:null,levels:[],playlistParsingError:null,sessionData:null,sessionKeys:null,startTimeOffset:null,variableList:null,hasVariableRefs:Ue(t)},n=[];let i;for(hr.lastIndex=0;null!=(i=hr.exec(t));)if(i[1]){var s;const t=new Ve(i[1],r),o=Be(r,i[2]),a={attrs:t,bitrate:t.decimalInteger("BANDWIDTH")||t.decimalInteger("AVERAGE-BANDWIDTH"),name:t.NAME,url:mr.resolve(o,e)},l=t.decimalResolution("RESOLUTION");l&&(a.width=l.width,a.height=l.height),Ar(t.CODECS,a);const c=t["SUPPLEMENTAL-CODECS"];c&&(a.supplemental={},Ar(c,a.supplemental)),null!=(s=a.unknownCodecs)&&s.length||n.push(a),r.levels.push(a)}else if(i[3]){const t=i[3],n=i[4];switch(t){case"SESSION-DATA":{const t=new Ve(n,r),e=t["DATA-ID"];e&&(null===r.sessionData&&(r.sessionData={}),r.sessionData[e]=t);break}case"SESSION-KEY":{const t=br(n,e,r);t.encrypted&&t.isSupported()?(null===r.sessionKeys&&(r.sessionKeys=[]),r.sessionKeys.push(t)):T.warn(`[Keys] Ignoring invalid EXT-X-SESSION-KEY tag: "${n}"`);break}case"DEFINE":$e(r,new Ve(n,r),e);break;case"CONTENT-STEERING":{const t=new Ve(n,r);r.contentSteering={uri:mr.resolve(t["SERVER-URI"],e),pathwayId:t["PATHWAY-ID"]||"."};break}case"START":r.startTimeOffset=Er(n)}}const o=n.length>0&&n.length<r.levels.length;return r.levels=o?n:r.levels,0===r.levels.length&&(r.playlistParsingError=new Error("no levels found in manifest")),r}static parseMasterPlaylistMedia(t,e,r){let n;const i={},s=r.levels,o={AUDIO:s.map((t=>({id:t.attrs.AUDIO,audioCodec:t.audioCodec}))),SUBTITLES:s.map((t=>({id:t.attrs.SUBTITLES,textCodec:t.textCodec}))),"CLOSED-CAPTIONS":[]};let a=0;for(dr.lastIndex=0;null!==(n=dr.exec(t));){const t=new Ve(n[1],r),s=t.TYPE;if(s){const r=o[s],n=i[s]||[];i[s]=n;const l=t.LANGUAGE,c=t["ASSOC-LANGUAGE"],u=t.CHANNELS,h=t.CHARACTERISTICS,d=t["INSTREAM-ID"],f={attrs:t,bitrate:0,id:a++,groupId:t["GROUP-ID"]||"",name:t.NAME||l||"",type:s,default:t.bool("DEFAULT"),autoselect:t.bool("AUTOSELECT"),forced:t.bool("FORCED"),lang:l,url:t.URI?mr.resolve(t.URI,e):""};if(c&&(f.assocLang=c),u&&(f.channels=u),h&&(f.characteristics=h),d&&(f.instreamId=d),null!=r&&r.length){const t=mr.findGroup(r,f.groupId)||r[0];wr(f,t,"audioCodec"),wr(f,t,"textCodec")}n.push(f)}}return i}static parseLevelPlaylist(t,e,r,i,s,o){var a;const l={url:e},c=new qe(e),u=c.fragments,h=[];let d,f,g,m,y=null,v=0,b=0,E=0,A=0,w=0,S=null,L=new G(i,l),_=-1,x=!1,k=null;if(pr.lastIndex=0,c.m3u8=t,c.hasVariableRefs=Ue(t),"#EXTM3U"!==(null==(a=pr.exec(t))?void 0:a[0]))return c.playlistParsingError=new Error("Missing format identifier #EXTM3U"),c;for(;null!==(d=pr.exec(t));){x&&(x=!1,L=new G(i,l),L.playlistOffset=E,L.setStart(E),L.sn=v,L.cc=A,w&&(L.bitrate=w),L.level=r,y&&(L.initSegment=y,y.rawProgramDateTime&&(L.rawProgramDateTime=y.rawProgramDateTime,y.rawProgramDateTime=null),k&&(L.setByteRange(k),k=null)));const t=d[1];if(t){L.duration=parseFloat(t);const e=(" "+d[2]).slice(1);L.title=e||null,L.tagList.push(e?["INF",t,e]:["INF",t])}else if(d[3]){if(n(L.duration)){L.playlistOffset=E,L.setStart(E),g&&Lr(L,g,c),L.sn=v,L.level=r,L.cc=A,u.push(L);const t=(" "+d[3]).slice(1);L.relurl=Be(c,t),Tr(L,S,h),S=L,E+=L.duration,v++,b=0,x=!0}}else{if(d=d[0].match(gr),!d){T.warn("No matches on slow regex match for level playlist!");continue}for(f=1;f<d.length&&void 0===d[f];f++);const t=(" "+d[f]).slice(1),s=(" "+d[f+1]).slice(1),a=d[f+2]?(" "+d[f+2]).slice(1):null;switch(t){case"BYTERANGE":S?L.setByteRange(s,S):L.setByteRange(s);break;case"PROGRAM-DATE-TIME":L.rawProgramDateTime=s,L.tagList.push(["PROGRAM-DATE-TIME",s]),-1===_&&(_=u.length);break;case"PLAYLIST-TYPE":c.type&&_r(c,t,d),c.type=s.toUpperCase();break;case"MEDIA-SEQUENCE":0!==c.startSN?_r(c,t,d):u.length>0&&xr(c,t,d),v=c.startSN=parseInt(s);break;case"SKIP":{c.skippedSegments&&_r(c,t,d);const e=new Ve(s,c),r=e.decimalInteger("SKIPPED-SEGMENTS");if(n(r)){c.skippedSegments+=r;for(let t=r;t--;)u.push(null);v+=r}const i=e.enumeratedString("RECENTLY-REMOVED-DATERANGES");i&&(c.recentlyRemovedDateranges=(c.recentlyRemovedDateranges||[]).concat(i.split("\t")));break}case"TARGETDURATION":0!==c.targetduration&&_r(c,t,d),c.targetduration=Math.max(parseInt(s),1);break;case"VERSION":null!==c.version&&_r(c,t,d),c.version=parseInt(s);break;case"INDEPENDENT-SEGMENTS":break;case"ENDLIST":c.live||_r(c,t,d),c.live=!1;break;case"#":(s||a)&&L.tagList.push(a?[s,a]:[s]);break;case"DISCONTINUITY":A++,L.tagList.push(["DIS"]);break;case"GAP":L.gap=!0,L.tagList.push([t]);break;case"BITRATE":L.tagList.push([t,s]),w=1e3*parseInt(s),n(w)?L.bitrate=w:w=0;break;case"DATERANGE":{const t=new Ve(s,c),e=new Ye(t,c.dateRanges[t.ID],c.dateRangeTagCount);c.dateRangeTagCount++,e.isValid||c.skippedSegments?c.dateRanges[e.id]=e:T.warn(`Ignoring invalid DATERANGE tag: "${s}"`),L.tagList.push(["EXT-X-DATERANGE",s]);break}case"DEFINE":{const t=new Ve(s,c);"IMPORT"in t?je(c,t,o):$e(c,t,e)}break;case"DISCONTINUITY-SEQUENCE":0!==c.startCC?_r(c,t,d):u.length>0&&xr(c,t,d),c.startCC=A=parseInt(s);break;case"KEY":{const t=br(s,e,c);if(t.isSupported()){if("NONE"===t.method){g=void 0;break}g||(g={});const e=g[t.keyFormat];null!=e&&e.matches(t)||(e&&(g=p({},g)),g[t.keyFormat]=t)}else T.warn(`[Keys] Ignoring invalid EXT-X-KEY tag: "${s}"`);break}case"START":c.startTimeOffset=Er(s);break;case"MAP":{const t=new Ve(s,c);if(L.duration){const e=new G(i,l);Sr(e,t,r,g),y=e,L.initSegment=y,y.rawProgramDateTime&&!L.rawProgramDateTime&&(L.rawProgramDateTime=y.rawProgramDateTime)}else{const e=L.byteRangeEndOffset;if(e){const t=L.byteRangeStartOffset;k=`${e-t}@${t}`}else k=null;Sr(L,t,r,g),y=L,x=!0}y.cc=A;break}case"SERVER-CONTROL":m&&_r(c,t,d),m=new Ve(s),c.canBlockReload=m.bool("CAN-BLOCK-RELOAD"),c.canSkipUntil=m.optionalFloat("CAN-SKIP-UNTIL",0),c.canSkipDateRanges=c.canSkipUntil>0&&m.bool("CAN-SKIP-DATERANGES"),c.partHoldBack=m.optionalFloat("PART-HOLD-BACK",0),c.holdBack=m.optionalFloat("HOLD-BACK",0);break;case"PART-INF":{c.partTarget&&_r(c,t,d);const e=new Ve(s);c.partTarget=e.decimalFloatingPoint("PART-TARGET");break}case"PART":{let t=c.partList;t||(t=c.partList=[]);const e=b>0?t[t.length-1]:void 0,r=b++,n=new Ve(s,c),i=new H(n,L,l,r,e);t.push(i),L.duration+=i.duration;break}case"PRELOAD-HINT":{const t=new Ve(s,c);c.preloadHint=t;break}case"RENDITION-REPORT":{const t=new Ve(s,c);c.renditionReports=c.renditionReports||[],c.renditionReports.push(t);break}default:T.warn(`line parsed but not handled: ${d}`)}}}S&&!S.relurl?(u.pop(),E-=S.duration,c.partList&&(c.fragmentHint=S)):c.partList&&(Tr(L,S,h),L.cc=A,c.fragmentHint=L,g&&Lr(L,g,c)),c.targetduration||(c.playlistParsingError=new Error("#EXT-X-TARGETDURATION is required"));const P=u.length,I=u[0],R=u[P-1];if(E+=c.skippedSegments*c.targetduration,E>0&&P&&R){c.averagetargetduration=E/P;const t=R.sn;c.endSN="initSegment"!==t?t:0,c.live||(R.endList=!0),_>0&&(!function(t,e){let r=t[e];for(let n=e;n--;){const e=t[n];if(!e)return;e.programDateTime=r.programDateTime-1e3*e.duration,r=e}}(u,_),I&&h.unshift(I))}return c.fragmentHint&&(E+=c.fragmentHint.duration),c.totalduration=E,h.length&&c.dateRangeTagCount&&I&&yr(h,c),c.endCC=A,c}}function yr(t,e){let r=t.length;if(!r){if(!e.hasProgramDateTime)return;{const n=e.fragments[e.fragments.length-1];t.push(n),r++}}const n=t[r-1],i=e.live?1/0:e.totalduration,s=Object.keys(e.dateRanges);for(let a=s.length;a--;){const l=e.dateRanges[s[a]],c=l.startDate.getTime();l.tagAnchor=n.ref;for(let n=r;n--;){var o;if((null==(o=t[n])?void 0:o.sn)<e.startSN)break;const r=vr(e,c,t,n,i);if(-1!==r){l.tagAnchor=e.fragments[r].ref;break}}}}function vr(t,e,r,n,i){const s=r[n];if(s){const a=s.programDateTime;if(e>=a||0===n){var o;if(e<=a+1e3*(((null==(o=r[n+1])?void 0:o.start)||i)-s.start)){const i=r[n].sn-t.startSN;if(i<0)return-1;const s=t.fragments;if(s.length>r.length){for(let o=(r[n+1]||s[s.length-1]).sn-t.startSN;o>i;o--){const t=s[o].programDateTime;if(e>=t&&e<t+1e3*s[o].duration)return o}}return i}}}return-1}function br(t,e,r){var n,i;const s=new Ve(t,r),o=null!=(n=s.METHOD)?n:"",a=s.URI,l=s.hexadecimalInteger("IV"),c=s.KEYFORMATVERSIONS,u=null!=(i=s.KEYFORMAT)?i:"identity";a&&s.IV&&!l&&T.error(`Invalid IV: ${s.IV}`);const h=a?mr.resolve(a,e):"",d=(c||"1").split("/").map(Number).filter(Number.isFinite);return new ur(o,h,u,d,l,s.KEYID)}function Er(t){const e=new Ve(t).decimalFloatingPoint("TIME-OFFSET");return n(e)?e:null}function Ar(t,e){let r=(t||"").split(/[ ,]+/).filter((t=>t));["video","audio","text"].forEach((t=>{const n=r.filter((e=>yt(e,t)));n.length&&(e[`${t}Codec`]=n.map((t=>t.split("/")[0])).join(","),r=r.filter((t=>-1===n.indexOf(t))))})),e.unknownCodecs=r}function wr(t,e,r){const n=e[r];n&&(t[r]=n)}function Tr(t,e,r){t.rawProgramDateTime?r.push(t):null!=e&&e.programDateTime&&(t.programDateTime=e.endProgramDateTime)}function Sr(t,e,r,n){t.relurl=e.URI,e.BYTERANGE&&t.setByteRange(e.BYTERANGE),t.level=r,t.sn="initSegment",n&&(t.levelkeys=n),t.initSegment=null}function Lr(t,e,r){t.levelkeys=e;const{encryptedFragments:n}=r;n.length&&n[n.length-1].levelkeys===e||!Object.keys(e).some((t=>e[t].isCommonEncryption))||n.push(t)}function _r(t,e,r){t.playlistParsingError=new Error(`#EXT-X-${e} must not appear more than once (${r[0]})`)}function xr(t,e,r){t.playlistParsingError=new Error(`#EXT-X-${e} must appear before the first Media Segment (${r[0]})`)}function kr(t,e){const r=e.startPTS;if(n(r)){let n,i=0;e.sn>t.sn?(i=r-t.start,n=t):(i=t.start-r,n=e),n.duration!==i&&n.setDuration(i)}else if(e.sn>t.sn){t.cc===e.cc&&t.minEndPTS?e.setStart(t.start+(t.minEndPTS-t.start)):e.setStart(t.start+t.duration)}else e.setStart(Math.max(t.start-e.duration,0))}function Pr(t,e,r,i,s,o,a){i-r<=0&&(a.warn("Fragment should have a positive duration",e),i=r+e.duration,o=s+e.duration);let l=r,c=i;const u=e.startPTS,h=e.endPTS;if(n(u)){const d=Math.abs(u-r);t&&d>t.totalduration?a.warn(`media timestamps and playlist times differ by ${d}s for level ${e.level} ${t.url}`):n(e.deltaPTS)?e.deltaPTS=Math.max(d,e.deltaPTS):e.deltaPTS=d,l=Math.max(r,u),r=Math.min(r,u),s=void 0!==e.startDTS?Math.min(s,e.startDTS):s,c=Math.min(i,h),i=Math.max(i,h),o=void 0!==e.endDTS?Math.max(o,e.endDTS):o}const d=r-e.start;0!==e.start&&e.setStart(r),e.setDuration(i-e.start),e.startPTS=r,e.maxStartPTS=l,e.startDTS=s,e.endPTS=i,e.minEndPTS=c,e.endDTS=o;const f=e.sn;if(!t||f<t.startSN||f>t.endSN)return 0;let p;const g=f-t.startSN,m=t.fragments;for(m[g]=e,p=g;p>0;p--)kr(m[p],m[p-1]);for(p=g;p<m.length-1;p++)kr(m[p],m[p+1]);return t.fragmentHint&&kr(m[m.length-1],t.fragmentHint),t.PTSKnown=t.alignedSliding=!0,d}function Ir(t,e,r){if(t===e)return;let i=null;const s=t.fragments;for(let t=s.length-1;t>=0;t--){const e=s[t].initSegment;if(e){i=e;break}}let o;t.fragmentHint&&delete t.fragmentHint.endPTS,function(t,e,r){const n=e.skippedSegments,i=Math.max(t.startSN,e.startSN)-e.startSN,s=(t.fragmentHint?1:0)+(n?e.endSN:Math.min(t.endSN,e.endSN))-e.startSN,o=e.startSN-t.startSN,a=e.fragmentHint?e.fragments.concat(e.fragmentHint):e.fragments,l=t.fragmentHint?t.fragments.concat(t.fragmentHint):t.fragments;for(let c=i;c<=s;c++){const i=l[o+c];let s=a[c];if(n&&!s&&i&&(s=e.fragments[c]=i),i&&s){r(i,s,c,a);const n=i.relurl,o=s.relurl;if(n&&Br(n,o))return void(e.playlistParsingError=Rr(`media sequence mismatch ${s.sn}:`,t,e,i,s));if(i.cc!==s.cc)return void(e.playlistParsingError=Rr(`discontinuity sequence mismatch (${i.cc}!=${s.cc})`,t,e,i,s))}}}(t,e,((t,r,s,a)=>{if((!e.startCC||e.skippedSegments)&&r.cc!==t.cc){const n=t.cc-r.cc;for(let t=s;t<a.length;t++)a[t].cc+=n;e.endCC=a[a.length-1].cc}n(t.startPTS)&&n(t.endPTS)&&(r.setStart(r.startPTS=t.startPTS),r.startDTS=t.startDTS,r.maxStartPTS=t.maxStartPTS,r.endPTS=t.endPTS,r.endDTS=t.endDTS,r.minEndPTS=t.minEndPTS,r.setDuration(t.endPTS-t.startPTS),r.duration&&(o=r),e.PTSKnown=e.alignedSliding=!0),t.hasStreams&&(r.elementaryStreams=t.elementaryStreams),r.loader=t.loader,t.hasStats&&(r.stats=t.stats),t.initSegment&&(r.initSegment=t.initSegment,i=t.initSegment)}));const a=e.fragments,l=e.fragmentHint?a.concat(e.fragmentHint):a;if(i&&l.forEach((t=>{var e;!t||t.initSegment&&t.initSegment.relurl!==(null==(e=i)?void 0:e.relurl)||(t.initSegment=i)})),e.skippedSegments){if(e.deltaUpdateFailed=a.some((t=>!t)),e.deltaUpdateFailed){r.warn("[level-helper] Previous playlist missing segments skipped in delta playlist");for(let t=e.skippedSegments;t--;)a.shift();e.startSN=a[0].sn}else{e.canSkipDateRanges&&(e.dateRanges=function(t,e,r){const{dateRanges:n,recentlyRemovedDateranges:i}=e,s=p({},t);i&&i.forEach((t=>{delete s[t]}));const o=Object.keys(s).length;if(!o)return n;return Object.keys(n).forEach((t=>{const e=s[t],i=new Ye(n[t].attr,e);i.isValid?(s[t]=i,e||(i.tagOrder+=o)):r.warn(`Ignoring invalid Playlist Delta Update DATERANGE tag: "${Yt(n[t].attr)}"`)})),s}(t.dateRanges,e,r));const n=t.fragments.filter((t=>t.rawProgramDateTime));if(t.hasProgramDateTime&&!e.hasProgramDateTime)for(let t=1;t<l.length;t++)null===l[t].programDateTime&&Tr(l[t],l[t-1],n);yr(n,e)}e.endCC=a[a.length-1].cc}if(!e.startCC){var c;const r=Mr(t,e.startSN-1);e.startCC=null!=(c=null==r?void 0:r.cc)?c:a[0].cc}!function(t,e,r){if(t&&e){let n=0;for(let i=0,s=t.length;i<=s;i++){const s=t[i],o=e[i+n];s&&o&&s.index===o.index&&s.fragment.sn===o.fragment.sn?r(s,o):n--}}}(t.partList,e.partList,((t,e)=>{e.elementaryStreams=t.elementaryStreams,e.stats=t.stats})),o?Pr(e,o,o.startPTS,o.endPTS,o.startDTS,o.endDTS,r):Or(t,e),a.length&&(e.totalduration=e.edge-a[0].start),e.driftStartTime=t.driftStartTime,e.driftStart=t.driftStart;const u=e.advancedDateTime;if(e.advanced&&u){const t=e.edge;e.driftStart||(e.driftStartTime=u,e.driftStart=t),e.driftEndTime=u,e.driftEnd=t}else e.driftEndTime=t.driftEndTime,e.driftEnd=t.driftEnd,e.advancedDateTime=t.advancedDateTime;-1===e.requestScheduled&&(e.requestScheduled=t.requestScheduled)}function Rr(t,e,r,n,i){return new Error(`${t} ${i.url}\nPlaylist starting @${e.startSN}\n${e.m3u8}\n\nPlaylist starting @${r.startSN}\n${r.m3u8}`)}function Or(t,e,r=!0){const n=e.startSN+e.skippedSegments-t.startSN,i=t.fragments,s=n>=0;let o=0;if(s&&n<i.length)o=i[n].start;else if(s&&e.startSN===t.endSN+1)o=t.fragmentEnd;else if(s&&r)o=t.fragmentStart+n*e.levelTargetDuration;else{if(e.skippedSegments||0!==e.fragmentStart)return;o=t.fragmentStart}Dr(e,o)}function Dr(t,e){if(e){const r=t.fragments;for(let n=t.skippedSegments;n<r.length;n++)r[n].addStart(e);t.fragmentHint&&t.fragmentHint.addStart(e)}}function Cr(t,e=1/0){let r=1e3*t.targetduration;if(t.updated){const n=t.fragments,i=4;if(n.length&&r*i>e){const t=1e3*n[n.length-1].duration;t<r&&(r=t)}}else r/=2;return Math.round(r)}function Mr(t,e,r){if(!t)return null;let n=t.fragments[e-t.startSN];return n||(n=t.fragmentHint,n&&n.sn===e?n:e<t.startSN&&r&&r.sn===e?r:null)}function Nr(t,e,r){return t?Fr(t.partList,e,r):null}function Fr(t,e,r){if(t)for(let n=t.length;n--;){const i=t[n];if(i.index===r&&i.fragment.sn===e)return i}return null}function Ur(t){t.forEach(((t,e)=>{var r;null==(r=t.details)||r.fragments.forEach((t=>{t.level=e,t.initSegment&&(t.initSegment.level=e)}))}))}function Br(t,e){return!(t===e||!e)&&$r(t)!==$r(e)}function $r(t){return t.replace(/\?[^?]*$/,"")}function jr(t,e){for(let n=0,i=t.length;n<i;n++){var r;if((null==(r=t[n])?void 0:r.cc)===e)return t[n]}return null}function Gr(t,e){const r=t.start+e;t.startPTS=r,t.setStart(r),t.endPTS=r+t.duration}function Hr(t,e){const r=e.fragments;for(let e=0,n=r.length;e<n;e++)Gr(r[e],t);e.fragmentHint&&Gr(e.fragmentHint,t),e.alignedSliding=!0}function Vr(t,e){if(!function(t,e){return!!(t&&e.startCC<t.endCC&&e.endCC>t.startCC)}(e,t))return;const r=Math.min(e.endCC,t.endCC),n=jr(e.fragments,r),i=jr(t.fragments,r);if(!n||!i)return;T.log(`Aligning playlist at start of dicontinuity sequence ${r}`);Hr(n.start-i.start,t)}function Kr(t,e){if(!t.hasProgramDateTime||!e.hasProgramDateTime)return;const r=t.fragments,n=e.fragments;if(!r.length||!n.length)return;let i,s;const o=Math.min(e.endCC,t.endCC);e.startCC<o&&t.startCC<o&&(i=jr(n,o),s=jr(r,o)),i&&s||(i=n[Math.floor(n.length/2)],s=jr(r,i.cc)||r[Math.floor(r.length/2)]);const a=i.programDateTime,l=s.programDateTime;if(!a||!l)return;Hr((l-a)/1e3-(s.start-i.start),t)}function Yr(t,e,r){qr(t,e,r),t.addEventListener(e,r)}function qr(t,e,r){t.removeEventListener(e,r)}const Wr=function(t){let e="";const r=t.length;for(let n=0;n<r;n++)e+=`[${t.start(n).toFixed(3)}-${t.end(n).toFixed(3)}]`;return e},zr={STOPPED:"STOPPED",IDLE:"IDLE",KEY_LOADING:"KEY_LOADING",FRAG_LOADING:"FRAG_LOADING",FRAG_LOADING_WAITING_RETRY:"FRAG_LOADING_WAITING_RETRY",WAITING_TRACK:"WAITING_TRACK",PARSING:"PARSING",PARSED:"PARSED",ENDED:"ENDED",ERROR:"ERROR",WAITING_INIT_PTS:"WAITING_INIT_PTS",WAITING_LEVEL:"WAITING_LEVEL"};class Xr extends De{constructor(t,e,r,i,s){super(i,t.logger),this.hls=void 0,this.fragPrevious=null,this.fragCurrent=null,this.fragmentTracker=void 0,this.transmuxer=null,this._state=zr.STOPPED,this.playlistType=void 0,this.media=null,this.mediaBuffer=null,this.config=void 0,this.bitrateTest=!1,this.lastCurrentTime=0,this.nextLoadPosition=0,this.startPosition=0,this.startTimeOffset=null,this.retryDate=0,this.levels=null,this.fragmentLoader=void 0,this.keyLoader=void 0,this.levelLastLoaded=null,this.startFragRequested=!1,this.decrypter=void 0,this.initPTS=[],this.buffering=!0,this.loadingParts=!1,this.loopSn=void 0,this.onMediaSeeking=()=>{const{config:t,fragCurrent:e,media:r,mediaBuffer:i,state:s}=this,o=r?r.currentTime:0,a=Ne.bufferInfo(i||r,o,t.maxBufferHole),l=!a.len;if(this.log(`Media seeking to ${n(o)?o.toFixed(3):o}, state: ${s}, ${l?"out of":"in"} buffer`),this.state===zr.ENDED)this.resetLoadingState();else if(e){const r=t.maxFragLookUpTolerance,n=e.start-r,i=e.start+e.duration+r;if(l||i<a.start||n>a.end){const t=o>i;(o<n||t)&&(t&&e.loader&&(this.log(`Cancelling fragment load for seek (sn: ${e.sn})`),e.abortRequests(),this.resetLoadingState()),this.fragPrevious=null)}}if(r){this.fragmentTracker.removeFragmentsInRange(o,1/0,this.playlistType,!0);if(o>this.lastCurrentTime&&(this.lastCurrentTime=o),!this.loadingParts){const t=Math.max(a.end,o),e=this.shouldLoadParts(this.getLevelDetails(),t);e&&(this.log(`LL-Part loading ON after seeking to ${o.toFixed(2)} with buffer @${t.toFixed(2)}`),this.loadingParts=e)}}this.hls.hasEnoughToStart||(this.log(`Setting ${l?"startPosition":"nextLoadPosition"} to ${o} for seek without enough to start`),this.nextLoadPosition=o,l&&(this.startPosition=o)),l&&this.state===zr.IDLE&&this.tickImmediate()},this.onMediaEnded=()=>{this.log("setting startPosition to 0 because media ended"),this.startPosition=this.lastCurrentTime=0},this.playlistType=s,this.hls=t,this.fragmentLoader=new Pe(t.config),this.keyLoader=r,this.fragmentTracker=e,this.config=t.config,this.decrypter=new xe(t.config)}registerListeners(){const{hls:t}=this;t.on(l.MEDIA_ATTACHED,this.onMediaAttached,this),t.on(l.MEDIA_DETACHING,this.onMediaDetaching,this),t.on(l.MANIFEST_LOADING,this.onManifestLoading,this),t.on(l.MANIFEST_LOADED,this.onManifestLoaded,this),t.on(l.ERROR,this.onError,this)}unregisterListeners(){const{hls:t}=this;t.off(l.MEDIA_ATTACHED,this.onMediaAttached,this),t.off(l.MEDIA_DETACHING,this.onMediaDetaching,this),t.off(l.MANIFEST_LOADING,this.onManifestLoading,this),t.off(l.MANIFEST_LOADED,this.onManifestLoaded,this),t.off(l.ERROR,this.onError,this)}doTick(){this.onTickEnd()}onTickEnd(){}startLoad(t){}stopLoad(){if(this.state===zr.STOPPED)return;this.fragmentLoader.abort(),this.keyLoader.abort(this.playlistType);const t=this.fragCurrent;null!=t&&t.loader&&(t.abortRequests(),this.fragmentTracker.removeFragment(t)),this.resetTransmuxer(),this.fragCurrent=null,this.fragPrevious=null,this.clearInterval(),this.clearNextTick(),this.state=zr.STOPPED}get startPositionValue(){const{nextLoadPosition:t,startPosition:e}=this;return-1===e&&t?t:e}get bufferingEnabled(){return this.buffering}pauseBuffering(){this.buffering=!1}resumeBuffering(){this.buffering=!0}get inFlightFrag(){return{frag:this.fragCurrent,state:this.state}}_streamEnded(t,e){if(e.live||!this.media)return!1;const r=t.end||0,n=this.config.timelineOffset||0;if(r<=n)return!1;const i=t.buffered;this.config.maxBufferHole&&i&&i.length>1&&(t=Ne.bufferedInfo(i,t.start,0));const s=t.nextStart;if(s&&s>n&&s<e.edge)return!1;if(this.media.currentTime<t.start)return!1;const o=e.partList;if(null!=o&&o.length){const t=o[o.length-1];return Ne.isBuffered(this.media,t.start+t.duration/2)}const a=e.fragments[e.fragments.length-1].type;return this.fragmentTracker.isEndListAppended(a)}getLevelDetails(){if(this.levels&&null!==this.levelLastLoaded)return this.levelLastLoaded.details}get timelineOffset(){const t=this.config.timelineOffset;var e;return t?(null==(e=this.getLevelDetails())?void 0:e.appliedTimelineOffset)||t:0}onMediaAttached(t,e){const r=this.media=this.mediaBuffer=e.media;Yr(r,"seeking",this.onMediaSeeking),Yr(r,"ended",this.onMediaEnded);const n=this.config;this.levels&&n.autoStartLoad&&this.state===zr.STOPPED&&this.startLoad(n.startPosition)}onMediaDetaching(t,e){const r=!!e.transferMedia,n=this.media;if(null!==n){if(n.ended&&(this.log("MSE detaching and video ended, reset startPosition"),this.startPosition=this.lastCurrentTime=0),qr(n,"seeking",this.onMediaSeeking),qr(n,"ended",this.onMediaEnded),this.keyLoader&&!r&&this.keyLoader.detach(),this.media=this.mediaBuffer=null,this.loopSn=void 0,r)return this.resetLoadingState(),void this.resetTransmuxer();this.loadingParts=!1,this.fragmentTracker.removeAllFragments(),this.stopLoad()}}onManifestLoading(){this.initPTS=[],this.levels=this.levelLastLoaded=this.fragCurrent=null,this.lastCurrentTime=this.startPosition=0,this.startFragRequested=!1}onError(t,e){}onManifestLoaded(t,e){this.startTimeOffset=e.startTimeOffset}onHandlerDestroying(){this.stopLoad(),this.transmuxer&&(this.transmuxer.destroy(),this.transmuxer=null),super.onHandlerDestroying(),this.hls=this.onMediaSeeking=this.onMediaEnded=null}onHandlerDestroyed(){this.state=zr.STOPPED,this.fragmentLoader&&this.fragmentLoader.destroy(),this.keyLoader&&this.keyLoader.destroy(),this.decrypter&&this.decrypter.destroy(),this.hls=this.log=this.warn=this.decrypter=this.keyLoader=this.fragmentLoader=this.fragmentTracker=null,super.onHandlerDestroyed()}loadFragment(t,e,r){this.startFragRequested=!0,this._loadFragForPlayback(t,e,r)}_loadFragForPlayback(t,e,r){this._doFragLoad(t,e,r,(t=>{const e=t.frag;if(this.fragContextChanged(e))return this.warn(`${e.type} sn: ${e.sn}${t.part?" part: "+t.part.index:""} of ${this.fragInfo(e,!1,t.part)}) was dropped during download.`),void this.fragmentTracker.removeFragment(e);e.stats.chunkCount++,this._handleFragmentLoadProgress(t)})).then((t=>{if(!t)return;const e=this.state,r=t.frag;this.fragContextChanged(r)?(e===zr.FRAG_LOADING||!this.fragCurrent&&e===zr.PARSING)&&(this.fragmentTracker.removeFragment(r),this.state=zr.IDLE):("payload"in t&&(this.log(`Loaded ${r.type} sn: ${r.sn} of ${this.playlistLabel()} ${r.level}`),this.hls.trigger(l.FRAG_LOADED,t)),this._handleFragmentLoadComplete(t))})).catch((e=>{this.state!==zr.STOPPED&&this.state!==zr.ERROR&&(this.warn(`Frag error: ${(null==e?void 0:e.message)||e}`),this.resetFragmentLoading(t))}))}clearTrackerIfNeeded(t){var e;const{fragmentTracker:r}=this;if(r.getState(t)===me){const e=t.type,n=this.getFwdBufferInfo(this.mediaBuffer,e),i=Math.max(t.duration,n?n.len:this.config.maxBufferLength),s=this.backtrackFragment;(1===(s?t.sn-s.sn:0)||this.reduceMaxBufferLength(i,t.duration))&&r.removeFragment(t)}else 0===(null==(e=this.mediaBuffer)?void 0:e.buffered.length)?r.removeAllFragments():r.hasParts(t.type)&&(r.detectPartialFragments({frag:t,part:null,stats:t.stats,id:t.type}),r.getState(t)===ye&&r.removeFragment(t))}checkLiveUpdate(t){if(t.updated&&!t.live){const e=t.fragments[t.fragments.length-1];this.fragmentTracker.detectPartialFragments({frag:e,part:null,stats:e.stats,id:e.type})}t.fragments[0]||(t.deltaUpdateFailed=!0)}waitForLive(t){const e=t.details;return(null==e?void 0:e.live)&&"EVENT"!==e.type&&(this.levelLastLoaded!==t||e.expired)}flushMainBuffer(t,e,r=null){if(!(t-e))return;const n={startOffset:t,endOffset:e,type:r};this.hls.trigger(l.BUFFER_FLUSHING,n)}_loadInitSegment(t,e){this._doFragLoad(t,e).then((t=>{const e=null==t?void 0:t.frag;if(!e||this.fragContextChanged(e)||!this.levels)throw new Error("init load aborted");return t})).then((t=>{const{hls:e}=this,{frag:r,payload:n}=t,i=r.decryptdata;if(n&&n.byteLength>0&&null!=i&&i.key&&i.iv&&Xe(i.method)){const s=self.performance.now();return this.decrypter.decrypt(new Uint8Array(n),i.key.buffer,i.iv.buffer,Qe(i.method)).catch((t=>{throw e.trigger(l.ERROR,{type:o.MEDIA_ERROR,details:a.FRAG_DECRYPT_ERROR,fatal:!1,error:t,reason:t.message,frag:r}),t})).then((n=>{const i=self.performance.now();return e.trigger(l.FRAG_DECRYPTED,{frag:r,payload:n,stats:{tstart:s,tdecrypt:i}}),t.payload=n,this.completeInitSegmentLoad(t)}))}return this.completeInitSegmentLoad(t)})).catch((e=>{this.state!==zr.STOPPED&&this.state!==zr.ERROR&&(this.warn(e),this.resetFragmentLoading(t))}))}completeInitSegmentLoad(t){const{levels:e}=this;if(!e)throw new Error("init load aborted, missing levels");const r=t.frag.stats;this.state!==zr.STOPPED&&(this.state=zr.IDLE),t.frag.data=new Uint8Array(t.payload),r.parsing.start=r.buffering.start=self.performance.now(),r.parsing.end=r.buffering.end=self.performance.now(),this.tick()}unhandledEncryptionError(t,e){var r,n;const i=t.tracks;if(i&&!e.encrypted&&(null!=(r=i.audio)&&r.encrypted||null!=(n=i.video)&&n.encrypted)&&(!this.config.emeEnabled||!this.keyLoader.emeController)){const t=this.media,r=new Error(`Encrypted track with no key in ${this.fragInfo(e)} (media ${t?"attached mediaKeys: "+t.mediaKeys:"detached"})`);return this.warn(r.message),!t||t.mediaKeys?!1:(this.hls.trigger(l.ERROR,{type:o.KEY_SYSTEM_ERROR,details:a.KEY_SYSTEM_NO_KEYS,fatal:!1,error:r,frag:e}),this.resetTransmuxer(),!0)}return!1}fragContextChanged(t){const{fragCurrent:e}=this;return!t||!e||t.sn!==e.sn||t.level!==e.level}fragBufferedComplete(t,e){const r=this.mediaBuffer?this.mediaBuffer:this.media;if(this.log(`Buffered ${t.type} sn: ${t.sn}${e?" part: "+e.index:""} of ${this.fragInfo(t,!1,e)} > buffer:${r?Wr(Ne.getBuffered(r)):"(detached)"})`),j(t)){var n;if(t.type!==u.SUBTITLE){const e=t.elementaryStreams;if(!Object.keys(e).some((t=>!!e[t])))return void(this.state=zr.IDLE)}const e=null==(n=this.levels)?void 0:n[t.level];null!=e&&e.fragmentError&&(this.log(`Resetting level fragment error count of ${e.fragmentError} on frag buffered`),e.fragmentError=0)}this.state=zr.IDLE}_handleFragmentLoadComplete(t){const{transmuxer:e}=this;if(!e)return;const{frag:r,part:n,partsLoaded:i}=t,s=!i||0===i.length||i.some((t=>!t)),o=new Ce(r.level,r.sn,r.stats.chunkCount+1,0,n?n.index:-1,!s);e.flush(o)}_handleFragmentLoadProgress(t){}_doFragLoad(t,e,r=null,i){var s;this.fragCurrent=t;const o=e.details;if(!this.levels||!o)throw new Error(`frag load aborted, missing level${o?"":" detail"}s`);let a=null;if(!t.encrypted||null!=(s=t.decryptdata)&&s.key)t.encrypted||(a=this.keyLoader.loadClear(t,o.encryptedFragments,this.startFragRequested),a&&this.log("[eme] blocking frag load until media-keys acquired"));else if(this.log(`Loading key for ${t.sn} of [${o.startSN}-${o.endSN}], ${this.playlistLabel()} ${t.level}`),this.state=zr.KEY_LOADING,this.fragCurrent=t,a=this.keyLoader.load(t).then((t=>{if(!this.fragContextChanged(t.frag))return this.hls.trigger(l.KEY_LOADED,t),this.state===zr.KEY_LOADING&&(this.state=zr.IDLE),t})),this.hls.trigger(l.KEY_LOADING,{frag:t}),null===this.fragCurrent)return this.log("context changed in KEY_LOADING"),Promise.resolve(null);const c=this.fragPrevious;if(j(t)&&(!c||t.sn!==c.sn)){const r=this.shouldLoadParts(e.details,t.end);r!==this.loadingParts&&(this.log(`LL-Part loading ${r?"ON":"OFF"} loading sn ${null==c?void 0:c.sn}->${t.sn}`),this.loadingParts=r)}if(r=Math.max(t.start,r||0),this.loadingParts&&j(t)){const n=o.partList;if(n&&i){r>o.fragmentEnd&&o.fragmentHint&&(t=o.fragmentHint);const s=this.getNextPart(n,t,r);if(s>-1){const c=n[s];let u;return t=this.fragCurrent=c.fragment,this.log(`Loading ${t.type} sn: ${t.sn} part: ${c.index} (${s}/${n.length-1}) of ${this.fragInfo(t,!1,c)}) cc: ${t.cc} [${o.startSN}-${o.endSN}], target: ${parseFloat(r.toFixed(3))}`),this.nextLoadPosition=c.start+c.duration,this.state=zr.FRAG_LOADING,u=a?a.then((r=>!r||this.fragContextChanged(r.frag)?null:this.doFragPartsLoad(t,c,e,i))).catch((t=>this.handleFragLoadError(t))):this.doFragPartsLoad(t,c,e,i).catch((t=>this.handleFragLoadError(t))),this.hls.trigger(l.FRAG_LOADING,{frag:t,part:c,targetBufferTime:r}),null===this.fragCurrent?Promise.reject(new Error("frag load aborted, context changed in FRAG_LOADING parts")):u}if(!t.url||this.loadedEndOfParts(n,r))return Promise.resolve(null)}}var u;if(j(t)&&this.loadingParts)this.log(`LL-Part loading OFF after next part miss @${r.toFixed(2)} Check buffer at sn: ${t.sn} loaded parts: ${null==(u=o.partList)?void 0:u.filter((t=>t.loaded)).map((t=>`[${t.start}-${t.end}]`))}`),this.loadingParts=!1;else if(!t.url)return Promise.resolve(null);this.log(`Loading ${t.type} sn: ${t.sn} of ${this.fragInfo(t,!1)}) cc: ${t.cc} ${"["+o.startSN+"-"+o.endSN+"]"}, target: ${parseFloat(r.toFixed(3))}`),n(t.sn)&&!this.bitrateTest&&(this.nextLoadPosition=t.start+t.duration),this.state=zr.FRAG_LOADING;const h=this.config.progressive;let d;return d=h&&a?a.then((e=>!e||this.fragContextChanged(e.frag)?null:this.fragmentLoader.load(t,i))).catch((t=>this.handleFragLoadError(t))):Promise.all([this.fragmentLoader.load(t,h?i:void 0),a]).then((([t])=>(!h&&i&&i(t),t))).catch((t=>this.handleFragLoadError(t))),this.hls.trigger(l.FRAG_LOADING,{frag:t,targetBufferTime:r}),null===this.fragCurrent?Promise.reject(new Error("frag load aborted, context changed in FRAG_LOADING")):d}doFragPartsLoad(t,e,r,n){return new Promise(((i,s)=>{var o;const a=[],c=null==(o=r.details)?void 0:o.partList,u=e=>{this.fragmentLoader.loadPart(t,e,n).then((n=>{a[e.index]=n;const s=n.part;this.hls.trigger(l.FRAG_LOADED,n);const o=Nr(r.details,t.sn,e.index+1)||Fr(c,t.sn,e.index+1);if(!o)return i({frag:t,part:s,partsLoaded:a});u(o)})).catch(s)};u(e)}))}handleFragLoadError(t){if("data"in t){const e=t.data;e.frag&&e.details===a.INTERNAL_ABORTED?this.handleFragLoadAborted(e.frag,e.part):e.frag&&e.type===o.KEY_SYSTEM_ERROR?(e.frag.abortRequests(),this.resetFragmentLoading(e.frag)):this.hls.trigger(l.ERROR,e)}else this.hls.trigger(l.ERROR,{type:o.OTHER_ERROR,details:a.INTERNAL_EXCEPTION,err:t,error:t,fatal:!0});return null}_handleTransmuxerFlush(t){const e=this.getCurrentContext(t);if(!e||this.state!==zr.PARSING)return void(this.fragCurrent||this.state===zr.STOPPED||this.state===zr.ERROR||(this.state=zr.IDLE));const{frag:r,part:n,level:i}=e,s=self.performance.now();r.stats.parsing.end=s,n&&(n.stats.parsing.end=s);const o=this.getLevelDetails(),a=o&&r.sn>o.endSN||this.shouldLoadParts(o,r.end);a!==this.loadingParts&&(this.log(`LL-Part loading ${a?"ON":"OFF"} after parsing segment ending @${r.end.toFixed(2)}`),this.loadingParts=a),this.updateLevelTiming(r,n,i,t.partial)}shouldLoadParts(t,e){if(this.config.lowLatencyMode){if(!t)return this.loadingParts;if(t.partList){var r;const i=t.partList[0];if(i.fragment.type===u.SUBTITLE)return!1;if(e>=i.end+((null==(r=t.fragmentHint)?void 0:r.duration)||0)){var n;if((this.hls.hasEnoughToStart?(null==(n=this.media)?void 0:n.currentTime)||this.lastCurrentTime:this.getLoadPosition())>i.start-i.fragment.duration)return!0}}}return!1}getCurrentContext(t){const{levels:e,fragCurrent:r}=this,{level:n,sn:i,part:s}=t;if(null==e||!e[n])return this.warn(`Levels object was unset while buffering fragment ${i} of ${this.playlistLabel()} ${n}. The current chunk will not be buffered.`),null;const o=e[n],a=o.details,l=s>-1?Nr(a,i,s):null,c=l?l.fragment:Mr(a,i,r);return c?(r&&r!==c&&(c.stats=r.stats),{frag:c,part:l,level:o}):null}bufferFragmentData(t,e,r,n,i){if(this.state!==zr.PARSING)return;const{data1:s,data2:o}=t;let a=s;if(o&&(a=lt(s,o)),!a.length)return;const c=this.initPTS[e.cc],u=c?-c.baseTime/c.timescale:void 0,h={type:t.type,frag:e,part:r,chunkMeta:n,offset:u,parent:e.type,data:a};if(this.hls.trigger(l.BUFFER_APPENDING,h),t.dropped&&t.independent&&!r){if(i)return;this.flushBufferGap(e)}}flushBufferGap(t){const e=this.media;if(!e)return;if(!Ne.isBuffered(e,e.currentTime))return void this.flushMainBuffer(0,t.start);const r=e.currentTime,n=Ne.bufferInfo(e,r,0),i=t.duration,s=Math.min(2*this.config.maxFragLookUpTolerance,.25*i),o=Math.max(Math.min(t.start-s,n.end-s),r+s);t.start-o>s&&this.flushMainBuffer(o,t.start)}getFwdBufferInfo(t,e){var r;const i=this.getLoadPosition();if(!n(i))return null;const s=this.lastCurrentTime>i||null!=(r=this.media)&&r.paused?0:this.config.maxBufferHole;return this.getFwdBufferInfoAtPos(t,i,e,s)}getFwdBufferInfoAtPos(t,e,r,n){const i=Ne.bufferInfo(t,e,n);if(0===i.len&&void 0!==i.nextStart){const s=this.fragmentTracker.getBufferedFrag(e,r);if(s&&(i.nextStart<=s.end||s.gap)){const r=Math.max(Math.min(i.nextStart,s.end)-e,n);return Ne.bufferInfo(t,e,r)}}return i}getMaxBufferLength(t){const{config:e}=this;let r;return r=t?Math.max(8*e.maxBufferSize/t,e.maxBufferLength):e.maxBufferLength,Math.min(r,e.maxMaxBufferLength)}reduceMaxBufferLength(t,e){const r=this.config,n=Math.max(Math.min(t-e,r.maxBufferLength),e),i=Math.max(t-3*e,r.maxMaxBufferLength/2,n);return i>=n&&(r.maxMaxBufferLength=i,this.warn(`Reduce max buffer length to ${i}s`),!0)}getAppendedFrag(t,e=u.MAIN){const r=this.fragmentTracker?this.fragmentTracker.getAppendedFrag(t,e):null;return r&&"fragment"in r?r.fragment:r}getNextFragment(t,e){const r=e.fragments,n=r.length;if(!n)return null;const{config:i}=this,s=r[0].start,o=i.lowLatencyMode&&!!e.partList;let a=null;if(e.live){const r=i.initialLiveManifestSize;if(n<r)return this.warn(`Not enough fragments to start playback (have: ${n}, need: ${r})`),null;if(!e.PTSKnown&&!this.startFragRequested&&-1===this.startPosition||t<s){var l;o&&!this.loadingParts&&(this.log("LL-Part loading ON for initial live fragment"),this.loadingParts=!0),a=this.getInitialLiveFragment(e);const r=this.hls.startPosition,n=this.hls.liveSyncPosition,i=a?(-1!==r&&r>=s?r:n)||a.start:t;this.log(`Setting startPosition to ${i} to match start frag at live edge. mainStart: ${r} liveSyncPosition: ${n} frag.start: ${null==(l=a)?void 0:l.start}`),this.startPosition=this.nextLoadPosition=i}}else t<=s&&(a=r[0]);if(!a){const r=this.loadingParts?e.partEnd:e.fragmentEnd;a=this.getFragmentAtPosition(t,r,e)}let c=this.filterReplacedPrimary(a,e);if(!c&&a){const t=a.sn-e.startSN;c=this.filterReplacedPrimary(r[t+1]||null,e)}return this.mapToInitFragWhenRequired(c)}isLoopLoading(t,e){const r=this.fragmentTracker.getState(t);return(r===ve||r===ye&&!!t.gap)&&this.nextLoadPosition>e}getNextFragmentLoopLoading(t,e,r,n,i){let s=null;if(t.gap&&(s=this.getNextFragment(this.nextLoadPosition,e),s&&!s.gap&&r.nextStart)){const t=this.getFwdBufferInfoAtPos(this.mediaBuffer?this.mediaBuffer:this.media,r.nextStart,n,0);if(null!==t&&r.len+t.len>=i){const t=s.sn;return this.loopSn!==t&&(this.log(`buffer full after gaps in "${n}" playlist starting at sn: ${t}`),this.loopSn=t),null}}return this.loopSn=void 0,s}get primaryPrefetch(){if(Qr(this.config)){var t;if(null==(t=this.hls.interstitialsManager)||null==(t=t.playingItem)?void 0:t.event)return!0}return!1}filterReplacedPrimary(t,e){if(!t)return t;if(Qr(this.config)&&t.type!==u.SUBTITLE){const r=this.hls.interstitialsManager,n=null==r?void 0:r.bufferingItem;if(n){const r=n.event;if(r){if(r.appendInPlace||Math.abs(t.start-n.start)>1||0===n.start)return null}else{if(t.end<=n.start&&!1===(null==e?void 0:e.live))return null;if(t.start>n.end&&n.nextEvent&&(n.nextEvent.appendInPlace||t.start-n.end>1))return null}}const i=null==r?void 0:r.playerQueue;if(i)for(let e=i.length;e--;){const r=i[e].interstitial;if(r.appendInPlace&&t.start>=r.startTime&&t.end<=r.resumeTime)return null}}return t}mapToInitFragWhenRequired(t){return null==t||!t.initSegment||t.initSegment.data||this.bitrateTest?t:t.initSegment}getNextPart(t,e,r){let n=-1,i=!1,s=!0;for(let o=0,a=t.length;o<a;o++){const a=t[o];if(s=s&&!a.independent,n>-1&&r<a.start)break;const l=a.loaded;l?n=-1:(i||(a.independent||s)&&a.fragment===e)&&(a.fragment!==e&&this.warn(`Need buffer at ${r} but next unloaded part starts at ${a.start}`),n=o),i=l}return n}loadedEndOfParts(t,e){let r;for(let n=t.length;n--;){if(r=t[n],!r.loaded)return!1;if(e>r.start)return!0}return!1}getInitialLiveFragment(t){const e=t.fragments,r=this.fragPrevious;let i=null;if(r){if(t.hasProgramDateTime&&(this.log(`Live playlist, switching playlist, load frag with same PDT: ${r.programDateTime}`),i=function(t,e,r){if(null===e||!Array.isArray(t)||!t.length||!n(e))return null;if(e<(t[0].programDateTime||0))return null;if(e>=(t[t.length-1].endProgramDateTime||0))return null;for(let n=0;n<t.length;++n){const i=t[n];if(ie(e,r,i))return i}return null}(e,r.endProgramDateTime,this.config.maxFragLookUpTolerance)),!i){const n=r.sn+1;if(n>=t.startSN&&n<=t.endSN){const s=e[n-t.startSN];r.cc===s.cc&&(i=s,this.log(`Live playlist, switching playlist, load frag with next SN: ${i.sn}`))}i||(i=se(t,r.cc,r.end),i&&this.log(`Live playlist, switching playlist, load frag with same CC: ${i.sn}`))}}else{const e=this.hls.liveSyncPosition;null!==e&&(i=this.getFragmentAtPosition(e,this.bitrateTest?t.fragmentEnd:t.edge,t))}return i}getFragmentAtPosition(t,e,r){const{config:n}=this;let{fragPrevious:i}=this,{fragments:s,endSN:o}=r;const{fragmentHint:a}=r,{maxFragLookUpTolerance:l}=n,c=r.partList,u=!!(this.loadingParts&&null!=c&&c.length&&a);let h;if(u&&!this.bitrateTest&&c[c.length-1].fragment.sn===a.sn&&(s=s.concat(a),o=a.sn),t<e){var d;h=re(i,s,t,t<this.lastCurrentTime||t>e-l||null!=(d=this.media)&&d.paused||!this.startFragRequested?0:l)}else h=s[s.length-1];if(h){const t=h.sn-r.startSN,e=this.fragmentTracker.getState(h);if((e===ve||e===ye&&h.gap)&&(i=h),i&&h.sn===i.sn&&(!u||c[0].fragment.sn>h.sn||!r.live)){if(h.level===i.level){const e=s[t+1];h=h.sn<o&&this.fragmentTracker.getState(e)!==ve?e:null}}}return h}alignPlaylists(t,e,r){const i=t.fragments.length;if(!i)return this.warn("No fragments in live playlist"),0;const s=t.fragmentStart,o=!e,a=t.alignedSliding&&n(s);if(o||!a&&!s){!function(t,e){t&&(Vr(e,t),e.alignedSliding||Kr(e,t),e.alignedSliding||e.skippedSegments||Or(t,e,!1))}(r,t);const n=t.fragmentStart;return this.log(`Live playlist sliding: ${n.toFixed(2)} start-sn: ${e?e.startSN:"na"}->${t.startSN} fragments: ${i}`),n}return s}waitForCdnTuneIn(t){return t.live&&t.canBlockReload&&t.partTarget&&t.tuneInGoal>Math.max(t.partHoldBack,3*t.partTarget)}setStartPosition(t,e){let r=this.startPosition;r<e&&(r=-1);const i=this.timelineOffset;if(-1===r){const s=null!==this.startTimeOffset,o=s?this.startTimeOffset:t.startTimeOffset;null!==o&&n(o)?(r=e+o,o<0&&(r+=t.edge),r=Math.min(Math.max(e,r),e+t.totalduration),this.log(`Setting startPosition to ${r} for start time offset ${o} found in ${s?"multivariant":"media"} playlist`),this.startPosition=r):t.live?(r=this.hls.liveSyncPosition||e,this.log(`Setting startPosition to -1 to start at live edge ${r}`),this.startPosition=-1):(this.log("setting startPosition to 0 by default"),this.startPosition=r=0),this.lastCurrentTime=r+i}this.nextLoadPosition=r+i}getLoadPosition(){var t;const{media:e}=this;let r=0;return null!=(t=this.hls)&&t.hasEnoughToStart&&e?r=e.currentTime:this.nextLoadPosition>=0&&(r=this.nextLoadPosition),r}handleFragLoadAborted(t,e){this.transmuxer&&t.type===this.playlistType&&j(t)&&t.stats.aborted&&(this.log(`Fragment ${t.sn}${e?" part "+e.index:""} of ${this.playlistLabel()} ${t.level} was aborted`),this.resetFragmentLoading(t))}resetFragmentLoading(t){this.fragCurrent&&(this.fragContextChanged(t)||this.state===zr.FRAG_LOADING_WAITING_RETRY)||(this.state=zr.IDLE)}onFragmentOrKeyLoadError(t,e){var r;if(e.chunkMeta&&!e.frag){const t=this.getCurrentContext(e.chunkMeta);t&&(e.frag=t.frag)}const n=e.frag;if(!n||n.type!==t||!this.levels)return;var i;if(this.fragContextChanged(n))return void this.warn(`Frag load error must match current frag to retry ${n.url} > ${null==(i=this.fragCurrent)?void 0:i.url}`);const s=e.details===a.FRAG_GAP;s&&this.fragmentTracker.fragBuffered(n,!0);const o=e.errorAction;if(!o)return void(this.state=zr.ERROR);const{action:l,flags:c,retryCount:u=0,retryConfig:h}=o,d=!!h,f=d&&l===de.RetryRequest,p=d&&!o.resolved&&c===fe.MoveAllAlternatesMatchingHost,g=null==(r=this.hls.latestLevelDetails)?void 0:r.live;if(!f&&p&&j(n)&&!n.endList&&g)this.resetFragmentErrors(t),this.treatAsGap(n),o.resolved=!0;else if((f||p)&&u<h.maxNumRetry){var m;const r=he(null==(m=e.response)?void 0:m.code),i=le(h,u);if(this.resetStartWhenNotLoaded(),this.retryDate=self.performance.now()+i,this.state=zr.FRAG_LOADING_WAITING_RETRY,o.resolved=!0,r)return this.log("Waiting for connection (offline)"),this.retryDate=1/0,void(e.reason="offline");this.warn(`Fragment ${n.sn} of ${t} ${n.level} errored with ${e.details}, retrying loading ${u+1}/${h.maxNumRetry} in ${i}ms`)}else if(h){if(this.resetFragmentErrors(t),!(u<h.maxNumRetry))return void this.warn(`${e.details} reached or exceeded max retry (${u})`);s||l===de.RemoveAlternatePermanently||(o.resolved=!0)}else l===de.SendAlternateToPenaltyBox?this.state=zr.WAITING_LEVEL:this.state=zr.ERROR;this.tickImmediate()}checkRetryDate(){const t=self.performance.now(),e=this.retryDate,r=e===1/0;(!e||t>=e||r&&!he(0))&&(r&&this.log("Connection restored (online)"),this.resetStartWhenNotLoaded(),this.state=zr.IDLE)}reduceLengthAndFlushBuffer(t){if(this.state===zr.PARSING||this.state===zr.PARSED){const e=t.frag,r=t.parent,n=this.getFwdBufferInfo(this.mediaBuffer,r),i=n&&n.len>.5;i&&this.reduceMaxBufferLength(n.len,(null==e?void 0:e.duration)||10);const s=!i;return s&&this.warn(`Buffer full error while media.currentTime (${this.getLoadPosition()}) is not buffered, flush ${r} buffer`),e&&(this.fragmentTracker.removeFragment(e),this.nextLoadPosition=e.start),this.resetLoadingState(),s}return!1}resetFragmentErrors(t){t===u.AUDIO&&(this.fragCurrent=null),this.hls.hasEnoughToStart||(this.startFragRequested=!1),this.state!==zr.STOPPED&&(this.state=zr.IDLE)}afterBufferFlushed(t,e,r){if(!t)return;const n=Ne.getBuffered(t);this.fragmentTracker.detectEvictedFragments(e,n,r),this.state===zr.ENDED&&this.resetLoadingState()}resetLoadingState(){this.log("Reset loading state"),this.fragCurrent=null,this.fragPrevious=null,this.state!==zr.STOPPED&&(this.state=zr.IDLE)}resetStartWhenNotLoaded(){if(!this.hls.hasEnoughToStart){this.startFragRequested=!1;const t=this.levelLastLoaded,e=t?t.details:null;null!=e&&e.live?(this.log("resetting startPosition for live start"),this.startPosition=-1,this.setStartPosition(e,e.fragmentStart),this.resetLoadingState()):this.nextLoadPosition=this.startPosition}}resetWhenMissingContext(t){this.log(`Loading context changed while buffering sn ${t.sn} of ${this.playlistLabel()} ${-1===t.level?"<removed>":t.level}. This chunk will not be buffered.`),this.removeUnbufferedFrags(),this.resetStartWhenNotLoaded(),this.resetLoadingState()}removeUnbufferedFrags(t=0){this.fragmentTracker.removeFragmentsInRange(t,1/0,this.playlistType,!1,!0)}updateLevelTiming(t,e,r,n){const i=r.details;if(!i)return void this.warn("level.details undefined");var s;if(!Object.keys(t.elementaryStreams).reduce(((e,s)=>{const o=t.elementaryStreams[s];if(o){const a=o.endPTS-o.startPTS;if(a<=0)return this.warn(`Could not parse fragment ${t.sn} ${s} duration reliably (${a})`),e||!1;const c=n?0:Pr(i,t,o.startPTS,o.endPTS,o.startDTS,o.endDTS,this);return this.hls.trigger(l.LEVEL_PTS_UPDATED,{details:i,level:r,drift:c,type:s,frag:t,start:o.startPTS,end:o.endPTS}),!0}return e}),!1)&&(0===r.fragmentError&&this.treatAsGap(t,r),null===(null==(s=this.transmuxer)?void 0:s.error))){const e=new Error(`Found no media in fragment ${t.sn} of ${this.playlistLabel()} ${t.level} resetting transmuxer to fallback to playlist timing`);if(this.warn(e.message),this.hls.trigger(l.ERROR,{type:o.MEDIA_ERROR,details:a.FRAG_PARSING_ERROR,fatal:!1,error:e,frag:t,reason:`Found no media in msn ${t.sn} of ${this.playlistLabel()} "${r.url}"`}),!this.hls)return;this.resetTransmuxer()}this.state=zr.PARSED,this.log(`Parsed ${t.type} sn: ${t.sn}${e?" part: "+e.index:""} of ${this.fragInfo(t,!1,e)})`),this.hls.trigger(l.FRAG_PARSED,{frag:t,part:e})}playlistLabel(){return this.playlistType===u.MAIN?"level":"track"}fragInfo(t,e=!0,r){var n,i;return`${this.playlistLabel()} ${t.level} (${r?"part":"frag"}:[${(null!=(n=e&&!r?t.startPTS:(r||t).start)?n:NaN).toFixed(3)}-${(null!=(i=e&&!r?t.endPTS:(r||t).end)?i:NaN).toFixed(3)}]${r&&"main"===t.type?"INDEPENDENT="+(r.independent?"YES":"NO"):""}`}treatAsGap(t,e){e&&e.fragmentError++,t.gap=!0,this.fragmentTracker.removeFragment(t),this.fragmentTracker.fragBuffered(t,!0)}resetTransmuxer(){var t;null==(t=this.transmuxer)||t.reset()}recoverWorkerError(t){"demuxerWorker"===t.event&&(this.fragmentTracker.removeAllFragments(),this.transmuxer&&(this.transmuxer.destroy(),this.transmuxer=null),this.resetStartWhenNotLoaded(),this.resetLoadingState())}set state(t){const e=this._state;e!==t&&(this._state=t,this.log(`${e}->${t}`))}get state(){return this._state}}function Qr(t){return!!t.interstitialsController&&!1!==t.enableInterstitialPlayback}class Jr{constructor(){this.chunks=[],this.dataLength=0}push(t){this.chunks.push(t),this.dataLength+=t.length}flush(){const{chunks:t,dataLength:e}=this;let r;return t.length?(r=1===t.length?t[0]:function(t,e){const r=new Uint8Array(e);let n=0;for(let e=0;e<t.length;e++){const i=t[e];r.set(i,n),n+=i.length}return r}(t,e),this.reset(),r):new Uint8Array(0)}reset(){this.chunks.length=0,this.dataLength=0}}var Zr,tn={exports:{}};var en=(Zr||(Zr=1,function(t){var e=Object.prototype.hasOwnProperty,r="~";function n(){}function i(t,e,r){this.fn=t,this.context=e,this.once=r||!1}function s(t,e,n,s,o){if("function"!=typeof n)throw new TypeError("The listener must be a function");var a=new i(n,s||t,o),l=r?r+e:e;return t._events[l]?t._events[l].fn?t._events[l]=[t._events[l],a]:t._events[l].push(a):(t._events[l]=a,t._eventsCount++),t}function o(t,e){0==--t._eventsCount?t._events=new n:delete t._events[e]}function a(){this._events=new n,this._eventsCount=0}Object.create&&(n.prototype=Object.create(null),(new n).__proto__||(r=!1)),a.prototype.eventNames=function(){var t,n,i=[];if(0===this._eventsCount)return i;for(n in t=this._events)e.call(t,n)&&i.push(r?n.slice(1):n);return Object.getOwnPropertySymbols?i.concat(Object.getOwnPropertySymbols(t)):i},a.prototype.listeners=function(t){var e=r?r+t:t,n=this._events[e];if(!n)return[];if(n.fn)return[n.fn];for(var i=0,s=n.length,o=new Array(s);i<s;i++)o[i]=n[i].fn;return o},a.prototype.listenerCount=function(t){var e=r?r+t:t,n=this._events[e];return n?n.fn?1:n.length:0},a.prototype.emit=function(t,e,n,i,s,o){var a=r?r+t:t;if(!this._events[a])return!1;var l,c,u=this._events[a],h=arguments.length;if(u.fn){switch(u.once&&this.removeListener(t,u.fn,void 0,!0),h){case 1:return u.fn.call(u.context),!0;case 2:return u.fn.call(u.context,e),!0;case 3:return u.fn.call(u.context,e,n),!0;case 4:return u.fn.call(u.context,e,n,i),!0;case 5:return u.fn.call(u.context,e,n,i,s),!0;case 6:return u.fn.call(u.context,e,n,i,s,o),!0}for(c=1,l=new Array(h-1);c<h;c++)l[c-1]=arguments[c];u.fn.apply(u.context,l)}else{var d,f=u.length;for(c=0;c<f;c++)switch(u[c].once&&this.removeListener(t,u[c].fn,void 0,!0),h){case 1:u[c].fn.call(u[c].context);break;case 2:u[c].fn.call(u[c].context,e);break;case 3:u[c].fn.call(u[c].context,e,n);break;case 4:u[c].fn.call(u[c].context,e,n,i);break;default:if(!l)for(d=1,l=new Array(h-1);d<h;d++)l[d-1]=arguments[d];u[c].fn.apply(u[c].context,l)}}return!0},a.prototype.on=function(t,e,r){return s(this,t,e,r,!1)},a.prototype.once=function(t,e,r){return s(this,t,e,r,!0)},a.prototype.removeListener=function(t,e,n,i){var s=r?r+t:t;if(!this._events[s])return this;if(!e)return o(this,s),this;var a=this._events[s];if(a.fn)a.fn!==e||i&&!a.once||n&&a.context!==n||o(this,s);else{for(var l=0,c=[],u=a.length;l<u;l++)(a[l].fn!==e||i&&!a[l].once||n&&a[l].context!==n)&&c.push(a[l]);c.length?this._events[s]=1===c.length?c[0]:c:o(this,s)}return this},a.prototype.removeAllListeners=function(t){var e;return t?(e=r?r+t:t,this._events[e]&&o(this,e)):(this._events=new n,this._eventsCount=0),this},a.prototype.off=a.prototype.removeListener,a.prototype.addListener=a.prototype.on,a.prefixed=r,a.EventEmitter=a,t.exports=a}(tn)),tn.exports),rn=P(en);const nn="1.6.11",sn={};function on(t,e){return e+10<=t.length&&51===t[e]&&68===t[e+1]&&73===t[e+2]&&t[e+3]<255&&t[e+4]<255&&t[e+6]<128&&t[e+7]<128&&t[e+8]<128&&t[e+9]<128}function an(t,e){return e+10<=t.length&&73===t[e]&&68===t[e+1]&&51===t[e+2]&&t[e+3]<255&&t[e+4]<255&&t[e+6]<128&&t[e+7]<128&&t[e+8]<128&&t[e+9]<128}function ln(t,e){let r=0;return r=(127&t[e])<<21,r|=(127&t[e+1])<<14,r|=(127&t[e+2])<<7,r|=127&t[e+3],r}function cn(t,e){const r=e;let n=0;for(;an(t,e);){n+=10;n+=ln(t,e+6),on(t,e+10)&&(n+=10),e+=n}if(n>0)return t.subarray(r,r+n)}function un(t,e){return 255===t[e]&&240==(246&t[e+1])}function hn(t,e){return 1&t[e+1]?7:9}function dn(t,e){return(3&t[e+3])<<11|t[e+4]<<3|(224&t[e+5])>>>5}function fn(t,e){return e+1<t.length&&un(t,e)}function pn(t,e){if(fn(t,e)){const r=hn(t,e);if(e+r>=t.length)return!1;const n=dn(t,e);if(n<=r)return!1;const i=e+n;return i===t.length||fn(t,i)}return!1}function gn(t,e,r,n,i){if(!t.samplerate){const s=function(t,e,r,n){const i=e[r+2],s=i>>2&15;if(s>12){const e=new Error(`invalid ADTS sampling index:${s}`);return void t.emit(l.ERROR,l.ERROR,{type:o.MEDIA_ERROR,details:a.FRAG_PARSING_ERROR,fatal:!0,error:e,reason:e.message})}const c=1+(i>>6&3),u=e[r+3]>>6&3|(1&i)<<2,h="mp4a.40."+c,d=[96e3,88200,64e3,48e3,44100,32e3,24e3,22050,16e3,12e3,11025,8e3,7350][s];let f=s;5!==c&&29!==c||(f-=3);const p=[c<<3|(14&f)>>1,(1&f)<<7|u<<3];return T.log(`manifest codec:${n}, parsed codec:${h}, channels:${u}, rate:${d} (ADTS object type:${c} sampling index:${s})`),{config:p,samplerate:d,channelCount:u,codec:h,parsedCodec:h,manifestCodec:n}}(e,r,n,i);if(!s)return;p(t,s)}}function mn(t){return 9216e4/t}function yn(t,e,r,n,i){const s=n+i*mn(t.samplerate),o=function(t,e){const r=hn(t,e);if(e+r<=t.length){const n=dn(t,e)-r;if(n>0)return{headerLength:r,frameLength:n}}}(e,r);let a;if(o){const{frameLength:n,headerLength:i}=o,l=i+n,c=Math.max(0,r+l-e.length);c?(a=new Uint8Array(l-i),a.set(e.subarray(r+i,e.length),0)):a=e.subarray(r+i,r+l);const u={unit:a,pts:s};return c||t.samples.push(u),{sample:u,length:l,missing:c}}const l=e.length-r;a=new Uint8Array(l),a.set(e.subarray(r,e.length),0);return{sample:{unit:a,pts:s},length:l,missing:-1}}function vn(t,e){return an(t,e)&&ln(t,e+6)+10<=t.length-e}function bn(t,e=0,r=1/0){return function(t,e,r,n){const i=function(t){return t instanceof ArrayBuffer?t:t.buffer}(t);let s=1;"BYTES_PER_ELEMENT"in n&&(s=n.BYTES_PER_ELEMENT);const o=(h=t,h&&h.buffer instanceof ArrayBuffer&&void 0!==h.byteLength&&void 0!==h.byteOffset?t.byteOffset:0),a=(o+t.byteLength)/s,l=(o+e)/s,c=Math.floor(Math.max(0,Math.min(l,a))),u=Math.floor(Math.min(c+Math.max(r,0),a));var h;return new n(i,c,u-c)}(t,e,r,Uint8Array)}function En(t){const e={key:t.type,description:"",data:"",mimeType:null,pictureType:null};if(t.size<2)return;if(3!==t.data[0])return;const r=t.data.subarray(1).indexOf(0);if(-1===r)return;const n=_(bn(t.data,1,r)),i=t.data[2+r],s=t.data.subarray(3+r).indexOf(0);if(-1===s)return;const o=_(bn(t.data,3+r,s));let a;return a="--\x3e"===n?_(bn(t.data,4+r+s)):function(t){return t instanceof ArrayBuffer?t:0==t.byteOffset&&t.byteLength==t.buffer.byteLength?t.buffer:new Uint8Array(t).buffer}(t.data.subarray(4+r+s)),e.mimeType=n,e.pictureType=i,e.description=o,e.data=a,e}function An(t){return"PRIV"===t.type?function(t){if(t.size<2)return;const e=_(t.data,!0),r=new Uint8Array(t.data.subarray(e.length+1));return{key:t.type,info:e,data:r.buffer}}(t):"W"===t.type[0]?function(t){if("WXXX"===t.type){if(t.size<2)return;let e=1;const r=_(t.data.subarray(e),!0);e+=r.length+1;const n=_(t.data.subarray(e));return{key:t.type,info:r,data:n}}const e=_(t.data);return{key:t.type,info:"",data:e}}(t):"APIC"===t.type?En(t):function(t){if(t.size<2)return;if("TXXX"===t.type){let e=1;const r=_(t.data.subarray(e),!0);e+=r.length+1;const n=_(t.data.subarray(e));return{key:t.type,info:r,data:n}}const e=_(t.data.subarray(1));return{key:t.type,info:"",data:e}}(t)}function wn(t){const e=String.fromCharCode(t[0],t[1],t[2],t[3]),r=ln(t,4);return{type:e,size:r,data:t.subarray(10,10+r)}}const Tn=10,Sn=10;function Ln(t){let e=0;const r=[];for(;an(t,e);){const n=ln(t,e+6);t[e+5]>>6&1&&(e+=Tn),e+=Tn;const i=e+n;for(;e+Sn<i;){const n=wn(t.subarray(e)),i=An(n);i&&r.push(i),e+=n.size+Tn}on(t,e)&&(e+=Tn)}return r}function _n(t){return t&&"PRIV"===t.key&&"com.apple.streaming.transportStreamTimestamp"===t.info}function xn(t){if(8===t.data.byteLength){const e=new Uint8Array(t.data),r=1&e[3];let n=(e[4]<<23)+(e[5]<<15)+(e[6]<<7)+e[7];return n/=45,r&&(n+=47721858.84),Math.round(n)}}function kn(t){const e=Ln(t);for(let t=0;t<e.length;t++){const r=e[t];if(_n(r))return xn(r)}}let Pn=function(t){return t.audioId3="org.id3",t.dateRange="com.apple.quicktime.HLS",t.emsg="https://aomedia.org/emsg/ID3",t.misbklv="urn:misb:KLV:bin:1910.1",t}({});function In(t="",e=9e4){return{type:t,id:-1,pid:-1,inputTimeScale:e,sequenceNumber:-1,samples:[],dropped:0}}class Rn{constructor(){this._audioTrack=void 0,this._id3Track=void 0,this.frameIndex=0,this.cachedData=null,this.basePTS=null,this.initPTS=null,this.lastPTS=null}resetInitSegment(t,e,r,n){this._id3Track={type:"id3",id:3,pid:-1,inputTimeScale:9e4,sequenceNumber:0,samples:[],dropped:0}}resetTimeStamp(t){this.initPTS=t,this.resetContiguity()}resetContiguity(){this.basePTS=null,this.lastPTS=null,this.frameIndex=0}canParse(t,e){return!1}appendFrame(t,e,r){}demux(t,e){this.cachedData&&(t=lt(this.cachedData,t),this.cachedData=null);let r,i=cn(t,0),s=i?i.length:0;const o=this._audioTrack,a=this._id3Track,l=i?kn(i):void 0,c=t.length;for((null===this.basePTS||0===this.frameIndex&&n(l))&&(this.basePTS=On(l,e,this.initPTS),this.lastPTS=this.basePTS),null===this.lastPTS&&(this.lastPTS=this.basePTS),i&&i.length>0&&a.samples.push({pts:this.lastPTS,dts:this.lastPTS,data:i,type:Pn.audioId3,duration:Number.POSITIVE_INFINITY});s<c;){if(this.canParse(t,s)){const e=this.appendFrame(o,t,s);e?(this.frameIndex++,this.lastPTS=e.sample.pts,s+=e.length,r=s):s=c}else vn(t,s)?(i=cn(t,s),a.samples.push({pts:this.lastPTS,dts:this.lastPTS,data:i,type:Pn.audioId3,duration:Number.POSITIVE_INFINITY}),s+=i.length,r=s):s++;if(s===c&&r!==c){const e=t.slice(r);this.cachedData?this.cachedData=lt(this.cachedData,e):this.cachedData=e}}return{audioTrack:o,videoTrack:In(),id3Track:a,textTrack:In()}}demuxSampleAes(t,e,r){return Promise.reject(new Error(`[${this}] This demuxer does not support Sample-AES decryption`))}flush(t){const e=this.cachedData;return e&&(this.cachedData=null,this.demux(e,0)),{audioTrack:this._audioTrack,videoTrack:In(),id3Track:this._id3Track,textTrack:In()}}destroy(){this.cachedData=null,this._audioTrack=this._id3Track=void 0}}const On=(t,e,r)=>{if(n(t))return 90*t;return 9e4*e+(r?9e4*r.baseTime/r.timescale:0)};let Dn=null;const Cn=[32,64,96,128,160,192,224,256,288,320,352,384,416,448,32,48,56,64,80,96,112,128,160,192,224,256,320,384,32,40,48,56,64,80,96,112,128,160,192,224,256,320,32,48,56,64,80,96,112,128,144,160,176,192,224,256,8,16,24,32,40,48,56,64,80,96,112,128,144,160],Mn=[44100,48e3,32e3,22050,24e3,16e3,11025,12e3,8e3],Nn=[[0,72,144,12],[0,0,0,0],[0,72,144,12],[0,144,144,12]],Fn=[0,1,1,4];function Un(t,e,r,n,i){if(r+24>e.length)return;const s=Bn(e,r);if(s&&r+s.frameLength<=e.length){const o=n+i*(9e4*s.samplesPerFrame/s.sampleRate),a={unit:e.subarray(r,r+s.frameLength),pts:o,dts:o};return t.config=[],t.channelCount=s.channelCount,t.samplerate=s.sampleRate,t.samples.push(a),{sample:a,length:s.frameLength,missing:0}}}function Bn(t,e){const r=t[e+1]>>3&3,n=t[e+1]>>1&3,i=t[e+2]>>4&15,s=t[e+2]>>2&3;if(1!==r&&0!==i&&15!==i&&3!==s){const o=t[e+2]>>1&1,a=t[e+3]>>6,l=1e3*Cn[14*(3===r?3-n:3===n?3:4)+i-1],c=Mn[3*(3===r?0:2===r?1:2)+s],u=3===a?1:2,h=Nn[r][n],d=Fn[n],f=8*h*d,p=Math.floor(h*l/c+o)*d;if(null===Dn){const t=(navigator.userAgent||"").match(/Chrome\/(\d+)/i);Dn=t?parseInt(t[1]):0}return!!Dn&&Dn<=87&&2===n&&l>=224e3&&0===a&&(t[e+3]=128|t[e+3]),{sampleRate:c,channelCount:u,frameLength:p,samplesPerFrame:f}}}function $n(t,e){return 255===t[e]&&224==(224&t[e+1])&&0!=(6&t[e+1])}function jn(t,e){return e+1<t.length&&$n(t,e)}function Gn(t,e){if(e+1<t.length&&$n(t,e)){const r=4,n=Bn(t,e);let i=r;null!=n&&n.frameLength&&(i=n.frameLength);const s=e+i;return s===t.length||jn(t,s)}return!1}const Hn=(t,e)=>{let r=0,n=5;e+=n;const i=new Uint32Array(1),s=new Uint32Array(1),o=new Uint8Array(1);for(;n>0;){o[0]=t[e];const a=Math.min(n,8),l=8-a;s[0]=4278190080>>>24+l<<l,i[0]=(o[0]&s[0])>>l,r=r?r<<a|i[0]:i[0],e+=1,n-=a}return r};class Vn extends Rn{constructor(t){super(),this.observer=void 0,this.observer=t}resetInitSegment(t,e,r,n){super.resetInitSegment(t,e,r,n),this._audioTrack={container:"audio/ac-3",type:"audio",id:2,pid:-1,sequenceNumber:0,segmentCodec:"ac3",samples:[],manifestCodec:e,duration:n,inputTimeScale:9e4,dropped:0}}canParse(t,e){return e+64<t.length}appendFrame(t,e,r){const n=Kn(t,e,r,this.basePTS,this.frameIndex);if(-1!==n){return{sample:t.samples[t.samples.length-1],length:n,missing:0}}}static probe(t){if(!t)return!1;const e=cn(t,0);if(!e)return!1;const r=e.length;return 11===t[r]&&119===t[r+1]&&void 0!==kn(e)&&Hn(t,r)<16}}function Kn(t,e,r,n,i){if(r+8>e.length)return-1;if(11!==e[r]||119!==e[r+1])return-1;const s=e[r+4]>>6;if(s>=3)return-1;const o=[48e3,44100,32e3][s],a=63&e[r+4],l=2*[64,69,96,64,70,96,80,87,120,80,88,120,96,104,144,96,105,144,112,121,168,112,122,168,128,139,192,128,140,192,160,174,240,160,175,240,192,208,288,192,209,288,224,243,336,224,244,336,256,278,384,256,279,384,320,348,480,320,349,480,384,417,576,384,418,576,448,487,672,448,488,672,512,557,768,512,558,768,640,696,960,640,697,960,768,835,1152,768,836,1152,896,975,1344,896,976,1344,1024,1114,1536,1024,1115,1536,1152,1253,1728,1152,1254,1728,1280,1393,1920,1280,1394,1920][3*a+s];if(r+l>e.length)return-1;const c=e[r+6]>>5;let u=0;2===c?u+=2:(1&c&&1!==c&&(u+=2),4&c&&(u+=2));const h=(e[r+6]<<8|e[r+7])>>12-u&1,d=[2,1,2,3,3,4,4,5][c]+h,f=e[r+5]>>3,p=7&e[r+5],g=new Uint8Array([s<<6|f<<1|p>>2,(3&p)<<6|c<<3|h<<2|a>>4,a<<4&224]),m=n+i*(1536/o*9e4),y=e.subarray(r,r+l);return t.config=g,t.channelCount=d,t.samplerate=o,t.samples.push({unit:y,pts:m}),l}const Yn=/\/emsg[-/]ID3/i;function qn(t,e){return n(t.presentationTime)?t.presentationTime/t.timeScale:e+t.presentationTimeDelta/t.timeScale}class Wn{constructor(t,e,r){this.keyData=void 0,this.decrypter=void 0,this.keyData=r,this.decrypter=new xe(e,{removePKCS7Padding:!1})}decryptBuffer(t){return this.decrypter.decrypt(t,this.keyData.key.buffer,this.keyData.iv.buffer,Te.cbc)}decryptAacSample(t,e,r){const n=t[e].unit;if(n.length<=16)return;const i=n.subarray(16,n.length-n.length%16),s=i.buffer.slice(i.byteOffset,i.byteOffset+i.length);this.decryptBuffer(s).then((i=>{const s=new Uint8Array(i);n.set(s,16),this.decrypter.isSync()||this.decryptAacSamples(t,e+1,r)})).catch(r)}decryptAacSamples(t,e,r){for(;;e++){if(e>=t.length)return void r();if(!(t[e].unit.length<32)&&(this.decryptAacSample(t,e,r),!this.decrypter.isSync()))return}}getAvcEncryptedData(t){const e=16*Math.floor((t.length-48)/160)+16,r=new Int8Array(e);let n=0;for(let e=32;e<t.length-16;e+=160,n+=16)r.set(t.subarray(e,e+16),n);return r}getAvcDecryptedUnit(t,e){const r=new Uint8Array(e);let n=0;for(let e=32;e<t.length-16;e+=160,n+=16)t.set(r.subarray(n,n+16),e);return t}decryptAvcSample(t,e,r,n,i){const s=ft(i.data),o=this.getAvcEncryptedData(s);this.decryptBuffer(o.buffer).then((o=>{i.data=this.getAvcDecryptedUnit(s,o),this.decrypter.isSync()||this.decryptAvcSamples(t,e,r+1,n)})).catch(n)}decryptAvcSamples(t,e,r,n){if(t instanceof Uint8Array)throw new Error("Cannot decrypt samples of type Uint8Array");for(;;e++,r=0){if(e>=t.length)return void n();const i=t[e].units;for(;!(r>=i.length);r++){const s=i[r];if(!(s.data.length<=48||1!==s.type&&5!==s.type||(this.decryptAvcSample(t,e,r,n,s),this.decrypter.isSync())))return}}}}class zn{constructor(){this.VideoSample=null}createVideoSample(t,e,r){return{key:t,frame:!1,pts:e,dts:r,units:[],length:0}}getLastNalUnit(t){var e;let r,n=this.VideoSample;if(n&&0!==n.units.length||(n=t[t.length-1]),null!=(e=n)&&e.units){const t=n.units;r=t[t.length-1]}return r}pushAccessUnit(t,e){if(t.units.length&&t.frame){if(void 0===t.pts){const r=e.samples,n=r.length;if(!n)return void e.dropped++;{const e=r[n-1];t.pts=e.pts,t.dts=e.dts}}e.samples.push(t)}}parseNALu(t,e,r){const n=e.byteLength;let i=t.naluState||0;const s=i,o=[];let a,l,c,u=0,h=-1,d=0;for(-1===i&&(h=0,d=this.getNALuType(e,0),i=0,u=1);u<n;)if(a=e[u++],i)if(1!==i)if(a)if(1===a){if(l=u-i-1,h>=0){const t={data:e.subarray(h,l),type:d};o.push(t)}else{const r=this.getLastNalUnit(t.samples);r&&(s&&u<=4-s&&r.state&&(r.data=r.data.subarray(0,r.data.byteLength-s)),l>0&&(r.data=lt(r.data,e.subarray(0,l)),r.state=0))}u<n?(c=this.getNALuType(e,u),h=u,d=c,i=0):i=-1}else i=0;else i=3;else i=a?0:2;else i=a?0:1;if(h>=0&&i>=0){const t={data:e.subarray(h,n),type:d,state:i};o.push(t)}if(0===o.length){const r=this.getLastNalUnit(t.samples);r&&(r.data=lt(r.data,e))}return t.naluState=i,o}}class Xn{constructor(t){this.data=void 0,this.bytesAvailable=void 0,this.word=void 0,this.bitsAvailable=void 0,this.data=t,this.bytesAvailable=t.byteLength,this.word=0,this.bitsAvailable=0}loadWord(){const t=this.data,e=this.bytesAvailable,r=t.byteLength-e,n=new Uint8Array(4),i=Math.min(4,e);if(0===i)throw new Error("no bytes available");n.set(t.subarray(r,r+i)),this.word=new DataView(n.buffer).getUint32(0),this.bitsAvailable=8*i,this.bytesAvailable-=i}skipBits(t){let e;t=Math.min(t,8*this.bytesAvailable+this.bitsAvailable),this.bitsAvailable>t?(this.word<<=t,this.bitsAvailable-=t):(e=(t-=this.bitsAvailable)>>3,t-=e<<3,this.bytesAvailable-=e,this.loadWord(),this.word<<=t,this.bitsAvailable-=t)}readBits(t){let e=Math.min(this.bitsAvailable,t);const r=this.word>>>32-e;if(t>32&&T.error("Cannot read more than 32 bits at a time"),this.bitsAvailable-=e,this.bitsAvailable>0)this.word<<=e;else{if(!(this.bytesAvailable>0))throw new Error("no bits available");this.loadWord()}return e=t-e,e>0&&this.bitsAvailable?r<<e|this.readBits(e):r}skipLZ(){let t;for(t=0;t<this.bitsAvailable;++t)if(0!=(this.word&2147483648>>>t))return this.word<<=t,this.bitsAvailable-=t,t;return this.loadWord(),t+this.skipLZ()}skipUEG(){this.skipBits(1+this.skipLZ())}skipEG(){this.skipBits(1+this.skipLZ())}readUEG(){const t=this.skipLZ();return this.readBits(t+1)-1}readEG(){const t=this.readUEG();return 1&t?1+t>>>1:-1*(t>>>1)}readBoolean(){return 1===this.readBits(1)}readUByte(){return this.readBits(8)}readUShort(){return this.readBits(16)}readUInt(){return this.readBits(32)}}class Qn extends zn{parsePES(t,e,r,n){const i=this.parseNALu(t,r.data,n);let s,o=this.VideoSample,a=!1;r.data=null,o&&i.length&&!t.audFound&&(this.pushAccessUnit(o,t),o=this.VideoSample=this.createVideoSample(!1,r.pts,r.dts)),i.forEach((n=>{var i,l;switch(n.type){case 1:{let e=!1;s=!0;const i=n.data;if(a&&i.length>4){const t=this.readSliceType(i);2!==t&&4!==t&&7!==t&&9!==t||(e=!0)}var c;if(e)null!=(c=o)&&c.frame&&!o.key&&(this.pushAccessUnit(o,t),o=this.VideoSample=null);o||(o=this.VideoSample=this.createVideoSample(!0,r.pts,r.dts)),o.frame=!0,o.key=e;break}case 5:s=!0,null!=(i=o)&&i.frame&&!o.key&&(this.pushAccessUnit(o,t),o=this.VideoSample=null),o||(o=this.VideoSample=this.createVideoSample(!0,r.pts,r.dts)),o.key=!0,o.frame=!0;break;case 6:s=!0,dt(n.data,1,r.pts,e.samples);break;case 7:{var u,h;s=!0,a=!0;const e=n.data,r=this.readSPS(e);if(!t.sps||t.width!==r.width||t.height!==r.height||(null==(u=t.pixelRatio)?void 0:u[0])!==r.pixelRatio[0]||(null==(h=t.pixelRatio)?void 0:h[1])!==r.pixelRatio[1]){t.width=r.width,t.height=r.height,t.pixelRatio=r.pixelRatio,t.sps=[e];const n=e.subarray(1,4);let i="avc1.";for(let t=0;t<3;t++){let e=n[t].toString(16);e.length<2&&(e="0"+e),i+=e}t.codec=i}break}case 8:s=!0,t.pps=[n.data];break;case 9:s=!0,t.audFound=!0,null!=(l=o)&&l.frame&&(this.pushAccessUnit(o,t),o=null),o||(o=this.VideoSample=this.createVideoSample(!1,r.pts,r.dts));break;case 12:s=!0;break;default:s=!1}if(o&&s){o.units.push(n)}})),n&&o&&(this.pushAccessUnit(o,t),this.VideoSample=null)}getNALuType(t,e){return 31&t[e]}readSliceType(t){const e=new Xn(t);return e.readUByte(),e.readUEG(),e.readUEG()}skipScalingList(t,e){let r,n=8,i=8;for(let s=0;s<t;s++)0!==i&&(r=e.readEG(),i=(n+r+256)%256),n=0===i?n:i}readSPS(t){const e=new Xn(t);let r,n,i,s=0,o=0,a=0,l=0;const c=e.readUByte.bind(e),u=e.readBits.bind(e),h=e.readUEG.bind(e),d=e.readBoolean.bind(e),f=e.skipBits.bind(e),p=e.skipEG.bind(e),g=e.skipUEG.bind(e),m=this.skipScalingList.bind(this);c();const y=c();if(u(5),f(3),c(),g(),100===y||110===y||122===y||244===y||44===y||83===y||86===y||118===y||128===y){const t=h();if(3===t&&f(1),g(),g(),f(1),d())for(n=3!==t?8:12,i=0;i<n;i++)d()&&m(i<6?16:64,e)}g();const v=h();if(0===v)h();else if(1===v)for(f(1),p(),p(),r=h(),i=0;i<r;i++)p();g(),f(1);const b=h(),E=h(),A=u(1);0===A&&f(1),f(1),d()&&(s=h(),o=h(),a=h(),l=h());let w=[1,1];if(d()&&d()){switch(c()){case 1:w=[1,1];break;case 2:w=[12,11];break;case 3:w=[10,11];break;case 4:w=[16,11];break;case 5:w=[40,33];break;case 6:w=[24,11];break;case 7:w=[20,11];break;case 8:w=[32,11];break;case 9:w=[80,33];break;case 10:w=[18,11];break;case 11:w=[15,11];break;case 12:w=[64,33];break;case 13:w=[160,99];break;case 14:w=[4,3];break;case 15:w=[3,2];break;case 16:w=[2,1];break;case 255:w=[c()<<8|c(),c()<<8|c()]}}return{width:Math.ceil(16*(b+1)-2*s-2*o),height:(2-A)*(E+1)*16-(A?2:4)*(a+l),pixelRatio:w}}}class Jn extends zn{constructor(...t){super(...t),this.initVPS=null}parsePES(t,e,r,n){const i=this.parseNALu(t,r.data,n);let s,o=this.VideoSample,a=!1;r.data=null,o&&i.length&&!t.audFound&&(this.pushAccessUnit(o,t),o=this.VideoSample=this.createVideoSample(!1,r.pts,r.dts)),i.forEach((n=>{var i,l;switch(n.type){case 0:case 1:case 2:case 3:case 4:case 5:case 6:case 7:case 8:case 9:o||(o=this.VideoSample=this.createVideoSample(!1,r.pts,r.dts)),o.frame=!0,s=!0;break;case 16:case 17:case 18:case 21:var c;if(s=!0,a)null!=(c=o)&&c.frame&&!o.key&&(this.pushAccessUnit(o,t),o=this.VideoSample=null);o||(o=this.VideoSample=this.createVideoSample(!0,r.pts,r.dts)),o.key=!0,o.frame=!0;break;case 19:case 20:s=!0,null!=(i=o)&&i.frame&&!o.key&&(this.pushAccessUnit(o,t),o=this.VideoSample=null),o||(o=this.VideoSample=this.createVideoSample(!0,r.pts,r.dts)),o.key=!0,o.frame=!0;break;case 39:s=!0,dt(n.data,2,r.pts,e.samples);break;case 32:s=!0,t.vps||("object"!=typeof t.params&&(t.params={}),t.params=p(t.params,this.readVPS(n.data)),this.initVPS=n.data),t.vps=[n.data];break;case 33:if(s=!0,a=!0,void 0===t.vps||t.vps[0]===this.initVPS||void 0===t.sps||this.matchSPS(t.sps[0],n.data)||(this.initVPS=t.vps[0],t.sps=t.pps=void 0),!t.sps){const e=this.readSPS(n.data);t.width=e.width,t.height=e.height,t.pixelRatio=e.pixelRatio,t.codec=e.codecString,t.sps=[],"object"!=typeof t.params&&(t.params={});for(const r in e.params)t.params[r]=e.params[r]}this.pushParameterSet(t.sps,n.data,t.vps),o||(o=this.VideoSample=this.createVideoSample(!0,r.pts,r.dts)),o.key=!0;break;case 34:if(s=!0,"object"==typeof t.params){if(!t.pps){t.pps=[];const e=this.readPPS(n.data);for(const r in e)t.params[r]=e[r]}this.pushParameterSet(t.pps,n.data,t.vps)}break;case 35:s=!0,t.audFound=!0,null!=(l=o)&&l.frame&&(this.pushAccessUnit(o,t),o=null),o||(o=this.VideoSample=this.createVideoSample(!1,r.pts,r.dts));break;default:s=!1}if(o&&s){o.units.push(n)}})),n&&o&&(this.pushAccessUnit(o,t),this.VideoSample=null)}pushParameterSet(t,e,r){(r&&r[0]===this.initVPS||!r&&!t.length)&&t.push(e)}getNALuType(t,e){return(126&t[e])>>>1}ebsp2rbsp(t){const e=new Uint8Array(t.byteLength);let r=0;for(let n=0;n<t.byteLength;n++)n>=2&&3===t[n]&&0===t[n-1]&&0===t[n-2]||(e[r]=t[n],r++);return new Uint8Array(e.buffer,0,r)}pushAccessUnit(t,e){super.pushAccessUnit(t,e),this.initVPS&&(this.initVPS=null)}readVPS(t){const e=new Xn(t);e.readUByte(),e.readUByte(),e.readBits(4),e.skipBits(2),e.readBits(6);return{numTemporalLayers:e.readBits(3)+1,temporalIdNested:e.readBoolean()}}readSPS(t){const e=new Xn(this.ebsp2rbsp(t));e.readUByte(),e.readUByte(),e.readBits(4);const r=e.readBits(3);e.readBoolean();const n=e.readBits(2),i=e.readBoolean(),s=e.readBits(5),o=e.readUByte(),a=e.readUByte(),l=e.readUByte(),c=e.readUByte(),u=e.readUByte(),h=e.readUByte(),d=e.readUByte(),f=e.readUByte(),p=e.readUByte(),g=e.readUByte(),m=e.readUByte(),y=[],v=[];for(let t=0;t<r;t++)y.push(e.readBoolean()),v.push(e.readBoolean());if(r>0)for(let t=r;t<8;t++)e.readBits(2);for(let t=0;t<r;t++)y[t]&&(e.readUByte(),e.readUByte(),e.readUByte(),e.readUByte(),e.readUByte(),e.readUByte(),e.readUByte(),e.readUByte(),e.readUByte(),e.readUByte(),e.readUByte()),v[t]&&e.readUByte();e.readUEG();const b=e.readUEG();3==b&&e.skipBits(1);const E=e.readUEG(),A=e.readUEG(),w=e.readBoolean();let T=0,S=0,L=0,_=0;w&&(T+=e.readUEG(),S+=e.readUEG(),L+=e.readUEG(),_+=e.readUEG());const x=e.readUEG(),k=e.readUEG(),P=e.readUEG();for(let t=e.readBoolean()?0:r;t<=r;t++)e.skipUEG(),e.skipUEG(),e.skipUEG();e.skipUEG(),e.skipUEG(),e.skipUEG(),e.skipUEG(),e.skipUEG(),e.skipUEG();if(e.readBoolean()){if(e.readBoolean())for(let t=0;t<4;t++)for(let r=0;r<(3===t?2:6);r++){if(e.readBoolean()){const r=Math.min(64,1<<4+(t<<1));t>1&&e.readEG();for(let t=0;t<r;t++)e.readEG()}else e.readUEG()}}e.readBoolean(),e.readBoolean();e.readBoolean()&&(e.readUByte(),e.skipUEG(),e.skipUEG(),e.readBoolean());const I=e.readUEG();let R=0;for(let t=0;t<I;t++){let r=!1;if(0!==t&&(r=e.readBoolean()),r){t===I&&e.readUEG(),e.readBoolean(),e.readUEG();let r=0;for(let t=0;t<=R;t++){const t=e.readBoolean();let n=!1;t||(n=e.readBoolean()),(t||n)&&r++}R=r}else{const t=e.readUEG(),r=e.readUEG();R=t+r;for(let r=0;r<t;r++)e.readUEG(),e.readBoolean();for(let t=0;t<r;t++)e.readUEG(),e.readBoolean()}}if(e.readBoolean()){const t=e.readUEG();for(let r=0;r<t;r++){for(let t=0;t<P+4;t++)e.readBits(1);e.readBits(1)}}let O=0,D=1,C=1,M=!0,N=1,F=0;e.readBoolean(),e.readBoolean();let U=!1;if(e.readBoolean()){if(e.readBoolean()){const t=e.readUByte();t>0&&t<16?(D=[1,12,10,16,40,24,20,32,80,18,15,64,160,4,3,2][t-1],C=[1,11,11,11,33,11,11,11,33,11,11,33,99,3,2,1][t-1]):255===t&&(D=e.readBits(16),C=e.readBits(16))}e.readBoolean()&&e.readBoolean();if(e.readBoolean()){e.readBits(3),e.readBoolean();e.readBoolean()&&(e.readUByte(),e.readUByte(),e.readUByte())}e.readBoolean()&&(e.readUEG(),e.readUEG()),e.readBoolean(),e.readBoolean(),e.readBoolean(),U=e.readBoolean(),U&&(e.skipUEG(),e.skipUEG(),e.skipUEG(),e.skipUEG());if(e.readBoolean()){N=e.readBits(32),F=e.readBits(32);e.readBoolean()&&e.readUEG();if(e.readBoolean()){const t=e.readBoolean(),n=e.readBoolean();let i=!1;(t||n)&&(i=e.readBoolean(),i&&(e.readUByte(),e.readBits(5),e.readBoolean(),e.readBits(5)),e.readBits(4),e.readBits(4),i&&e.readBits(4),e.readBits(5),e.readBits(5),e.readBits(5));for(let s=0;s<=r;s++){M=e.readBoolean();let r=!1;M||e.readBoolean()?e.readEG():r=e.readBoolean();const s=r?1:e.readUEG()+1;if(t)for(let t=0;t<s;t++)e.readUEG(),e.readUEG(),i&&(e.readUEG(),e.readUEG()),e.skipBits(1);if(n)for(let t=0;t<s;t++)e.readUEG(),e.readUEG(),i&&(e.readUEG(),e.readUEG()),e.skipBits(1)}}}e.readBoolean()&&(e.readBoolean(),e.readBoolean(),e.readBoolean(),O=e.readUEG())}let B=E,$=A;if(w){let t=1,e=1;1===b?t=e=2:2==b&&(t=2),B=E-t*S-t*T,$=A-e*_-e*L}const j=n?["A","B","C"][n]:"",G=o<<24|a<<16|l<<8|c;let H=0;for(let t=0;t<32;t++)H=(H|(G>>t&1)<<31-t)>>>0;let V=H.toString(16);1===s&&"2"===V&&(V="6");return{codecString:`hvc1.${j}${s}.${V}.${i?"H":"L"}${m}.B0`,params:{general_tier_flag:i,general_profile_idc:s,general_profile_space:n,general_profile_compatibility_flags:[o,a,l,c],general_constraint_indicator_flags:[u,h,d,f,p,g],general_level_idc:m,bit_depth:x+8,bit_depth_luma_minus8:x,bit_depth_chroma_minus8:k,min_spatial_segmentation_idc:O,chroma_format_idc:b,frame_rate:{fixed:M,fps:F/N}},width:B,height:$,pixelRatio:[D,C]}}readPPS(t){const e=new Xn(this.ebsp2rbsp(t));e.readUByte(),e.readUByte(),e.skipUEG(),e.skipUEG(),e.skipBits(2),e.skipBits(3),e.skipBits(2),e.skipUEG(),e.skipUEG(),e.skipEG(),e.skipBits(2);e.readBoolean()&&e.skipUEG(),e.skipEG(),e.skipEG(),e.skipBits(4);const r=e.readBoolean(),n=e.readBoolean();let i=1;return n&&r?i=0:n?i=3:r&&(i=2),{parallelismType:i}}matchSPS(t,e){return String.fromCharCode.apply(null,t).substr(3)===String.fromCharCode.apply(null,e).substr(3)}}const Zn=188;class ti{constructor(t,e,r,n){this.logger=void 0,this.observer=void 0,this.config=void 0,this.typeSupported=void 0,this.sampleAes=null,this.pmtParsed=!1,this.audioCodec=void 0,this.videoCodec=void 0,this._pmtId=-1,this._videoTrack=void 0,this._audioTrack=void 0,this._id3Track=void 0,this._txtTrack=void 0,this.aacOverFlow=null,this.remainderData=null,this.videoParser=void 0,this.observer=t,this.config=e,this.typeSupported=r,this.logger=n,this.videoParser=null}static probe(t,e){const r=ti.syncOffset(t);return r>0&&e.warn(`MPEG2-TS detected but first sync word found @ offset ${r}`),-1!==r}static syncOffset(t){const e=t.length;let r=Math.min(940,e-Zn)+1,n=0;for(;n<r;){let i=!1,s=-1,o=0;for(let a=n;a<e;a+=Zn){if(71!==t[a]||e-a!==Zn&&71!==t[a+Zn]){if(o)return-1;break}if(o++,-1===s&&(s=a,0!==s&&(r=Math.min(s+18612,t.length-Zn)+1)),i||(i=0===ei(t,a)),i&&o>1&&(0===s&&o>2||a+Zn>r))return s}n++}return-1}static createTrack(t,e){return{container:"video"===t||"audio"===t?"video/mp2t":void 0,type:t,id:q[t],pid:-1,inputTimeScale:9e4,sequenceNumber:0,samples:[],dropped:0,duration:"audio"===t?e:void 0}}resetInitSegment(t,e,r,n){this.pmtParsed=!1,this._pmtId=-1,this._videoTrack=ti.createTrack("video"),this._videoTrack.duration=n,this._audioTrack=ti.createTrack("audio",n),this._id3Track=ti.createTrack("id3"),this._txtTrack=ti.createTrack("text"),this._audioTrack.segmentCodec="aac",this.videoParser=null,this.aacOverFlow=null,this.remainderData=null,this.audioCodec=e,this.videoCodec=r}resetTimeStamp(){}resetContiguity(){const{_audioTrack:t,_videoTrack:e,_id3Track:r}=this;t&&(t.pesData=null),e&&(e.pesData=null),r&&(r.pesData=null),this.aacOverFlow=null,this.remainderData=null}demux(t,e,r=!1,n=!1){let i;r||(this.sampleAes=null);const s=this._videoTrack,o=this._audioTrack,a=this._id3Track,l=this._txtTrack;let c=s.pid,u=s.pesData,h=o.pid,d=a.pid,f=o.pesData,p=a.pesData,g=null,m=this.pmtParsed,y=this._pmtId,v=t.length;if(this.remainderData&&(v=(t=lt(this.remainderData,t)).length,this.remainderData=null),v<Zn&&!n)return this.remainderData=t,{audioTrack:o,videoTrack:s,id3Track:a,textTrack:l};const b=Math.max(0,ti.syncOffset(t));v-=(v-b)%Zn,v<t.byteLength&&!n&&(this.remainderData=new Uint8Array(t.buffer,v,t.buffer.byteLength-v));let E=0;for(let e=b;e<v;e+=Zn)if(71===t[e]){const n=!!(64&t[e+1]),v=ei(t,e);let E;if((48&t[e+3])>>4>1){if(E=e+5+t[e+4],E===e+Zn)continue}else E=e+4;switch(v){case c:n&&(u&&(i=oi(u,this.logger))&&(this.readyVideoParser(s.segmentCodec),null!==this.videoParser&&this.videoParser.parsePES(s,l,i,!1)),u={data:[],size:0}),u&&(u.data.push(t.subarray(E,e+Zn)),u.size+=e+Zn-E);break;case h:if(n){if(f&&(i=oi(f,this.logger)))switch(o.segmentCodec){case"aac":this.parseAACPES(o,i);break;case"mp3":this.parseMPEGPES(o,i);break;case"ac3":this.parseAC3PES(o,i)}f={data:[],size:0}}f&&(f.data.push(t.subarray(E,e+Zn)),f.size+=e+Zn-E);break;case d:n&&(p&&(i=oi(p,this.logger))&&this.parseID3PES(a,i),p={data:[],size:0}),p&&(p.data.push(t.subarray(E,e+Zn)),p.size+=e+Zn-E);break;case 0:n&&(E+=t[E]+1),y=this._pmtId=ri(t,E);break;case y:{n&&(E+=t[E]+1);const i=ni(t,E,this.typeSupported,r,this.observer,this.logger);c=i.videoPid,c>0&&(s.pid=c,s.segmentCodec=i.segmentVideoCodec),h=i.audioPid,h>0&&(o.pid=h,o.segmentCodec=i.segmentAudioCodec),d=i.id3Pid,d>0&&(a.pid=d),null===g||m||(this.logger.warn(`MPEG-TS PMT found at ${e} after unknown PID '${g}'. Backtracking to sync byte @${b} to parse all TS packets.`),g=null,e=b-188),m=this.pmtParsed=!0;break}case 17:case 8191:break;default:g=v}}else E++;E>0&&ii(this.observer,new Error(`Found ${E} TS packet/s that do not start with 0x47`),void 0,this.logger),s.pesData=u,o.pesData=f,a.pesData=p;const A={audioTrack:o,videoTrack:s,id3Track:a,textTrack:l};return n&&this.extractRemainingSamples(A),A}flush(){const{remainderData:t}=this;let e;return this.remainderData=null,e=t?this.demux(t,-1,!1,!0):{videoTrack:this._videoTrack,audioTrack:this._audioTrack,id3Track:this._id3Track,textTrack:this._txtTrack},this.extractRemainingSamples(e),this.sampleAes?this.decrypt(e,this.sampleAes):e}extractRemainingSamples(t){const{audioTrack:e,videoTrack:r,id3Track:n,textTrack:i}=t,s=r.pesData,o=e.pesData,a=n.pesData;let l;if(s&&(l=oi(s,this.logger))?(this.readyVideoParser(r.segmentCodec),null!==this.videoParser&&(this.videoParser.parsePES(r,i,l,!0),r.pesData=null)):r.pesData=s,o&&(l=oi(o,this.logger))){switch(e.segmentCodec){case"aac":this.parseAACPES(e,l);break;case"mp3":this.parseMPEGPES(e,l);break;case"ac3":this.parseAC3PES(e,l)}e.pesData=null}else null!=o&&o.size&&this.logger.log("last AAC PES packet truncated,might overlap between fragments"),e.pesData=o;a&&(l=oi(a,this.logger))?(this.parseID3PES(n,l),n.pesData=null):n.pesData=a}demuxSampleAes(t,e,r){const n=this.demux(t,r,!0,!this.config.progressive),i=this.sampleAes=new Wn(this.observer,this.config,e);return this.decrypt(n,i)}readyVideoParser(t){null===this.videoParser&&("avc"===t?this.videoParser=new Qn:"hevc"===t&&(this.videoParser=new Jn))}decrypt(t,e){return new Promise((r=>{const{audioTrack:n,videoTrack:i}=t;n.samples&&"aac"===n.segmentCodec?e.decryptAacSamples(n.samples,0,(()=>{i.samples?e.decryptAvcSamples(i.samples,0,0,(()=>{r(t)})):r(t)})):i.samples&&e.decryptAvcSamples(i.samples,0,0,(()=>{r(t)}))}))}destroy(){this.observer&&this.observer.removeAllListeners(),this.config=this.logger=this.observer=null,this.aacOverFlow=this.videoParser=this.remainderData=this.sampleAes=null,this._videoTrack=this._audioTrack=this._id3Track=this._txtTrack=void 0}parseAACPES(t,e){let r=0;const n=this.aacOverFlow;let i,s,o,a=e.data;if(n){this.aacOverFlow=null;const e=n.missing,i=n.sample.unit.byteLength;if(-1===e)a=lt(n.sample.unit,a);else{const s=i-e;n.sample.unit.set(a.subarray(0,e),s),t.samples.push(n.sample),r=n.missing}}for(i=r,s=a.length;i<s-1&&!fn(a,i);i++);if(i!==r){let t;const e=i<s-1;if(t=e?`AAC PES did not start with ADTS header,offset:${i}`:"No ADTS header found in AAC PES",ii(this.observer,new Error(t),e,this.logger),!e)return}if(gn(t,this.observer,a,i,this.audioCodec),void 0!==e.pts)o=e.pts;else{if(!n)return void this.logger.warn("[tsdemuxer]: AAC PES unknown PTS");{const e=mn(t.samplerate);o=n.sample.pts+e}}let l,c=0;for(;i<s;){if(l=yn(t,a,i,o,c),i+=l.length,l.missing){this.aacOverFlow=l;break}for(c++;i<s-1&&!fn(a,i);i++);}}parseMPEGPES(t,e){const r=e.data,n=r.length;let i=0,s=0;const o=e.pts;if(void 0!==o)for(;s<n;)if(jn(r,s)){const e=Un(t,r,s,o,i);if(!e)break;s+=e.length,i++}else s++;else this.logger.warn("[tsdemuxer]: MPEG PES unknown PTS")}parseAC3PES(t,e){{const r=e.data,n=e.pts;if(void 0===n)return void this.logger.warn("[tsdemuxer]: AC3 PES unknown PTS");const i=r.length;let s,o=0,a=0;for(;a<i&&(s=Kn(t,r,a,n,o++))>0;)a+=s}}parseID3PES(t,e){if(void 0===e.pts)return void this.logger.warn("[tsdemuxer]: ID3 PES unknown PTS");const r=p({},e,{type:this._videoTrack?Pn.emsg:Pn.audioId3,duration:Number.POSITIVE_INFINITY});t.samples.push(r)}}function ei(t,e){return((31&t[e+1])<<8)+t[e+2]}function ri(t,e){return(31&t[e+10])<<8|t[e+11]}function ni(t,e,r,n,i,s){const o={audioPid:-1,videoPid:-1,id3Pid:-1,segmentVideoCodec:"avc",segmentAudioCodec:"aac"},a=e+3+((15&t[e+1])<<8|t[e+2])-4;for(e+=12+((15&t[e+10])<<8|t[e+11]);e<a;){const a=ei(t,e),l=(15&t[e+3])<<8|t[e+4];switch(t[e]){case 207:if(!n){si("ADTS AAC",s);break}case 15:-1===o.audioPid&&(o.audioPid=a);break;case 21:-1===o.id3Pid&&(o.id3Pid=a);break;case 219:if(!n){si("H.264",s);break}case 27:-1===o.videoPid&&(o.videoPid=a);break;case 3:case 4:r.mpeg||r.mp3?-1===o.audioPid&&(o.audioPid=a,o.segmentAudioCodec="mp3"):s.log("MPEG audio found, not supported in this browser");break;case 193:if(!n){si("AC-3",s);break}case 129:r.ac3?-1===o.audioPid&&(o.audioPid=a,o.segmentAudioCodec="ac3"):s.log("AC-3 audio found, not supported in this browser");break;case 6:if(-1===o.audioPid&&l>0){let n=e+5,i=l;for(;i>2;){if(106===t[n])!0!==r.ac3?s.log("AC-3 audio found, not supported in this browser for now"):(o.audioPid=a,o.segmentAudioCodec="ac3");const e=t[n+1]+2;n+=e,i-=e}}break;case 194:case 135:return ii(i,new Error("Unsupported EC-3 in M2TS found"),void 0,s),o;case 36:-1===o.videoPid&&(o.videoPid=a,o.segmentVideoCodec="hevc",s.log("HEVC in M2TS found"))}e+=l+5}return o}function ii(t,e,r,n){n.warn(`parsing error: ${e.message}`),t.emit(l.ERROR,l.ERROR,{type:o.MEDIA_ERROR,details:a.FRAG_PARSING_ERROR,fatal:!1,levelRetry:r,error:e,reason:e.message})}function si(t,e){e.log(`${t} with AES-128-CBC encryption found in unencrypted stream`)}function oi(t,e){let r,n,i,s,o,a=0;const l=t.data;if(!t||0===t.size)return null;for(;l[0].length<19&&l.length>1;)l[0]=lt(l[0],l[1]),l.splice(1,1);r=l[0];if(1===(r[0]<<16)+(r[1]<<8)+r[2]){if(n=(r[4]<<8)+r[5],n&&n>t.size-6)return null;const c=r[7];192&c&&(s=536870912*(14&r[9])+4194304*(255&r[10])+16384*(254&r[11])+128*(255&r[12])+(254&r[13])/2,64&c?(o=536870912*(14&r[14])+4194304*(255&r[15])+16384*(254&r[16])+128*(255&r[17])+(254&r[18])/2,s-o>54e5&&(e.warn(`${Math.round((s-o)/9e4)}s delta between PTS and DTS, align them`),s=o)):o=s),i=r[8];let u=i+9;if(t.size<=u)return null;t.size-=u;const h=new Uint8Array(t.size);for(let t=0,e=l.length;t<e;t++){r=l[t];let e=r.byteLength;if(u){if(u>e){u-=e;continue}r=r.subarray(u),e-=u,u=0}h.set(r,a),a+=e}return n&&(n-=i+3),{data:h,pts:s,dts:o,len:n}}return null}class ai{static getSilentFrame(t,e){if("mp4a.40.2"===t){if(1===e)return new Uint8Array([0,200,0,128,35,128]);if(2===e)return new Uint8Array([33,0,73,144,2,25,0,35,128]);if(3===e)return new Uint8Array([0,200,0,128,32,132,1,38,64,8,100,0,142]);if(4===e)return new Uint8Array([0,200,0,128,32,132,1,38,64,8,100,0,128,44,128,8,2,56]);if(5===e)return new Uint8Array([0,200,0,128,32,132,1,38,64,8,100,0,130,48,4,153,0,33,144,2,56]);if(6===e)return new Uint8Array([0,200,0,128,32,132,1,38,64,8,100,0,130,48,4,153,0,33,144,2,0,178,0,32,8,224])}else{if(1===e)return new Uint8Array([1,64,34,128,163,78,230,128,186,8,0,0,0,28,6,241,193,10,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,94]);if(2===e)return new Uint8Array([1,64,34,128,163,94,230,128,186,8,0,0,0,0,149,0,6,241,161,10,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,94]);if(3===e)return new Uint8Array([1,64,34,128,163,94,230,128,186,8,0,0,0,0,149,0,6,241,161,10,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,94])}}}const li=Math.pow(2,32)-1;class ci{static init(){let t;for(t in ci.types={avc1:[],avcC:[],hvc1:[],hvcC:[],btrt:[],dinf:[],dref:[],esds:[],ftyp:[],hdlr:[],mdat:[],mdhd:[],mdia:[],mfhd:[],minf:[],moof:[],moov:[],mp4a:[],".mp3":[],dac3:[],"ac-3":[],mvex:[],mvhd:[],pasp:[],sdtp:[],stbl:[],stco:[],stsc:[],stsd:[],stsz:[],stts:[],tfdt:[],tfhd:[],traf:[],trak:[],trun:[],trex:[],tkhd:[],vmhd:[],smhd:[]},ci.types)ci.types.hasOwnProperty(t)&&(ci.types[t]=[t.charCodeAt(0),t.charCodeAt(1),t.charCodeAt(2),t.charCodeAt(3)]);const e=new Uint8Array([0,0,0,0,0,0,0,0,118,105,100,101,0,0,0,0,0,0,0,0,0,0,0,0,86,105,100,101,111,72,97,110,100,108,101,114,0]),r=new Uint8Array([0,0,0,0,0,0,0,0,115,111,117,110,0,0,0,0,0,0,0,0,0,0,0,0,83,111,117,110,100,72,97,110,100,108,101,114,0]);ci.HDLR_TYPES={video:e,audio:r};const n=new Uint8Array([0,0,0,0,0,0,0,1,0,0,0,12,117,114,108,32,0,0,0,1]),i=new Uint8Array([0,0,0,0,0,0,0,0]);ci.STTS=ci.STSC=ci.STCO=i,ci.STSZ=new Uint8Array([0,0,0,0,0,0,0,0,0,0,0,0]),ci.VMHD=new Uint8Array([0,0,0,1,0,0,0,0,0,0,0,0]),ci.SMHD=new Uint8Array([0,0,0,0,0,0,0,0]),ci.STSD=new Uint8Array([0,0,0,0,0,0,0,1]);const s=new Uint8Array([105,115,111,109]),o=new Uint8Array([97,118,99,49]),a=new Uint8Array([0,0,0,1]);ci.FTYP=ci.box(ci.types.ftyp,s,a,s,o),ci.DINF=ci.box(ci.types.dinf,ci.box(ci.types.dref,n))}static box(t,...e){let r=8,n=e.length;const i=n;for(;n--;)r+=e[n].byteLength;const s=new Uint8Array(r);for(s[0]=r>>24&255,s[1]=r>>16&255,s[2]=r>>8&255,s[3]=255&r,s.set(t,4),n=0,r=8;n<i;n++)s.set(e[n],r),r+=e[n].byteLength;return s}static hdlr(t){return ci.box(ci.types.hdlr,ci.HDLR_TYPES[t])}static mdat(t){return ci.box(ci.types.mdat,t)}static mdhd(t,e){e*=t;const r=Math.floor(e/(li+1)),n=Math.floor(e%(li+1));return ci.box(ci.types.mdhd,new Uint8Array([1,0,0,0,0,0,0,0,0,0,0,2,0,0,0,0,0,0,0,3,t>>24&255,t>>16&255,t>>8&255,255&t,r>>24,r>>16&255,r>>8&255,255&r,n>>24,n>>16&255,n>>8&255,255&n,85,196,0,0]))}static mdia(t){return ci.box(ci.types.mdia,ci.mdhd(t.timescale||0,t.duration||0),ci.hdlr(t.type),ci.minf(t))}static mfhd(t){return ci.box(ci.types.mfhd,new Uint8Array([0,0,0,0,t>>24,t>>16&255,t>>8&255,255&t]))}static minf(t){return"audio"===t.type?ci.box(ci.types.minf,ci.box(ci.types.smhd,ci.SMHD),ci.DINF,ci.stbl(t)):ci.box(ci.types.minf,ci.box(ci.types.vmhd,ci.VMHD),ci.DINF,ci.stbl(t))}static moof(t,e,r){return ci.box(ci.types.moof,ci.mfhd(t),ci.traf(r,e))}static moov(t){let e=t.length;const r=[];for(;e--;)r[e]=ci.trak(t[e]);return ci.box.apply(null,[ci.types.moov,ci.mvhd(t[0].timescale||0,t[0].duration||0)].concat(r).concat(ci.mvex(t)))}static mvex(t){let e=t.length;const r=[];for(;e--;)r[e]=ci.trex(t[e]);return ci.box.apply(null,[ci.types.mvex,...r])}static mvhd(t,e){e*=t;const r=Math.floor(e/(li+1)),n=Math.floor(e%(li+1)),i=new Uint8Array([1,0,0,0,0,0,0,0,0,0,0,2,0,0,0,0,0,0,0,3,t>>24&255,t>>16&255,t>>8&255,255&t,r>>24,r>>16&255,r>>8&255,255&r,n>>24,n>>16&255,n>>8&255,255&n,0,1,0,0,1,0,0,0,0,0,0,0,0,0,0,0,0,1,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,1,0,0,0,0,0,0,0,0,0,0,0,0,0,0,64,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,255,255,255,255]);return ci.box(ci.types.mvhd,i)}static sdtp(t){const e=t.samples||[],r=new Uint8Array(4+e.length);let n,i;for(n=0;n<e.length;n++)i=e[n].flags,r[n+4]=i.dependsOn<<4|i.isDependedOn<<2|i.hasRedundancy;return ci.box(ci.types.sdtp,r)}static stbl(t){return ci.box(ci.types.stbl,ci.stsd(t),ci.box(ci.types.stts,ci.STTS),ci.box(ci.types.stsc,ci.STSC),ci.box(ci.types.stsz,ci.STSZ),ci.box(ci.types.stco,ci.STCO))}static avc1(t){let e,r,n,i=[],s=[];for(e=0;e<t.sps.length;e++)r=t.sps[e],n=r.byteLength,i.push(n>>>8&255),i.push(255&n),i=i.concat(Array.prototype.slice.call(r));for(e=0;e<t.pps.length;e++)r=t.pps[e],n=r.byteLength,s.push(n>>>8&255),s.push(255&n),s=s.concat(Array.prototype.slice.call(r));const o=ci.box(ci.types.avcC,new Uint8Array([1,i[3],i[4],i[5],255,224|t.sps.length].concat(i).concat([t.pps.length]).concat(s))),a=t.width,l=t.height,c=t.pixelRatio[0],u=t.pixelRatio[1];return ci.box(ci.types.avc1,new Uint8Array([0,0,0,0,0,0,0,1,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,a>>8&255,255&a,l>>8&255,255&l,0,72,0,0,0,72,0,0,0,0,0,0,0,1,18,100,97,105,108,121,109,111,116,105,111,110,47,104,108,115,46,106,115,0,0,0,0,0,0,0,0,0,0,0,0,0,0,24,17,17]),o,ci.box(ci.types.btrt,new Uint8Array([0,28,156,128,0,45,198,192,0,45,198,192])),ci.box(ci.types.pasp,new Uint8Array([c>>24,c>>16&255,c>>8&255,255&c,u>>24,u>>16&255,u>>8&255,255&u])))}static esds(t){const e=t.config;return new Uint8Array([0,0,0,0,3,25,0,1,0,4,17,64,21,0,0,0,0,0,0,0,0,0,0,0,5,2,...e,6,1,2])}static audioStsd(t){const e=t.samplerate||0;return new Uint8Array([0,0,0,0,0,0,0,1,0,0,0,0,0,0,0,0,0,t.channelCount||0,0,16,0,0,0,0,e>>8&255,255&e,0,0])}static mp4a(t){return ci.box(ci.types.mp4a,ci.audioStsd(t),ci.box(ci.types.esds,ci.esds(t)))}static mp3(t){return ci.box(ci.types[".mp3"],ci.audioStsd(t))}static ac3(t){return ci.box(ci.types["ac-3"],ci.audioStsd(t),ci.box(ci.types.dac3,t.config))}static stsd(t){const{segmentCodec:e}=t;if("audio"===t.type){if("aac"===e)return ci.box(ci.types.stsd,ci.STSD,ci.mp4a(t));if("ac3"===e&&t.config)return ci.box(ci.types.stsd,ci.STSD,ci.ac3(t));if("mp3"===e&&"mp3"===t.codec)return ci.box(ci.types.stsd,ci.STSD,ci.mp3(t))}else{if(!t.pps||!t.sps)throw new Error("video track missing pps or sps");if("avc"===e)return ci.box(ci.types.stsd,ci.STSD,ci.avc1(t));if("hevc"===e&&t.vps)return ci.box(ci.types.stsd,ci.STSD,ci.hvc1(t))}throw new Error(`unsupported ${t.type} segment codec (${e}/${t.codec})`)}static tkhd(t){const e=t.id,r=(t.duration||0)*(t.timescale||0),n=t.width||0,i=t.height||0,s=Math.floor(r/(li+1)),o=Math.floor(r%(li+1));return ci.box(ci.types.tkhd,new Uint8Array([1,0,0,7,0,0,0,0,0,0,0,2,0,0,0,0,0,0,0,3,e>>24&255,e>>16&255,e>>8&255,255&e,0,0,0,0,s>>24,s>>16&255,s>>8&255,255&s,o>>24,o>>16&255,o>>8&255,255&o,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,1,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,1,0,0,0,0,0,0,0,0,0,0,0,0,0,0,64,0,0,0,n>>8&255,255&n,0,0,i>>8&255,255&i,0,0]))}static traf(t,e){const r=ci.sdtp(t),n=t.id,i=Math.floor(e/(li+1)),s=Math.floor(e%(li+1));return ci.box(ci.types.traf,ci.box(ci.types.tfhd,new Uint8Array([0,0,0,0,n>>24,n>>16&255,n>>8&255,255&n])),ci.box(ci.types.tfdt,new Uint8Array([1,0,0,0,i>>24,i>>16&255,i>>8&255,255&i,s>>24,s>>16&255,s>>8&255,255&s])),ci.trun(t,r.length+16+20+8+16+8+8),r)}static trak(t){return t.duration=t.duration||4294967295,ci.box(ci.types.trak,ci.tkhd(t),ci.mdia(t))}static trex(t){const e=t.id;return ci.box(ci.types.trex,new Uint8Array([0,0,0,0,e>>24,e>>16&255,e>>8&255,255&e,0,0,0,1,0,0,0,0,0,0,0,0,0,1,0,1]))}static trun(t,e){const r=t.samples||[],n=r.length,i=12+16*n,s=new Uint8Array(i);let o,a,l,c,u,h;for(e+=8+i,s.set(["video"===t.type?1:0,0,15,1,n>>>24&255,n>>>16&255,n>>>8&255,255&n,e>>>24&255,e>>>16&255,e>>>8&255,255&e],0),o=0;o<n;o++)a=r[o],l=a.duration,c=a.size,u=a.flags,h=a.cts,s.set([l>>>24&255,l>>>16&255,l>>>8&255,255&l,c>>>24&255,c>>>16&255,c>>>8&255,255&c,u.isLeading<<2|u.dependsOn,u.isDependedOn<<6|u.hasRedundancy<<4|u.paddingValue<<1|u.isNonSync,61440&u.degradPrio,15&u.degradPrio,h>>>24&255,h>>>16&255,h>>>8&255,255&h],12+16*o);return ci.box(ci.types.trun,s)}static initSegment(t){ci.types||ci.init();const e=ci.moov(t);return lt(ci.FTYP,e)}static hvc1(t){const e=t.params,r=[t.vps,t.sps,t.pps],n=new Uint8Array([1,e.general_profile_space<<6|(e.general_tier_flag?32:0)|e.general_profile_idc,e.general_profile_compatibility_flags[0],e.general_profile_compatibility_flags[1],e.general_profile_compatibility_flags[2],e.general_profile_compatibility_flags[3],e.general_constraint_indicator_flags[0],e.general_constraint_indicator_flags[1],e.general_constraint_indicator_flags[2],e.general_constraint_indicator_flags[3],e.general_constraint_indicator_flags[4],e.general_constraint_indicator_flags[5],e.general_level_idc,240|e.min_spatial_segmentation_idc>>8,255&e.min_spatial_segmentation_idc,252|e.parallelismType,252|e.chroma_format_idc,248|e.bit_depth_luma_minus8,248|e.bit_depth_chroma_minus8,0,parseInt(e.frame_rate.fps),3|e.temporal_id_nested<<2|e.num_temporal_layers<<3|(e.frame_rate.fixed?64:0),r.length]);let i=n.length;for(let t=0;t<r.length;t+=1){i+=3;for(let e=0;e<r[t].length;e+=1)i+=2+r[t][e].length}const s=new Uint8Array(i);s.set(n,0),i=n.length;const o=r.length-1;for(let t=0;t<r.length;t+=1){s.set(new Uint8Array([32+t|(t===o?128:0),0,r[t].length]),i),i+=3;for(let e=0;e<r[t].length;e+=1)s.set(new Uint8Array([r[t][e].length>>8,255&r[t][e].length]),i),i+=2,s.set(r[t][e],i),i+=r[t][e].length}const a=ci.box(ci.types.hvcC,s),l=t.width,c=t.height,u=t.pixelRatio[0],h=t.pixelRatio[1];return ci.box(ci.types.hvc1,new Uint8Array([0,0,0,0,0,0,0,1,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,l>>8&255,255&l,c>>8&255,255&c,0,72,0,0,0,72,0,0,0,0,0,0,0,1,18,100,97,105,108,121,109,111,116,105,111,110,47,104,108,115,46,106,115,0,0,0,0,0,0,0,0,0,0,0,0,0,0,24,17,17]),a,ci.box(ci.types.btrt,new Uint8Array([0,28,156,128,0,45,198,192,0,45,198,192])),ci.box(ci.types.pasp,new Uint8Array([u>>24,u>>16&255,u>>8&255,255&u,h>>24,h>>16&255,h>>8&255,255&h])))}}ci.types=void 0,ci.HDLR_TYPES=void 0,ci.STTS=void 0,ci.STSC=void 0,ci.STCO=void 0,ci.STSZ=void 0,ci.VMHD=void 0,ci.SMHD=void 0,ci.STSD=void 0,ci.FTYP=void 0,ci.DINF=void 0;const ui=9e4;function hi(t,e,r=1,n=!1){const i=t*e*r;return n?Math.round(i):i}function di(t,e=!1){return hi(t,1e3,1/ui,e)}let fi,pi=null,gi=null;function mi(t,e,r,n){return{duration:e,size:r,cts:n,flags:{isLeading:0,isDependedOn:0,hasRedundancy:0,degradPrio:0,dependsOn:t?2:1,isNonSync:t?0:1}}}class yi extends y{constructor(t,e,r,n){if(super("mp4-remuxer",n),this.observer=void 0,this.config=void 0,this.typeSupported=void 0,this.ISGenerated=!1,this._initPTS=null,this._initDTS=null,this.nextVideoTs=null,this.nextAudioTs=null,this.videoSampleDuration=null,this.isAudioContiguous=!1,this.isVideoContiguous=!1,this.videoTrackConfig=void 0,this.observer=t,this.config=e,this.typeSupported=r,this.ISGenerated=!1,null===pi){const t=(navigator.userAgent||"").match(/Chrome\/(\d+)/i);pi=t?parseInt(t[1]):0}if(null===gi){const t=navigator.userAgent.match(/Safari\/(\d+)/i);gi=t?parseInt(t[1]):0}}destroy(){this.config=this.videoTrackConfig=this._initPTS=this._initDTS=null}resetTimeStamp(t){this.log("initPTS & initDTS reset"),this._initPTS=this._initDTS=t}resetNextTimestamp(){this.log("reset next timestamp"),this.isVideoContiguous=!1,this.isAudioContiguous=!1}resetInitSegment(){this.log("ISGenerated flag reset"),this.ISGenerated=!1,this.videoTrackConfig=void 0}getVideoStartPts(t){let e=!1;const r=t[0].pts,n=t.reduce(((t,n)=>{let i=n.pts,s=i-t;return s<-4294967296&&(e=!0,i=vi(i,r),s=i-t),s>0?t:i}),r);return e&&this.debug("PTS rollover detected"),n}remux(t,e,r,n,i,s,o,a){let l,c,h,d,f,p,g=i,m=i;const y=t.pid>-1,v=e.pid>-1,b=e.samples.length,E=t.samples.length>0,A=o&&b>0||b>1;if((!y||E)&&(!v||A)||this.ISGenerated||o){if(this.ISGenerated){var w,T,S,L;const t=this.videoTrackConfig;(t&&(e.width!==t.width||e.height!==t.height||(null==(w=e.pixelRatio)?void 0:w[0])!==(null==(T=t.pixelRatio)?void 0:T[0])||(null==(S=e.pixelRatio)?void 0:S[1])!==(null==(L=t.pixelRatio)?void 0:L[1]))||!t&&A||null===this.nextAudioTs&&E)&&this.resetInitSegment()}this.ISGenerated||(h=this.generateIS(t,e,i,s));const r=this.isVideoContiguous;let n,o=-1;if(A&&(o=function(t){for(let e=0;e<t.length;e++)if(t[e].key)return e;return-1}(e.samples),!r&&this.config.forceKeyFrameOnDiscontinuity))if(p=!0,o>0){this.warn(`Dropped ${o} out of ${b} video samples due to a missing keyframe`);const t=this.getVideoStartPts(e.samples);e.samples=e.samples.slice(o),e.dropped+=o,m+=(e.samples[0].pts-t)/e.inputTimeScale,n=m}else-1===o&&(this.warn(`No keyframe found out of ${b} video samples`),p=!1);if(this.ISGenerated){if(E&&A){const r=this.getVideoStartPts(e.samples),n=(vi(t.samples[0].pts,r)-r)/e.inputTimeScale;g+=Math.max(0,n),m+=Math.max(0,-n)}if(E){if(t.samplerate||(this.warn("regenerate InitSegment as audio detected"),h=this.generateIS(t,e,i,s)),c=this.remuxAudio(t,g,this.isAudioContiguous,s,v||A||a===u.AUDIO?m:void 0),A){const n=c?c.endPTS-c.startPTS:0;e.inputTimeScale||(this.warn("regenerate InitSegment as video detected"),h=this.generateIS(t,e,i,s)),l=this.remuxVideo(e,m,r,n)}}else A&&(l=this.remuxVideo(e,m,r,0));l&&(l.firstKeyFrame=o,l.independent=-1!==o,l.firstKeyFramePTS=n)}}return this.ISGenerated&&this._initPTS&&this._initDTS&&(r.samples.length&&(f=bi(r,i,this._initPTS,this._initDTS)),n.samples.length&&(d=Ei(n,i,this._initPTS))),{audio:c,video:l,initSegment:h,independent:p,text:d,id3:f}}generateIS(t,e,r,n){const i=t.samples,s=e.samples,o=this.typeSupported,a={},l=this._initPTS;let c,u,h,d=!l||n,f="audio/mp4",p=-1;if(d&&(c=u=1/0),t.config&&i.length){switch(t.timescale=t.samplerate,t.segmentCodec){case"mp3":o.mpeg?(f="audio/mpeg",t.codec=""):o.mp3&&(t.codec="mp3");break;case"ac3":t.codec="ac-3"}a.audio={id:"audio",container:f,codec:t.codec,initSegment:"mp3"===t.segmentCodec&&o.mpeg?new Uint8Array(0):ci.initSegment([t]),metadata:{channelCount:t.channelCount}},d&&(p=t.id,h=t.inputTimeScale,l&&h===l.timescale?d=!1:c=u=i[0].pts-Math.round(h*r))}if(e.sps&&e.pps&&s.length){if(e.timescale=e.inputTimeScale,a.video={id:"main",container:"video/mp4",codec:e.codec,initSegment:ci.initSegment([e]),metadata:{width:e.width,height:e.height}},d)if(p=e.id,h=e.inputTimeScale,l&&h===l.timescale)d=!1;else{const t=this.getVideoStartPts(s),e=Math.round(h*r);u=Math.min(u,vi(s[0].dts,t)-e),c=Math.min(c,t-e)}this.videoTrackConfig={width:e.width,height:e.height,pixelRatio:e.pixelRatio}}if(Object.keys(a).length)return this.ISGenerated=!0,d?(l&&this.warn(`Timestamps at playlist time: ${n?"":"~"}${r} ${c/h} != initPTS: ${l.baseTime/l.timescale} (${l.baseTime}/${l.timescale}) trackId: ${l.trackId}`),this.log(`Found initPTS at playlist time: ${r} offset: ${c/h} (${c}/${h}) trackId: ${p}`),this._initPTS={baseTime:c,timescale:h,trackId:p},this._initDTS={baseTime:u,timescale:h,trackId:p}):c=h=void 0,{tracks:a,initPTS:c,timescale:h,trackId:p}}remuxVideo(t,e,r,n){const i=t.inputTimeScale,s=t.samples,c=[],u=s.length,h=this._initPTS,d=h.baseTime*i/h.timescale;let f,g,m=this.nextVideoTs,y=8,v=this.videoSampleDuration,b=Number.POSITIVE_INFINITY,E=Number.NEGATIVE_INFINITY,A=!1;if(!r||null===m){const t=d+e*i,n=s[0].pts-vi(s[0].dts,s[0].pts);pi&&null!==m&&Math.abs(t-n-(m+d))<15e3?r=!0:m=t-n-d}const w=m+d;for(let t=0;t<u;t++){const e=s[t];e.pts=vi(e.pts,w),e.dts=vi(e.dts,w),e.dts<s[t>0?t-1:t].dts&&(A=!0)}A&&s.sort((function(t,e){const r=t.dts-e.dts,n=t.pts-e.pts;return r||n})),f=s[0].dts,g=s[s.length-1].dts;const T=g-f,S=T?Math.round(T/(u-1)):v||t.inputTimeScale/30;if(r){const r=f-w,n=r>S,i=r<-1;if((n||i)&&(n?this.warn(`${(t.segmentCodec||"").toUpperCase()}: ${di(r,!0)} ms (${r}dts) hole between fragments detected at ${e.toFixed(3)}`):this.warn(`${(t.segmentCodec||"").toUpperCase()}: ${di(-r,!0)} ms (${r}dts) overlapping between fragments detected at ${e.toFixed(3)}`),!i||w>=s[0].pts||pi)){f=w;const t=s[0].pts-r;if(n)s[0].dts=f,s[0].pts=t;else{let e=!0;for(let n=0;n<s.length&&!(s[n].dts>t&&e);n++){const t=s[n].pts;if(s[n].dts-=r,s[n].pts-=r,n<s.length-1){const r=s[n+1].pts;e=r<=s[n].pts==r<=t}}}this.log(`Video: Initial PTS/DTS adjusted: ${di(t,!0)}/${di(f,!0)}, delta: ${di(r,!0)} ms`)}}f=Math.max(0,f);let L=0,_=0,x=f;for(let t=0;t<u;t++){const e=s[t],r=e.units,n=r.length;let i=0;for(let t=0;t<n;t++)i+=r[t].data.length;_+=i,L+=n,e.length=i,e.dts<x?(e.dts=x,x+=S/4|0||1):x=e.dts,b=Math.min(e.pts,b),E=Math.max(e.pts,E)}g=s[u-1].dts;const k=_+4*L+8;let P;try{P=new Uint8Array(k)}catch(t){return void this.observer.emit(l.ERROR,l.ERROR,{type:o.MUX_ERROR,details:a.REMUX_ALLOC_ERROR,fatal:!1,error:t,bytes:k,reason:`fail allocating video mdat ${k}`})}const I=new DataView(P.buffer);I.setUint32(0,k),P.set(ci.types.mdat,4);let R=!1,O=Number.POSITIVE_INFINITY,D=Number.POSITIVE_INFINITY,C=Number.NEGATIVE_INFINITY,M=Number.NEGATIVE_INFINITY;for(let t=0;t<u;t++){const e=s[t],r=e.units;let o,a=0;for(let t=0,e=r.length;t<e;t++){const e=r[t],n=e.data,i=e.data.byteLength;I.setUint32(y,i),y+=4,P.set(n,y),y+=i,a+=4+i}if(t<u-1)v=s[t+1].dts-e.dts,o=s[t+1].pts-e.pts;else{const r=this.config,a=t>0?e.dts-s[t-1].dts:S;if(o=t>0?e.pts-s[t-1].pts:S,r.stretchShortVideoTrack&&null!==this.nextAudioTs){const t=Math.floor(r.maxBufferHole*i),s=(n?b+n*i:this.nextAudioTs+d)-e.pts;s>t?(v=s-a,v<0?v=a:R=!0,this.log(`It is approximately ${s/90} ms to the next segment; using duration ${v/90} ms for the last video frame.`)):v=a}else v=a}const l=Math.round(e.pts-e.dts);O=Math.min(O,v),C=Math.max(C,v),D=Math.min(D,o),M=Math.max(M,o),c.push(mi(e.key,v,a,l))}if(c.length)if(pi){if(pi<70){const t=c[0].flags;t.dependsOn=2,t.isNonSync=0}}else if(gi&&M-D<C-O&&S/C<.025&&0===c[0].cts){this.warn("Found irregular gaps in sample duration. Using PTS instead of DTS to determine MP4 sample duration.");let t=f;for(let e=0,r=c.length;e<r;e++){const n=t+c[e].duration,i=t+c[e].cts;if(e<r-1){const t=n+c[e+1].cts;c[e].duration=t-i}else c[e].duration=e?c[e-1].duration:S;c[e].cts=0,t=n}}v=R||!v?S:v;const N=g+v;this.nextVideoTs=m=N-d,this.videoSampleDuration=v,this.isVideoContiguous=!0;const F={data1:ci.moof(t.sequenceNumber++,f,p(t,{samples:c})),data2:P,startPTS:(b-d)/i,endPTS:(E+v-d)/i,startDTS:(f-d)/i,endDTS:m/i,type:"video",hasAudio:!1,hasVideo:!0,nb:c.length,dropped:t.dropped};return t.samples=[],t.dropped=0,F}getSamplesPerFrame(t){switch(t.segmentCodec){case"mp3":return 1152;case"ac3":return 1536;default:return 1024}}remuxAudio(t,e,r,n,i){const s=t.inputTimeScale,c=s/(t.samplerate?t.samplerate:s),u=this.getSamplesPerFrame(t),h=u*c,d=this._initPTS,f="mp3"===t.segmentCodec&&this.typeSupported.mpeg,g=[],m=void 0!==i;let y=t.samples,v=f?0:8,b=this.nextAudioTs||-1;const E=d.baseTime*s/d.timescale,A=E+e*s;if(this.isAudioContiguous=r=r||y.length&&b>0&&(n&&Math.abs(A-(b+E))<9e3||Math.abs(vi(y[0].pts,A)-(b+E))<20*h),y.forEach((function(t){t.pts=vi(t.pts,A)})),!r||b<0){if(y=y.filter((t=>t.pts>=0)),!y.length)return;b=0===i?0:n&&!m?Math.max(0,A-E):y[0].pts-E}if("aac"===t.segmentCodec){const e=this.config.maxAudioFramesDrift;for(let r=0,n=b+E;r<y.length;r++){const i=y[r],o=i.pts,a=o-n,l=Math.abs(1e3*a/s);if(a<=-e*h&&m)0===r&&(this.warn(`Audio frame @ ${(o/s).toFixed(3)}s overlaps marker by ${Math.round(1e3*a/s)} ms.`),this.nextAudioTs=b=o-E,n=o);else if(a>=e*h&&l<1e4&&m){let e=Math.round(a/h);for(n=o-e*h;n<0&&e&&h;)e--,n+=h;0===r&&(this.nextAudioTs=b=n-E),this.warn(`Injecting ${e} audio frames @ ${((n-E)/s).toFixed(3)}s due to ${Math.round(1e3*a/s)} ms gap.`);for(let s=0;s<e;s++){let e=ai.getSilentFrame(t.parsedCodec||t.manifestCodec||t.codec,t.channelCount);e||(this.log("Unable to get silent frame for given audio codec; duplicating last frame instead."),e=i.unit.subarray()),y.splice(r,0,{unit:e,pts:n}),n+=h,r++}}i.pts=n,n+=h}}let w,T=null,S=null,L=0,_=y.length;for(;_--;)L+=y[_].unit.byteLength;for(let e=0,n=y.length;e<n;e++){const n=y[e],i=n.unit;let s=n.pts;if(null!==S){g[e-1].duration=Math.round((s-S)/c)}else{if(r&&"aac"===t.segmentCodec&&(s=b+E),T=s,!(L>0))return;L+=v;try{w=new Uint8Array(L)}catch(t){return void this.observer.emit(l.ERROR,l.ERROR,{type:o.MUX_ERROR,details:a.REMUX_ALLOC_ERROR,fatal:!1,error:t,bytes:L,reason:`fail allocating audio mdat ${L}`})}if(!f){new DataView(w.buffer).setUint32(0,L),w.set(ci.types.mdat,4)}}w.set(i,v);const h=i.byteLength;v+=h,g.push(mi(!0,u,h,0)),S=s}const x=g.length;if(!x)return;const k=g[g.length-1];b=S-E,this.nextAudioTs=b+c*k.duration;const P=f?new Uint8Array(0):ci.moof(t.sequenceNumber++,T/c,p({},t,{samples:g}));t.samples=[];const I=(T-E)/s,R=b/s,O={data1:P,data2:w,startPTS:I,endPTS:R,startDTS:I,endDTS:R,type:"audio",hasAudio:!0,hasVideo:!1,nb:x};return this.isAudioContiguous=!0,O}}function vi(t,e){let r;if(null===e)return t;for(r=e<t?-8589934592:8589934592;Math.abs(t-e)>4294967296;)t+=r;return t}function bi(t,e,r,n){const i=t.samples.length;if(!i)return;const s=t.inputTimeScale;for(let o=0;o<i;o++){const i=t.samples[o];i.pts=vi(i.pts-r.baseTime*s/r.timescale,e*s)/s,i.dts=vi(i.dts-n.baseTime*s/n.timescale,e*s)/s}const o=t.samples;return t.samples=[],{samples:o}}function Ei(t,e,r){const n=t.samples.length;if(!n)return;const i=t.inputTimeScale;for(let s=0;s<n;s++){const n=t.samples[s];n.pts=vi(n.pts-r.baseTime*i/r.timescale,e*i)/i}t.samples.sort(((t,e)=>t.pts-e.pts));const s=t.samples;return t.samples=[],{samples:s}}function Ai(t,e,r=!1){return void 0!==(null==t?void 0:t.start)?(t.start+(r?t.duration:0))/t.timescale:e}function wi(t,e,r){const n=t.codec;if(n&&n.length>4)return n;if(e===B.AUDIO){if("ec-3"===n||"ac-3"===n||"alac"===n)return n;if("fLaC"===n||"Opus"===n){return Lt(n,!1)}return r.warn(`Unhandled audio codec "${n}" in mp4 MAP`),n||"mp4a"}return r.warn(`Unhandled video codec "${n}" in mp4 MAP`),n||"avc1"}try{fi=self.performance.now.bind(self.performance)}catch(t){fi=Date.now}const Ti=[{demux:class{constructor(t,e){this.remainderData=null,this.timeOffset=0,this.config=void 0,this.videoTrack=void 0,this.audioTrack=void 0,this.id3Track=void 0,this.txtTrack=void 0,this.config=e}resetTimeStamp(){}resetInitSegment(t,e,r,n){const i=this.videoTrack=In("video",1),s=this.audioTrack=In("audio",1),o=this.txtTrack=In("text",1);if(this.id3Track=In("id3",1),this.timeOffset=0,null==t||!t.byteLength)return;const a=et(t);if(a.video){const{id:t,timescale:e,codec:r,supplemental:n}=a.video;i.id=t,i.timescale=o.timescale=e,i.codec=r,i.supplemental=n}if(a.audio){const{id:t,timescale:e,codec:r}=a.audio;s.id=t,s.timescale=e,s.codec=r}o.id=q.text,i.sampleDuration=0,i.duration=s.duration=n}resetContiguity(){this.remainderData=null}static probe(t){return function(t){const e=t.byteLength;for(let r=0;r<e;){const n=X(t,r);if(n>8&&109===t[r+4]&&111===t[r+5]&&111===t[r+6]&&102===t[r+7])return!0;r=n>1?r+n:e}return!1}(t)}demux(t,e){this.timeOffset=e;let r=t;const n=this.videoTrack,i=this.txtTrack;if(this.config.progressive){this.remainderData&&(r=lt(this.remainderData,t));const e=function(t){const e={valid:null,remainder:null},r=Z(t,["moof"]);if(r.length<2)return e.remainder=t,e;const n=r[r.length-1];return e.valid=t.slice(0,n.byteOffset-8),e.remainder=t.slice(n.byteOffset-8),e}(r);this.remainderData=e.remainder,n.samples=e.valid||new Uint8Array}else n.samples=r;const s=this.extractID3Track(n,e);return i.samples=ct(e,n),{videoTrack:n,audioTrack:this.audioTrack,id3Track:s,textTrack:this.txtTrack}}flush(){const t=this.timeOffset,e=this.videoTrack,r=this.txtTrack;e.samples=this.remainderData||new Uint8Array,this.remainderData=null;const n=this.extractID3Track(e,this.timeOffset);return r.samples=ct(t,e),{videoTrack:e,audioTrack:In(),id3Track:n,textTrack:In()}}extractID3Track(t,e){const r=this.id3Track;if(t.samples.length){const n=Z(t.samples,["emsg"]);n&&n.forEach((t=>{const n=function(t){const e=t[0];let r="",n="",s=0,o=0,a=0,l=0,c=0,u=0;if(0===e){for(;"\0"!==W(t.subarray(u,u+1));)r+=W(t.subarray(u,u+1)),u+=1;for(r+=W(t.subarray(u,u+1)),u+=1;"\0"!==W(t.subarray(u,u+1));)n+=W(t.subarray(u,u+1)),u+=1;n+=W(t.subarray(u,u+1)),u+=1,s=X(t,12),o=X(t,16),l=X(t,20),c=X(t,24),u=28}else if(1===e){u+=4,s=X(t,u),u+=4;const e=X(t,u);u+=4;const o=X(t,u);for(u+=4,a=2**32*e+o,i(a)||(a=Number.MAX_SAFE_INTEGER,T.warn("Presentation time exceeds safe integer limit and wrapped to max safe integer in parsing emsg box")),l=X(t,u),u+=4,c=X(t,u),u+=4;"\0"!==W(t.subarray(u,u+1));)r+=W(t.subarray(u,u+1)),u+=1;for(r+=W(t.subarray(u,u+1)),u+=1;"\0"!==W(t.subarray(u,u+1));)n+=W(t.subarray(u,u+1)),u+=1;n+=W(t.subarray(u,u+1)),u+=1}return{schemeIdUri:r,value:n,timeScale:s,presentationTime:a,presentationTimeDelta:o,eventDuration:l,id:c,payload:t.subarray(u,t.byteLength)}}(t);if(Yn.test(n.schemeIdUri)){const t=qn(n,e);let i=4294967295===n.eventDuration?Number.POSITIVE_INFINITY:n.eventDuration/n.timeScale;i<=.001&&(i=Number.POSITIVE_INFINITY);const s=n.payload;r.samples.push({data:s,len:s.byteLength,dts:t,pts:t,type:Pn.emsg,duration:i})}else if(this.config.enableEmsgKLVMetadata&&n.schemeIdUri.startsWith("urn:misb:KLV:bin:1910.1")){const t=qn(n,e);r.samples.push({data:n.payload,len:n.payload.byteLength,dts:t,pts:t,type:Pn.misbklv,duration:Number.POSITIVE_INFINITY})}}))}return r}demuxSampleAes(t,e,r){return Promise.reject(new Error("The MP4 demuxer does not support SAMPLE-AES decryption"))}destroy(){this.config=null,this.remainderData=null,this.videoTrack=this.audioTrack=this.id3Track=this.txtTrack=void 0}},remux:class extends y{constructor(t,e,r,n){super("passthrough-remuxer",n),this.emitInitSegment=!1,this.audioCodec=void 0,this.videoCodec=void 0,this.initData=void 0,this.initPTS=null,this.initTracks=void 0,this.lastEndTime=null,this.isVideoContiguous=!1}destroy(){}resetTimeStamp(t){this.lastEndTime=null;const e=this.initPTS;e&&t&&e.baseTime===t.baseTime&&e.timescale===t.timescale||(this.initPTS=t)}resetNextTimestamp(){this.isVideoContiguous=!1,this.lastEndTime=null}resetInitSegment(t,e,r,n){this.audioCodec=e,this.videoCodec=r,this.generateInitSegment(t,n),this.emitInitSegment=!0}generateInitSegment(t,e){let{audioCodec:r,videoCodec:n}=this;if(null==t||!t.byteLength)return this.initTracks=void 0,void(this.initData=void 0);const{audio:i,video:s}=this.initData=et(t);if(e)!function(t,e){if(!t||!e)return;const r=e.keyId;r&&e.isCommonEncryption&&Z(t,["moov","trak"]).forEach((t=>{const e=Z(t,["mdia","minf","stbl","stsd"])[0].subarray(8);let n=Z(e,["enca"]);const i=n.length>0;i||(n=Z(e,["encv"])),n.forEach((t=>{Z(i?t.subarray(28):t.subarray(78),["sinf"]).forEach((t=>{const e=at(t);if(e){const t=e.subarray(8,24);t.some((t=>0!==t))||(T.log(`[eme] Patching keyId in 'enc${i?"a":"v"}>sinf>>tenc' box: ${x(t)} -> ${x(r)}`),e.set(r,8))}}))}))}))}(t,e);else{const t=i||s;null!=t&&t.encrypted&&this.warn(`Init segment with encrypted track with has no key ("${t.codec}")!`)}i&&(r=wi(i,B.AUDIO,this)),s&&(n=wi(s,B.VIDEO,this));const o={};i&&s?o.audiovideo={container:"video/mp4",codec:r+","+n,supplemental:s.supplemental,encrypted:s.encrypted,initSegment:t,id:"main"}:i?o.audio={container:"audio/mp4",codec:r,encrypted:i.encrypted,initSegment:t,id:"audio"}:s?o.video={container:"video/mp4",codec:n,supplemental:s.supplemental,encrypted:s.encrypted,initSegment:t,id:"main"}:this.warn("initSegment does not contain moov or trak boxes."),this.initTracks=o}remux(t,e,r,i,s,o){var a,l;let{initPTS:c,lastEndTime:u}=this;const h={audio:void 0,video:void 0,text:i,id3:r,initSegment:void 0};n(u)||(u=this.lastEndTime=s||0);const d=e.samples;if(!d.length)return h;const f={initPTS:void 0,timescale:void 0,trackId:void 0};let p=this.initData;if(null!=(a=p)&&a.length||(this.generateInitSegment(d),p=this.initData),null==(l=p)||!l.length)return this.warn("Failed to generate initSegment."),h;this.emitInitSegment&&(f.tracks=this.initTracks,this.emitInitSegment=!1);const g=function(t,e,r){const i={},s=Z(t,["moof","traf"]);for(let t=0;t<s.length;t++){const o=s[t],a=Z(o,["tfhd"])[0],l=X(a,4),c=e[l];if(!c)continue;i[l]||(i[l]={start:NaN,duration:0,sampleCount:0,timescale:c.timescale,type:c.type});const u=i[l],h=Z(o,["tfdt"])[0];if(h){const t=h[0];let e=X(h,4);1===t&&(e===K?r.warn("[mp4-demuxer]: Ignoring assumed invalid signed 64-bit track fragment decode time"):(e*=K+1,e+=X(h,8))),n(e)&&(!n(u.start)||e<u.start)&&(u.start=e)}const d=c.default,f=X(a,0)|(null==d?void 0:d.flags);let p=(null==d?void 0:d.duration)||0;8&f&&(p=X(a,2&f?12:8));const g=Z(o,["trun"]);let m=u.start||0,y=0,v=p;for(let t=0;t<g.length;t++){const e=g[t],r=X(e,4),n=u.sampleCount;u.sampleCount+=r;const i=1&e[3],s=4&e[3],o=1&e[2],a=2&e[2],l=4&e[2],c=8&e[2];let h=8,d=r;for(i&&(h+=4),s&&r&&(1&e[h+1]||void 0!==u.keyFrameIndex||(u.keyFrameIndex=n),h+=4,o?(v=X(e,h),h+=4):v=p,a&&(h+=4),c&&(h+=4),m+=v,y+=v,d--);d--;)o?(v=X(e,h),h+=4):v=p,a&&(h+=4),l&&(1&e[h+1]||void 0===u.keyFrameIndex&&(u.keyFrameIndex=u.sampleCount-(d+1),u.keyFrameStart=m),h+=4),c&&(h+=4),m+=v,y+=v;!y&&p&&(y+=p*r)}u.duration+=y}if(!Object.keys(i).some((t=>i[t].duration))){let e=1/0,r=0;const s=Z(t,["sidx"]);for(let t=0;t<s.length;t++){const n=tt(s[t]);if(null!=n&&n.references){e=Math.min(e,n.earliestPresentationTime/n.timescale);const t=n.references.reduce(((t,e)=>t+e.info.duration||0),0);r=Math.max(r,t+n.earliestPresentationTime/n.timescale)}}r&&n(r)&&Object.keys(i).forEach((t=>{i[t].duration||(i[t].duration=r*i[t].timescale-i[t].start)}))}return i}(d,p,this),m=p.audio?g[p.audio.id]:null,y=p.video?g[p.video.id]:null,v=Ai(y,1/0),b=Ai(m,1/0),E=Ai(y,0,!0),A=Ai(m,0,!0);let w=s,T=0;const S=m&&(!y||!c&&b<v||c&&c.trackId===p.audio.id),L=S?m:y;if(L){const t=L.timescale,e=L.start-s*t,r=S?p.audio.id:p.video.id;w=L.start/t,T=S?A-b:E-v,!o&&c||!function(t,e,r,n){if(null===t)return!0;const i=Math.max(n,1),s=e-t.baseTime/t.timescale;return Math.abs(s-r)>i}(c,w,s,T)&&t===c.timescale||(c&&this.warn(`Timestamps at playlist time: ${o?"":"~"}${s} ${e/t} != initPTS: ${c.baseTime/c.timescale} (${c.baseTime}/${c.timescale}) trackId: ${c.trackId}`),this.log(`Found initPTS at playlist time: ${s} offset: ${w-s} (${e}/${t}) trackId: ${r}`),c=null,f.initPTS=e,f.timescale=t,f.trackId=r)}else this.warn(`No audio or video samples found for initPTS at playlist time: ${s}`);c?(f.initPTS=c.baseTime,f.timescale=c.timescale,f.trackId=c.trackId):(f.timescale&&void 0!==f.trackId&&void 0!==f.initPTS||(this.warn("Could not set initPTS"),f.initPTS=w,f.timescale=1,f.trackId=-1),this.initPTS=c={baseTime:f.initPTS,timescale:f.timescale,trackId:f.trackId});const _=w-c.baseTime/c.timescale,x=_+T;T>0?this.lastEndTime=x:(this.warn("Duration parsed from mp4 should be greater than zero"),this.resetNextTimestamp());const k=!!p.audio,P=!!p.video;let I="";k&&(I+="audio"),P&&(I+="video");const R={data1:d,startPTS:_,startDTS:_,endPTS:x,endDTS:x,type:I,hasAudio:k,hasVideo:P,nb:1,dropped:0,encrypted:!!p.audio&&p.audio.encrypted||!!p.video&&p.video.encrypted};h.audio=k&&!P?R:void 0,h.video=P?R:void 0;const O=null==y?void 0:y.sampleCount;if(O){const t=y.keyFrameIndex,e=-1!==t;R.nb=O,R.dropped=0===t||this.isVideoContiguous?0:e?t:O,R.independent=e,R.firstKeyFrame=t,e&&y.keyFrameStart&&(R.firstKeyFramePTS=(y.keyFrameStart-c.baseTime)/c.timescale),this.isVideoContiguous||(h.independent=e),this.isVideoContiguous||(this.isVideoContiguous=e),R.dropped&&this.warn(`fmp4 does not start with IDR: firstIDR ${t}/${O} dropped: ${R.dropped} start: ${R.firstKeyFramePTS||"NA"}`)}return h.initSegment=f,h.id3=bi(r,s,c,c),i.samples.length&&(h.text=Ei(i,s,c)),h}}},{demux:ti,remux:yi},{demux:class extends Rn{constructor(t,e){super(),this.observer=void 0,this.config=void 0,this.observer=t,this.config=e}resetInitSegment(t,e,r,n){super.resetInitSegment(t,e,r,n),this._audioTrack={container:"audio/adts",type:"audio",id:2,pid:-1,sequenceNumber:0,segmentCodec:"aac",samples:[],manifestCodec:e,duration:n,inputTimeScale:9e4,dropped:0}}static probe(t,e){if(!t)return!1;const r=cn(t,0);let n=(null==r?void 0:r.length)||0;if(Gn(t,n))return!1;for(let r=t.length;n<r;n++)if(pn(t,n))return e.log("ADTS sync word found !"),!0;return!1}canParse(t,e){return function(t,e){return function(t,e){return e+5<t.length}(t,e)&&un(t,e)&&dn(t,e)<=t.length-e}(t,e)}appendFrame(t,e,r){gn(t,this.observer,e,r,t.manifestCodec);const n=yn(t,e,r,this.basePTS,this.frameIndex);if(n&&0===n.missing)return n}},remux:yi},{demux:class extends Rn{resetInitSegment(t,e,r,n){super.resetInitSegment(t,e,r,n),this._audioTrack={container:"audio/mpeg",type:"audio",id:2,pid:-1,sequenceNumber:0,segmentCodec:"mp3",samples:[],manifestCodec:e,duration:n,inputTimeScale:9e4,dropped:0}}static probe(t){if(!t)return!1;const e=cn(t,0);let r=(null==e?void 0:e.length)||0;if(e&&11===t[r]&&119===t[r+1]&&void 0!==kn(e)&&Hn(t,r)<=16)return!1;for(let e=t.length;r<e;r++)if(Gn(t,r))return T.log("MPEG Audio sync word found !"),!0;return!1}canParse(t,e){return function(t,e){return $n(t,e)&&4<=t.length-e}(t,e)}appendFrame(t,e,r){if(null!==this.basePTS)return Un(t,e,r,this.basePTS,this.frameIndex)}},remux:yi}];Ti.splice(2,0,{demux:Vn,remux:yi});class Si{constructor(t,e,r,n,i,s){this.asyncResult=!1,this.logger=void 0,this.observer=void 0,this.typeSupported=void 0,this.config=void 0,this.id=void 0,this.demuxer=void 0,this.remuxer=void 0,this.decrypter=void 0,this.probe=void 0,this.decryptionPromise=null,this.transmuxConfig=void 0,this.currentTransmuxState=void 0,this.observer=t,this.typeSupported=e,this.config=r,this.id=i,this.logger=s}configure(t){this.transmuxConfig=t,this.decrypter&&this.decrypter.reset()}push(t,e,r,n){const i=r.transmuxing;i.executeStart=fi();let s=new Uint8Array(t);const{currentTransmuxState:c,transmuxConfig:u}=this;n&&(this.currentTransmuxState=n);const{contiguous:h,discontinuity:d,trackSwitch:f,accurateTimeOffset:p,timeOffset:g,initSegmentChange:m}=n||c,{audioCodec:y,videoCodec:v,defaultInitPts:b,duration:E,initSegmentData:A}=u,w=function(t,e){let r=null;t.byteLength>0&&null!=(null==e?void 0:e.key)&&null!==e.iv&&null!=e.method&&(r=e);return r}(s,e);if(w&&Xe(w.method)){const t=this.getDecrypter(),e=Qe(w.method);if(!t.isSync())return this.asyncResult=!0,this.decryptionPromise=t.webCryptoDecrypt(s,w.key.buffer,w.iv.buffer,e).then((t=>{const e=this.push(t,null,r);return this.decryptionPromise=null,e})),this.decryptionPromise;{let n=t.softwareDecrypt(s,w.key.buffer,w.iv.buffer,e);if(r.part>-1){const e=t.flush();n=e?e.buffer:e}if(!n)return i.executeEnd=fi(),Li(r);s=new Uint8Array(n)}}const T=this.needsProbing(d,f);if(T){const t=this.configureTransmuxer(s);if(t)return this.logger.warn(`[transmuxer] ${t.message}`),this.observer.emit(l.ERROR,l.ERROR,{type:o.MEDIA_ERROR,details:a.FRAG_PARSING_ERROR,fatal:!1,error:t,reason:t.message}),i.executeEnd=fi(),Li(r)}(d||f||m||T)&&this.resetInitSegment(A,y,v,E,e),(d||m||T)&&this.resetInitialTimestamp(b),h||this.resetContiguity();const S=this.transmux(s,w,g,p,r);this.asyncResult=_i(S);const L=this.currentTransmuxState;return L.contiguous=!0,L.discontinuity=!1,L.trackSwitch=!1,i.executeEnd=fi(),S}flush(t){const e=t.transmuxing;e.executeStart=fi();const{decrypter:r,currentTransmuxState:n,decryptionPromise:i}=this;if(i)return this.asyncResult=!0,i.then((()=>this.flush(t)));const s=[],{timeOffset:o}=n;if(r){const e=r.flush();e&&s.push(this.push(e.buffer,null,t))}const{demuxer:a,remuxer:l}=this;if(!a||!l){e.executeEnd=fi();const r=[Li(t)];return this.asyncResult?Promise.resolve(r):r}const c=a.flush(o);return _i(c)?(this.asyncResult=!0,c.then((e=>(this.flushRemux(s,e,t),s)))):(this.flushRemux(s,c,t),this.asyncResult?Promise.resolve(s):s)}flushRemux(t,e,r){const{audioTrack:n,videoTrack:i,id3Track:s,textTrack:o}=e,{accurateTimeOffset:a,timeOffset:l}=this.currentTransmuxState;this.logger.log(`[transmuxer.ts]: Flushed ${this.id} sn: ${r.sn}${r.part>-1?" part: "+r.part:""} of ${this.id===u.MAIN?"level":"track"} ${r.level}`);const c=this.remuxer.remux(n,i,s,o,l,a,!0,this.id);t.push({remuxResult:c,chunkMeta:r}),r.transmuxing.executeEnd=fi()}resetInitialTimestamp(t){const{demuxer:e,remuxer:r}=this;e&&r&&(e.resetTimeStamp(t),r.resetTimeStamp(t))}resetContiguity(){const{demuxer:t,remuxer:e}=this;t&&e&&(t.resetContiguity(),e.resetNextTimestamp())}resetInitSegment(t,e,r,n,i){const{demuxer:s,remuxer:o}=this;s&&o&&(s.resetInitSegment(t,e,r,n),o.resetInitSegment(t,e,r,i))}destroy(){this.demuxer&&(this.demuxer.destroy(),this.demuxer=void 0),this.remuxer&&(this.remuxer.destroy(),this.remuxer=void 0)}transmux(t,e,r,n,i){let s;return s=e&&"SAMPLE-AES"===e.method?this.transmuxSampleAes(t,e,r,n,i):this.transmuxUnencrypted(t,r,n,i),s}transmuxUnencrypted(t,e,r,n){const{audioTrack:i,videoTrack:s,id3Track:o,textTrack:a}=this.demuxer.demux(t,e,!1,!this.config.progressive);return{remuxResult:this.remuxer.remux(i,s,o,a,e,r,!1,this.id),chunkMeta:n}}transmuxSampleAes(t,e,r,n,i){return this.demuxer.demuxSampleAes(t,e,r).then((t=>({remuxResult:this.remuxer.remux(t.audioTrack,t.videoTrack,t.id3Track,t.textTrack,r,n,!1,this.id),chunkMeta:i})))}configureTransmuxer(t){const{config:e,observer:r,typeSupported:n}=this;let i;for(let e=0,r=Ti.length;e<r;e++){var s;if(null!=(s=Ti[e].demux)&&s.probe(t,this.logger)){i=Ti[e];break}}if(!i)return new Error("Failed to find demuxer by probing fragment data");const o=this.demuxer,a=this.remuxer,l=i.remux,c=i.demux;a&&a instanceof l||(this.remuxer=new l(r,e,n,this.logger)),o&&o instanceof c||(this.demuxer=new c(r,e,n,this.logger),this.probe=c.probe)}needsProbing(t,e){return!this.demuxer||!this.remuxer||t||e}getDecrypter(){let t=this.decrypter;return t||(t=this.decrypter=new xe(this.config)),t}}const Li=t=>({remuxResult:{},chunkMeta:t});function _i(t){return"then"in t&&t.then instanceof Function}class xi{constructor(t,e,r,n,i){this.audioCodec=void 0,this.videoCodec=void 0,this.initSegmentData=void 0,this.duration=void 0,this.defaultInitPts=void 0,this.audioCodec=t,this.videoCodec=e,this.initSegmentData=r,this.duration=n,this.defaultInitPts=i||null}}class ki{constructor(t,e,r,n,i,s){this.discontinuity=void 0,this.contiguous=void 0,this.accurateTimeOffset=void 0,this.trackSwitch=void 0,this.timeOffset=void 0,this.initSegmentChange=void 0,this.discontinuity=t,this.contiguous=e,this.accurateTimeOffset=r,this.trackSwitch=n,this.timeOffset=i,this.initSegmentChange=s}}let Pi=0;class Ii{constructor(t,e,r,n){this.error=null,this.hls=void 0,this.id=void 0,this.instanceNo=Pi++,this.observer=void 0,this.frag=null,this.part=null,this.useWorker=void 0,this.workerContext=null,this.transmuxer=null,this.onTransmuxComplete=void 0,this.onFlush=void 0,this.onWorkerMessage=t=>{const e=t.data,r=this.hls;if(r&&null!=e&&e.event&&e.instanceNo===this.instanceNo)switch(e.event){case"init":{var n;const t=null==(n=this.workerContext)?void 0:n.objectURL;t&&self.URL.revokeObjectURL(t);break}case"transmuxComplete":this.handleTransmuxComplete(e.data);break;case"flush":this.onFlush(e.data);break;case"workerLog":r.logger[e.data.logType]&&r.logger[e.data.logType](e.data.message);break;default:e.data=e.data||{},e.data.frag=this.frag,e.data.part=this.part,e.data.id=this.id,r.trigger(e.event,e.data)}},this.onWorkerError=t=>{if(!this.hls)return;const e=new Error(`${t.message}  (${t.filename}:${t.lineno})`);this.hls.config.enableWorker=!1,this.hls.logger.warn(`Error in "${this.id}" Web Worker, fallback to inline`),this.hls.trigger(l.ERROR,{type:o.OTHER_ERROR,details:a.INTERNAL_EXCEPTION,fatal:!1,event:"demuxerWorker",error:e})};const i=t.config;this.hls=t,this.id=e,this.useWorker=!!i.enableWorker,this.onTransmuxComplete=r,this.onFlush=n;const s=(t,e)=>{(e=e||{}).frag=this.frag||void 0,t===l.ERROR&&(e.parent=this.id,e.part=this.part,this.error=e.error),this.hls.trigger(t,e)};this.observer=new rn,this.observer.on(l.FRAG_DECRYPTED,s),this.observer.on(l.ERROR,s);const c=Pt(i.preferManagedMediaSource);if(this.useWorker&&"undefined"!=typeof Worker){const r=this.hls.logger;if(i.workerPath||"function"==typeof __HLS_WORKER_BUNDLE__){try{i.workerPath?(r.log(`loading Web Worker ${i.workerPath} for "${e}"`),this.workerContext=function(t){const e=sn[t];if(e)return e.clientCount++,e;const r=new self.URL(t,self.location.href).href,n={worker:new self.Worker(r),scriptURL:r,clientCount:1};return sn[t]=n,n}(i.workerPath)):(r.log(`injecting Web Worker for "${e}"`),this.workerContext=function(){const t=sn[nn];if(t)return t.clientCount++,t;const e=new self.Blob([`var exports={};var module={exports:exports};function define(f){f()};define.amd=true;(${__HLS_WORKER_BUNDLE__.toString()})(true);`],{type:"text/javascript"}),r=self.URL.createObjectURL(e),n={worker:new self.Worker(r),objectURL:r,clientCount:1};return sn[nn]=n,n}());const{worker:t}=this.workerContext;t.addEventListener("message",this.onWorkerMessage),t.addEventListener("error",this.onWorkerError),t.postMessage({instanceNo:this.instanceNo,cmd:"init",typeSupported:c,id:e,config:Yt(i)})}catch(n){r.warn(`Error setting up "${e}" Web Worker, fallback to inline`,n),this.terminateWorker(),this.error=null,this.transmuxer=new Si(this.observer,c,i,"",e,t.logger)}return}}this.transmuxer=new Si(this.observer,c,i,"",e,t.logger)}reset(){if(this.frag=null,this.part=null,this.workerContext){const t=this.instanceNo;this.instanceNo=Pi++;const e=this.hls.config,r=Pt(e.preferManagedMediaSource);this.workerContext.worker.postMessage({instanceNo:this.instanceNo,cmd:"reset",resetNo:t,typeSupported:r,id:this.id,config:Yt(e)})}}terminateWorker(){if(this.workerContext){const{worker:t}=this.workerContext;this.workerContext=null,t.removeEventListener("message",this.onWorkerMessage),t.removeEventListener("error",this.onWorkerError),function(t){const e=sn[t||nn];if(e&&1==e.clientCount--){const{worker:r,objectURL:n}=e;delete sn[t||nn],n&&self.URL.revokeObjectURL(n),r.terminate()}}(this.hls.config.workerPath)}}destroy(){if(this.workerContext)this.terminateWorker(),this.onWorkerMessage=this.onWorkerError=null;else{const t=this.transmuxer;t&&(t.destroy(),this.transmuxer=null)}const t=this.observer;t&&t.removeAllListeners(),this.frag=null,this.part=null,this.observer=null,this.hls=null}push(t,e,r,n,i,s,o,a,l,c){var h,d;l.transmuxing.start=self.performance.now();const{instanceNo:f,transmuxer:p}=this,g=s?s.start:i.start,m=i.decryptdata,y=this.frag,v=!(y&&i.cc===y.cc),b=!(y&&l.level===y.level),E=y?l.sn-y.sn:-1,A=this.part?l.part-this.part.index:-1,w=0===E&&l.id>1&&l.id===(null==y?void 0:y.stats.chunkCount),T=!b&&(1===E||0===E&&(1===A||w&&A<=0)),S=self.performance.now();(b||E||0===i.stats.parsing.start)&&(i.stats.parsing.start=S),!s||!A&&T||(s.stats.parsing.start=S);const L=!(y&&(null==(h=i.initSegment)?void 0:h.url)===(null==(d=y.initSegment)?void 0:d.url)),_=new ki(v,T,a,b,g,L);if(!T||v||L){this.hls.logger.log(`[transmuxer-interface]: Starting new transmux session for ${i.type} sn: ${l.sn}${l.part>-1?" part: "+l.part:""} ${this.id===u.MAIN?"level":"track"}: ${l.level} id: ${l.id}\n        discontinuity: ${v}\n        trackSwitch: ${b}\n        contiguous: ${T}\n        accurateTimeOffset: ${a}\n        timeOffset: ${g}\n        initSegmentChange: ${L}`);const t=new xi(r,n,e,o,c);this.configureTransmuxer(t)}if(this.frag=i,this.part=s,this.workerContext)this.workerContext.worker.postMessage({instanceNo:f,cmd:"demux",data:t,decryptdata:m,chunkMeta:l,state:_},t instanceof ArrayBuffer?[t]:[]);else if(p){const e=p.push(t,m,l,_);_i(e)?e.then((t=>{this.handleTransmuxComplete(t)})).catch((t=>{this.transmuxerError(t,l,"transmuxer-interface push error")})):this.handleTransmuxComplete(e)}}flush(t){t.transmuxing.start=self.performance.now();const{instanceNo:e,transmuxer:r}=this;if(this.workerContext)this.workerContext.worker.postMessage({instanceNo:e,cmd:"flush",chunkMeta:t});else if(r){const e=r.flush(t);_i(e)?e.then((e=>{this.handleFlushResult(e,t)})).catch((e=>{this.transmuxerError(e,t,"transmuxer-interface flush error")})):this.handleFlushResult(e,t)}}transmuxerError(t,e,r){this.hls&&(this.error=t,this.hls.trigger(l.ERROR,{type:o.MEDIA_ERROR,details:a.FRAG_PARSING_ERROR,chunkMeta:e,frag:this.frag||void 0,part:this.part||void 0,fatal:!1,error:t,err:t,reason:r}))}handleFlushResult(t,e){t.forEach((t=>{this.handleTransmuxComplete(t)})),this.onFlush(e)}configureTransmuxer(t){const{instanceNo:e,transmuxer:r}=this;this.workerContext?this.workerContext.worker.postMessage({instanceNo:e,cmd:"configure",config:t}):r&&r.configure(t)}handleTransmuxComplete(t){t.chunkMeta.transmuxing.end=self.performance.now(),this.onTransmuxComplete(t)}}class Ri extends y{constructor(t,e){super(e,t.logger),this.hls=void 0,this.canLoad=!1,this.timer=-1,this.hls=t}destroy(){this.clearTimer(),this.hls=this.log=this.warn=null}clearTimer(){-1!==this.timer&&(self.clearTimeout(this.timer),this.timer=-1)}startLoad(){this.canLoad=!0,this.loadPlaylist()}stopLoad(){this.canLoad=!1,this.clearTimer()}switchParams(t,e,r){const n=null==e?void 0:e.renditionReports;if(n){let i=-1;for(let r=0;r<n.length;r++){const s=n[r];let o;try{o=new self.URL(s.URI,e.url).href}catch(t){this.warn(`Could not construct new URL for Rendition Report: ${t}`),o=s.URI||""}if(o===t){i=r;break}o===t.substring(0,o.length)&&(i=r)}if(-1!==i){const t=n[i],s=parseInt(t["LAST-MSN"])||e.lastPartSn;let o=parseInt(t["LAST-PART"])||e.lastPartIndex;if(this.hls.config.lowLatencyMode){const t=Math.min(e.age-e.partTarget,e.targetduration);o>=0&&t>e.partTarget&&(o+=1)}const a=r&&jt(r);return new Gt(s,o>=0?o:void 0,a)}}}loadPlaylist(t){this.clearTimer()}loadingPlaylist(t,e){this.clearTimer()}shouldLoadPlaylist(t){return this.canLoad&&!!t&&!!t.url&&(!t.details||t.details.live)}getUrlWithDirectives(t,e){if(e)try{return e.addDirectives(t)}catch(t){this.warn(`Could not construct new URL with HLS Delivery Directives: ${t}`)}return t}playlistLoaded(t,e,r){const{details:n,stats:i}=e,s=self.performance.now(),c=i.loading.first?Math.max(0,s-i.loading.first):0;n.advancedDateTime=Date.now()-c;const u=this.hls.config.timelineOffset;if(u!==n.appliedTimelineOffset){const t=Math.max(u||0,0);n.appliedTimelineOffset=t,n.fragments.forEach((e=>{e.setStart(e.playlistOffset+t)}))}if(n.live||null!=r&&r.live){const u="levelInfo"in e?e.levelInfo:e.track;if(n.reloaded(r),r&&n.fragments.length>0){Ir(r,n,this);const t=n.playlistParsingError;if(t){this.warn(t);const r=this.hls;if(!r.config.ignorePlaylistParsingErrors){var h;const{networkDetails:s}=e;return void r.trigger(l.ERROR,{type:o.NETWORK_ERROR,details:a.LEVEL_PARSING_ERROR,fatal:!1,url:n.url,error:t,reason:t.message,level:e.level||void 0,parent:null==(h=n.fragments[0])?void 0:h.type,networkDetails:s,stats:i})}n.playlistParsingError=null}}-1===n.requestScheduled&&(n.requestScheduled=i.loading.start);const d=this.hls.mainForwardBufferInfo,f=d?d.end-d.len:0,p=Cr(n,1e3*(n.edge-f));if(n.requestScheduled+p<s?n.requestScheduled=s:n.requestScheduled+=p,this.log(`live playlist ${t} ${n.advanced?"REFRESHED "+n.lastPartSn+"-"+n.lastPartIndex:n.updated?"UPDATED":"MISSED"}`),!this.canLoad||!n.live)return;let g,m,y;if(n.canBlockReload&&n.endSN&&n.advanced){const t=this.hls.config.lowLatencyMode,i=n.lastPartSn,o=n.endSN,a=n.lastPartIndex,l=i===o;-1!==a?l?(m=o+1,y=t?0:a):(m=i,y=t?a+1:n.maxPartIndex):m=o+1;const c=n.age,h=c+n.ageHeader;let d=Math.min(h-n.partTarget,1.5*n.targetduration);if(d>0){if(h>3*n.targetduration)this.log(`Playlist last advanced ${c.toFixed(2)}s ago. Omitting segment and part directives.`),m=void 0,y=void 0;else if(null!=r&&r.tuneInGoal&&h-n.partTarget>r.tuneInGoal)this.warn(`CDN Tune-in goal increased from: ${r.tuneInGoal} to: ${d} with playlist age: ${n.age}`),d=0;else{const t=Math.floor(d/n.targetduration);if(m+=t,void 0!==y){y+=Math.round(d%n.targetduration/n.partTarget)}this.log(`CDN Tune-in age: ${n.ageHeader}s last advanced ${c.toFixed(2)}s goal: ${d} skip sn ${t} to part ${y}`)}n.tuneInGoal=d}if(g=this.getDeliveryDirectives(n,e.deliveryDirectives,m,y),t||!l)return n.requestScheduled=s,void this.loadingPlaylist(u,g)}else(n.canBlockReload||n.canSkipUntil)&&(g=this.getDeliveryDirectives(n,e.deliveryDirectives,m,y));g&&void 0!==m&&n.canBlockReload&&(n.requestScheduled=i.loading.first+Math.max(p-2*c,p/2)),this.scheduleLoading(u,g,n)}else this.clearTimer()}scheduleLoading(t,e,r){const n=r||t.details;if(!n)return void this.loadingPlaylist(t,e);const i=self.performance.now(),s=n.requestScheduled;if(i>=s)return void this.loadingPlaylist(t,e);const o=s-i;this.log(`reload live playlist ${t.name||t.bitrate+"bps"} in ${Math.round(o)} ms`),this.clearTimer(),this.timer=self.setTimeout((()=>this.loadingPlaylist(t,e)),o)}getDeliveryDirectives(t,e,r,n){let i=jt(t);return null!=e&&e.skip&&t.deltaUpdateFailed&&(r=e.msn,n=e.part,i=$t.No),new Gt(r,n,i)}checkRetry(t){const e=t.details,r=oe(t),n=t.errorAction,{action:i,retryCount:s=0,retryConfig:o}=n||{},a=!!n&&!!o&&(i===de.RetryRequest||!n.resolved&&i===de.SendAlternateToPenaltyBox);if(a){var l;if(s>=o.maxNumRetry)return!1;if(r&&null!=(l=t.context)&&l.deliveryDirectives)this.warn(`Retrying playlist loading ${s+1}/${o.maxNumRetry} after "${e}" without delivery-directives`),this.loadPlaylist();else{const t=le(o,s);this.clearTimer(),this.timer=self.setTimeout((()=>this.loadPlaylist()),t),this.warn(`Retrying playlist loading ${s+1}/${o.maxNumRetry} after "${e}" in ${t}ms`)}t.levelRetry=!0,n.resolved=!0}return a}}function Oi(t,e){if(t.length!==e.length)return!1;for(let r=0;r<t.length;r++)if(!Di(t[r].attrs,e[r].attrs))return!1;return!0}function Di(t,e,r){const n=t["STABLE-RENDITION-ID"];return n&&!r?n===e["STABLE-RENDITION-ID"]:!(r||["LANGUAGE","NAME","CHARACTERISTICS","AUTOSELECT","DEFAULT","FORCED","ASSOC-LANGUAGE"]).some((r=>t[r]!==e[r]))}function Ci(t,e){return e.label.toLowerCase()===t.name.toLowerCase()&&(!e.language||e.language.toLowerCase()===(t.lang||"").toLowerCase())}class Mi{constructor(t){this.tracks=void 0,this.queues={video:[],audio:[],audiovideo:[]},this.tracks=t}destroy(){this.tracks=this.queues=null}append(t,e,r){if(null===this.queues||null===this.tracks)return;const n=this.queues[e];n.push(t),1!==n.length||r||this.executeNext(e)}appendBlocker(t){return new Promise((e=>{const r={label:"async-blocker",execute:e,onStart:()=>{},onComplete:()=>{},onError:()=>{}};this.append(r,t)}))}prependBlocker(t){return new Promise((e=>{if(this.queues){const r={label:"async-blocker-prepend",execute:e,onStart:()=>{},onComplete:()=>{},onError:()=>{}};this.queues[t].unshift(r)}}))}removeBlockers(){null!==this.queues&&[this.queues.video,this.queues.audio,this.queues.audiovideo].forEach((t=>{var e;const r=null==(e=t[0])?void 0:e.label;"async-blocker"!==r&&"async-blocker-prepend"!==r||(t[0].execute(),t.splice(0,1))}))}unblockAudio(t){if(null===this.queues)return;this.queues.audio[0]===t&&this.shiftAndExecuteNext("audio")}executeNext(t){if(null===this.queues||null===this.tracks)return;const e=this.queues[t];if(e.length){const n=e[0];try{n.execute()}catch(e){var r;if(n.onError(e),null===this.queues||null===this.tracks)return;const i=null==(r=this.tracks[t])?void 0:r.buffer;null!=i&&i.updating||this.shiftAndExecuteNext(t)}}}shiftAndExecuteNext(t){null!==this.queues&&(this.queues[t].shift(),this.executeNext(t))}current(t){var e;return(null==(e=this.queues)?void 0:e[t][0])||null}toString(){const{queues:t,tracks:e}=this;return null===t||null===e?"<destroyed>":`\n${this.list("video")}\n${this.list("audio")}\n${this.list("audiovideo")}}`}list(t){var e,r;return null!=(e=this.queues)&&e[t]||null!=(r=this.tracks)&&r[t]?`${t}: (${this.listSbInfo(t)}) ${this.listOps(t)}`:""}listSbInfo(t){var e;const r=null==(e=this.tracks)?void 0:e[t],n=null==r?void 0:r.buffer;return n?`SourceBuffer${n.updating?" updating":""}${r.ended?" ended":""}${r.ending?" ending":""}`:"none"}listOps(t){var e;return(null==(e=this.queues)?void 0:e[t].map((t=>t.label)).join(", "))||""}}const Ni=/(avc[1234]|hvc1|hev1|dvh[1e]|vp09|av01)(?:\.[^.,]+)+/,Fi="HlsJsTrackRemovedError";class Ui extends Error{constructor(t){super(t),this.name=Fi}}function Bi(t){const e=t.querySelectorAll("source");[].slice.call(e).forEach((e=>{t.removeChild(e)}))}function $i(t){return"audio"===t?1:0}class ji{constructor(t){this.hls=void 0,this.autoLevelCapping=void 0,this.firstLevel=void 0,this.media=void 0,this.restrictedLevels=void 0,this.timer=void 0,this.clientRect=void 0,this.streamController=void 0,this.hls=t,this.autoLevelCapping=Number.POSITIVE_INFINITY,this.firstLevel=-1,this.media=null,this.restrictedLevels=[],this.timer=void 0,this.clientRect=null,this.registerListeners()}setStreamController(t){this.streamController=t}destroy(){this.hls&&this.unregisterListener(),this.timer&&this.stopCapping(),this.media=null,this.clientRect=null,this.hls=this.streamController=null}registerListeners(){const{hls:t}=this;t.on(l.FPS_DROP_LEVEL_CAPPING,this.onFpsDropLevelCapping,this),t.on(l.MEDIA_ATTACHING,this.onMediaAttaching,this),t.on(l.MANIFEST_PARSED,this.onManifestParsed,this),t.on(l.LEVELS_UPDATED,this.onLevelsUpdated,this),t.on(l.BUFFER_CODECS,this.onBufferCodecs,this),t.on(l.MEDIA_DETACHING,this.onMediaDetaching,this)}unregisterListener(){const{hls:t}=this;t.off(l.FPS_DROP_LEVEL_CAPPING,this.onFpsDropLevelCapping,this),t.off(l.MEDIA_ATTACHING,this.onMediaAttaching,this),t.off(l.MANIFEST_PARSED,this.onManifestParsed,this),t.off(l.LEVELS_UPDATED,this.onLevelsUpdated,this),t.off(l.BUFFER_CODECS,this.onBufferCodecs,this),t.off(l.MEDIA_DETACHING,this.onMediaDetaching,this)}onFpsDropLevelCapping(t,e){const r=this.hls.levels[e.droppedLevel];this.isLevelAllowed(r)&&this.restrictedLevels.push({bitrate:r.bitrate,height:r.height,width:r.width})}onMediaAttaching(t,e){this.media=e.media instanceof HTMLVideoElement?e.media:null,this.clientRect=null,this.timer&&this.hls.levels.length&&this.detectPlayerSize()}onManifestParsed(t,e){const r=this.hls;this.restrictedLevels=[],this.firstLevel=e.firstLevel,r.config.capLevelToPlayerSize&&e.video&&this.startCapping()}onLevelsUpdated(t,e){this.timer&&n(this.autoLevelCapping)&&this.detectPlayerSize()}onBufferCodecs(t,e){this.hls.config.capLevelToPlayerSize&&e.video&&this.startCapping()}onMediaDetaching(){this.stopCapping(),this.media=null}detectPlayerSize(){if(this.media){if(this.mediaHeight<=0||this.mediaWidth<=0)return void(this.clientRect=null);const t=this.hls.levels;if(t.length){const e=this.hls,r=this.getMaxLevel(t.length-1);r!==this.autoLevelCapping&&e.logger.log(`Setting autoLevelCapping to ${r}: ${t[r].height}p@${t[r].bitrate} for media ${this.mediaWidth}x${this.mediaHeight}`),e.autoLevelCapping=r,e.autoLevelEnabled&&e.autoLevelCapping>this.autoLevelCapping&&this.streamController&&this.streamController.nextLevelSwitch(),this.autoLevelCapping=e.autoLevelCapping}}}getMaxLevel(t){const e=this.hls.levels;if(!e.length)return-1;const r=e.filter(((e,r)=>this.isLevelAllowed(e)&&r<=t));return this.clientRect=null,ji.getMaxLevelByMediaSize(r,this.mediaWidth,this.mediaHeight)}startCapping(){this.timer||(this.autoLevelCapping=Number.POSITIVE_INFINITY,self.clearInterval(this.timer),this.timer=self.setInterval(this.detectPlayerSize.bind(this),1e3),this.detectPlayerSize())}stopCapping(){this.restrictedLevels=[],this.firstLevel=-1,this.autoLevelCapping=Number.POSITIVE_INFINITY,this.timer&&(self.clearInterval(this.timer),this.timer=void 0)}getDimensions(){if(this.clientRect)return this.clientRect;const t=this.media,e={width:0,height:0};if(t){const r=t.getBoundingClientRect();e.width=r.width,e.height=r.height,e.width||e.height||(e.width=r.right-r.left||t.width||0,e.height=r.bottom-r.top||t.height||0)}return this.clientRect=e,e}get mediaWidth(){return this.getDimensions().width*this.contentScaleFactor}get mediaHeight(){return this.getDimensions().height*this.contentScaleFactor}get contentScaleFactor(){let t=1;if(!this.hls.config.ignoreDevicePixelRatio)try{t=self.devicePixelRatio}catch(t){}return Math.min(t,this.hls.config.maxDevicePixelRatio)}isLevelAllowed(t){return!this.restrictedLevels.some((e=>t.bitrate===e.bitrate&&t.width===e.width&&t.height===e.height))}static getMaxLevelByMediaSize(t,e,r){if(null==t||!t.length)return-1;let n=t.length-1;const i=Math.max(e,r);for(let e=0;e<t.length;e+=1){const r=t[e];if((r.width>=i||r.height>=i)&&(s=r,!(o=t[e+1])||s.width!==o.width||s.height!==o.height)){n=e;break}}var s,o;return n}}const Gi={MANIFEST:"m",AUDIO:"a",VIDEO:"v",MUXED:"av",INIT:"i",CAPTION:"c",TIMED_TEXT:"tt",KEY:"k",OTHER:"o"},Hi={HLS:"h"};class Vi{constructor(t,e){Array.isArray(t)&&(t=t.map((t=>t instanceof Vi?t:new Vi(t)))),this.value=t,this.params=e}}const Ki="Dict";function Yi(t,e,r,n){return new Error(`failed to ${t} "${i=e,Array.isArray(i)?JSON.stringify(i):i instanceof Map?"Map{}":i instanceof Set?"Set{}":"object"==typeof i?JSON.stringify(i):String(i)}" as ${r}`,{cause:n});var i}function qi(t,e,r){return Yi("serialize",t,e,r)}class Wi{constructor(t){this.description=t}}const zi="Bare Item",Xi="Boolean";const Qi="Byte Sequence";function Ji(t){if(!1===ArrayBuffer.isView(t))throw qi(t,Qi);return`:${e=t,btoa(String.fromCharCode(...e))}:`;var e}const Zi="Integer";function ts(t){if(function(t){return t<-999999999999999||999999999999999<t}(t))throw qi(t,Zi);return t.toString()}function es(t,e){if(t<0)return-es(-t,e);const r=Math.pow(10,e);if(Math.abs(t*r%1-.5)<Number.EPSILON){const e=Math.floor(t*r);return(e%2==0?e:e+1)/r}return Math.round(t*r)/r}const rs="Decimal";function ns(t){const e=es(t,3);if(Math.floor(Math.abs(e)).toString().length>12)throw qi(t,rs);const r=e.toString();return r.includes(".")?r:`${r}.0`}const is="String",ss=/[\x00-\x1f\x7f]+/;const os="Token";function as(t){const e=(r=t).description||r.toString().slice(7,-1);var r;if(!1===/^([a-zA-Z*])([!#$%&'*+\-.^_`|~\w:/]*)$/.test(e))throw qi(e,os);return e}function ls(t){switch(typeof t){case"number":if(!n(t))throw qi(t,zi);return Number.isInteger(t)?ts(t):ns(t);case"string":return function(t){if(ss.test(t))throw qi(t,is);return`"${t.replace(/\\/g,"\\\\").replace(/"/g,'\\"')}"`}(t);case"symbol":return as(t);case"boolean":return function(t){if("boolean"!=typeof t)throw qi(t,Xi);return t?"?1":"?0"}(t);case"object":if(t instanceof Date)return function(t){return`@${ts(t.getTime()/1e3)}`}(t);if(t instanceof Uint8Array)return Ji(t);if(t instanceof Wi)return as(t);default:throw qi(t,zi)}}const cs="Key";function us(t){if(!1===/^[a-z*][a-z0-9\-_.*]*$/.test(t))throw qi(t,cs);return t}function hs(t){return null==t?"":Object.entries(t).map((([t,e])=>!0===e?`;${us(t)}`:`;${us(t)}=${ls(e)}`)).join("")}function ds(t){return t instanceof Vi?`${ls(t.value)}${hs(t.params)}`:ls(t)}function fs(t,e={whitespace:!0}){if("object"!=typeof t||null==t)throw qi(t,Ki);const r=t instanceof Map?t.entries():Object.entries(t),n=(null==e?void 0:e.whitespace)?" ":"";return Array.from(r).map((([t,e])=>{e instanceof Vi==!1&&(e=new Vi(e));let r=us(t);var n;return!0===e.value?r+=hs(e.params):(r+="=",Array.isArray(e.value)?r+=`(${(n=e).value.map(ds).join(" ")})${hs(n.params)}`:r+=ds(e)),r})).join(`,${n}`)}function ps(t,e){return fs(t,e)}const gs="CMCD-Object",ms="CMCD-Request",ys="CMCD-Session",vs="CMCD-Status",bs={br:gs,ab:gs,d:gs,ot:gs,tb:gs,tpb:gs,lb:gs,tab:gs,lab:gs,url:gs,pb:ms,bl:ms,tbl:ms,dl:ms,ltc:ms,mtp:ms,nor:ms,nrr:ms,rc:ms,sn:ms,sta:ms,su:ms,ttfb:ms,ttfbb:ms,ttlb:ms,cmsdd:ms,cmsds:ms,smrt:ms,df:ms,cs:ms,ts:ms,cid:ys,pr:ys,sf:ys,sid:ys,st:ys,v:ys,msd:ys,bs:vs,bsd:vs,cdn:vs,rtp:vs,bg:vs,pt:vs,ec:vs,e:vs},Es={REQUEST:ms};function As(t,e){const r={};if(!t)return r;const n=Object.keys(t),i=e?(s=e,Object.keys(s).reduce(((t,e)=>{var r;return null===(r=s[e])||void 0===r||r.forEach((r=>t[r]=e)),t}),{})):{};var s;return n.reduce(((e,r)=>{var n;const s=bs[r]||i[r]||Es.REQUEST;return(null!==(n=e[s])&&void 0!==n?n:e[s]={})[r]=t[r],e}),r)}const ws="event";const Ts=t=>Math.round(t),Ss=(t,e)=>Array.isArray(t)?t.map((t=>Ss(t,e))):t instanceof Vi&&"string"==typeof t.value?new Vi(Ss(t.value,e),t.params):(e.baseUrl&&(t=function(t,e){const r=new URL(t),n=new URL(e);if(r.origin!==n.origin)return t;const i=r.pathname.split("/").slice(1),s=n.pathname.split("/").slice(1,-1);for(;i[0]===s[0];)i.shift(),s.shift();for(;s.length;)s.shift(),i.unshift("..");return i.join("/")+r.search+r.hash}(t,e.baseUrl)),1===e.version?encodeURIComponent(t):t),Ls=t=>100*Ts(t/100),_s={br:Ts,d:Ts,bl:Ls,dl:Ls,mtp:Ls,nor:(t,e)=>{let r=t;return e.version>=2&&(t instanceof Vi&&"string"==typeof t.value?r=new Vi([t]):"string"==typeof t&&(r=[t])),Ss(r,e)},rtp:Ls,tb:Ts},xs="request",ks="response",Ps=["ab","bg","bl","br","bs","bsd","cdn","cid","cs","df","ec","lab","lb","ltc","msd","mtp","pb","pr","pt","sf","sid","sn","st","sta","tab","tb","tbl","tpb","ts","v"],Is=["e"],Rs=/^[a-zA-Z0-9-.]+-[a-zA-Z0-9-.]+$/;function Os(t){return Rs.test(t)}const Ds=["d","dl","nor","ot","rtp","su"];const Cs=["cmsdd","cmsds","rc","smrt","ttfb","ttfbb","ttlb","url"];const Ms=["bl","br","bs","cid","d","dl","mtp","nor","nrr","ot","pr","rtp","sf","sid","st","su","tb","v"];function Ns(t){return Ms.includes(t)||Os(t)}const Fs={[ks]:function(t){return Ps.includes(t)||Ds.includes(t)||Cs.includes(t)||Os(t)},[ws]:function(t){return Ps.includes(t)||Is.includes(t)||Os(t)},[xs]:function(t){return Ps.includes(t)||Ds.includes(t)||Os(t)}};function Us(t,e={}){const r={};if(null==t||"object"!=typeof t)return r;const i=e.version||t.v||1,s=e.reportingMode||xs,o=1===i?Ns:Fs[s];let a=Object.keys(t).filter(o);const l=e.filter;"function"==typeof l&&(a=a.filter(l));const c=s===ks||s===ws;c&&!a.includes("ts")&&a.push("ts"),i>1&&!a.includes("v")&&a.push("v");const u=p({},_s,e.formatters),h={version:i,reportingMode:s,baseUrl:e.baseUrl};return a.sort().forEach((e=>{let s=t[e];const o=u[e];if("function"==typeof o&&(s=o(s,h)),"v"===e){if(1===i)return;s=i}"pr"==e&&1===s||(c&&"ts"===e&&!n(s)&&(s=Date.now()),function(t){return"number"==typeof t?n(t):null!=t&&""!==t&&!1!==t}(s)&&(function(t){return["ot","sf","st","e","sta"].includes(t)}(e)&&"string"==typeof s&&(s=new Wi(s)),r[e]=s))})),r}function Bs(t,e,r){return p(t,function(t,e={}){const r={};if(!t)return r;const n=As(Us(t,e),null==e?void 0:e.customHeaderMap);return Object.entries(n).reduce(((t,[e,r])=>{const n=ps(r,{whitespace:!1});return n&&(t[e]=n),t}),r)}(e,r))}const $s="CMCD";function js(t,e={}){if(!t)return"";const r=function(t,e={}){return t?ps(Us(t,e),{whitespace:!1}):""}(t,e);return encodeURIComponent(r)}const Gs=/CMCD=[^&#]+/;function Hs(t,e,r){const n=function(t,e={}){if(!t)return"";const r=js(t,e);return`${$s}=${r}`}(e,r);if(!n)return t;if(Gs.test(t))return t.replace(Gs,n);const i=t.includes("?")?"&":"?";return`${t}${i}${n}`}function Vs(t,e,r,n){t&&Object.keys(e).forEach((i=>{const s=t.filter((t=>t.groupId===i)).map((t=>{const s=p({},t);return s.details=void 0,s.attrs=new Ve(s.attrs),s.url=s.attrs.URI=Ks(t.url,t.attrs["STABLE-RENDITION-ID"],"PER-RENDITION-URIS",r),s.groupId=s.attrs["GROUP-ID"]=e[i],s.attrs["PATHWAY-ID"]=n,s}));t.push(...s)}))}function Ks(t,e,r,n){const{HOST:i,PARAMS:s,[r]:o}=n;let a;e&&(a=null==o?void 0:o[e],a&&(t=a));const l=new self.URL(t);return i&&!a&&(l.host=i),s&&Object.keys(s).sort().forEach((t=>{t&&l.searchParams.set(t,s[t])})),l.href}class Ys extends y{constructor(t){super("eme",t.logger),this.hls=void 0,this.config=void 0,this.media=null,this.keyFormatPromise=null,this.keySystemAccessPromises={},this._requestLicenseFailureCount=0,this.mediaKeySessions=[],this.keyIdToKeySessionPromise={},this.mediaKeys=null,this.setMediaKeysQueue=Ys.CDMCleanupPromise?[Ys.CDMCleanupPromise]:[],this.bannedKeyIds={},this.onMediaEncrypted=t=>{const{initDataType:e,initData:r}=t,n=`"${t.type}" event: init data type: "${e}"`;if(this.debug(n),null!==r){if(!this.keyFormatPromise){let t=Object.keys(this.keySystemAccessPromises);t.length||(t=or(this.config));const e=t.map(sr).filter((t=>!!t));this.keyFormatPromise=this.getKeyFormatPromise(e)}this.keyFormatPromise.then((i=>{const s=ir(i);if("sinf"!==e||s!==rr.FAIRPLAY)return void this.log(`Ignoring "${t.type}" event with init data type: "${e}" for selected key-system ${s}`);let o;try{const t=W(new Uint8Array(r)),e=at(Je(JSON.parse(t).sinf));if(!e)throw new Error("'schm' box missing or not cbcs/cenc with schi > tenc");o=new Uint8Array(e.subarray(8,24))}catch(t){return void this.warn(`${n} Failed to parse sinf: ${t}`)}const a=x(o),{keyIdToKeySessionPromise:l,mediaKeySessions:c}=this;let u=l[a];for(let t=0;t<c.length;t++){const n=c[t],i=n.decryptdata;if(!i.keyId)continue;const s=x(i.keyId);if(a===s||-1!==i.uri.replace(/-/g,"").indexOf(a)){if(u=l[s],!u)continue;if(i.pssh)break;delete l[s],i.pssh=new Uint8Array(r),i.keyId=o,u=l[a]=u.then((()=>this.generateRequestWithPreferredKeySession(n,e,r,"encrypted-event-key-match"))),u.catch((t=>this.handleError(t)));break}}u||this.handleError(new Error(`Key ID ${a} not encountered in playlist. Key-system sessions ${c.length}.`))})).catch((t=>this.handleError(t)))}},this.onWaitingForKey=t=>{this.log(`"${t.type}" event`)},this.hls=t,this.config=t.config,this.registerListeners()}destroy(){this.onDestroying(),this.onMediaDetached();const t=this.config;t.requestMediaKeySystemAccessFunc=null,t.licenseXhrSetup=t.licenseResponseCallback=void 0,t.drmSystems=t.drmSystemOptions={},this.hls=this.config=this.keyIdToKeySessionPromise=null,this.onMediaEncrypted=this.onWaitingForKey=null}registerListeners(){this.hls.on(l.MEDIA_ATTACHED,this.onMediaAttached,this),this.hls.on(l.MEDIA_DETACHED,this.onMediaDetached,this),this.hls.on(l.MANIFEST_LOADING,this.onManifestLoading,this),this.hls.on(l.MANIFEST_LOADED,this.onManifestLoaded,this),this.hls.on(l.DESTROYING,this.onDestroying,this)}unregisterListeners(){this.hls.off(l.MEDIA_ATTACHED,this.onMediaAttached,this),this.hls.off(l.MEDIA_DETACHED,this.onMediaDetached,this),this.hls.off(l.MANIFEST_LOADING,this.onManifestLoading,this),this.hls.off(l.MANIFEST_LOADED,this.onManifestLoaded,this),this.hls.off(l.DESTROYING,this.onDestroying,this)}getLicenseServerUrl(t){const{drmSystems:e,widevineLicenseUrl:r}=this.config,n=null==e?void 0:e[t];return n?n.licenseUrl:t===rr.WIDEVINE&&r?r:void 0}getLicenseServerUrlOrThrow(t){const e=this.getLicenseServerUrl(t);if(void 0===e)throw new Error(`no license server URL configured for key-system "${t}"`);return e}getServerCertificateUrl(t){const{drmSystems:e}=this.config,r=null==e?void 0:e[t];if(r)return r.serverCertificateUrl;this.log(`No Server Certificate in config.drmSystems["${t}"]`)}attemptKeySystemAccess(t){const e=this.hls.levels,r=(t,e,r)=>!!t&&r.indexOf(t)===e,n=e.map((t=>t.audioCodec)).filter(r),i=e.map((t=>t.videoCodec)).filter(r);return n.length+i.length===0&&i.push("avc1.42e01e"),new Promise(((e,r)=>{const s=t=>{const l=t.shift();this.getMediaKeysPromise(l,n,i).then((t=>e({keySystem:l,mediaKeys:t}))).catch((e=>{t.length?s(t):r(e instanceof qs?e:new qs({type:o.KEY_SYSTEM_ERROR,details:a.KEY_SYSTEM_NO_ACCESS,error:e,fatal:!0},e.message))}))};s(t)}))}requestMediaKeySystemAccess(t,e){const{requestMediaKeySystemAccessFunc:r}=this.config;if("function"!=typeof r){let t=`Configured requestMediaKeySystemAccess is not a function ${r}`;return null===ar&&"http:"===self.location.protocol&&(t=`navigator.requestMediaKeySystemAccess is not available over insecure protocol ${location.protocol}`),Promise.reject(new Error(t))}return r(t,e)}getMediaKeysPromise(t,e,r){var n;const i=function(t,e,r,n){let i;switch(t){case rr.FAIRPLAY:i=["cenc","sinf"];break;case rr.WIDEVINE:case rr.PLAYREADY:i=["cenc"];break;case rr.CLEARKEY:i=["cenc","keyids"];break;default:throw new Error(`Unknown key-system: ${t}`)}return function(t,e,r,n){return[{initDataTypes:t,persistentState:n.persistentState||"optional",distinctiveIdentifier:n.distinctiveIdentifier||"optional",sessionTypes:n.sessionTypes||[n.sessionType||"temporary"],audioCapabilities:e.map((t=>({contentType:`audio/mp4; codecs=${t}`,robustness:n.audioRobustness||"",encryptionScheme:n.audioEncryptionScheme||null}))),videoCapabilities:r.map((t=>({contentType:`video/mp4; codecs=${t}`,robustness:n.videoRobustness||"",encryptionScheme:n.videoEncryptionScheme||null})))}]}(i,e,r,n)}(t,e,r,this.config.drmSystemOptions||{});let s=this.keySystemAccessPromises[t],o=null==(n=s)?void 0:n.keySystemAccess;if(!o){this.log(`Requesting encrypted media "${t}" key-system access with config: ${Yt(i)}`),o=this.requestMediaKeySystemAccess(t,i);const e=s=this.keySystemAccessPromises[t]={keySystemAccess:o};return o.catch((e=>{this.log(`Failed to obtain access to key-system "${t}": ${e}`)})),o.then((r=>{this.log(`Access for key-system "${r.keySystem}" obtained`);const n=this.fetchServerCertificate(t);this.log(`Create media-keys for "${t}"`);const i=e.mediaKeys=r.createMediaKeys().then((r=>(this.log(`Media-keys created for "${t}"`),e.hasMediaKeys=!0,n.then((e=>e?this.setMediaKeysServerCertificate(r,t,e):r)))));return i.catch((e=>{this.error(`Failed to create media-keys for "${t}"}: ${e}`)})),i}))}return o.then((()=>s.mediaKeys))}createMediaKeySessionContext({decryptdata:t,keySystem:e,mediaKeys:r}){this.log(`Creating key-system session "${e}" keyId: ${x(t.keyId||[])}`);const n=r.createSession(),i={decryptdata:t,keySystem:e,mediaKeys:r,mediaKeysSession:n,keyStatus:"status-pending"};return this.mediaKeySessions.push(i),i}renewKeySession(t){const e=t.decryptdata;if(e.pssh){const r=this.createMediaKeySessionContext(t),n=this.getKeyIdString(e),i="cenc";this.keyIdToKeySessionPromise[n]=this.generateRequestWithPreferredKeySession(r,i,e.pssh.buffer,"expired")}else this.warn("Could not renew expired session. Missing pssh initData.");this.removeSession(t)}getKeyIdString(t){if(!t)throw new Error("Could not read keyId of undefined decryptdata");if(null===t.keyId)throw new Error("keyId is null");return x(t.keyId)}updateKeySession(t,e){const r=t.mediaKeysSession;return this.log(`Updating key-session "${r.sessionId}" for keyId ${x(t.decryptdata.keyId||[])}\n      } (data length: ${e.byteLength})`),r.update(e)}getSelectedKeySystemFormats(){return Object.keys(this.keySystemAccessPromises).map((t=>({keySystem:t,hasMediaKeys:this.keySystemAccessPromises[t].hasMediaKeys}))).filter((({hasMediaKeys:t})=>!!t)).map((({keySystem:t})=>sr(t))).filter((t=>!!t))}getKeySystemAccess(t){return this.getKeySystemSelectionPromise(t).then((({keySystem:t,mediaKeys:e})=>this.attemptSetMediaKeys(t,e)))}selectKeySystem(t){return new Promise(((e,r)=>{this.getKeySystemSelectionPromise(t).then((({keySystem:t})=>{const n=sr(t);n?e(n):r(new Error(`Unable to find format for key-system "${t}"`))})).catch(r)}))}selectKeySystemFormat(t){const e=Object.keys(t.levelkeys||{});return this.keyFormatPromise||(this.log(`Selecting key-system from fragment (sn: ${t.sn} ${t.type}: ${t.level}) key formats ${e.join(", ")}`),this.keyFormatPromise=this.getKeyFormatPromise(e)),this.keyFormatPromise}getKeyFormatPromise(t){const e=or(this.config),r=t.map(ir).filter((t=>!!t&&-1!==e.indexOf(t)));return this.selectKeySystem(r)}loadKey(t){const e=t.keyInfo.decryptdata,r=this.getKeyIdString(e),n=this.bannedKeyIds[r];if(n){const r=Ws(n,e);return this.handleError(r,t.frag),Promise.reject(r)}const i=`(keyId: ${r} format: "${e.keyFormat}" method: ${e.method} uri: ${e.uri})`;this.log(`Starting session for key ${i}`);const s=this.keyIdToKeySessionPromise[r];if(!s){const n=this.getKeySystemForKeyPromise(e).then((({keySystem:r,mediaKeys:n})=>(this.throwIfDestroyed(),this.log(`Handle encrypted media sn: ${t.frag.sn} ${t.frag.type}: ${t.frag.level} using key ${i}`),this.attemptSetMediaKeys(r,n).then((()=>(this.throwIfDestroyed(),this.createMediaKeySessionContext({keySystem:r,mediaKeys:n,decryptdata:e}))))))).then((t=>{const r=e.pssh?e.pssh.buffer:null;return this.generateRequestWithPreferredKeySession(t,"cenc",r,"playlist-key")}));return n.catch((e=>this.handleError(e,t.frag))),this.keyIdToKeySessionPromise[r]=n,n}return s}throwIfDestroyed(t="Invalid state"){if(!this.hls)throw new Error("invalid state")}handleError(t,e){this.hls&&(this.error(t.message),t instanceof qs?(e&&(t.data.frag=e),this.hls.trigger(l.ERROR,t.data)):this.hls.trigger(l.ERROR,{type:o.KEY_SYSTEM_ERROR,details:a.KEY_SYSTEM_NO_KEYS,error:t,fatal:!0}))}getKeySystemForKeyPromise(t){const e=this.getKeyIdString(t),r=this.keyIdToKeySessionPromise[e];if(!r){const e=ir(t.keyFormat),r=e?[e]:or(this.config);return this.attemptKeySystemAccess(r)}return r}getKeySystemSelectionPromise(t){if(t.length||(t=or(this.config)),0===t.length)throw new qs({type:o.KEY_SYSTEM_ERROR,details:a.KEY_SYSTEM_NO_CONFIGURED_LICENSE,fatal:!0},`Missing key-system license configuration options ${Yt({drmSystems:this.config.drmSystems})}`);return this.attemptKeySystemAccess(t)}attemptSetMediaKeys(t,e){if(this.mediaKeys===e)return Promise.resolve();const r=this.setMediaKeysQueue.slice();this.log(`Setting media-keys for "${t}"`);const n=Promise.all(r).then((()=>{if(!this.media)throw this.mediaKeys=null,new Error("Attempted to set mediaKeys without media element attached");return this.media.setMediaKeys(e)}));return this.mediaKeys=e,this.setMediaKeysQueue.push(n),n.then((()=>{this.log(`Media-keys set for "${t}"`),r.push(n),this.setMediaKeysQueue=this.setMediaKeysQueue.filter((t=>-1===r.indexOf(t)))}))}generateRequestWithPreferredKeySession(t,e,r,n){var i;const s=null==(i=this.config.drmSystems)||null==(i=i[t.keySystem])?void 0:i.generateRequest;if(s)try{const n=s.call(this.hls,e,r,t);if(!n)throw new Error("Invalid response from configured generateRequest filter");e=n.initDataType,r=n.initData?n.initData:null,t.decryptdata.pssh=r?new Uint8Array(r):null}catch(t){if(this.warn(t.message),this.hls&&this.hls.config.debug)throw t}if(null===r)return this.log(`Skipping key-session request for "${n}" (no initData)`),Promise.resolve(t);const l=this.getKeyIdString(t.decryptdata);this.log(`Generating key-session request for "${n}": ${l} (init data type: ${e} length: ${r.byteLength})`);const c=new rn,u=t._onmessage=e=>{const r=t.mediaKeysSession;if(!r)return void c.emit("error",new Error("invalid state"));const{messageType:n,message:i}=e;this.log(`"${n}" message event for session "${r.sessionId}" message size: ${i.byteLength}`),"license-request"===n||"license-renewal"===n?this.renewLicense(t,i).catch((t=>{c.eventNames().length?c.emit("error",t):this.handleError(t)})):"license-release"===n?t.keySystem===rr.FAIRPLAY&&(this.updateKeySession(t,Ze("acknowledged")),this.removeSession(t)):this.warn(`unhandled media key message type "${n}"`)},h=t._onkeystatuseschange=e=>{if(!t.mediaKeysSession)return void c.emit("error",new Error("invalid state"));const r=t.keyStatus;this.onKeyStatusChange(t);const n=t.keyStatus;n!==r&&(c.emit("keyStatus",n,t),"expired"===n&&(this.log(`${t.keySystem} expired for key ${l}`),this.renewKeySession(t)))};Yr(t.mediaKeysSession,"message",u),Yr(t.mediaKeysSession,"keystatuseschange",h);const d=new Promise(((t,e)=>{c.on("error",e),c.on("keyStatus",((r,{decryptdata:n})=>{r.startsWith("usable")?t():"internal-error"===r||"output-restricted"===r?e(Ws(r,n)):"expired"===r?e(new Error(`key expired while generating request (keyId: ${l})`)):this.warn(`unhandled key status change "${r}" (keyId: ${l})`)}))}));return t.mediaKeysSession.generateRequest(e,r).then((()=>{this.log(`Request generated for key-session "${t.mediaKeysSession.sessionId}" keyId: ${l}`)})).catch((e=>{throw new qs({type:o.KEY_SYSTEM_ERROR,details:a.KEY_SYSTEM_NO_SESSION,error:e,decryptdata:t.decryptdata,fatal:!1},`Error generating key-session request: ${e}`)})).then((()=>d)).catch((e=>{throw c.removeAllListeners(),this.removeSession(t),e})).then((()=>(c.removeAllListeners(),t)))}onKeyStatusChange(t){const e=x(new Uint8Array(t.decryptdata.keyId||[]));t.mediaKeysSession.keyStatuses.forEach(((r,n)=>{if("string"==typeof n&&"object"==typeof r){const t=n;n=r,r=t}const i=x("buffer"in n?new Uint8Array(n.buffer,n.byteOffset,n.byteLength):new Uint8Array(n));"internal-error"===r&&(this.bannedKeyIds[i]=r);const s=i===e;this.log(`${s?"":"un"}matched key status change "${r}" for keyStatuses keyId: ${i} session keyId: ${e} uri: ${t.decryptdata.uri}`),s&&(t.keyStatus=r)}))}fetchServerCertificate(t){const e=this.config,r=new(0,e.loader)(e),n=this.getServerCertificateUrl(t);return n?(this.log(`Fetching server certificate for "${t}"`),new Promise(((i,s)=>{const l={responseType:"arraybuffer",url:n},c=e.certLoadPolicy.default,u={loadPolicy:c,timeout:c.maxLoadTimeMs,maxRetry:0,retryDelay:0,maxRetryDelay:0},h={onSuccess:(t,e,r,n)=>{i(t.data)},onError:(e,r,i,c)=>{s(new qs({type:o.KEY_SYSTEM_ERROR,details:a.KEY_SYSTEM_SERVER_CERTIFICATE_REQUEST_FAILED,fatal:!0,networkDetails:i,response:m({url:l.url,data:void 0},e)},`"${t}" certificate request failed (${n}). Status: ${e.code} (${e.text})`))},onTimeout:(e,r,i)=>{s(new qs({type:o.KEY_SYSTEM_ERROR,details:a.KEY_SYSTEM_SERVER_CERTIFICATE_REQUEST_FAILED,fatal:!0,networkDetails:i,response:{url:l.url,data:void 0}},`"${t}" certificate request timed out (${n})`))},onAbort:(t,e,r)=>{s(new Error("aborted"))}};r.load(l,u,h)}))):Promise.resolve()}setMediaKeysServerCertificate(t,e,r){return new Promise(((n,i)=>{t.setServerCertificate(r).then((i=>{this.log(`setServerCertificate ${i?"success":"not supported by CDM"} (${r.byteLength}) on "${e}"`),n(t)})).catch((t=>{i(new qs({type:o.KEY_SYSTEM_ERROR,details:a.KEY_SYSTEM_SERVER_CERTIFICATE_UPDATE_FAILED,error:t,fatal:!0},t.message))}))}))}renewLicense(t,e){return this.requestLicense(t,new Uint8Array(e)).then((e=>this.updateKeySession(t,new Uint8Array(e)).catch((e=>{throw new qs({type:o.KEY_SYSTEM_ERROR,details:a.KEY_SYSTEM_SESSION_UPDATE_FAILED,decryptdata:t.decryptdata,error:e,fatal:!1},e.message)}))))}unpackPlayReadyKeyMessage(t,e){const r=String.fromCharCode.apply(null,new Uint16Array(e.buffer));if(!r.includes("PlayReadyKeyMessage"))return t.setRequestHeader("Content-Type","text/xml; charset=utf-8"),e;const n=(new DOMParser).parseFromString(r,"application/xml"),i=n.querySelectorAll("HttpHeader");if(i.length>0){let e;for(let r=0,n=i.length;r<n;r++){var s,o;e=i[r];const n=null==(s=e.querySelector("name"))?void 0:s.textContent,a=null==(o=e.querySelector("value"))?void 0:o.textContent;n&&a&&t.setRequestHeader(n,a)}}const a=n.querySelector("Challenge"),l=null==a?void 0:a.textContent;if(!l)throw new Error("Cannot find <Challenge> in key message");return Ze(atob(l))}setupLicenseXHR(t,e,r,n){const i=this.config.licenseXhrSetup;return i?Promise.resolve().then((()=>{if(!r.decryptdata)throw new Error("Key removed");return i.call(this.hls,t,e,r,n)})).catch((s=>{if(!r.decryptdata)throw s;return t.open("POST",e,!0),i.call(this.hls,t,e,r,n)})).then((r=>{t.readyState||t.open("POST",e,!0);return{xhr:t,licenseChallenge:r||n}})):(t.open("POST",e,!0),Promise.resolve({xhr:t,licenseChallenge:n}))}requestLicense(t,e){const r=this.config.keyLoadPolicy.default;return new Promise(((n,i)=>{const s=this.getLicenseServerUrlOrThrow(t.keySystem);this.log(`Sending license request to URL: ${s}`);const l=new XMLHttpRequest;l.responseType="arraybuffer",l.onreadystatechange=()=>{if(!this.hls||!t.mediaKeysSession)return i(new Error("invalid state"));if(4===l.readyState)if(200===l.status){this._requestLicenseFailureCount=0;let e=l.response;this.log(`License received ${e instanceof ArrayBuffer?e.byteLength:e}`);const r=this.config.licenseResponseCallback;if(r)try{e=r.call(this.hls,l,s,t)}catch(t){this.error(t)}n(e)}else{const c=r.errorRetry,u=c?c.maxNumRetry:0;if(this._requestLicenseFailureCount++,this._requestLicenseFailureCount>u||l.status>=400&&l.status<500)i(new qs({type:o.KEY_SYSTEM_ERROR,details:a.KEY_SYSTEM_LICENSE_REQUEST_FAILED,decryptdata:t.decryptdata,fatal:!0,networkDetails:l,response:{url:s,data:void 0,code:l.status,text:l.statusText}},`License Request XHR failed (${s}). Status: ${l.status} (${l.statusText})`));else{const r=u-this._requestLicenseFailureCount+1;this.warn(`Retrying license request, ${r} attempts left`),this.requestLicense(t,e).then(n,i)}}},t.licenseXhr&&t.licenseXhr.readyState!==XMLHttpRequest.DONE&&t.licenseXhr.abort(),t.licenseXhr=l,this.setupLicenseXHR(l,s,t,e).then((({xhr:e,licenseChallenge:r})=>{t.keySystem==rr.PLAYREADY&&(r=this.unpackPlayReadyKeyMessage(e,r)),e.send(r)})).catch(i)}))}onDestroying(){this.unregisterListeners(),this._clear()}onMediaAttached(t,e){if(!this.config.emeEnabled)return;const r=e.media;this.media=r,Yr(r,"encrypted",this.onMediaEncrypted),Yr(r,"waitingforkey",this.onWaitingForKey)}onMediaDetached(){const t=this.media;t&&(qr(t,"encrypted",this.onMediaEncrypted),qr(t,"waitingforkey",this.onWaitingForKey),this.media=null,this.mediaKeys=null)}_clear(){var t;if(this._requestLicenseFailureCount=0,this.keyIdToKeySessionPromise={},this.bannedKeyIds={},!this.mediaKeys&&!this.mediaKeySessions.length)return;const e=this.media,r=this.mediaKeySessions.slice();this.mediaKeySessions=[],this.mediaKeys=null,ur.clearKeyUriToKeyIdMap();const n=r.length;Ys.CDMCleanupPromise=Promise.all(r.map((t=>this.removeSession(t))).concat(null==e||null==(t=e.setMediaKeys(null))?void 0:t.catch((t=>{this.log(`Could not clear media keys: ${t}`),this.hls&&this.hls.trigger(l.ERROR,{type:o.OTHER_ERROR,details:a.KEY_SYSTEM_DESTROY_MEDIA_KEYS_ERROR,fatal:!1,error:new Error(`Could not clear media keys: ${t}`)})})))).catch((t=>{this.log(`Could not close sessions and clear media keys: ${t}`),this.hls&&this.hls.trigger(l.ERROR,{type:o.OTHER_ERROR,details:a.KEY_SYSTEM_DESTROY_CLOSE_SESSION_ERROR,fatal:!1,error:new Error(`Could not close sessions and clear media keys: ${t}`)})})).then((()=>{n&&this.log("finished closing key sessions and clearing media keys")}))}onManifestLoading(){this.keyFormatPromise=null,this.bannedKeyIds={}}onManifestLoaded(t,{sessionKeys:e}){if(e&&this.config.emeEnabled&&!this.keyFormatPromise){const t=e.reduce(((t,e)=>(-1===t.indexOf(e.keyFormat)&&t.push(e.keyFormat),t)),[]);this.log(`Selecting key-system from session-keys ${t.join(", ")}`),this.keyFormatPromise=this.getKeyFormatPromise(t)}}removeSession(t){const{mediaKeysSession:e,licenseXhr:r,decryptdata:n}=t;if(e){this.log(`Remove licenses and keys and close session "${e.sessionId}" keyId: ${x((null==n?void 0:n.keyId)||[])}`),t._onmessage&&(e.removeEventListener("message",t._onmessage),t._onmessage=void 0),t._onkeystatuseschange&&(e.removeEventListener("keystatuseschange",t._onkeystatuseschange),t._onkeystatuseschange=void 0),r&&r.readyState!==XMLHttpRequest.DONE&&r.abort(),t.mediaKeysSession=t.decryptdata=t.licenseXhr=void 0;const i=this.mediaKeySessions.indexOf(t);i>-1&&this.mediaKeySessions.splice(i,1);const{drmSystemOptions:s}=this.config,c=function(t){var e;return!(!t||"persistent-license"!==t.sessionType&&(null==(e=t.sessionTypes)||!e.some((t=>"persistent-license"===t))))}(s)?new Promise(((t,r)=>{self.setTimeout((()=>r(new Error("MediaKeySession.remove() timeout"))),8e3),e.remove().then(t).catch(r)})):Promise.resolve();return c.catch((t=>{this.log(`Could not remove session: ${t}`),this.hls&&this.hls.trigger(l.ERROR,{type:o.OTHER_ERROR,details:a.KEY_SYSTEM_DESTROY_REMOVE_SESSION_ERROR,fatal:!1,error:new Error(`Could not remove session: ${t}`)})})).then((()=>e.close())).catch((t=>{this.log(`Could not close session: ${t}`),this.hls&&this.hls.trigger(l.ERROR,{type:o.OTHER_ERROR,details:a.KEY_SYSTEM_DESTROY_CLOSE_SESSION_ERROR,fatal:!1,error:new Error(`Could not close session: ${t}`)})}))}}}Ys.CDMCleanupPromise=void 0;class qs extends Error{constructor(t,e){super(e),this.data=void 0,t.error||(t.error=new Error(e)),this.data=t,t.err=t.error}}function Ws(t,e){const r="output-restricted"===t,n=r?a.KEY_SYSTEM_STATUS_OUTPUT_RESTRICTED:a.KEY_SYSTEM_STATUS_INTERNAL_ERROR;return new qs({type:o.KEY_SYSTEM_ERROR,details:n,fatal:!1,decryptdata:e},r?"HDCP level output restricted":`key status changed to "${t}"`)}function zs(t,e){let r;try{r=new Event("addtrack")}catch(t){r=document.createEvent("Event"),r.initEvent("addtrack",!1,!1)}r.track=t,e.dispatchEvent(r)}function Xs(t,e){const r=t.mode;if("disabled"===r&&(t.mode="hidden"),t.cues&&!t.cues.getCueById(e.id))try{if(t.addCue(e),!t.cues.getCueById(e.id))throw new Error(`addCue is failed for: ${e}`)}catch(r){T.debug(`[texttrack-utils]: ${r}`);try{const r=new self.TextTrackCue(e.startTime,e.endTime,e.text);r.id=e.id,t.addCue(r)}catch(t){T.debug(`[texttrack-utils]: Legacy TextTrackCue fallback failed: ${t}`)}}"disabled"===r&&(t.mode=r)}function Qs(t,e){const r=t.mode;if("disabled"===r&&(t.mode="hidden"),t.cues)for(let r=t.cues.length;r--;)e&&t.cues[r].removeEventListener("enter",e),t.removeCue(t.cues[r]);"disabled"===r&&(t.mode=r)}function Js(t,e,r,n){const i=t.mode;if("disabled"===i&&(t.mode="hidden"),t.cues&&t.cues.length>0){const i=function(t,e,r){const n=[],i=function(t,e){if(e<=t[0].startTime)return 0;const r=t.length-1;if(e>t[r].endTime)return-1;let n,i=0,s=r;for(;i<=s;)if(n=Math.floor((s+i)/2),e<t[n].startTime)s=n-1;else{if(!(e>t[n].startTime&&i<r))return n;i=n+1}return t[i].startTime-e<e-t[s].startTime?i:s}(t,e);if(i>-1)for(let s=i,o=t.length;s<o;s++){const i=t[s];if(i.startTime>=e&&i.endTime<=r)n.push(i);else if(i.startTime>r)return n}return n}(t.cues,e,r);for(let e=0;e<i.length;e++)n&&!n(i[e])||t.removeCue(i[e])}"disabled"===i&&(t.mode=i)}function Zs(t){const e=[];for(let r=0;r<t.length;r++){const n=t[r];"subtitles"!==n.kind&&"captions"!==n.kind||!n.label||e.push(t[r])}return e}function to(t){let e=5381,r=t.length;for(;r;)e=33*e^t.charCodeAt(--r);return(e>>>0).toString()}const eo=.025;let ro=function(t){return t[t.Point=0]="Point",t[t.Range=1]="Range",t}({});function no(t,e,r){return`${t.identifier}-${r+1}-${to(e)}`}class io{constructor(t,e){this.base=void 0,this._duration=null,this._timelineStart=null,this.appendInPlaceDisabled=void 0,this.appendInPlaceStarted=void 0,this.dateRange=void 0,this.hasPlayed=!1,this.cumulativeDuration=0,this.resumeOffset=NaN,this.playoutLimit=NaN,this.restrictions={skip:!1,jump:!1},this.snapOptions={out:!1,in:!1},this.assetList=[],this.assetListLoader=void 0,this.assetListResponse=null,this.resumeAnchor=void 0,this.error=void 0,this.resetOnResume=void 0,this.base=e,this.dateRange=t,this.setDateRange(t)}setDateRange(t){this.dateRange=t,this.resumeOffset=t.attr.optionalFloat("X-RESUME-OFFSET",this.resumeOffset),this.playoutLimit=t.attr.optionalFloat("X-PLAYOUT-LIMIT",this.playoutLimit),this.restrictions=t.attr.enumeratedStringList("X-RESTRICT",this.restrictions),this.snapOptions=t.attr.enumeratedStringList("X-SNAP",this.snapOptions)}reset(){var t;this.appendInPlaceStarted=!1,null==(t=this.assetListLoader)||t.destroy(),this.assetListLoader=void 0,this.supplementsPrimary||(this.assetListResponse=null,this.assetList=[],this._duration=null)}isAssetPastPlayoutLimit(t){var e;if(t>0&&t>=this.assetList.length)return!0;const r=this.playoutLimit;if(t<=0||isNaN(r))return!1;if(0===r)return!0;return((null==(e=this.assetList[t])?void 0:e.startOffset)||0)>r}findAssetIndex(t){return this.assetList.indexOf(t)}get identifier(){return this.dateRange.id}get startDate(){return this.dateRange.startDate}get startTime(){const t=this.dateRange.startTime;if(this.snapOptions.out){const e=this.dateRange.tagAnchor;if(e)return so(t,e)}return t}get startOffset(){return this.cue.pre?0:this.startTime}get startIsAligned(){if(0===this.startTime||this.snapOptions.out)return!0;const t=this.dateRange.tagAnchor;if(t){const e=this.dateRange.startTime;return e-so(e,t)<.1}return!1}get resumptionOffset(){const t=this.resumeOffset,e=n(t)?t:this.duration;return this.cumulativeDuration+e}get resumeTime(){const t=this.startOffset+this.resumptionOffset;if(this.snapOptions.in){const e=this.resumeAnchor;if(e)return so(t,e)}return t}get appendInPlace(){return!!this.appendInPlaceStarted||!this.appendInPlaceDisabled&&!(this.cue.once||this.cue.pre||!this.startIsAligned||!(isNaN(this.playoutLimit)&&isNaN(this.resumeOffset)||this.resumeOffset&&this.duration&&Math.abs(this.resumeOffset-this.duration)<eo))}set appendInPlace(t){this.appendInPlaceStarted?this.resetOnResume=!t:this.appendInPlaceDisabled=!t}get timelineStart(){return null!==this._timelineStart?this._timelineStart:this.startTime}set timelineStart(t){this._timelineStart=t}get duration(){const t=this.playoutLimit;let e;return e=null!==this._duration?this._duration:this.dateRange.duration?this.dateRange.duration:this.dateRange.plannedDuration||0,!isNaN(t)&&t<e&&(e=t),e}set duration(t){this._duration=t}get cue(){return this.dateRange.cue}get timelineOccupancy(){return"RANGE"===this.dateRange.attr["X-TIMELINE-OCCUPIES"]?ro.Range:ro.Point}get supplementsPrimary(){return"PRIMARY"===this.dateRange.attr["X-TIMELINE-STYLE"]}get contentMayVary(){return"NO"!==this.dateRange.attr["X-CONTENT-MAY-VARY"]}get assetUrl(){return this.dateRange.attr["X-ASSET-URI"]}get assetListUrl(){return this.dateRange.attr["X-ASSET-LIST"]}get baseUrl(){return this.base.url}get assetListLoaded(){return this.assetList.length>0||null!==this.assetListResponse}toString(){return`["${(t=this).identifier}" ${t.cue.pre?"<pre>":t.cue.post?"<post>":""}${t.timelineStart.toFixed(2)}-${t.resumeTime.toFixed(2)}]`;var t}}function so(t,e){return t-e.start<e.duration/2&&!(Math.abs(t-(e.start+e.duration))<eo)?e.start:e.start+e.duration}function oo(t,e,r){const n=new self.URL(t,r);return"data:"!==n.protocol&&n.searchParams.set("_HLS_primary_id",e),n}function ao(t,e){for(;null!=(r=t.assetList[++e])&&r.error;)var r;return e}function lo(t){const e=t.timelineStart,r=t.duration||0;return`["${t.identifier}" ${e.toFixed(2)}-${(e+r).toFixed(2)}]`}class co{constructor(t,e,r,n){this.hls=void 0,this.interstitial=void 0,this.assetItem=void 0,this.tracks=null,this.hasDetails=!1,this.mediaAttached=null,this._currentTime=void 0,this._bufferedEosTime=void 0,this.checkPlayout=()=>{this.reachedPlayout(this.currentTime)&&this.hls&&this.hls.trigger(l.PLAYOUT_LIMIT_REACHED,{})};const i=this.hls=new t(e);this.interstitial=r,this.assetItem=n;const s=()=>{this.hasDetails=!0};i.once(l.LEVEL_LOADED,s),i.once(l.AUDIO_TRACK_LOADED,s),i.once(l.SUBTITLE_TRACK_LOADED,s),i.on(l.MEDIA_ATTACHING,((t,{media:e})=>{this.removeMediaListeners(),this.mediaAttached=e;this.interstitial.playoutLimit&&(e.addEventListener("timeupdate",this.checkPlayout),this.appendInPlace&&i.on(l.BUFFER_APPENDED,(()=>{const t=this.bufferedEnd;this.reachedPlayout(t)&&(this._bufferedEosTime=t,i.trigger(l.BUFFERED_TO_END,void 0))})))}))}get appendInPlace(){return this.interstitial.appendInPlace}loadSource(){const t=this.hls;if(t)if(t.url)t.levels.length&&!t.started&&t.startLoad(-1,!0);else{let e=this.assetItem.uri;try{e=oo(e,t.config.primarySessionId||"").href}catch(t){}t.loadSource(e)}}bufferedInPlaceToEnd(t){var e;if(!this.appendInPlace)return!1;if(null!=(e=this.hls)&&e.bufferedToEnd)return!0;if(!t)return!1;const r=Math.min(this._bufferedEosTime||1/0,this.duration),n=this.timelineOffset,i=Ne.bufferInfo(t,n,0);return this.getAssetTime(i.end)>=r-.02}reachedPlayout(t){const e=this.interstitial.playoutLimit;return this.startOffset+t>=e}get destroyed(){var t;return!(null!=(t=this.hls)&&t.userConfig)}get assetId(){return this.assetItem.identifier}get interstitialId(){return this.assetItem.parentIdentifier}get media(){var t;return(null==(t=this.hls)?void 0:t.media)||null}get bufferedEnd(){const t=this.media||this.mediaAttached;if(!t)return this._bufferedEosTime?this._bufferedEosTime:this.currentTime;const e=Ne.bufferInfo(t,t.currentTime,.001);return this.getAssetTime(e.end)}get currentTime(){const t=this.media||this.mediaAttached;return t?this.getAssetTime(t.currentTime):this._currentTime||0}get duration(){const t=this.assetItem.duration;if(!t)return 0;const e=this.interstitial.playoutLimit;if(e){const r=e-this.startOffset;if(r>0&&r<t)return r}return t}get remaining(){const t=this.duration;return t?Math.max(0,t-this.currentTime):0}get startOffset(){return this.assetItem.startOffset}get timelineOffset(){var t;return(null==(t=this.hls)?void 0:t.config.timelineOffset)||0}set timelineOffset(t){const e=this.timelineOffset;if(t!==e){const r=t-e;if(Math.abs(r)>1/9e4&&this.hls){if(this.hasDetails)throw new Error("Cannot set timelineOffset after playlists are loaded");this.hls.config.timelineOffset=t}}}getAssetTime(t){const e=this.timelineOffset,r=this.duration;return Math.min(Math.max(0,t-e),r)}removeMediaListeners(){const t=this.mediaAttached;t&&(this._currentTime=t.currentTime,this.bufferSnapShot(),t.removeEventListener("timeupdate",this.checkPlayout))}bufferSnapShot(){var t;this.mediaAttached&&(null!=(t=this.hls)&&t.bufferedToEnd&&(this._bufferedEosTime=this.bufferedEnd))}destroy(){this.removeMediaListeners(),this.hls&&this.hls.destroy(),this.hls=null,this.tracks=this.mediaAttached=this.checkPlayout=null}attachMedia(t){var e;this.loadSource(),null==(e=this.hls)||e.attachMedia(t)}detachMedia(){var t;this.removeMediaListeners(),this.mediaAttached=null,null==(t=this.hls)||t.detachMedia()}resumeBuffering(){var t;null==(t=this.hls)||t.resumeBuffering()}pauseBuffering(){var t;null==(t=this.hls)||t.pauseBuffering()}transferMedia(){var t;return this.bufferSnapShot(),(null==(t=this.hls)?void 0:t.transferMedia())||null}resetDetails(){const t=this.hls;if(t&&this.hasDetails){t.stopLoad();const e=t=>delete t.details;t.levels.forEach(e),t.allAudioTracks.forEach(e),t.allSubtitleTracks.forEach(e),this.hasDetails=!1}}on(t,e,r){var n;null==(n=this.hls)||n.on(t,e)}once(t,e,r){var n;null==(n=this.hls)||n.once(t,e)}off(t,e,r){var n;null==(n=this.hls)||n.off(t,e)}toString(){var t;return`HlsAssetPlayer: ${lo(this.assetItem)} ${null==(t=this.hls)?void 0:t.sessionId} ${this.appendInPlace?"append-in-place":""}`}}class uo extends y{constructor(t,e){super("interstitials-sched",e),this.onScheduleUpdate=void 0,this.eventMap={},this.events=null,this.items=null,this.durations={primary:0,playout:0,integrated:0},this.onScheduleUpdate=t}destroy(){this.reset(),this.onScheduleUpdate=null}reset(){this.eventMap={},this.setDurations(0,0,0),this.events&&this.events.forEach((t=>t.reset())),this.events=this.items=null}resetErrorsInRange(t,e){return this.events?this.events.reduce(((r,n)=>t<=n.startOffset&&e>n.startOffset?(delete n.error,r+1):r),0):0}get duration(){const t=this.items;return t?t[t.length-1].end:0}get length(){return this.items?this.items.length:0}getEvent(t){return t&&this.eventMap[t]||null}hasEvent(t){return t in this.eventMap}findItemIndex(t,e){if(t.event)return this.findEventIndex(t.event.identifier);let r=-1;t.nextEvent?r=this.findEventIndex(t.nextEvent.identifier)-1:t.previousEvent&&(r=this.findEventIndex(t.previousEvent.identifier)+1);const n=this.items;if(n)for(n[r]||(void 0===e&&(e=t.start),r=this.findItemIndexAtTime(e));r>=0&&null!=(i=n[r])&&i.event;){var i;r--}return r}findItemIndexAtTime(t,e){const r=this.items;if(r)for(let n=0;n<r.length;n++){let i=r[n];if(e&&"primary"!==e&&(i=i[e]),t===i.start||t>i.start&&t<i.end)return n}return-1}findJumpRestrictedIndex(t,e){const r=this.items;if(r)for(let n=t;n<=e&&r[n];n++){const t=r[n].event;if(null!=t&&t.restrictions.jump&&!t.appendInPlace)return n}return-1}findEventIndex(t){const e=this.items;if(e)for(let n=e.length;n--;){var r;if((null==(r=e[n].event)?void 0:r.identifier)===t)return n}return-1}findAssetIndex(t,e){const r=t.assetList,n=r.length;if(n>1)for(let t=0;t<n;t++){const i=r[t];if(!i.error){const r=i.timelineStart;if(e===r||e>r&&(e<r+(i.duration||0)||t===n-1))return t}}return 0}get assetIdAtEnd(){var t;const e=null==(t=this.items)||null==(t=t[this.length-1])?void 0:t.event;if(e){const t=e.assetList,r=t[t.length-1];if(r)return r.identifier}return null}parseInterstitialDateRanges(t,e){const r=t.main.details,{dateRanges:n}=r,i=this.events,s=this.parseDateRanges(n,{url:r.url},e),o=Object.keys(n),a=i?i.filter((t=>!o.includes(t.identifier))):[];s.length&&s.sort(((t,e)=>{const r=t.cue.pre,n=t.cue.post,i=e.cue.pre,s=e.cue.post;if(r&&!i)return-1;if(i&&!r)return 1;if(n&&!s)return 1;if(s&&!n)return-1;if(!(r||i||n||s)){const r=t.startTime,n=e.startTime;if(r!==n)return r-n}return t.dateRange.tagOrder-e.dateRange.tagOrder})),this.events=s,a.forEach((t=>{this.removeEvent(t)})),this.updateSchedule(t,a)}updateSchedule(t,e=[],r=!1){const n=this.events||[];if(n.length||e.length||this.length<2){const i=this.items,s=this.parseSchedule(n,t);(r||e.length||(null==i?void 0:i.length)!==s.length||s.some(((t,e)=>Math.abs(t.playout.start-i[e].playout.start)>.005||Math.abs(t.playout.end-i[e].playout.end)>.005)))&&(this.items=s,this.onScheduleUpdate(e,i))}}parseDateRanges(t,e,r){const n=[],i=Object.keys(t);for(let s=0;s<i.length;s++){const o=i[s],a=t[o];if(a.isInterstitial){let t=this.eventMap[o];t?t.setDateRange(a):(t=new io(a,e),this.eventMap[o]=t,!1===r&&(t.appendInPlace=r)),n.push(t)}}return n}parseSchedule(t,e){const r=[],n=e.main.details,i=n.live?1/0:n.edge;let s=0;if((t=t.filter((t=>!(t.error||t.cue.once&&t.hasPlayed)))).length){this.resolveOffsets(t,e);let n=0,a=0;if(t.forEach(((e,o)=>{const l=e.cue.pre,c=e.cue.post,u=t[o-1]||null,h=e.appendInPlace,d=c?i:e.startOffset,f=e.duration,p=e.timelineOccupancy===ro.Range?f:0,g=e.resumptionOffset,m=(null==u?void 0:u.startTime)===d,y=d+e.cumulativeDuration;let v=h?y+f:d+g;if(l||!c&&d<=0){const t=a;a+=p,e.timelineStart=y;const n=s;s+=f,r.push({event:e,start:y,end:v,playout:{start:n,end:s},integrated:{start:t,end:a}})}else{if(!(d<=i))return;{if(!m){const i=d-n;if(i>.033){const l=n,c=a;a+=i;const u=s;s+=i;const h={previousEvent:t[o-1]||null,nextEvent:e,start:l,end:l+i,playout:{start:u,end:s},integrated:{start:c,end:a}};r.push(h)}else i>0&&u&&(u.cumulativeDuration+=i,r[r.length-1].end=d)}c&&(v=y),e.timelineStart=y;const i=a;a+=p;const l=s;s+=f,r.push({event:e,start:y,end:v,playout:{start:l,end:s},integrated:{start:i,end:a}})}}const b=e.resumeTime;n=c||b>i?i:b})),n<i){var o;const t=n,e=a,l=i-n;a+=l;const c=s;s+=l,r.push({previousEvent:(null==(o=r[r.length-1])?void 0:o.event)||null,nextEvent:null,start:n,end:t+l,playout:{start:c,end:s},integrated:{start:e,end:a}})}this.setDurations(i,s,a)}else{const t=0;r.push({previousEvent:null,nextEvent:null,start:t,end:i,playout:{start:t,end:i},integrated:{start:t,end:i}}),this.setDurations(i,i,i)}return r}setDurations(t,e,r){this.durations={primary:t,playout:e,integrated:r}}resolveOffsets(t,e){const r=e.main.details,i=r.live?1/0:r.edge;let s=0,o=-1;t.forEach(((a,l)=>{const c=a.cue.pre,u=a.cue.post,h=c?0:u?i:a.startTime;this.updateAssetDurations(a);if(o===h?a.cumulativeDuration=s:(s=0,o=h),!u&&a.snapOptions.in&&(a.resumeAnchor=re(null,r.fragments,a.startOffset+a.resumptionOffset,0,0)||void 0),a.appendInPlace&&!a.appendInPlaceStarted){this.primaryCanResumeInPlaceAt(a,e)||(a.appendInPlace=!1)}if(!a.appendInPlace&&l+1<t.length){t[l+1].startTime-t[l].resumeTime<.033&&(t[l+1].appendInPlace=!1,t[l+1].appendInPlace&&this.warn(`Could not change append strategy for abutting event ${a}`))}const d=n(a.resumeOffset)?a.resumeOffset:a.duration;s+=d}))}primaryCanResumeInPlaceAt(t,e){const r=t.resumeTime,n=t.startTime+t.resumptionOffset;if(Math.abs(r-n)>eo)return this.log(`"${t.identifier}" resumption ${r} not aligned with estimated timeline end ${n}`),!1;return!Object.keys(e).some((n=>{const i=e[n].details,s=i.edge;if(r>=s)return this.log(`"${t.identifier}" resumption ${r} past ${n} playlist end ${s}`),!1;const o=re(null,i.fragments,r);if(!o)return this.log(`"${t.identifier}" resumption ${r} does not align with any fragments in ${n} playlist (${i.fragStart}-${i.fragmentEnd})`),!0;const a="audio"===n?.175:0;return!(Math.abs(o.start-r)<eo+a||Math.abs(o.end-r)<eo+a)&&(this.log(`"${t.identifier}" resumption ${r} not aligned with ${n} fragment bounds (${o.start}-${o.end} sn: ${o.sn} cc: ${o.cc})`),!0)}))}updateAssetDurations(t){if(!t.assetListLoaded)return;const e=t.timelineStart;let r=0,n=!1,i=!1;for(let s=0;s<t.assetList.length;s++){const o=t.assetList[s],a=e+r;o.startOffset=r,o.timelineStart=a,n||(n=null===o.duration),i||(i=!!o.error);r+=o.error?0:o.duration||0}t.duration=n&&!i?Math.max(r,t.duration):r}removeEvent(t){t.reset(),delete this.eventMap[t.identifier]}}function ho(t){return`[${t.event?'"'+t.event.identifier+'"':"primary"}: ${t.start.toFixed(2)}-${t.end.toFixed(2)}]`}class fo{constructor(t){this.hls=void 0,this.hls=t}destroy(){this.hls=null}loadAssetList(t,e){const r=t.assetListUrl;let n;try{n=oo(r,this.hls.sessionId,t.baseUrl)}catch(e){const n=this.assignAssetListError(t,a.ASSET_LIST_LOAD_ERROR,e,r);return void this.hls.trigger(l.ERROR,n)}e&&"data:"!==n.protocol&&n.searchParams.set("_HLS_start_offset",""+e);const i=this.hls.config,s=new(0,i.loader)(i),o={responseType:"json",url:n.href},c=i.interstitialAssetListLoadPolicy.default,u={loadPolicy:c,timeout:c.maxLoadTimeMs,maxRetry:0,retryDelay:0,maxRetryDelay:0},h={onSuccess:(e,r,n,i)=>{const s=e.data,o=null==s?void 0:s.ASSETS;if(Array.isArray(o))t.assetListResponse=s,this.hls.trigger(l.ASSET_LIST_LOADED,{event:t,assetListResponse:s,networkDetails:i});else{const e=this.assignAssetListError(t,a.ASSET_LIST_PARSING_ERROR,new Error("Invalid interstitial asset list"),n.url,r,i);this.hls.trigger(l.ERROR,e)}},onError:(e,r,n,i)=>{const s=this.assignAssetListError(t,a.ASSET_LIST_LOAD_ERROR,new Error(`Error loading X-ASSET-LIST: HTTP status ${e.code} ${e.text} (${r.url})`),r.url,i,n);this.hls.trigger(l.ERROR,s)},onTimeout:(e,r,n)=>{const i=this.assignAssetListError(t,a.ASSET_LIST_LOAD_TIMEOUT,new Error(`Timeout loading X-ASSET-LIST (${r.url})`),r.url,e,n);this.hls.trigger(l.ERROR,i)}};return s.load(o,u,h),this.hls.trigger(l.ASSET_LIST_LOADING,{event:t}),s}assignAssetListError(t,e,r,n,i,s){return t.error=r,{type:o.NETWORK_ERROR,details:e,fatal:!1,interstitial:t,url:n,error:r,networkDetails:s,stats:i}}}function po(t){null==t||t.play().catch((()=>{}))}function go(t,e){return`[${t}] Advancing timeline position to ${e}`}class mo{constructor(t){this.buffered=void 0;const e=(e,r,n)=>{if((r>>>=0)>n-1)throw new DOMException(`Failed to execute '${e}' on 'TimeRanges': The index provided (${r}) is greater than the maximum bound (${n})`);return t[r][e]};this.buffered={get length(){return t.length},end:r=>e("end",r,t.length),start:r=>e("start",r,t.length)}}}const yo={42:225,92:233,94:237,95:243,96:250,123:231,124:247,125:209,126:241,127:9608,128:174,129:176,130:189,131:191,132:8482,133:162,134:163,135:9834,136:224,137:32,138:232,139:226,140:234,141:238,142:244,143:251,144:193,145:201,146:211,147:218,148:220,149:252,150:8216,151:161,152:42,153:8217,154:9473,155:169,156:8480,157:8226,158:8220,159:8221,160:192,161:194,162:199,163:200,164:202,165:203,166:235,167:206,168:207,169:239,170:212,171:217,172:249,173:219,174:171,175:187,176:195,177:227,178:205,179:204,180:236,181:210,182:242,183:213,184:245,185:123,186:125,187:92,188:94,189:95,190:124,191:8764,192:196,193:228,194:214,195:246,196:223,197:165,198:164,199:9475,200:197,201:229,202:216,203:248,204:9487,205:9491,206:9495,207:9499},vo=t=>String.fromCharCode(yo[t]||t),bo=15,Eo=100,Ao={17:1,18:3,21:5,22:7,23:9,16:11,19:12,20:14},wo={17:2,18:4,21:6,22:8,23:10,19:13,20:15},To={25:1,26:3,29:5,30:7,31:9,24:11,27:12,28:14},So={25:2,26:4,29:6,30:8,31:10,27:13,28:15},Lo=["white","green","blue","cyan","red","yellow","magenta","black","transparent"];class _o{constructor(){this.time=null,this.verboseLevel=0}log(t,e){if(this.verboseLevel>=t){const r="function"==typeof e?e():e;T.log(`${this.time} [${t}] ${r}`)}}}const xo=function(t){const e=[];for(let r=0;r<t.length;r++)e.push(t[r].toString(16));return e};class ko{constructor(){this.foreground="white",this.underline=!1,this.italics=!1,this.background="black",this.flash=!1}reset(){this.foreground="white",this.underline=!1,this.italics=!1,this.background="black",this.flash=!1}setStyles(t){const e=["foreground","underline","italics","background","flash"];for(let r=0;r<e.length;r++){const n=e[r];t.hasOwnProperty(n)&&(this[n]=t[n])}}isDefault(){return"white"===this.foreground&&!this.underline&&!this.italics&&"black"===this.background&&!this.flash}equals(t){return this.foreground===t.foreground&&this.underline===t.underline&&this.italics===t.italics&&this.background===t.background&&this.flash===t.flash}copy(t){this.foreground=t.foreground,this.underline=t.underline,this.italics=t.italics,this.background=t.background,this.flash=t.flash}toString(){return"color="+this.foreground+", underline="+this.underline+", italics="+this.italics+", background="+this.background+", flash="+this.flash}}class Po{constructor(){this.uchar=" ",this.penState=new ko}reset(){this.uchar=" ",this.penState.reset()}setChar(t,e){this.uchar=t,this.penState.copy(e)}setPenState(t){this.penState.copy(t)}equals(t){return this.uchar===t.uchar&&this.penState.equals(t.penState)}copy(t){this.uchar=t.uchar,this.penState.copy(t.penState)}isEmpty(){return" "===this.uchar&&this.penState.isDefault()}}class Io{constructor(t){this.chars=[],this.pos=0,this.currPenState=new ko,this.cueStartTime=null,this.logger=void 0;for(let t=0;t<Eo;t++)this.chars.push(new Po);this.logger=t}equals(t){for(let e=0;e<Eo;e++)if(!this.chars[e].equals(t.chars[e]))return!1;return!0}copy(t){for(let e=0;e<Eo;e++)this.chars[e].copy(t.chars[e])}isEmpty(){let t=!0;for(let e=0;e<Eo;e++)if(!this.chars[e].isEmpty()){t=!1;break}return t}setCursor(t){this.pos!==t&&(this.pos=t),this.pos<0?(this.logger.log(3,"Negative cursor position "+this.pos),this.pos=0):this.pos>Eo&&(this.logger.log(3,"Too large cursor position "+this.pos),this.pos=Eo)}moveCursor(t){const e=this.pos+t;if(t>1)for(let t=this.pos+1;t<e+1;t++)this.chars[t].setPenState(this.currPenState);this.setCursor(e)}backSpace(){this.moveCursor(-1),this.chars[this.pos].setChar(" ",this.currPenState)}insertChar(t){t>=144&&this.backSpace();const e=vo(t);this.pos>=Eo?this.logger.log(0,(()=>"Cannot insert "+t.toString(16)+" ("+e+") at position "+this.pos+". Skipping it!")):(this.chars[this.pos].setChar(e,this.currPenState),this.moveCursor(1))}clearFromPos(t){let e;for(e=t;e<Eo;e++)this.chars[e].reset()}clear(){this.clearFromPos(0),this.pos=0,this.currPenState.reset()}clearToEndOfRow(){this.clearFromPos(this.pos)}getTextString(){const t=[];let e=!0;for(let r=0;r<Eo;r++){const n=this.chars[r].uchar;" "!==n&&(e=!1),t.push(n)}return e?"":t.join("")}setPenStyles(t){this.currPenState.setStyles(t);this.chars[this.pos].setPenState(this.currPenState)}}class Ro{constructor(t){this.rows=[],this.currRow=14,this.nrRollUpRows=null,this.lastOutputScreen=null,this.logger=void 0;for(let e=0;e<bo;e++)this.rows.push(new Io(t));this.logger=t}reset(){for(let t=0;t<bo;t++)this.rows[t].clear();this.currRow=14}equals(t){let e=!0;for(let r=0;r<bo;r++)if(!this.rows[r].equals(t.rows[r])){e=!1;break}return e}copy(t){for(let e=0;e<bo;e++)this.rows[e].copy(t.rows[e])}isEmpty(){let t=!0;for(let e=0;e<bo;e++)if(!this.rows[e].isEmpty()){t=!1;break}return t}backSpace(){this.rows[this.currRow].backSpace()}clearToEndOfRow(){this.rows[this.currRow].clearToEndOfRow()}insertChar(t){this.rows[this.currRow].insertChar(t)}setPen(t){this.rows[this.currRow].setPenStyles(t)}moveCursor(t){this.rows[this.currRow].moveCursor(t)}setCursor(t){this.logger.log(2,"setCursor: "+t);this.rows[this.currRow].setCursor(t)}setPAC(t){this.logger.log(2,(()=>"pacData = "+Yt(t)));let e=t.row-1;if(this.nrRollUpRows&&e<this.nrRollUpRows-1&&(e=this.nrRollUpRows-1),this.nrRollUpRows&&this.currRow!==e){for(let t=0;t<bo;t++)this.rows[t].clear();const t=this.currRow+1-this.nrRollUpRows,r=this.lastOutputScreen;if(r){const n=r.rows[t].cueStartTime,i=this.logger.time;if(null!==n&&null!==i&&n<i)for(let n=0;n<this.nrRollUpRows;n++)this.rows[e-this.nrRollUpRows+n+1].copy(r.rows[t+n])}}this.currRow=e;const r=this.rows[this.currRow];if(null!==t.indent){const e=t.indent,n=Math.max(e-1,0);r.setCursor(t.indent),t.color=r.chars[n].penState.foreground}const n={foreground:t.color,underline:t.underline,italics:t.italics,background:"black",flash:!1};this.setPen(n)}setBkgData(t){this.logger.log(2,(()=>"bkgData = "+Yt(t))),this.backSpace(),this.setPen(t),this.insertChar(32)}setRollUpRows(t){this.nrRollUpRows=t}rollUp(){if(null===this.nrRollUpRows)return void this.logger.log(3,"roll_up but nrRollUpRows not set yet");this.logger.log(1,(()=>this.getDisplayText()));const t=this.currRow+1-this.nrRollUpRows,e=this.rows.splice(t,1)[0];e.clear(),this.rows.splice(this.currRow,0,e),this.logger.log(2,"Rolling up")}getDisplayText(t){t=t||!1;const e=[];let r="",n=-1;for(let r=0;r<bo;r++){const i=this.rows[r].getTextString();i&&(n=r+1,t?e.push("Row "+n+": '"+i+"'"):e.push(i.trim()))}return e.length>0&&(r=t?"["+e.join(" | ")+"]":e.join("\n")),r}getTextAndFormat(){return this.rows}}class Oo{constructor(t,e,r){this.chNr=void 0,this.outputFilter=void 0,this.mode=void 0,this.verbose=void 0,this.displayedMemory=void 0,this.nonDisplayedMemory=void 0,this.lastOutputScreen=void 0,this.currRollUpRow=void 0,this.writeScreen=void 0,this.cueStartTime=void 0,this.logger=void 0,this.chNr=t,this.outputFilter=e,this.mode=null,this.verbose=0,this.displayedMemory=new Ro(r),this.nonDisplayedMemory=new Ro(r),this.lastOutputScreen=new Ro(r),this.currRollUpRow=this.displayedMemory.rows[14],this.writeScreen=this.displayedMemory,this.mode=null,this.cueStartTime=null,this.logger=r}reset(){this.mode=null,this.displayedMemory.reset(),this.nonDisplayedMemory.reset(),this.lastOutputScreen.reset(),this.outputFilter.reset(),this.currRollUpRow=this.displayedMemory.rows[14],this.writeScreen=this.displayedMemory,this.mode=null,this.cueStartTime=null}getHandler(){return this.outputFilter}setHandler(t){this.outputFilter=t}setPAC(t){this.writeScreen.setPAC(t)}setBkgData(t){this.writeScreen.setBkgData(t)}setMode(t){t!==this.mode&&(this.mode=t,this.logger.log(2,(()=>"MODE="+t)),"MODE_POP-ON"===this.mode?this.writeScreen=this.nonDisplayedMemory:(this.writeScreen=this.displayedMemory,this.writeScreen.reset()),"MODE_ROLL-UP"!==this.mode&&(this.displayedMemory.nrRollUpRows=null,this.nonDisplayedMemory.nrRollUpRows=null),this.mode=t)}insertChars(t){for(let e=0;e<t.length;e++)this.writeScreen.insertChar(t[e]);const e=this.writeScreen===this.displayedMemory?"DISP":"NON_DISP";this.logger.log(2,(()=>e+": "+this.writeScreen.getDisplayText(!0))),"MODE_PAINT-ON"!==this.mode&&"MODE_ROLL-UP"!==this.mode||(this.logger.log(1,(()=>"DISPLAYED: "+this.displayedMemory.getDisplayText(!0))),this.outputDataUpdate())}ccRCL(){this.logger.log(2,"RCL - Resume Caption Loading"),this.setMode("MODE_POP-ON")}ccBS(){this.logger.log(2,"BS - BackSpace"),"MODE_TEXT"!==this.mode&&(this.writeScreen.backSpace(),this.writeScreen===this.displayedMemory&&this.outputDataUpdate())}ccAOF(){}ccAON(){}ccDER(){this.logger.log(2,"DER- Delete to End of Row"),this.writeScreen.clearToEndOfRow(),this.outputDataUpdate()}ccRU(t){this.logger.log(2,"RU("+t+") - Roll Up"),this.writeScreen=this.displayedMemory,this.setMode("MODE_ROLL-UP"),this.writeScreen.setRollUpRows(t)}ccFON(){this.logger.log(2,"FON - Flash On"),this.writeScreen.setPen({flash:!0})}ccRDC(){this.logger.log(2,"RDC - Resume Direct Captioning"),this.setMode("MODE_PAINT-ON")}ccTR(){this.logger.log(2,"TR"),this.setMode("MODE_TEXT")}ccRTD(){this.logger.log(2,"RTD"),this.setMode("MODE_TEXT")}ccEDM(){this.logger.log(2,"EDM - Erase Displayed Memory"),this.displayedMemory.reset(),this.outputDataUpdate(!0)}ccCR(){this.logger.log(2,"CR - Carriage Return"),this.writeScreen.rollUp(),this.outputDataUpdate(!0)}ccENM(){this.logger.log(2,"ENM - Erase Non-displayed Memory"),this.nonDisplayedMemory.reset()}ccEOC(){if(this.logger.log(2,"EOC - End Of Caption"),"MODE_POP-ON"===this.mode){const t=this.displayedMemory;this.displayedMemory=this.nonDisplayedMemory,this.nonDisplayedMemory=t,this.writeScreen=this.nonDisplayedMemory,this.logger.log(1,(()=>"DISP: "+this.displayedMemory.getDisplayText()))}this.outputDataUpdate(!0)}ccTO(t){this.logger.log(2,"TO("+t+") - Tab Offset"),this.writeScreen.moveCursor(t)}ccMIDROW(t){const e={flash:!1};if(e.underline=t%2==1,e.italics=t>=46,e.italics)e.foreground="white";else{const r=Math.floor(t/2)-16,n=["white","green","blue","cyan","red","yellow","magenta"];e.foreground=n[r]}this.logger.log(2,"MIDROW: "+Yt(e)),this.writeScreen.setPen(e)}outputDataUpdate(t=!1){const e=this.logger.time;null!==e&&this.outputFilter&&(null!==this.cueStartTime||this.displayedMemory.isEmpty()?this.displayedMemory.equals(this.lastOutputScreen)||(this.outputFilter.newCue(this.cueStartTime,e,this.lastOutputScreen),t&&this.outputFilter.dispatchCue&&this.outputFilter.dispatchCue(),this.cueStartTime=this.displayedMemory.isEmpty()?null:e):this.cueStartTime=e,this.lastOutputScreen.copy(this.displayedMemory))}cueSplitAtTime(t){this.outputFilter&&(this.displayedMemory.isEmpty()||(this.outputFilter.newCue&&this.outputFilter.newCue(this.cueStartTime,t,this.displayedMemory),this.cueStartTime=t))}}class Do{constructor(t,e,r){this.channels=void 0,this.currentChannel=0,this.cmdHistory={a:null,b:null},this.logger=void 0;const n=this.logger=new _o;this.channels=[null,new Oo(t,e,n),new Oo(t+1,r,n)]}getHandler(t){return this.channels[t].getHandler()}setHandler(t,e){this.channels[t].setHandler(e)}addData(t,e){this.logger.time=t;for(let t=0;t<e.length;t+=2){const r=127&e[t],n=127&e[t+1];let i=!1,s=null;if(0===r&&0===n)continue;this.logger.log(3,(()=>"["+xo([e[t],e[t+1]])+"] -> ("+xo([r,n])+")"));const o=this.cmdHistory;if(r>=16&&r<=31){if(Mo(r,n,o)){Co(null,null,o),this.logger.log(3,(()=>"Repeated command ("+xo([r,n])+") is dropped"));continue}Co(r,n,this.cmdHistory),i=this.parseCmd(r,n),i||(i=this.parseMidrow(r,n)),i||(i=this.parsePAC(r,n)),i||(i=this.parseBackgroundAttributes(r,n))}else Co(null,null,o);if(!i&&(s=this.parseChars(r,n),s)){const t=this.currentChannel;if(t&&t>0){this.channels[t].insertChars(s)}else this.logger.log(2,"No channel found yet. TEXT-MODE?")}i||s||this.logger.log(2,(()=>"Couldn't parse cleaned data "+xo([r,n])+" orig: "+xo([e[t],e[t+1]])))}}parseCmd(t,e){if(!((20===t||28===t||21===t||29===t)&&e>=32&&e<=47)&&!((23===t||31===t)&&e>=33&&e<=35))return!1;const r=20===t||21===t||23===t?1:2,n=this.channels[r];return 20===t||21===t||28===t||29===t?32===e?n.ccRCL():33===e?n.ccBS():34===e?n.ccAOF():35===e?n.ccAON():36===e?n.ccDER():37===e?n.ccRU(2):38===e?n.ccRU(3):39===e?n.ccRU(4):40===e?n.ccFON():41===e?n.ccRDC():42===e?n.ccTR():43===e?n.ccRTD():44===e?n.ccEDM():45===e?n.ccCR():46===e?n.ccENM():47===e&&n.ccEOC():n.ccTO(e-32),this.currentChannel=r,!0}parseMidrow(t,e){let r=0;if((17===t||25===t)&&e>=32&&e<=47){if(r=17===t?1:2,r!==this.currentChannel)return this.logger.log(0,"Mismatch channel in midrow parsing"),!1;const n=this.channels[r];return!!n&&(n.ccMIDROW(e),this.logger.log(3,(()=>"MIDROW ("+xo([t,e])+")")),!0)}return!1}parsePAC(t,e){let r;if(!((t>=17&&t<=23||t>=25&&t<=31)&&e>=64&&e<=127)&&!((16===t||24===t)&&e>=64&&e<=95))return!1;const n=t<=23?1:2;r=e>=64&&e<=95?1===n?Ao[t]:To[t]:1===n?wo[t]:So[t];const i=this.channels[n];return!!i&&(i.setPAC(this.interpretPAC(r,e)),this.currentChannel=n,!0)}interpretPAC(t,e){let r;const n={color:null,italics:!1,indent:null,underline:!1,row:t};return r=e>95?e-96:e-64,n.underline=1==(1&r),r<=13?n.color=["white","green","blue","cyan","red","yellow","magenta","white"][Math.floor(r/2)]:r<=15?(n.italics=!0,n.color="white"):n.indent=4*Math.floor((r-16)/2),n}parseChars(t,e){let r,n=null,i=null;if(t>=25?(r=2,i=t-8):(r=1,i=t),i>=17&&i<=19){let t;t=17===i?e+80:18===i?e+112:e+144,this.logger.log(2,(()=>"Special char '"+vo(t)+"' in channel "+r)),n=[t]}else t>=32&&t<=127&&(n=0===e?[t]:[t,e]);return n&&this.logger.log(3,(()=>"Char codes =  "+xo(n).join(","))),n}parseBackgroundAttributes(t,e){if(!((16===t||24===t)&&e>=32&&e<=47)&&!((23===t||31===t)&&e>=45&&e<=47))return!1;let r;const n={};16===t||24===t?(r=Math.floor((e-32)/2),n.background=Lo[r],e%2==1&&(n.background=n.background+"_semi")):45===e?n.background="transparent":(n.foreground="black",47===e&&(n.underline=!0));const i=t<=23?1:2;return this.channels[i].setBkgData(n),!0}reset(){for(let t=0;t<Object.keys(this.channels).length;t++){const e=this.channels[t];e&&e.reset()}Co(null,null,this.cmdHistory)}cueSplitAtTime(t){for(let e=0;e<this.channels.length;e++){const r=this.channels[e];r&&r.cueSplitAtTime(t)}}}function Co(t,e,r){r.a=t,r.b=e}function Mo(t,e,r){return r.a===t&&r.b===e}var No=function(){if(null!=er&&er.VTTCue)return self.VTTCue;const t=["","lr","rl"],e=["start","middle","end","left","right"];function r(t,e){if("string"!=typeof e)return!1;if(!Array.isArray(t))return!1;const r=e.toLowerCase();return!!~t.indexOf(r)&&r}function n(t){return r(e,t)}function i(t,...e){let r=1;for(;r<arguments.length;r++){const e=arguments[r];for(const r in e)t[r]=e[r]}return t}function s(e,s,o){const a=this,l={enumerable:!0};a.hasBeenReset=!1;let c="",u=!1,h=e,d=s,f=o,p=null,g="",m=!0,y="auto",v="start",b=50,E="middle",A=50,w="middle";Object.defineProperty(a,"id",i({},l,{get:function(){return c},set:function(t){c=""+t}})),Object.defineProperty(a,"pauseOnExit",i({},l,{get:function(){return u},set:function(t){u=!!t}})),Object.defineProperty(a,"startTime",i({},l,{get:function(){return h},set:function(t){if("number"!=typeof t)throw new TypeError("Start time must be set to a number.");h=t,this.hasBeenReset=!0}})),Object.defineProperty(a,"endTime",i({},l,{get:function(){return d},set:function(t){if("number"!=typeof t)throw new TypeError("End time must be set to a number.");d=t,this.hasBeenReset=!0}})),Object.defineProperty(a,"text",i({},l,{get:function(){return f},set:function(t){f=""+t,this.hasBeenReset=!0}})),Object.defineProperty(a,"region",i({},l,{get:function(){return p},set:function(t){p=t,this.hasBeenReset=!0}})),Object.defineProperty(a,"vertical",i({},l,{get:function(){return g},set:function(e){const n=function(e){return r(t,e)}(e);if(!1===n)throw new SyntaxError("An invalid or illegal string was specified.");g=n,this.hasBeenReset=!0}})),Object.defineProperty(a,"snapToLines",i({},l,{get:function(){return m},set:function(t){m=!!t,this.hasBeenReset=!0}})),Object.defineProperty(a,"line",i({},l,{get:function(){return y},set:function(t){if("number"!=typeof t&&"auto"!==t)throw new SyntaxError("An invalid number or illegal string was specified.");y=t,this.hasBeenReset=!0}})),Object.defineProperty(a,"lineAlign",i({},l,{get:function(){return v},set:function(t){const e=n(t);if(!e)throw new SyntaxError("An invalid or illegal string was specified.");v=e,this.hasBeenReset=!0}})),Object.defineProperty(a,"position",i({},l,{get:function(){return b},set:function(t){if(t<0||t>100)throw new Error("Position must be between 0 and 100.");b=t,this.hasBeenReset=!0}})),Object.defineProperty(a,"positionAlign",i({},l,{get:function(){return E},set:function(t){const e=n(t);if(!e)throw new SyntaxError("An invalid or illegal string was specified.");E=e,this.hasBeenReset=!0}})),Object.defineProperty(a,"size",i({},l,{get:function(){return A},set:function(t){if(t<0||t>100)throw new Error("Size must be between 0 and 100.");A=t,this.hasBeenReset=!0}})),Object.defineProperty(a,"align",i({},l,{get:function(){return w},set:function(t){const e=n(t);if(!e)throw new SyntaxError("An invalid or illegal string was specified.");w=e,this.hasBeenReset=!0}})),a.displayState=void 0}return s.prototype.getCueAsHTML=function(){return self.WebVTT.convertCueToDOMTree(self,this.text)},s}();class Fo{decode(t,e){if(!t)return"";if("string"!=typeof t)throw new Error("Error - expected string data.");return decodeURIComponent(encodeURIComponent(t))}}function Uo(t){function e(t,e,r,n){return 3600*(0|t)+60*(0|e)+(0|r)+parseFloat(n||0)}const r=t.match(/^(?:(\d+):)?(\d{2}):(\d{2})(\.\d+)?/);return r?parseFloat(r[2])>59?e(r[2],r[3],0,r[4]):e(r[1],r[2],r[3],r[4]):null}class Bo{constructor(){this.values=Object.create(null)}set(t,e){this.get(t)||""===e||(this.values[t]=e)}get(t,e,r){return r?this.has(t)?this.values[t]:e[r]:this.has(t)?this.values[t]:e}has(t){return t in this.values}alt(t,e,r){for(let n=0;n<r.length;++n)if(e===r[n]){this.set(t,e);break}}integer(t,e){/^-?\d+$/.test(e)&&this.set(t,parseInt(e,10))}percent(t,e){if(/^([\d]{1,3})(\.[\d]*)?%$/.test(e)){const r=parseFloat(e);if(r>=0&&r<=100)return this.set(t,r),!0}return!1}}function $o(t,e,r,n){const i=n?t.split(n):[t];for(const t in i){if("string"!=typeof i[t])continue;const n=i[t].split(r);if(2!==n.length)continue;e(n[0],n[1])}}const jo=new No(0,0,""),Go="middle"===jo.align?"middle":"center";function Ho(t,e,r){const n=t;function i(){const e=Uo(t);if(null===e)throw new Error("Malformed timestamp: "+n);return t=t.replace(/^[^\sa-zA-Z-]+/,""),e}function s(){t=t.replace(/^\s+/,"")}if(s(),e.startTime=i(),s(),"--\x3e"!==t.slice(0,3))throw new Error("Malformed time stamp (time stamps must be separated by '--\x3e'): "+n);t=t.slice(3),s(),e.endTime=i(),s(),function(t,e){const n=new Bo;$o(t,(function(t,e){let i;switch(t){case"region":for(let i=r.length-1;i>=0;i--)if(r[i].id===e){n.set(t,r[i].region);break}break;case"vertical":n.alt(t,e,["rl","lr"]);break;case"line":i=e.split(","),n.integer(t,i[0]),n.percent(t,i[0])&&n.set("snapToLines",!1),n.alt(t,i[0],["auto"]),2===i.length&&n.alt("lineAlign",i[1],["start",Go,"end"]);break;case"position":i=e.split(","),n.percent(t,i[0]),2===i.length&&n.alt("positionAlign",i[1],["start",Go,"end","line-left","line-right","auto"]);break;case"size":n.percent(t,e);break;case"align":n.alt(t,e,["start",Go,"end","left","right"])}}),/:/,/\s/),e.region=n.get("region",null),e.vertical=n.get("vertical","");let i=n.get("line","auto");"auto"===i&&-1===jo.line&&(i=-1),e.line=i,e.lineAlign=n.get("lineAlign","start"),e.snapToLines=n.get("snapToLines",!0),e.size=n.get("size",100),e.align=n.get("align",Go);let s=n.get("position","auto");"auto"===s&&50===jo.position&&(s="start"===e.align||"left"===e.align?0:"end"===e.align||"right"===e.align?100:50),e.position=s}(t,e)}function Vo(t){return t.replace(/<br(?: \/)?>/gi,"\n")}class Ko{constructor(){this.state="INITIAL",this.buffer="",this.decoder=new Fo,this.regionList=[],this.cue=null,this.oncue=void 0,this.onparsingerror=void 0,this.onflush=void 0}parse(t){const e=this;function r(){let t=e.buffer,r=0;for(t=Vo(t);r<t.length&&"\r"!==t[r]&&"\n"!==t[r];)++r;const n=t.slice(0,r);return"\r"===t[r]&&++r,"\n"===t[r]&&++r,e.buffer=t.slice(r),n}t&&(e.buffer+=e.decoder.decode(t,{stream:!0}));try{let t="";if("INITIAL"===e.state){if(!/\r\n|\n/.test(e.buffer))return this;t=r();const n=t.match(/^()?WEBVTT([ \t].*)?$/);if(null==n||!n[0])throw new Error("Malformed WebVTT signature.");e.state="HEADER"}let n=!1;for(;e.buffer;){if(!/\r\n|\n/.test(e.buffer))return this;switch(n?n=!1:t=r(),e.state){case"HEADER":/:/.test(t)?$o(t,(function(t,e){}),/:/):t||(e.state="ID");continue;case"NOTE":t||(e.state="ID");continue;case"ID":if(/^NOTE($|[ \t])/.test(t)){e.state="NOTE";break}if(!t)continue;if(e.cue=new No(0,0,""),e.state="CUE",-1===t.indexOf("--\x3e")){e.cue.id=t;continue}case"CUE":if(!e.cue){e.state="BADCUE";continue}try{Ho(t,e.cue,e.regionList)}catch(t){e.cue=null,e.state="BADCUE";continue}e.state="CUETEXT";continue;case"CUETEXT":{const r=-1!==t.indexOf("--\x3e");if(!t||r&&(n=!0)){e.oncue&&e.cue&&e.oncue(e.cue),e.cue=null,e.state="ID";continue}if(null===e.cue)continue;e.cue.text&&(e.cue.text+="\n"),e.cue.text+=t}continue;case"BADCUE":t||(e.state="ID")}}}catch(t){"CUETEXT"===e.state&&e.cue&&e.oncue&&e.oncue(e.cue),e.cue=null,e.state="INITIAL"===e.state?"BADWEBVTT":"BADCUE"}return this}flush(){const t=this;try{if((t.cue||"HEADER"===t.state)&&(t.buffer+="\n\n",t.parse()),"INITIAL"===t.state||"BADWEBVTT"===t.state)throw new Error("Malformed WebVTT signature.")}catch(e){t.onparsingerror&&t.onparsingerror(e)}return t.onflush&&t.onflush(),this}}const Yo=/\r\n|\n\r|\n|\r/g,qo=function(t,e,r=0){return t.slice(r,r+e.length)===e},Wo=function(t){let e=parseInt(t.slice(-3));const r=parseInt(t.slice(-6,-4)),i=parseInt(t.slice(-9,-7)),s=t.length>9?parseInt(t.substring(0,t.indexOf(":"))):0;if(!(n(e)&&n(r)&&n(i)&&n(s)))throw Error(`Malformed X-TIMESTAMP-MAP: Local:${t}`);return e+=1e3*r,e+=6e4*i,e+=36e5*s,e};function zo(t,e,r){return to(t.toString())+to(e.toString())+to(r)}const Xo=function(t,e,r){let n=t[e],i=t[n.prevCC];if(!i||!i.new&&n.new)return t.ccOffset=t.presentationOffset=n.start,void(n.new=!1);for(;null!=(s=i)&&s.new;){var s;t.ccOffset+=n.start-i.start,n.new=!1,n=i,i=t[n.prevCC]}t.presentationOffset=r};function Qo(t,e,r,n,i,s,o){const a=new Ko,l=_(new Uint8Array(t)).trim().replace(Yo,"\n").split("\n"),c=[],u=e?function(t,e=1){return hi(t,ui,1/e)}(e.baseTime,e.timescale):0;let h,d="00:00.000",f=0,p=0,g=!0;a.oncue=function(t){const s=r[n];let o=r.ccOffset;const a=(f-u)/9e4;if(null!=s&&s.new&&(void 0!==p?o=r.ccOffset=s.start:Xo(r,n,a)),a){if(!e)return void(h=new Error("Missing initPTS for VTT MPEGTS"));o=a-r.presentationOffset}const l=t.endTime-t.startTime,d=vi(9e4*(t.startTime+o-p),9e4*i)/9e4;t.startTime=Math.max(d,0),t.endTime=Math.max(d+l,0);const g=t.text.trim();t.text=decodeURIComponent(encodeURIComponent(g)),t.id||(t.id=zo(t.startTime,t.endTime,g)),t.endTime>0&&c.push(t)},a.onparsingerror=function(t){h=t},a.onflush=function(){h?o(h):s(c)},l.forEach((t=>{if(g){if(qo(t,"X-TIMESTAMP-MAP=")){g=!1,t.slice(16).split(",").forEach((t=>{qo(t,"LOCAL:")?d=t.slice(6):qo(t,"MPEGTS:")&&(f=parseInt(t.slice(7)))}));try{p=Wo(d)/1e3}catch(t){h=t}return}""===t&&(g=!1)}a.parse(t+"\n")})),a.flush()}const Jo="stpp.ttml.im1t",Zo=/^(\d{2,}):(\d{2}):(\d{2}):(\d{2})\.?(\d+)?$/,ta=/^(\d*(?:\.\d*)?)(h|m|s|ms|f|t)$/,ea={left:"start",center:"center",right:"end",start:"start",end:"end"};function ra(t,e,r,n){const i=Z(new Uint8Array(t),["mdat"]);if(0===i.length)return void n(new Error("Could not parse IMSC1 mdat"));const s=i.map((t=>_(t))),o=function(t,e,r=1,n=!1){return hi(t,e,1/r,n)}(e.baseTime,1,e.timescale);try{s.forEach((t=>r(function(t,e){const r=(new DOMParser).parseFromString(t,"text/xml"),n=r.getElementsByTagName("tt")[0];if(!n)throw new Error("Invalid ttml");const i={frameRate:30,subFrameRate:1,frameRateMultiplier:0,tickRate:0},s=Object.keys(i).reduce(((t,e)=>(t[e]=n.getAttribute(`ttp:${e}`)||i[e],t)),{}),o="preserve"!==n.getAttribute("xml:space"),a=ia(na(n,"styling","style")),l=ia(na(n,"layout","region")),c=na(n,"body","[begin]");return[].map.call(c,(t=>{const r=sa(t,o);if(!r||!t.hasAttribute("begin"))return null;const n=la(t.getAttribute("begin"),s),i=la(t.getAttribute("dur"),s);let c=la(t.getAttribute("end"),s);if(null===n)throw aa(t);if(null===c){if(null===i)throw aa(t);c=n+i}const u=new No(n-e,c-e,r);u.id=zo(u.startTime,u.endTime,u.text);const h=function(t,e,r){const n="http://www.w3.org/ns/ttml#styling";let i=null;const s=["displayAlign","textAlign","color","backgroundColor","fontSize","fontFamily"],o=null!=t&&t.hasAttribute("style")?t.getAttribute("style"):null;o&&r.hasOwnProperty(o)&&(i=r[o]);return s.reduce(((r,s)=>{const o=oa(e,n,s)||oa(t,n,s)||oa(i,n,s);return o&&(r[s]=o),r}),{})}(l[t.getAttribute("region")],a[t.getAttribute("style")],a),{textAlign:d}=h;if(d){const t=ea[d];t&&(u.lineAlign=t),u.align=d}return p(u,h),u})).filter((t=>null!==t))}(t,o))))}catch(t){n(t)}}function na(t,e,r){const n=t.getElementsByTagName(e)[0];return n?[].slice.call(n.querySelectorAll(r)):[]}function ia(t){return t.reduce(((t,e)=>{const r=e.getAttribute("xml:id");return r&&(t[r]=e),t}),{})}function sa(t,e){return[].slice.call(t.childNodes).reduce(((t,r,n)=>{var i;return"br"===r.nodeName&&n?t+"\n":null!=(i=r.childNodes)&&i.length?sa(r,e):e?t+r.textContent.trim().replace(/\s+/g," "):t+r.textContent}),"")}function oa(t,e,r){return t&&t.hasAttributeNS(e,r)?t.getAttributeNS(e,r):null}function aa(t){return new Error(`Could not parse ttml timestamp ${t}`)}function la(t,e){if(!t)return null;let r=Uo(t);return null===r&&(Zo.test(t)?r=function(t,e){const r=Zo.exec(t),n=(0|r[4])+(0|r[5])/e.subFrameRate;return 3600*(0|r[1])+60*(0|r[2])+(0|r[3])+n/e.frameRate}(t,e):ta.test(t)&&(r=function(t,e){const r=ta.exec(t),n=Number(r[1]);switch(r[2]){case"h":return 3600*n;case"m":return 60*n;case"ms":return 1e3*n;case"f":return n/e.frameRate;case"t":return n/e.tickRate}return n}(t,e))),r}class ca{constructor(t,e){this.timelineController=void 0,this.cueRanges=[],this.trackName=void 0,this.startTime=null,this.endTime=null,this.screen=null,this.timelineController=t,this.trackName=e}dispatchCue(){null!==this.startTime&&(this.timelineController.addCues(this.trackName,this.startTime,this.endTime,this.screen,this.cueRanges),this.startTime=null)}newCue(t,e,r){(null===this.startTime||this.startTime>t)&&(this.startTime=t),this.endTime=e,this.screen=r,this.timelineController.createCaptionsTrack(this.trackName)}reset(){this.cueRanges=[],this.startTime=null}}function ua(t){return t.characteristics&&/transcribes-spoken-dialog/gi.test(t.characteristics)&&/describes-music-and-sound/gi.test(t.characteristics)?"captions":"subtitles"}function ha(t,e){return!!t&&t.kind===ua(e)&&Ci(e,t)}const da=/\s/,fa={newCue(t,e,r,n){const i=[];let s,o,a,l,c;const u=self.VTTCue||self.TextTrackCue;for(let d=0;d<n.rows.length;d++)if(s=n.rows[d],a=!0,l=0,c="",!s.isEmpty()){var h;for(let t=0;t<s.chars.length;t++)da.test(s.chars[t].uchar)&&a?l++:(c+=s.chars[t].uchar,a=!1);s.cueStartTime=e,e===r&&(r+=1e-4),l>=16?l--:l++;const n=Vo(c.trim()),f=zo(e,r,n);null!=t&&null!=(h=t.cues)&&h.getCueById(f)||(o=new u(e,r,n),o.id=f,o.line=d+1,o.align="left",o.position=10+Math.min(80,10*Math.floor(8*l/32)),i.push(o))}return t&&i.length&&(i.sort(((t,e)=>"auto"===t.line||"auto"===e.line?0:t.line>8&&e.line>8?e.line-t.line:t.line-e.line)),i.forEach((e=>Xs(t,e)))),i}};const pa=/(\d+)-(\d+)\/(\d+)/;class ga{constructor(t){this.fetchSetup=void 0,this.requestTimeout=void 0,this.request=null,this.response=null,this.controller=void 0,this.context=null,this.config=null,this.callbacks=null,this.stats=void 0,this.loader=null,this.fetchSetup=t.fetchSetup||ma,this.controller=new self.AbortController,this.stats=new U}destroy(){this.loader=this.callbacks=this.context=this.config=this.request=null,this.abortInternal(),this.response=null,this.fetchSetup=this.controller=this.stats=null}abortInternal(){this.controller&&!this.stats.loading.end&&(this.stats.aborted=!0,this.controller.abort())}abort(){var t;this.abortInternal(),null!=(t=this.callbacks)&&t.onAbort&&this.callbacks.onAbort(this.stats,this.context,this.response)}load(t,e,r){const i=this.stats;if(i.loading.start)throw new Error("Loader can only be used once.");i.loading.start=self.performance.now();const s=function(t,e){const r={method:"GET",mode:"cors",credentials:"same-origin",signal:e,headers:new self.Headers(p({},t.headers))};t.rangeEnd&&r.headers.set("Range","bytes="+t.rangeStart+"-"+String(t.rangeEnd-1));return r}(t,this.controller.signal),o="arraybuffer"===t.responseType,a=o?"byteLength":"length",{maxTimeToFirstByteMs:l,maxLoadTimeMs:c}=e.loadPolicy;this.context=t,this.config=e,this.callbacks=r,this.request=this.fetchSetup(t,s),self.clearTimeout(this.requestTimeout),e.timeout=l&&n(l)?l:c,this.requestTimeout=self.setTimeout((()=>{this.callbacks&&(this.abortInternal(),this.callbacks.onTimeout(i,t,this.response))}),e.timeout);(_i(this.request)?this.request.then(self.fetch):self.fetch(this.request)).then((r=>{var s;this.response=this.loader=r;const a=Math.max(self.performance.now(),i.loading.start);if(self.clearTimeout(this.requestTimeout),e.timeout=c,this.requestTimeout=self.setTimeout((()=>{this.callbacks&&(this.abortInternal(),this.callbacks.onTimeout(i,t,this.response))}),c-(a-i.loading.start)),!r.ok){const{status:t,statusText:e}=r;throw new ya(e||"fetch, bad network response",t,r)}i.loading.first=a,i.total=function(t){const e=t.get("Content-Range");if(e){const t=function(t){const e=pa.exec(t);if(e)return parseInt(e[2])-parseInt(e[1])+1}(e);if(n(t))return t}const r=t.get("Content-Length");if(r)return parseInt(r)}(r.headers)||i.total;const l=null==(s=this.callbacks)?void 0:s.onProgress;return l&&n(e.highWaterMark)?this.loadProgressively(r,i,t,e.highWaterMark,l):o?r.arrayBuffer():"json"===t.responseType?r.json():r.text()})).then((r=>{var s,o;const l=this.response;if(!l)throw new Error("loader destroyed");self.clearTimeout(this.requestTimeout),i.loading.end=Math.max(self.performance.now(),i.loading.first);const c=r[a];c&&(i.loaded=i.total=c);const u={url:l.url,data:r,code:l.status},h=null==(s=this.callbacks)?void 0:s.onProgress;h&&!n(e.highWaterMark)&&h(i,t,r,l),null==(o=this.callbacks)||o.onSuccess(u,i,t,l)})).catch((e=>{var r;if(self.clearTimeout(this.requestTimeout),i.aborted)return;const n=e&&e.code||0,s=e?e.message:null;null==(r=this.callbacks)||r.onError({code:n,text:s},t,e?e.details:null,i)}))}getCacheAge(){let t=null;if(this.response){const e=this.response.headers.get("age");t=e?parseFloat(e):null}return t}getResponseHeader(t){return this.response?this.response.headers.get(t):null}loadProgressively(t,e,r,n=0,i){const s=new Jr,o=t.body.getReader(),a=()=>o.read().then((o=>{if(o.done)return s.dataLength&&i(e,r,s.flush().buffer,t),Promise.resolve(new ArrayBuffer(0));const l=o.value,c=l.length;return e.loaded+=c,c<n||s.dataLength?(s.push(l),s.dataLength>=n&&i(e,r,s.flush().buffer,t)):i(e,r,l.buffer,t),a()})).catch((()=>Promise.reject()));return a()}}function ma(t,e){return new self.Request(t.url,e)}class ya extends Error{constructor(t,e,r){super(t),this.code=void 0,this.details=void 0,this.code=e,this.details=r}}const va=/^age:\s*[\d.]+\s*$/im;class ba{constructor(t){this.xhrSetup=void 0,this.requestTimeout=void 0,this.retryTimeout=void 0,this.retryDelay=void 0,this.config=null,this.callbacks=null,this.context=null,this.loader=null,this.stats=void 0,this.xhrSetup=t&&t.xhrSetup||null,this.stats=new U,this.retryDelay=0}destroy(){this.callbacks=null,this.abortInternal(),this.loader=null,this.config=null,this.context=null,this.xhrSetup=null}abortInternal(){const t=this.loader;self.clearTimeout(this.requestTimeout),self.clearTimeout(this.retryTimeout),t&&(t.onreadystatechange=null,t.onprogress=null,4!==t.readyState&&(this.stats.aborted=!0,t.abort()))}abort(){var t;this.abortInternal(),null!=(t=this.callbacks)&&t.onAbort&&this.callbacks.onAbort(this.stats,this.context,this.loader)}load(t,e,r){if(this.stats.loading.start)throw new Error("Loader can only be used once.");this.stats.loading.start=self.performance.now(),this.context=t,this.config=e,this.callbacks=r,this.loadInternal()}loadInternal(){const{config:t,context:e}=this;if(!t||!e)return;const r=this.loader=new self.XMLHttpRequest,n=this.stats;n.loading.first=0,n.loaded=0,n.aborted=!1;const i=this.xhrSetup;i?Promise.resolve().then((()=>{if(this.loader===r&&!this.stats.aborted)return i(r,e.url)})).catch((t=>{if(this.loader===r&&!this.stats.aborted)return r.open("GET",e.url,!0),i(r,e.url)})).then((()=>{this.loader!==r||this.stats.aborted||this.openAndSendXhr(r,e,t)})).catch((t=>{var i;null==(i=this.callbacks)||i.onError({code:r.status,text:t.message},e,r,n)})):this.openAndSendXhr(r,e,t)}openAndSendXhr(t,e,r){t.readyState||t.open("GET",e.url,!0);const i=e.headers,{maxTimeToFirstByteMs:s,maxLoadTimeMs:o}=r.loadPolicy;if(i)for(const e in i)t.setRequestHeader(e,i[e]);e.rangeEnd&&t.setRequestHeader("Range","bytes="+e.rangeStart+"-"+(e.rangeEnd-1)),t.onreadystatechange=this.readystatechange.bind(this),t.onprogress=this.loadprogress.bind(this),t.responseType=e.responseType,self.clearTimeout(this.requestTimeout),r.timeout=s&&n(s)?s:o,this.requestTimeout=self.setTimeout(this.loadtimeout.bind(this),r.timeout),t.send()}readystatechange(){const{context:t,loader:e,stats:r}=this;if(!t||!e)return;const n=e.readyState,i=this.config;if(!r.aborted&&n>=2&&(0===r.loading.first&&(r.loading.first=Math.max(self.performance.now(),r.loading.start),i.timeout!==i.loadPolicy.maxLoadTimeMs&&(self.clearTimeout(this.requestTimeout),i.timeout=i.loadPolicy.maxLoadTimeMs,this.requestTimeout=self.setTimeout(this.loadtimeout.bind(this),i.loadPolicy.maxLoadTimeMs-(r.loading.first-r.loading.start)))),4===n)){self.clearTimeout(this.requestTimeout),e.onreadystatechange=null,e.onprogress=null;const n=e.status,l="text"===e.responseType?e.responseText:null;if(n>=200&&n<300){const i=null!=l?l:e.response;if(null!=i){var s,o;r.loading.end=Math.max(self.performance.now(),r.loading.first);const a="arraybuffer"===e.responseType?i.byteLength:i.length;r.loaded=r.total=a,r.bwEstimate=8e3*r.total/(r.loading.end-r.loading.first);const l=null==(s=this.callbacks)?void 0:s.onProgress;l&&l(r,t,i,e);const c={url:e.responseURL,data:i,code:n};return void(null==(o=this.callbacks)||o.onSuccess(c,r,t,e))}}const c=i.loadPolicy.errorRetry;var a;if(ue(c,r.retry,!1,{url:t.url,data:void 0,code:n}))this.retry(c);else T.error(`${n} while loading ${t.url}`),null==(a=this.callbacks)||a.onError({code:n,text:e.statusText},t,e,r)}}loadtimeout(){if(!this.config)return;const t=this.config.loadPolicy.timeoutRetry;if(ue(t,this.stats.retry,!0))this.retry(t);else{var e;T.warn(`timeout while loading ${null==(e=this.context)?void 0:e.url}`);const t=this.callbacks;t&&(this.abortInternal(),t.onTimeout(this.stats,this.context,this.loader))}}retry(t){const{context:e,stats:r}=this;this.retryDelay=le(t,r.retry),r.retry++,T.warn(`${status?"HTTP Status "+status:"Timeout"} while loading ${null==e?void 0:e.url}, retrying ${r.retry}/${t.maxNumRetry} in ${this.retryDelay}ms`),this.abortInternal(),this.loader=null,self.clearTimeout(this.retryTimeout),this.retryTimeout=self.setTimeout(this.loadInternal.bind(this),this.retryDelay)}loadprogress(t){const e=this.stats;e.loaded=t.loaded,t.lengthComputable&&(e.total=t.total)}getCacheAge(){let t=null;if(this.loader&&va.test(this.loader.getAllResponseHeaders())){const e=this.loader.getResponseHeader("age");t=e?parseFloat(e):null}return t}getResponseHeader(t){return this.loader&&new RegExp(`^${t}:\\s*[\\d.]+\\s*$`,"im").test(this.loader.getAllResponseHeaders())?this.loader.getResponseHeader(t):null}}const Ea=m(m({autoStartLoad:!0,startPosition:-1,defaultAudioCodec:void 0,debug:!1,capLevelOnFPSDrop:!1,capLevelToPlayerSize:!1,ignoreDevicePixelRatio:!1,maxDevicePixelRatio:Number.POSITIVE_INFINITY,preferManagedMediaSource:!0,initialLiveManifestSize:1,maxBufferLength:30,backBufferLength:1/0,frontBufferFlushThreshold:1/0,startOnSegmentBoundary:!1,maxBufferSize:6e7,maxFragLookUpTolerance:.25,maxBufferHole:.1,detectStallWithCurrentTimeMs:1250,highBufferWatchdogPeriod:2,nudgeOffset:.1,nudgeMaxRetry:3,nudgeOnVideoHole:!0,liveSyncMode:"edge",liveSyncDurationCount:3,liveSyncOnStallIncrease:1,liveMaxLatencyDurationCount:1/0,liveSyncDuration:void 0,liveMaxLatencyDuration:void 0,maxLiveSyncPlaybackRate:1,liveDurationInfinity:!1,liveBackBufferLength:null,maxMaxBufferLength:600,enableWorker:!0,workerPath:null,enableSoftwareAES:!0,startLevel:void 0,startFragPrefetch:!1,fpsDroppedMonitoringPeriod:5e3,fpsDroppedMonitoringThreshold:.2,appendErrorMaxRetry:3,ignorePlaylistParsingErrors:!1,loader:ba,fLoader:void 0,pLoader:void 0,xhrSetup:void 0,licenseXhrSetup:void 0,licenseResponseCallback:void 0,abrController:class extends y{constructor(t){super("abr",t.logger),this.hls=void 0,this.lastLevelLoadSec=0,this.lastLoadedFragLevel=-1,this.firstSelection=-1,this._nextAutoLevel=-1,this.nextAutoLevelKey="",this.audioTracksByGroup=null,this.codecTiers=null,this.timer=-1,this.fragCurrent=null,this.partCurrent=null,this.bitrateTestDelay=0,this.rebufferNotice=-1,this.supportedCache={},this.bwEstimator=void 0,this._abandonRulesCheck=t=>{var e;const{fragCurrent:r,partCurrent:i,hls:s}=this,{autoLevelEnabled:o,media:a}=s;if(!r||!a)return;const c=performance.now(),u=i?i.stats:r.stats,h=i?i.duration:r.duration,d=c-u.loading.start,f=s.minAutoLevel,p=r.level,g=this._nextAutoLevel;if(u.aborted||u.loaded&&u.loaded===u.total||p<=f)return this.clearTimer(),void(this._nextAutoLevel=-1);if(!o)return;const m=g>-1&&g!==p,y=!!t||m;if(!y&&(a.paused||!a.playbackRate||!a.readyState))return;const v=s.mainForwardBufferInfo;if(!y&&null===v)return;const b=this.bwEstimator.getEstimateTTFB(),E=Math.abs(a.playbackRate);if(d<=Math.max(b,h/(2*E)*1e3))return;const A=v?v.len/E:0,w=u.loading.first?u.loading.first-u.loading.start:-1,T=u.loaded&&w>-1,S=this.getBwEstimate(),L=s.levels,_=L[p],x=Math.max(u.loaded,Math.round(h*(r.bitrate||_.averageBitrate)/8));let k=T?d-w:d;k<1&&T&&(k=Math.min(d,8*u.loaded/S));const P=T?1e3*u.loaded/k:0,I=b/1e3,R=P?(x-u.loaded)/P:8*x/S+I;if(R<=A)return;const O=P?8*P:S,D=!0===(null==(e=(null==t?void 0:t.details)||this.hls.latestLevelDetails)?void 0:e.live),C=this.hls.config.abrBandWidthUpFactor;let M,N=Number.POSITIVE_INFINITY;for(M=p-1;M>f;M--){const t=L[M].maxBitrate,e=!L[M].details||D;if(N=this.getTimeToLoadFrag(I,O,h*t,e),N<Math.min(A,h+I))break}if(N>=R)return;if(N>10*h)return;T?this.bwEstimator.sample(d-Math.min(b,w),u.loaded):this.bwEstimator.sampleTTFB(d);const F=L[M].maxBitrate;this.getBwEstimate()*C>F&&this.resetEstimator(F);const U=this.findBestLevel(F,f,M,0,A,1,1);U>-1&&(M=U),this.warn(`Fragment ${r.sn}${i?" part "+i.index:""} of level ${p} is loading too slowly;\n      Fragment duration: ${r.duration.toFixed(3)}\n      Time to underbuffer: ${A.toFixed(3)} s\n      Estimated load time for current fragment: ${R.toFixed(3)} s\n      Estimated load time for down switch fragment: ${N.toFixed(3)} s\n      TTFB estimate: ${0|w} ms\n      Current BW estimate: ${n(S)?0|S:"Unknown"} bps\n      New BW estimate: ${0|this.getBwEstimate()} bps\n      Switching to level ${M} @ ${0|F} bps`),s.nextLoadLevel=s.nextAutoLevel=M,this.clearTimer();const B=()=>{if(this.clearTimer(),this.fragCurrent===r&&this.hls.loadLevel===M&&M>0){const t=this.getStarvationDelay();if(this.warn(`Aborting inflight request ${M>0?"and switching down":""}\n      Fragment duration: ${r.duration.toFixed(3)} s\n      Time to underbuffer: ${t.toFixed(3)} s`),r.abortRequests(),this.fragCurrent=this.partCurrent=null,M>f){let e=this.findBestLevel(this.hls.levels[f].bitrate,f,M,0,t,1,1);-1===e&&(e=f),this.hls.nextLoadLevel=this.hls.nextAutoLevel=e,this.resetEstimator(this.hls.levels[e].bitrate)}}};m||R>2*N?B():this.timer=self.setInterval(B,1e3*N),s.trigger(l.FRAG_LOAD_EMERGENCY_ABORTED,{frag:r,part:i,stats:u})},this.hls=t,this.bwEstimator=this.initEstimator(),this.registerListeners()}resetEstimator(t){t&&(this.log(`setting initial bwe to ${t}`),this.hls.config.abrEwmaDefaultEstimate=t),this.firstSelection=-1,this.bwEstimator=this.initEstimator()}initEstimator(){const t=this.hls.config;return new d(t.abrEwmaSlowVoD,t.abrEwmaFastVoD,t.abrEwmaDefaultEstimate)}registerListeners(){const{hls:t}=this;t.on(l.MANIFEST_LOADING,this.onManifestLoading,this),t.on(l.FRAG_LOADING,this.onFragLoading,this),t.on(l.FRAG_LOADED,this.onFragLoaded,this),t.on(l.FRAG_BUFFERED,this.onFragBuffered,this),t.on(l.LEVEL_SWITCHING,this.onLevelSwitching,this),t.on(l.LEVEL_LOADED,this.onLevelLoaded,this),t.on(l.LEVELS_UPDATED,this.onLevelsUpdated,this),t.on(l.MAX_AUTO_LEVEL_UPDATED,this.onMaxAutoLevelUpdated,this),t.on(l.ERROR,this.onError,this)}unregisterListeners(){const{hls:t}=this;t&&(t.off(l.MANIFEST_LOADING,this.onManifestLoading,this),t.off(l.FRAG_LOADING,this.onFragLoading,this),t.off(l.FRAG_LOADED,this.onFragLoaded,this),t.off(l.FRAG_BUFFERED,this.onFragBuffered,this),t.off(l.LEVEL_SWITCHING,this.onLevelSwitching,this),t.off(l.LEVEL_LOADED,this.onLevelLoaded,this),t.off(l.LEVELS_UPDATED,this.onLevelsUpdated,this),t.off(l.MAX_AUTO_LEVEL_UPDATED,this.onMaxAutoLevelUpdated,this),t.off(l.ERROR,this.onError,this))}destroy(){this.unregisterListeners(),this.clearTimer(),this.hls=this._abandonRulesCheck=this.supportedCache=null,this.fragCurrent=this.partCurrent=null}onManifestLoading(t,e){this.lastLoadedFragLevel=-1,this.firstSelection=-1,this.lastLevelLoadSec=0,this.supportedCache={},this.fragCurrent=this.partCurrent=null,this.onLevelsUpdated(),this.clearTimer()}onLevelsUpdated(){this.lastLoadedFragLevel>-1&&this.fragCurrent&&(this.lastLoadedFragLevel=this.fragCurrent.level),this._nextAutoLevel=-1,this.onMaxAutoLevelUpdated(),this.codecTiers=null,this.audioTracksByGroup=null}onMaxAutoLevelUpdated(){this.firstSelection=-1,this.nextAutoLevelKey=""}onFragLoading(t,e){const r=e.frag;if(!this.ignoreFragment(r)){var n;if(!r.bitrateTest)this.fragCurrent=r,this.partCurrent=null!=(n=e.part)?n:null;this.clearTimer(),this.timer=self.setInterval(this._abandonRulesCheck,100)}}onLevelSwitching(t,e){this.clearTimer()}onError(t,e){if(!e.fatal)switch(e.details){case a.BUFFER_ADD_CODEC_ERROR:case a.BUFFER_APPEND_ERROR:this.lastLoadedFragLevel=-1,this.firstSelection=-1;break;case a.FRAG_LOAD_TIMEOUT:{const t=e.frag,{fragCurrent:r,partCurrent:n}=this;if(t&&r&&t.sn===r.sn&&t.level===r.level){const e=performance.now(),r=n?n.stats:t.stats,i=e-r.loading.start,s=r.loading.first?r.loading.first-r.loading.start:-1;if(r.loaded&&s>-1){const t=this.bwEstimator.getEstimateTTFB();this.bwEstimator.sample(i-Math.min(t,s),r.loaded)}else this.bwEstimator.sampleTTFB(i)}break}}}getTimeToLoadFrag(t,e,r,n){return t+r/e+(n?t+this.lastLevelLoadSec:0)}onLevelLoaded(t,e){const r=this.hls.config,{loading:i}=e.stats,s=i.end-i.first;n(s)&&(this.lastLevelLoadSec=s/1e3),e.details.live?this.bwEstimator.update(r.abrEwmaSlowLive,r.abrEwmaFastLive):this.bwEstimator.update(r.abrEwmaSlowVoD,r.abrEwmaFastVoD),this.timer>-1&&this._abandonRulesCheck(e.levelInfo)}onFragLoaded(t,{frag:e,part:r}){const n=r?r.stats:e.stats;if(e.type===u.MAIN&&this.bwEstimator.sampleTTFB(n.loading.first-n.loading.start),!this.ignoreFragment(e)){if(this.clearTimer(),e.level===this._nextAutoLevel&&(this._nextAutoLevel=-1),this.firstSelection=-1,this.hls.config.abrMaxWithRealBitrate){const t=r?r.duration:e.duration,i=this.hls.levels[e.level],s=(i.loaded?i.loaded.bytes:0)+n.loaded,o=(i.loaded?i.loaded.duration:0)+t;i.loaded={bytes:s,duration:o},i.realBitrate=Math.round(8*s/o)}if(e.bitrateTest){const t={stats:n,frag:e,part:r,id:e.type};this.onFragBuffered(l.FRAG_BUFFERED,t),e.bitrateTest=!1}else this.lastLoadedFragLevel=e.level}}onFragBuffered(t,e){const{frag:r,part:n}=e,i=null!=n&&n.stats.loaded?n.stats:r.stats;if(i.aborted)return;if(this.ignoreFragment(r))return;const s=i.parsing.end-i.loading.start-Math.min(i.loading.first-i.loading.start,this.bwEstimator.getEstimateTTFB());this.bwEstimator.sample(s,i.loaded),i.bwEstimate=this.getBwEstimate(),r.bitrateTest?this.bitrateTestDelay=s/1e3:this.bitrateTestDelay=0}ignoreFragment(t){return t.type!==u.MAIN||"initSegment"===t.sn}clearTimer(){this.timer>-1&&(self.clearInterval(this.timer),this.timer=-1)}get firstAutoLevel(){const{maxAutoLevel:t,minAutoLevel:e}=this.hls,r=this.getBwEstimate(),n=this.hls.config.maxStarvationDelay,i=this.findBestLevel(r,e,t,0,n,1,1);if(i>-1)return i;const s=this.hls.firstLevel,o=Math.min(Math.max(s,e),t);return this.warn(`Could not find best starting auto level. Defaulting to first in playlist ${s} clamped to ${o}`),o}get forcedAutoLevel(){return this.nextAutoLevelKey?-1:this._nextAutoLevel}get nextAutoLevel(){const t=this.forcedAutoLevel,e=this.bwEstimator.canEstimate(),r=this.lastLoadedFragLevel>-1;if(!(-1===t||e&&r&&this.nextAutoLevelKey!==this.getAutoLevelKey()))return t;const n=e&&r?this.getNextABRAutoLevel():this.firstAutoLevel;if(-1!==t){const e=this.hls.levels;if(e.length>Math.max(t,n)&&e[t].loadError<=e[n].loadError)return t}return this._nextAutoLevel=n,this.nextAutoLevelKey=this.getAutoLevelKey(),n}getAutoLevelKey(){return`${this.getBwEstimate()}_${this.getStarvationDelay().toFixed(2)}`}getNextABRAutoLevel(){const{fragCurrent:t,partCurrent:e,hls:r}=this;if(r.levels.length<=1)return r.loadLevel;const{maxAutoLevel:n,config:i,minAutoLevel:s}=r,o=e?e.duration:t?t.duration:0,a=this.getBwEstimate(),l=this.getStarvationDelay();let c=i.abrBandWidthFactor,u=i.abrBandWidthUpFactor;if(l){const t=this.findBestLevel(a,s,n,l,0,c,u);if(t>=0)return this.rebufferNotice=-1,t}let h=o?Math.min(o,i.maxStarvationDelay):i.maxStarvationDelay;if(!l){const t=this.bitrateTestDelay;if(t){h=(o?Math.min(o,i.maxLoadingDelay):i.maxLoadingDelay)-t,this.info(`bitrate test took ${Math.round(1e3*t)}ms, set first fragment max fetchDuration to ${Math.round(1e3*h)} ms`),c=u=1}}const d=this.findBestLevel(a,s,n,l,h,c,u);if(this.rebufferNotice!==d&&(this.rebufferNotice=d,this.info(`${l?"rebuffering expected":"buffer is empty"}, optimal quality level ${d}`)),d>-1)return d;const f=r.levels[s],p=r.loadLevelObj;return p&&(null==f?void 0:f.bitrate)<p.bitrate?s:r.loadLevel}getStarvationDelay(){const t=this.hls,e=t.media;if(!e)return 1/0;const r=e&&0!==e.playbackRate?Math.abs(e.playbackRate):1,n=t.mainForwardBufferInfo;return(n?n.len:0)/r}getBwEstimate(){return this.bwEstimator.canEstimate()?this.bwEstimator.getEstimate():this.hls.config.abrEwmaDefaultEstimate}findBestLevel(t,e,r,i,s,o,a){var l;const c=i+s,u=this.lastLoadedFragLevel,h=-1===u?this.hls.firstLevel:u,{fragCurrent:d,partCurrent:f}=this,{levels:p,allAudioTracks:g,loadLevel:m,config:y}=this.hls;if(1===p.length)return 0;const v=p[h],b=!(null==(l=this.hls.latestLevelDetails)||!l.live),E=-1===m||-1===u;let A,w="SDR",T=(null==v?void 0:v.frameRate)||0;const{audioPreference:S,videoPreference:L}=y,_=this.audioTracksByGroup||(this.audioTracksByGroup=Wt(g));let x=-1;if(E){if(-1!==this.firstSelection)return this.firstSelection;const i=this.codecTiers||(this.codecTiers=function(t,e,r,n){return t.slice(r,n+1).reduce(((t,r,n)=>{if(!r.codecSet)return t;const i=r.audioGroups;let s=t[r.codecSet];s||(t[r.codecSet]=s={minBitrate:1/0,minHeight:1/0,minFramerate:1/0,minIndex:n,maxScore:0,videoRanges:{SDR:0},channels:{2:0},hasDefaultAudio:!i,fragmentError:0}),s.minBitrate=Math.min(s.minBitrate,r.bitrate);const o=Math.min(r.height,r.width);return s.minHeight=Math.min(s.minHeight,o),s.minFramerate=Math.min(s.minFramerate,r.frameRate),s.minIndex=Math.min(s.minIndex,n),s.maxScore=Math.max(s.maxScore,r.score),s.fragmentError+=r.fragmentError,s.videoRanges[r.videoRange]=(s.videoRanges[r.videoRange]||0)+1,i&&i.forEach((t=>{if(!t)return;const r=e.groups[t];r&&(s.hasDefaultAudio=s.hasDefaultAudio||e.hasDefaultAudio?r.hasDefault:r.hasAutoSelect||!e.hasDefaultAudio&&!e.hasAutoSelectAudio,Object.keys(r.channels).forEach((t=>{s.channels[t]=(s.channels[t]||0)+r.channels[t]})))})),t}),{})}(p,_,e,r)),s=function(t,e,r,i,s){const o=Object.keys(t),a=null==i?void 0:i.channels,l=null==i?void 0:i.audioCodec,c=null==s?void 0:s.videoCodec,u=a&&2===parseInt(a);let h=!1,d=!1,f=1/0,p=1/0,g=1/0,m=1/0,y=0,v=[];const{preferHDR:b,allowedVideoRanges:E}=Kt(e,s);for(let e=o.length;e--;){const r=t[o[e]];h||(h=r.channels[2]>0),f=Math.min(f,r.minHeight),p=Math.min(p,r.minFramerate),g=Math.min(g,r.minBitrate),E.filter((t=>r.videoRanges[t]>0)).length>0&&(d=!0)}f=n(f)?f:0,p=n(p)?p:0;const A=Math.max(1080,f),w=Math.max(30,p);g=n(g)?g:r,r=Math.max(g,r),d||(e=void 0);const T=o.length>1;return{codecSet:o.reduce(((e,n)=>{const i=t[n];if(n===e)return e;if(v=d?E.filter((t=>i.videoRanges[t]>0)):[],T){if(i.minBitrate>r)return qt(n,`min bitrate of ${i.minBitrate} > current estimate of ${r}`),e;if(!i.hasDefaultAudio)return qt(n,"no renditions with default or auto-select sound found"),e;if(l&&n.indexOf(l.substring(0,4))%5!=0)return qt(n,`audio codec preference "${l}" not found`),e;if(a&&!u){if(!i.channels[a])return qt(n,`no renditions with ${a} channel sound found (channels options: ${Object.keys(i.channels)})`),e}else if((!l||u)&&h&&0===i.channels[2])return qt(n,"no renditions with stereo sound found"),e;if(i.minHeight>A)return qt(n,`min resolution of ${i.minHeight} > maximum of ${A}`),e;if(i.minFramerate>w)return qt(n,`min framerate of ${i.minFramerate} > maximum of ${w}`),e;if(!v.some((t=>i.videoRanges[t]>0)))return qt(n,`no variants with VIDEO-RANGE of ${Yt(v)} found`),e;if(c&&n.indexOf(c.substring(0,4))%5!=0)return qt(n,`video codec preference "${c}" not found`),e;if(i.maxScore<y)return qt(n,`max score of ${i.maxScore} < selected max of ${y}`),e}return e&&(wt(n)>=wt(e)||i.fragmentError>t[e].fragmentError)?e:(m=i.minIndex,y=i.maxScore,n)}),void 0),videoRanges:v,preferHDR:b,minFramerate:p,minBitrate:g,minIndex:m}}(i,w,t,S,L),{codecSet:o,videoRanges:a,minFramerate:l,minBitrate:c,minIndex:u,preferHDR:h}=s;x=u,A=o,w=h?a[a.length-1]:a[0],T=l,t=Math.max(t,c),this.log(`picked start tier ${Yt(s)}`)}else A=null==v?void 0:v.codecSet,w=null==v?void 0:v.videoRange;const k=f?f.duration:d?d.duration:0,P=this.bwEstimator.getEstimateTTFB()/1e3,I=[];for(let l=r;l>=e;l--){var R;const e=p[l],d=l>h;if(!e)continue;if(y.useMediaCapabilities&&!e.supportedResult&&!e.supportedPromise){const r=navigator.mediaCapabilities;"function"==typeof(null==r?void 0:r.decodingInfo)&&Ct(e,_,w,T,t,S)?(e.supportedPromise=Mt(e,_,r,this.supportedCache),e.supportedPromise.then((t=>{if(!this.hls)return;e.supportedResult=t;const r=this.hls.levels,n=r.indexOf(e);t.error?this.warn(`MediaCapabilities decodingInfo error: "${t.error}" for level ${n} ${Yt(t)}`):t.supported?t.decodingInfoResults.some((t=>!1===t.smooth||!1===t.powerEfficient))&&this.log(`MediaCapabilities decodingInfo for level ${n} not smooth or powerEfficient: ${Yt(t)}`):(this.warn(`Unsupported MediaCapabilities decodingInfo result for level ${n} ${Yt(t)}`),n>-1&&r.length>1&&(this.log(`Removing unsupported level ${n}`),this.hls.removeLevel(n),-1===this.hls.loadLevel&&(this.hls.nextLoadLevel=0)))})).catch((t=>{this.warn(`Error handling MediaCapabilities decodingInfo: ${t}`)}))):e.supportedResult=Ot}if((A&&e.codecSet!==A||w&&e.videoRange!==w||d&&T>e.frameRate||!d&&T>0&&T<e.frameRate||null!=(R=e.supportedResult)&&null!=(R=R.decodingInfoResults)&&R.some((t=>!1===t.smooth)))&&(!E||l!==x)){I.push(l);continue}const g=e.details,v=(f?null==g?void 0:g.partTarget:null==g?void 0:g.averagetargetduration)||k;let L;L=d?a*t:o*t;const O=k&&i>=2*k&&0===s?e.averageBitrate:e.maxBitrate,D=this.getTimeToLoadFrag(P,L,O*v,void 0===g);if(L>=O&&(l===u||0===e.loadError&&0===e.fragmentError)&&(D<=P||!n(D)||b&&!this.bitrateTestDelay||D<c)){const t=this.forcedAutoLevel;return l===m||-1!==t&&t===m||(I.length&&this.trace(`Skipped level(s) ${I.join(",")} of ${r} max with CODECS and VIDEO-RANGE:"${p[I[0]].codecs}" ${p[I[0]].videoRange}; not compatible with "${A}" ${w}`),this.info(`switch candidate:${h}->${l} adjustedbw(${Math.round(L)})-bitrate=${Math.round(L-O)} ttfb:${P.toFixed(1)} avgDuration:${v.toFixed(1)} maxFetchDuration:${c.toFixed(1)} fetchDuration:${D.toFixed(1)} firstSelection:${E} codecSet:${e.codecSet} videoRange:${e.videoRange} hls.loadLevel:${m}`)),E&&(this.firstSelection=l),l}}return-1}set nextAutoLevel(t){const e=this.deriveNextAutoLevel(t);this._nextAutoLevel!==e&&(this.nextAutoLevelKey="",this._nextAutoLevel=e)}deriveNextAutoLevel(t){const{maxAutoLevel:e,minAutoLevel:r}=this.hls;return Math.min(Math.max(t,r),e)}},bufferController:class extends y{constructor(t,e){var r;super("buffer-controller",t.logger),this.hls=void 0,this.fragmentTracker=void 0,this.details=null,this._objectUrl=null,this.operationQueue=null,this.bufferCodecEventsTotal=0,this.media=null,this.mediaSource=null,this.lastMpegAudioChunk=null,this.blockedAudioAppend=null,this.lastVideoAppendEnd=0,this.appendSource=void 0,this.transferData=void 0,this.overrides=void 0,this.appendErrors={audio:0,video:0,audiovideo:0},this.tracks={},this.sourceBuffers=[[null,null],[null,null]],this._onEndStreaming=t=>{var e;this.hls&&"open"===(null==(e=this.mediaSource)?void 0:e.readyState)&&this.hls.pauseBuffering()},this._onStartStreaming=t=>{this.hls&&this.hls.resumeBuffering()},this._onMediaSourceOpen=t=>{const{media:e,mediaSource:r}=this;t&&this.log("Media source opened"),e&&r&&(r.removeEventListener("sourceopen",this._onMediaSourceOpen),e.removeEventListener("emptied",this._onMediaEmptied),this.updateDuration(),this.hls.trigger(l.MEDIA_ATTACHED,{media:e,mediaSource:r}),null!==this.mediaSource&&this.checkPendingTracks())},this._onMediaSourceClose=()=>{this.log("Media source closed")},this._onMediaSourceEnded=()=>{this.log("Media source ended")},this._onMediaEmptied=()=>{const{mediaSrc:t,_objectUrl:e}=this;t!==e&&this.error(`Media element src was set while attaching MediaSource (${e} > ${t})`)},this.hls=t,this.fragmentTracker=e,this.appendSource=(r=S(t.config.preferManagedMediaSource),"undefined"!=typeof self&&r===self.ManagedMediaSource),this.initTracks(),this.registerListeners()}hasSourceTypes(){return Object.keys(this.tracks).length>0}destroy(){this.unregisterListeners(),this.details=null,this.lastMpegAudioChunk=this.blockedAudioAppend=null,this.transferData=this.overrides=void 0,this.operationQueue&&(this.operationQueue.destroy(),this.operationQueue=null),this.hls=this.fragmentTracker=null,this._onMediaSourceOpen=this._onMediaSourceClose=null,this._onMediaSourceEnded=null,this._onStartStreaming=this._onEndStreaming=null}registerListeners(){const{hls:t}=this;t.on(l.MEDIA_ATTACHING,this.onMediaAttaching,this),t.on(l.MEDIA_DETACHING,this.onMediaDetaching,this),t.on(l.MANIFEST_LOADING,this.onManifestLoading,this),t.on(l.MANIFEST_PARSED,this.onManifestParsed,this),t.on(l.BUFFER_RESET,this.onBufferReset,this),t.on(l.BUFFER_APPENDING,this.onBufferAppending,this),t.on(l.BUFFER_CODECS,this.onBufferCodecs,this),t.on(l.BUFFER_EOS,this.onBufferEos,this),t.on(l.BUFFER_FLUSHING,this.onBufferFlushing,this),t.on(l.LEVEL_UPDATED,this.onLevelUpdated,this),t.on(l.FRAG_PARSED,this.onFragParsed,this),t.on(l.FRAG_CHANGED,this.onFragChanged,this),t.on(l.ERROR,this.onError,this)}unregisterListeners(){const{hls:t}=this;t.off(l.MEDIA_ATTACHING,this.onMediaAttaching,this),t.off(l.MEDIA_DETACHING,this.onMediaDetaching,this),t.off(l.MANIFEST_LOADING,this.onManifestLoading,this),t.off(l.MANIFEST_PARSED,this.onManifestParsed,this),t.off(l.BUFFER_RESET,this.onBufferReset,this),t.off(l.BUFFER_APPENDING,this.onBufferAppending,this),t.off(l.BUFFER_CODECS,this.onBufferCodecs,this),t.off(l.BUFFER_EOS,this.onBufferEos,this),t.off(l.BUFFER_FLUSHING,this.onBufferFlushing,this),t.off(l.LEVEL_UPDATED,this.onLevelUpdated,this),t.off(l.FRAG_PARSED,this.onFragParsed,this),t.off(l.FRAG_CHANGED,this.onFragChanged,this),t.off(l.ERROR,this.onError,this)}transferMedia(){const{media:t,mediaSource:e}=this;if(!t)return null;const r={};if(this.operationQueue){const t=this.isUpdating();t||this.operationQueue.removeBlockers();const e=this.isQueued();(t||e)&&this.warn(`Transfering MediaSource with${e?" operations in queue":""}${t?" updating SourceBuffer(s)":""} ${this.operationQueue}`),this.operationQueue.destroy()}const n=this.transferData;return!this.sourceBufferCount&&n&&n.mediaSource===e?p(r,n.tracks):this.sourceBuffers.forEach((t=>{const[e]=t;e&&(r[e]=p({},this.tracks[e]),this.removeBuffer(e)),t[0]=t[1]=null})),{media:t,mediaSource:e,tracks:r}}initTracks(){this.sourceBuffers=[[null,null],[null,null]],this.tracks={},this.resetQueue(),this.resetAppendErrors(),this.lastMpegAudioChunk=this.blockedAudioAppend=null,this.lastVideoAppendEnd=0}onManifestLoading(){this.bufferCodecEventsTotal=0,this.details=null}onManifestParsed(t,e){var r;let n=2;(e.audio&&!e.video||!e.altAudio)&&(n=1),this.bufferCodecEventsTotal=n,this.log(`${n} bufferCodec event(s) expected.`),null!=(r=this.transferData)&&r.mediaSource&&this.sourceBufferCount&&n&&this.bufferCreated()}onMediaAttaching(t,e){const r=this.media=e.media;this.transferData=this.overrides=void 0;const n=S(this.appendSource);if(n){const t=!!e.mediaSource;(t||e.overrides)&&(this.transferData=e,this.overrides=e.overrides);const i=this.mediaSource=e.mediaSource||new n;if(this.assignMediaSource(i),t)this._objectUrl=r.src,this.attachTransferred();else{const t=this._objectUrl=self.URL.createObjectURL(i);if(this.appendSource)try{r.removeAttribute("src");const e=self.ManagedMediaSource;r.disableRemotePlayback=r.disableRemotePlayback||e&&i instanceof e,Bi(r),function(t,e){const r=self.document.createElement("source");r.type="video/mp4",r.src=e,t.appendChild(r)}(r,t),r.load()}catch(e){r.src=t}else r.src=t}r.addEventListener("emptied",this._onMediaEmptied)}}assignMediaSource(t){var e,r;this.log(`${(null==(e=this.transferData)?void 0:e.mediaSource)===t?"transferred":"created"} media source: ${null==(r=t.constructor)?void 0:r.name}`),t.addEventListener("sourceopen",this._onMediaSourceOpen),t.addEventListener("sourceended",this._onMediaSourceEnded),t.addEventListener("sourceclose",this._onMediaSourceClose),this.appendSource&&(t.addEventListener("startstreaming",this._onStartStreaming),t.addEventListener("endstreaming",this._onEndStreaming))}attachTransferred(){const t=this.media,e=this.transferData;if(!e||!t)return;const r=this.tracks,n=e.tracks,i=n?Object.keys(n):null,s=i?i.length:0,o=()=>{Promise.resolve().then((()=>{this.media&&this.mediaSourceOpenOrEnded&&this._onMediaSourceOpen()}))};if(n&&i&&s){if(!this.tracksReady)return this.hls.config.startFragPrefetch=!0,void this.log("attachTransferred: waiting for SourceBuffer track info");if(this.log(`attachTransferred: (bufferCodecEventsTotal ${this.bufferCodecEventsTotal})\nrequired tracks: ${Yt(r,((t,e)=>"initSegment"===t?void 0:e))};\ntransfer tracks: ${Yt(n,((t,e)=>"initSegment"===t?void 0:e))}}`),!L(n,r)){e.mediaSource=null,e.tracks=void 0;const i=t.currentTime,s=this.details,o=Math.max(i,(null==s?void 0:s.fragments[0].start)||0);return o-i>1?void this.log(`attachTransferred: waiting for playback to reach new tracks start time ${i} -> ${o}`):(this.warn(`attachTransferred: resetting MediaSource for incompatible tracks ("${Object.keys(n)}"->"${Object.keys(r)}") start time: ${o} currentTime: ${i}`),this.onMediaDetaching(l.MEDIA_DETACHING,{}),this.onMediaAttaching(l.MEDIA_ATTACHING,e),void(t.currentTime=o))}this.transferData=void 0,i.forEach((t=>{const e=t,r=n[e];if(r){const t=r.buffer;if(t){const n=this.fragmentTracker,i=r.id;if(n.hasFragments(i)||n.hasParts(i)){const r=Ne.getBuffered(t);n.detectEvictedFragments(e,r,i,null,!0)}const s=$i(e),o=[e,t];this.sourceBuffers[s]=o,t.updating&&this.operationQueue&&this.operationQueue.prependBlocker(e),this.trackSourceBuffer(e,r)}}})),o(),this.bufferCreated()}else this.log("attachTransferred: MediaSource w/o SourceBuffers"),o()}get mediaSourceOpenOrEnded(){var t;const e=null==(t=this.mediaSource)?void 0:t.readyState;return"open"===e||"ended"===e}onMediaDetaching(t,e){const r=!!e.transferMedia;this.transferData=this.overrides=void 0;const{media:n,mediaSource:i,_objectUrl:s}=this;if(i){if(this.log("media source "+(r?"transferring":"detaching")),r)this.sourceBuffers.forEach((([t])=>{t&&this.removeBuffer(t)})),this.resetQueue();else{if(this.mediaSourceOpenOrEnded){const t="open"===i.readyState;try{const e=i.sourceBuffers;for(let r=e.length;r--;)t&&e[r].abort(),i.removeSourceBuffer(e[r]);t&&i.endOfStream()}catch(t){this.warn(`onMediaDetaching: ${t.message} while calling endOfStream`)}}this.sourceBufferCount&&this.onBufferReset()}i.removeEventListener("sourceopen",this._onMediaSourceOpen),i.removeEventListener("sourceended",this._onMediaSourceEnded),i.removeEventListener("sourceclose",this._onMediaSourceClose),this.appendSource&&(i.removeEventListener("startstreaming",this._onStartStreaming),i.removeEventListener("endstreaming",this._onEndStreaming)),this.mediaSource=null,this._objectUrl=null}n&&(n.removeEventListener("emptied",this._onMediaEmptied),r||(s&&self.URL.revokeObjectURL(s),this.mediaSrc===s?(n.removeAttribute("src"),this.appendSource&&Bi(n),n.load()):this.warn("media|source.src was changed by a third party - skip cleanup")),this.media=null),this.hls.trigger(l.MEDIA_DETACHED,e)}onBufferReset(){this.sourceBuffers.forEach((([t])=>{t&&this.resetBuffer(t)})),this.initTracks()}resetBuffer(t){var e;const r=null==(e=this.tracks[t])?void 0:e.buffer;if(this.removeBuffer(t),r)try{var n;null!=(n=this.mediaSource)&&n.sourceBuffers.length&&this.mediaSource.removeSourceBuffer(r)}catch(e){this.warn(`onBufferReset ${t}`,e)}delete this.tracks[t]}removeBuffer(t){this.removeBufferListeners(t),this.sourceBuffers[$i(t)]=[null,null];const e=this.tracks[t];e&&(e.buffer=void 0)}resetQueue(){this.operationQueue&&this.operationQueue.destroy(),this.operationQueue=new Mi(this.tracks)}onBufferCodecs(t,e){const r=this.tracks,n=Object.keys(e);this.log(`BUFFER_CODECS: "${n}" (current SB count ${this.sourceBufferCount})`);const i="audiovideo"in e&&(r.audio||r.video)||r.audiovideo&&("audio"in e||"video"in e),s=!i&&this.sourceBufferCount&&this.media&&n.some((t=>!r[t]));i||s?this.warn(`Unsupported transition between "${Object.keys(r)}" and "${n}" SourceBuffers`):(n.forEach((t=>{var n,i;const s=e[t],{id:o,codec:a,levelCodec:l,container:c,metadata:u,supplemental:h}=s;let d=r[t];const f=null==(n=this.transferData)||null==(n=n.tracks)?void 0:n[t],p=null!=f&&f.buffer?f:d,g=(null==p?void 0:p.pendingCodec)||(null==p?void 0:p.codec),m=null==p?void 0:p.levelCodec;d||(d=r[t]={buffer:void 0,listeners:[],codec:a,supplemental:h,container:c,levelCodec:l,metadata:u,id:o});const y=_t(g,m),v=null==y?void 0:y.replace(Ni,"$1");let b=_t(a,l);const E=null==(i=b)?void 0:i.replace(Ni,"$1");b&&y&&v!==E&&("audio"===t.slice(0,5)&&(b=Lt(b,this.appendSource)),this.log(`switching codec ${g} to ${b}`),b!==(d.pendingCodec||d.codec)&&(d.pendingCodec=b),d.container=c,this.appendChangeType(t,c,b))})),(this.tracksReady||this.sourceBufferCount)&&(e.tracks=this.sourceBufferTracks),this.sourceBufferCount||this.mediaSourceOpenOrEnded&&this.checkPendingTracks())}get sourceBufferTracks(){return Object.keys(this.tracks).reduce(((t,e)=>{const r=this.tracks[e];return t[e]={id:r.id,container:r.container,codec:r.codec,levelCodec:r.levelCodec},t}),{})}appendChangeType(t,e,r){const n=`${e};codecs=${r}`,i={label:`change-type=${n}`,execute:()=>{const i=this.tracks[t];if(i){const s=i.buffer;null!=s&&s.changeType&&(this.log(`changing ${t} sourceBuffer type to ${n}`),s.changeType(n),i.codec=r,i.container=e)}this.shiftAndExecuteNext(t)},onStart:()=>{},onComplete:()=>{},onError:e=>{this.warn(`Failed to change ${t} SourceBuffer type`,e)}};this.append(i,t,this.isPending(this.tracks[t]))}blockAudio(t){var e;const r=t.start,n=r+.05*t.duration;if(!0===(null==(e=this.fragmentTracker.getAppendedFrag(r,u.MAIN))?void 0:e.gap))return;const i={label:"block-audio",execute:()=>{var t;const e=this.tracks.video;(this.lastVideoAppendEnd>n||null!=e&&e.buffer&&Ne.isBuffered(e.buffer,n)||!0===(null==(t=this.fragmentTracker.getAppendedFrag(n,u.MAIN))?void 0:t.gap))&&(this.blockedAudioAppend=null,this.shiftAndExecuteNext("audio"))},onStart:()=>{},onComplete:()=>{},onError:t=>{this.warn("Error executing block-audio operation",t)}};this.blockedAudioAppend={op:i,frag:t},this.append(i,"audio",!0)}unblockAudio(){const{blockedAudioAppend:t,operationQueue:e}=this;t&&e&&(this.blockedAudioAppend=null,e.unblockAudio(t.op))}onBufferAppending(t,e){const{tracks:r}=this,{data:i,type:s,parent:c,frag:u,part:h,chunkMeta:d,offset:f}=e,p=d.buffering[s],{sn:g,cc:m}=u,y=self.performance.now();p.start=y;const v=u.stats.buffering,b=h?h.stats.buffering:null;0===v.start&&(v.start=y),b&&0===b.start&&(b.start=y);const E=r.audio;let A=!1;"audio"===s&&"audio/mpeg"===(null==E?void 0:E.container)&&(A=!this.lastMpegAudioChunk||1===d.id||this.lastMpegAudioChunk.sn!==d.sn,this.lastMpegAudioChunk=d);const w=r.video,T=null==w?void 0:w.buffer;if(T&&"initSegment"!==g){const t=h||u,e=this.blockedAudioAppend;if("audio"!==s||"main"===c||this.blockedAudioAppend||w.ending||w.ended){if("video"===s){const r=t.end;if(e){const t=e.frag.start;(r>t||r<this.lastVideoAppendEnd||Ne.isBuffered(T,t))&&this.unblockAudio()}this.lastVideoAppendEnd=r}}else{const e=t.start+.05*t.duration,r=T.buffered,n=this.currentOp("video");r.length||n?!n&&!Ne.isBuffered(T,e)&&this.lastVideoAppendEnd<e&&this.blockAudio(t):this.blockAudio(t)}}const S=(h||u).start,L={label:`append-${s}`,execute:()=>{var t;p.executeStart=self.performance.now();const e=null==(t=this.tracks[s])?void 0:t.buffer;e&&(A?this.updateTimestampOffset(e,S,.1,s,g,m):void 0!==f&&n(f)&&this.updateTimestampOffset(e,f,1e-6,s,g,m)),this.appendExecutor(i,s)},onStart:()=>{},onComplete:()=>{const t=self.performance.now();p.executeEnd=p.end=t,0===v.first&&(v.first=t),b&&0===b.first&&(b.first=t);const e={};this.sourceBuffers.forEach((([t,r])=>{t&&(e[t]=Ne.getBuffered(r))})),this.appendErrors[s]=0,"audio"===s||"video"===s?this.appendErrors.audiovideo=0:(this.appendErrors.audio=0,this.appendErrors.video=0),this.hls.trigger(l.BUFFER_APPENDED,{type:s,frag:u,part:h,chunkMeta:d,parent:u.type,timeRanges:e})},onError:t=>{var e;const r={type:o.MEDIA_ERROR,parent:u.type,details:a.BUFFER_APPEND_ERROR,sourceBufferName:s,frag:u,part:h,chunkMeta:d,error:t,err:t,fatal:!1},n=null==(e=this.media)?void 0:e.error;if(t.code===DOMException.QUOTA_EXCEEDED_ERR||"QuotaExceededError"==t.name||"quota"in t)r.details=a.BUFFER_FULL_ERROR;else if(t.code===DOMException.INVALID_STATE_ERR&&this.mediaSourceOpenOrEnded&&!n)r.errorAction=pe(!0);else if(t.name===Fi&&0===this.sourceBufferCount)r.errorAction=pe(!0);else{const t=++this.appendErrors[s];this.warn(`Failed ${t}/${this.hls.config.appendErrorMaxRetry} times to append segment in "${s}" sourceBuffer (${n||"no media error"})`),(t>=this.hls.config.appendErrorMaxRetry||n)&&(r.fatal=!0)}this.hls.trigger(l.ERROR,r)}};this.append(L,s,this.isPending(this.tracks[s]))}getFlushOp(t,e,r){return this.log(`queuing "${t}" remove ${e}-${r}`),{label:"remove",execute:()=>{this.removeExecutor(t,e,r)},onStart:()=>{},onComplete:()=>{this.hls.trigger(l.BUFFER_FLUSHED,{type:t})},onError:n=>{this.warn(`Failed to remove ${e}-${r} from "${t}" SourceBuffer`,n)}}}onBufferFlushing(t,e){const{type:r,startOffset:n,endOffset:i}=e;r?this.append(this.getFlushOp(r,n,i),r):this.sourceBuffers.forEach((([t])=>{t&&this.append(this.getFlushOp(t,n,i),t)}))}onFragParsed(t,e){const{frag:r,part:n}=e,i=[],s=n?n.elementaryStreams:r.elementaryStreams;s[B.AUDIOVIDEO]?i.push("audiovideo"):(s[B.AUDIO]&&i.push("audio"),s[B.VIDEO]&&i.push("video"));0===i.length&&this.warn(`Fragments must have at least one ElementaryStreamType set. type: ${r.type} level: ${r.level} sn: ${r.sn}`),this.blockBuffers((()=>{const t=self.performance.now();r.stats.buffering.end=t,n&&(n.stats.buffering.end=t);const e=n?n.stats:r.stats;this.hls.trigger(l.FRAG_BUFFERED,{frag:r,part:n,stats:e,id:r.type})}),i).catch((t=>{this.warn(`Fragment buffered callback ${t}`),this.stepOperationQueue(this.sourceBufferTypes)}))}onFragChanged(t,e){this.trimBuffers()}get bufferedToEnd(){return this.sourceBufferCount>0&&!this.sourceBuffers.some((([t])=>{if(t){const e=this.tracks[t];if(e)return!e.ended||e.ending}return!1}))}onBufferEos(t,e){var r;this.sourceBuffers.forEach((([t])=>{if(t){const r=this.tracks[t];e.type&&e.type!==t||(r.ending=!0,r.ended||(r.ended=!0,this.log(`${t} buffer reached EOS`)))}}));const n=!1!==(null==(r=this.overrides)?void 0:r.endOfStream);this.sourceBufferCount>0&&!this.sourceBuffers.some((([t])=>{var e;return t&&!(null!=(e=this.tracks[t])&&e.ended)}))?n?(this.log("Queueing EOS"),this.blockUntilOpen((()=>{this.tracksEnded();const{mediaSource:t}=this;t&&"open"===t.readyState?(this.log("Calling mediaSource.endOfStream()"),t.endOfStream(),this.hls.trigger(l.BUFFERED_TO_END,void 0)):t&&this.log(`Could not call mediaSource.endOfStream(). mediaSource.readyState: ${t.readyState}`)}))):(this.tracksEnded(),this.hls.trigger(l.BUFFERED_TO_END,void 0)):"video"===e.type&&this.unblockAudio()}tracksEnded(){this.sourceBuffers.forEach((([t])=>{if(null!==t){const e=this.tracks[t];e&&(e.ending=!1)}}))}onLevelUpdated(t,{details:e}){e.fragments.length&&(this.details=e,this.updateDuration())}updateDuration(){this.blockUntilOpen((()=>{const t=this.getDurationAndRange();t&&this.updateMediaSource(t)}))}onError(t,e){if(e.details===a.BUFFER_APPEND_ERROR&&e.frag){var r;const t=null==(r=e.errorAction)?void 0:r.nextAutoLevel;n(t)&&t!==e.frag.level&&this.resetAppendErrors()}}resetAppendErrors(){this.appendErrors={audio:0,video:0,audiovideo:0}}trimBuffers(){const{hls:t,details:e,media:r}=this;if(!r||null===e)return;if(!this.sourceBufferCount)return;const i=t.config,s=r.currentTime,o=e.levelTargetDuration,a=e.live&&null!==i.liveBackBufferLength?i.liveBackBufferLength:i.backBufferLength;if(n(a)&&a>=0){const t=Math.max(a,o),e=Math.floor(s/o)*o-t;this.flushBackBuffer(s,o,e)}const l=i.frontBufferFlushThreshold;if(n(l)&&l>0){const t=Math.max(i.maxBufferLength,l),e=Math.max(t,o),r=Math.floor(s/o)*o+e;this.flushFrontBuffer(s,o,r)}}flushBackBuffer(t,e,r){this.sourceBuffers.forEach((([t,e])=>{if(e){const i=Ne.getBuffered(e);if(i.length>0&&r>i.start(0)){var n;this.hls.trigger(l.BACK_BUFFER_REACHED,{bufferEnd:r});const e=this.tracks[t];if(null!=(n=this.details)&&n.live)this.hls.trigger(l.LIVE_BACK_BUFFER_REACHED,{bufferEnd:r});else if(null!=e&&e.ended)return void this.log(`Cannot flush ${t} back buffer while SourceBuffer is in ended state`);this.hls.trigger(l.BUFFER_FLUSHING,{startOffset:0,endOffset:r,type:t})}}}))}flushFrontBuffer(t,e,r){this.sourceBuffers.forEach((([e,n])=>{if(n){const i=Ne.getBuffered(n),s=i.length;if(s<2)return;const o=i.start(s-1),a=i.end(s-1);if(r>o||t>=o&&t<=a)return;this.hls.trigger(l.BUFFER_FLUSHING,{startOffset:o,endOffset:1/0,type:e})}}))}getDurationAndRange(){var t;const{details:e,mediaSource:r}=this;if(!e||!this.media||"open"!==(null==r?void 0:r.readyState))return null;const i=e.edge;if(e.live&&this.hls.config.liveDurationInfinity){if(e.fragments.length&&r.setLiveSeekableRange){const t=Math.max(0,e.fragmentStart);return{duration:1/0,start:t,end:Math.max(t,i)}}return{duration:1/0}}const s=null==(t=this.overrides)?void 0:t.duration;if(s)return n(s)?{duration:s}:null;const o=this.media.duration;return i>(n(r.duration)?r.duration:0)&&i>o||!n(o)?{duration:i}:null}updateMediaSource({duration:t,start:e,end:r}){const i=this.mediaSource;this.media&&i&&"open"===i.readyState&&(i.duration!==t&&(n(t)&&this.log(`Updating MediaSource duration to ${t.toFixed(3)}`),i.duration=t),void 0!==e&&void 0!==r&&(this.log(`MediaSource duration is set to ${i.duration}. Setting seekable range to ${e}-${r}.`),i.setLiveSeekableRange(e,r)))}get tracksReady(){const t=this.pendingTrackCount;return t>0&&(t>=this.bufferCodecEventsTotal||this.isPending(this.tracks.audiovideo))}checkPendingTracks(){const{bufferCodecEventsTotal:t,pendingTrackCount:e,tracks:r}=this;if(this.log(`checkPendingTracks (pending: ${e} codec events expected: ${t}) ${Yt(r)}`),this.tracksReady){var n;const t=null==(n=this.transferData)?void 0:n.tracks;t&&Object.keys(t).length?this.attachTransferred():this.createSourceBuffers()}}bufferCreated(){if(this.sourceBufferCount){const t={};this.sourceBuffers.forEach((([e,r])=>{if(e){const n=this.tracks[e];t[e]={buffer:r,container:n.container,codec:n.codec,supplemental:n.supplemental,levelCodec:n.levelCodec,id:n.id,metadata:n.metadata}}})),this.hls.trigger(l.BUFFER_CREATED,{tracks:t}),this.log(`SourceBuffers created. Running queue: ${this.operationQueue}`),this.sourceBuffers.forEach((([t])=>{this.executeNext(t)}))}else{const t=new Error("could not create source buffer for media codec(s)");this.hls.trigger(l.ERROR,{type:o.MEDIA_ERROR,details:a.BUFFER_INCOMPATIBLE_CODECS_ERROR,fatal:!0,error:t,reason:t.message})}}createSourceBuffers(){const{tracks:t,sourceBuffers:e,mediaSource:r}=this;if(!r)throw new Error("createSourceBuffers called when mediaSource was null");for(const i in t){const s=i,c=t[s];if(this.isPending(c)){const t=this.getTrackCodec(c,s),i=`${c.container};codecs=${t}`;c.codec=t,this.log(`creating sourceBuffer(${i})${this.currentOp(s)?" Queued":""} ${Yt(c)}`);try{const t=r.addSourceBuffer(i),n=$i(s),o=[s,t];e[n]=o,c.buffer=t}catch(t){var n;return this.error(`error while trying to add sourceBuffer: ${t.message}`),this.shiftAndExecuteNext(s),null==(n=this.operationQueue)||n.removeBlockers(),delete this.tracks[s],void this.hls.trigger(l.ERROR,{type:o.MEDIA_ERROR,details:a.BUFFER_ADD_CODEC_ERROR,fatal:!1,error:t,sourceBufferName:s,mimeType:i,parent:c.id})}this.trackSourceBuffer(s,c)}}this.bufferCreated()}getTrackCodec(t,e){const r=t.supplemental;let n=t.codec;r&&("video"===e||"audiovideo"===e)&&vt(r,"video")&&(n=function(t,e){const r=[];if(t){const e=t.split(",");for(let t=0;t<e.length;t++)yt(e[t],"video")||r.push(e[t])}return e&&r.push(e),r.join(",")}(n,r));const i=_t(n,t.levelCodec);return i?"audio"===e.slice(0,5)?Lt(i,this.appendSource):i:""}trackSourceBuffer(t,e){const r=e.buffer;if(!r)return;const n=this.getTrackCodec(e,t);this.tracks[t]={buffer:r,codec:n,container:e.container,levelCodec:e.levelCodec,supplemental:e.supplemental,metadata:e.metadata,id:e.id,listeners:[]},this.removeBufferListeners(t),this.addBufferListener(t,"updatestart",this.onSBUpdateStart),this.addBufferListener(t,"updateend",this.onSBUpdateEnd),this.addBufferListener(t,"error",this.onSBUpdateError),this.appendSource&&this.addBufferListener(t,"bufferedchange",((t,e)=>{const r=e.removedRanges;null!=r&&r.length&&this.hls.trigger(l.BUFFER_FLUSHED,{type:t})}))}get mediaSrc(){var t,e;const r=(null==(t=this.media)||null==(e=t.querySelector)?void 0:e.call(t,"source"))||this.media;return null==r?void 0:r.src}onSBUpdateStart(t){const e=this.currentOp(t);e&&e.onStart()}onSBUpdateEnd(t){var e;if("closed"===(null==(e=this.mediaSource)?void 0:e.readyState))return void this.resetBuffer(t);const r=this.currentOp(t);r&&(r.onComplete(),this.shiftAndExecuteNext(t))}onSBUpdateError(t,e){var r;const n=new Error(`${t} SourceBuffer error. MediaSource readyState: ${null==(r=this.mediaSource)?void 0:r.readyState}`);this.error(`${n}`,e),this.hls.trigger(l.ERROR,{type:o.MEDIA_ERROR,details:a.BUFFER_APPENDING_ERROR,sourceBufferName:t,error:n,fatal:!1});const i=this.currentOp(t);i&&i.onError(n)}updateTimestampOffset(t,e,r,n,i,s){const o=e-t.timestampOffset;Math.abs(o)>=r&&(this.log(`Updating ${n} SourceBuffer timestampOffset to ${e} (sn: ${i} cc: ${s})`),t.timestampOffset=e)}removeExecutor(t,e,r){const{media:i,mediaSource:s}=this,o=this.tracks[t],a=null==o?void 0:o.buffer;if(!i||!s||!a)return this.warn(`Attempting to remove from the ${t} SourceBuffer, but it does not exist`),void this.shiftAndExecuteNext(t);const l=n(i.duration)?i.duration:1/0,c=n(s.duration)?s.duration:1/0,u=Math.max(0,e),h=Math.min(r,l,c);h>u&&(!o.ending||o.ended)?(o.ended=!1,this.log(`Removing [${u},${h}] from the ${t} SourceBuffer`),a.remove(u,h)):this.shiftAndExecuteNext(t)}appendExecutor(t,e){const r=this.tracks[e],n=null==r?void 0:r.buffer;if(!n)throw new Ui(`Attempting to append to the ${e} SourceBuffer, but it does not exist`);r.ending=!1,r.ended=!1,n.appendBuffer(t)}blockUntilOpen(t){if(this.isUpdating()||this.isQueued())this.blockBuffers(t).catch((t=>{this.warn(`SourceBuffer blocked callback ${t}`),this.stepOperationQueue(this.sourceBufferTypes)}));else try{t()}catch(t){this.warn(`Callback run without blocking ${this.operationQueue} ${t}`)}}isUpdating(){return this.sourceBuffers.some((([t,e])=>t&&e.updating))}isQueued(){return this.sourceBuffers.some((([t])=>t&&!!this.currentOp(t)))}isPending(t){return!!t&&!t.buffer}blockBuffers(t,e=this.sourceBufferTypes){if(!e.length)return this.log("Blocking operation requested, but no SourceBuffers exist"),Promise.resolve().then(t);const{operationQueue:r}=this,n=e.map((t=>this.appendBlocker(t)));return e.length>1&&!!this.blockedAudioAppend&&this.unblockAudio(),Promise.all(n).then((e=>{r===this.operationQueue&&(t(),this.stepOperationQueue(this.sourceBufferTypes))}))}stepOperationQueue(t){t.forEach((t=>{var e;const r=null==(e=this.tracks[t])?void 0:e.buffer;r&&!r.updating&&this.shiftAndExecuteNext(t)}))}append(t,e,r){this.operationQueue&&this.operationQueue.append(t,e,r)}appendBlocker(t){if(this.operationQueue)return this.operationQueue.appendBlocker(t)}currentOp(t){return this.operationQueue?this.operationQueue.current(t):null}executeNext(t){t&&this.operationQueue&&this.operationQueue.executeNext(t)}shiftAndExecuteNext(t){this.operationQueue&&this.operationQueue.shiftAndExecuteNext(t)}get pendingTrackCount(){return Object.keys(this.tracks).reduce(((t,e)=>t+(this.isPending(this.tracks[e])?1:0)),0)}get sourceBufferCount(){return this.sourceBuffers.reduce(((t,[e])=>t+(e?1:0)),0)}get sourceBufferTypes(){return this.sourceBuffers.map((([t])=>t)).filter((t=>!!t))}addBufferListener(t,e,r){const n=this.tracks[t];if(!n)return;const i=n.buffer;if(!i)return;const s=r.bind(this,t);n.listeners.push({event:e,listener:s}),i.addEventListener(e,s)}removeBufferListeners(t){const e=this.tracks[t];if(!e)return;const r=e.buffer;r&&(e.listeners.forEach((t=>{r.removeEventListener(t.event,t.listener)})),e.listeners.length=0)}},capLevelController:ji,errorController:class extends y{constructor(t){super("error-controller",t.logger),this.hls=void 0,this.playlistError=0,this.hls=t,this.registerListeners()}registerListeners(){const t=this.hls;t.on(l.ERROR,this.onError,this),t.on(l.MANIFEST_LOADING,this.onManifestLoading,this),t.on(l.LEVEL_UPDATED,this.onLevelUpdated,this)}unregisterListeners(){const t=this.hls;t&&(t.off(l.ERROR,this.onError,this),t.off(l.ERROR,this.onErrorOut,this),t.off(l.MANIFEST_LOADING,this.onManifestLoading,this),t.off(l.LEVEL_UPDATED,this.onLevelUpdated,this))}destroy(){this.unregisterListeners(),this.hls=null}startLoad(t){}stopLoad(){this.playlistError=0}getVariantLevelIndex(t){return(null==t?void 0:t.type)===u.MAIN?t.level:this.getVariantIndex()}getVariantIndex(){var t;const e=this.hls,r=e.currentLevel;return null!=(t=e.loadLevelObj)&&t.details||-1===r?e.loadLevel:r}variantHasKey(t,e){if(t){var r;if(null!=(r=t.details)&&r.hasKey(e))return!0;const n=t.audioGroups;if(n){return this.hls.allAudioTracks.filter((t=>n.indexOf(t.groupId)>=0)).some((t=>{var r;return null==(r=t.details)?void 0:r.hasKey(e)}))}}return!1}onManifestLoading(){this.playlistError=0}onLevelUpdated(){this.playlistError=0}onError(t,e){var r;if(e.fatal)return;const n=this.hls,i=e.context;switch(e.details){case a.FRAG_LOAD_ERROR:case a.FRAG_LOAD_TIMEOUT:case a.KEY_LOAD_ERROR:case a.KEY_LOAD_TIMEOUT:return void(e.errorAction=this.getFragRetryOrSwitchAction(e));case a.FRAG_PARSING_ERROR:if(null!=(r=e.frag)&&r.gap)return void(e.errorAction=pe());case a.FRAG_GAP:case a.FRAG_DECRYPT_ERROR:return e.errorAction=this.getFragRetryOrSwitchAction(e),void(e.errorAction.action=de.SendAlternateToPenaltyBox);case a.LEVEL_EMPTY_ERROR:case a.LEVEL_PARSING_ERROR:{var s;const t=e.parent===u.MAIN?e.level:n.loadLevel;e.details===a.LEVEL_EMPTY_ERROR&&null!=(s=e.context)&&null!=(s=s.levelDetails)&&s.live?e.errorAction=this.getPlaylistRetryOrSwitchAction(e,t):(e.levelRetry=!1,e.errorAction=this.getLevelSwitchAction(e,t))}return;case a.LEVEL_LOAD_ERROR:case a.LEVEL_LOAD_TIMEOUT:return void("number"==typeof(null==i?void 0:i.level)&&(e.errorAction=this.getPlaylistRetryOrSwitchAction(e,i.level)));case a.AUDIO_TRACK_LOAD_ERROR:case a.AUDIO_TRACK_LOAD_TIMEOUT:case a.SUBTITLE_LOAD_ERROR:case a.SUBTITLE_TRACK_LOAD_TIMEOUT:if(i){const t=n.loadLevelObj;if(t&&(i.type===c.AUDIO_TRACK&&t.hasAudioGroup(i.groupId)||i.type===c.SUBTITLE_TRACK&&t.hasSubtitleGroup(i.groupId)))return e.errorAction=this.getPlaylistRetryOrSwitchAction(e,n.loadLevel),e.errorAction.action=de.SendAlternateToPenaltyBox,void(e.errorAction.flags=fe.MoveAllAlternatesMatchingHost)}return;case a.KEY_SYSTEM_STATUS_OUTPUT_RESTRICTED:return void(e.errorAction={action:de.SendAlternateToPenaltyBox,flags:fe.MoveAllAlternatesMatchingHDCP});case a.KEY_SYSTEM_SESSION_UPDATE_FAILED:case a.KEY_SYSTEM_STATUS_INTERNAL_ERROR:case a.KEY_SYSTEM_NO_SESSION:return void(e.errorAction={action:de.SendAlternateToPenaltyBox,flags:fe.MoveAllAlternatesMatchingKey});case a.BUFFER_ADD_CODEC_ERROR:case a.REMUX_ALLOC_ERROR:case a.BUFFER_APPEND_ERROR:var l;if(!e.errorAction)e.errorAction=this.getLevelSwitchAction(e,null!=(l=e.level)?l:n.loadLevel);return;case a.INTERNAL_EXCEPTION:case a.BUFFER_APPENDING_ERROR:case a.BUFFER_FULL_ERROR:case a.LEVEL_SWITCH_ERROR:case a.BUFFER_STALLED_ERROR:case a.BUFFER_SEEK_OVER_HOLE:case a.BUFFER_NUDGE_ON_STALL:return void(e.errorAction=pe())}e.type===o.KEY_SYSTEM_ERROR&&(e.levelRetry=!1,e.errorAction=pe())}getPlaylistRetryOrSwitchAction(t,e){const r=ae(this.hls.config.playlistLoadPolicy,t),n=this.playlistError++;if(ue(r,n,oe(t),t.response))return{action:de.RetryRequest,flags:fe.None,retryConfig:r,retryCount:n};const i=this.getLevelSwitchAction(t,e);return r&&(i.retryConfig=r,i.retryCount=n),i}getFragRetryOrSwitchAction(t){const e=this.hls,r=this.getVariantLevelIndex(t.frag),n=e.levels[r],{fragLoadPolicy:i,keyLoadPolicy:s}=e.config,o=ae(t.details.startsWith("key")?s:i,t),l=e.levels.reduce(((t,e)=>t+e.fragmentError),0);if(n){t.details!==a.FRAG_GAP&&n.fragmentError++;if(ue(o,l,oe(t),t.response))return{action:de.RetryRequest,flags:fe.None,retryConfig:o,retryCount:l}}const c=this.getLevelSwitchAction(t,r);return o&&(c.retryConfig=o,c.retryCount=l),c}getLevelSwitchAction(t,e){const r=this.hls;null==e&&(e=r.loadLevel);const n=this.hls.levels[e];if(n){var i,s;const e=t.details;n.loadError++,e===a.BUFFER_APPEND_ERROR&&n.fragmentError++;let h=-1;const{levels:d,loadLevel:f,minAutoLevel:p,maxAutoLevel:g}=r;r.autoLevelEnabled||r.config.preserveManualLevelOnError||(r.loadLevel=-1);const m=null==(i=t.frag)?void 0:i.type,y=(m===u.AUDIO&&e===a.FRAG_PARSING_ERROR||"audio"===t.sourceBufferName&&(e===a.BUFFER_ADD_CODEC_ERROR||e===a.BUFFER_APPEND_ERROR))&&d.some((({audioCodec:t})=>n.audioCodec!==t)),v="video"===t.sourceBufferName&&(e===a.BUFFER_ADD_CODEC_ERROR||e===a.BUFFER_APPEND_ERROR)&&d.some((({codecSet:t,audioCodec:e})=>n.codecSet!==t&&n.audioCodec===e)),{type:b,groupId:E}=null!=(s=t.context)?s:{};for(let r=d.length;r--;){const i=(r+f)%d.length;if(i!==f&&i>=p&&i<=g&&0===d[i].loadError){var o,l;const r=d[i];if(e===a.FRAG_GAP&&m===u.MAIN&&t.frag){const e=d[i].details;if(e){const r=re(t.frag,e.fragments,t.frag.start);if(null!=r&&r.gap)continue}}else{if(b===c.AUDIO_TRACK&&r.hasAudioGroup(E)||b===c.SUBTITLE_TRACK&&r.hasSubtitleGroup(E))continue;if(m===u.AUDIO&&null!=(o=n.audioGroups)&&o.some((t=>r.hasAudioGroup(t)))||m===u.SUBTITLE&&null!=(l=n.subtitleGroups)&&l.some((t=>r.hasSubtitleGroup(t)))||y&&n.audioCodec===r.audioCodec||v&&n.codecSet===r.codecSet||!y&&n.codecSet!==r.codecSet)continue}h=i;break}}if(h>-1&&r.loadLevel!==h)return t.levelRetry=!0,this.playlistError=0,{action:de.SendAlternateToPenaltyBox,flags:fe.None,nextAutoLevel:h}}return{action:de.SendAlternateToPenaltyBox,flags:fe.MoveAllAlternatesMatchingHost}}onErrorOut(t,e){var r;switch(null==(r=e.errorAction)?void 0:r.action){case de.DoNothing:break;case de.SendAlternateToPenaltyBox:this.sendAlternateToPenaltyBox(e),e.errorAction.resolved||e.details===a.FRAG_GAP?/MediaSource readyState: ended/.test(e.error.message)&&(this.warn(`MediaSource ended after "${e.sourceBufferName}" sourceBuffer append error. Attempting to recover from media error.`),this.hls.recoverMediaError()):e.fatal=!0;case de.RetryRequest:}e.fatal&&this.hls.stopLoad()}sendAlternateToPenaltyBox(t){const e=this.hls,r=t.errorAction;if(!r)return;const{flags:n}=r,i=r.nextAutoLevel;switch(n){case fe.None:this.switchLevel(t,i);break;case fe.MoveAllAlternatesMatchingHDCP:{const n=this.getVariantLevelIndex(t.frag),i=e.levels[n],s=null==i?void 0:i.attrs["HDCP-LEVEL"];if(r.hdcpLevel=s,s){e.maxHdcpLevel=Ut[Ut.indexOf(s)-1],r.resolved=!0,this.warn(`Restricting playback to HDCP-LEVEL of "${e.maxHdcpLevel}" or lower`);break}}case fe.MoveAllAlternatesMatchingKey:{const e=t.decryptdata;if(e){const n=this.hls.levels;for(let r=n.length;r--;){var s,o;if(this.variantHasKey(n[r],e))this.log(`Banned key found in level ${r} (${n[r].bitrate}bps) or audio group "${null==(s=n[r].audioGroups)?void 0:s.join(",")}" (${null==(o=t.frag)?void 0:o.type} fragment) ${x(e.keyId||[])}`),n[r].fragmentError++,n[r].loadError++,this.log(`Removing level ${r} with key error (${t.error})`),this.hls.removeLevel(r)}n.length&&(r.resolved=!0)}break}}r.resolved||this.switchLevel(t,i)}switchLevel(t,e){if(void 0!==e&&t.errorAction&&(this.warn(`switching to level ${e} after ${t.details}`),this.hls.nextAutoLevel=e,t.errorAction.resolved=!0,this.hls.nextLoadLevel=this.hls.nextAutoLevel,t.details===a.BUFFER_ADD_CODEC_ERROR&&t.mimeType&&"audiovideo"!==t.sourceBufferName)){const e=It(t.mimeType),r=this.hls.levels;for(let n=r.length;n--;)r[n][`${t.sourceBufferName}Codec`]===e&&(this.log(`Removing level ${n} for ${t.details} ("${e}" not supported)`),this.hls.removeLevel(n))}}},fpsController:class{constructor(t){this.hls=void 0,this.isVideoPlaybackQualityAvailable=!1,this.timer=void 0,this.media=null,this.lastTime=void 0,this.lastDroppedFrames=0,this.lastDecodedFrames=0,this.streamController=void 0,this.hls=t,this.registerListeners()}setStreamController(t){this.streamController=t}registerListeners(){this.hls.on(l.MEDIA_ATTACHING,this.onMediaAttaching,this),this.hls.on(l.MEDIA_DETACHING,this.onMediaDetaching,this)}unregisterListeners(){this.hls.off(l.MEDIA_ATTACHING,this.onMediaAttaching,this),this.hls.off(l.MEDIA_DETACHING,this.onMediaDetaching,this)}destroy(){this.timer&&clearInterval(this.timer),this.unregisterListeners(),this.isVideoPlaybackQualityAvailable=!1,this.media=null}onMediaAttaching(t,e){const r=this.hls.config;if(r.capLevelOnFPSDrop){const t=e.media instanceof self.HTMLVideoElement?e.media:null;this.media=t,t&&"function"==typeof t.getVideoPlaybackQuality&&(this.isVideoPlaybackQualityAvailable=!0),self.clearInterval(this.timer),this.timer=self.setInterval(this.checkFPSInterval.bind(this),r.fpsDroppedMonitoringPeriod)}}onMediaDetaching(){this.media=null}checkFPS(t,e,r){const n=performance.now();if(e){if(this.lastTime){const t=n-this.lastTime,i=r-this.lastDroppedFrames,s=e-this.lastDecodedFrames,o=1e3*i/t,a=this.hls;if(a.trigger(l.FPS_DROP,{currentDropped:i,currentDecoded:s,totalDroppedFrames:r}),o>0&&i>a.config.fpsDroppedMonitoringThreshold*s){let t=a.currentLevel;a.logger.warn("drop FPS ratio greater than max allowed value for currentLevel: "+t),t>0&&(-1===a.autoLevelCapping||a.autoLevelCapping>=t)&&(t-=1,a.trigger(l.FPS_DROP_LEVEL_CAPPING,{level:t,droppedLevel:a.currentLevel}),a.autoLevelCapping=t,this.streamController.nextLevelSwitch())}}this.lastTime=n,this.lastDroppedFrames=r,this.lastDecodedFrames=e}}checkFPSInterval(){const t=this.media;if(t)if(this.isVideoPlaybackQualityAvailable){const e=t.getVideoPlaybackQuality();this.checkFPS(t,e.totalVideoFrames,e.droppedVideoFrames)}else this.checkFPS(t,t.webkitDecodedFrameCount,t.webkitDroppedFrameCount)}},stretchShortVideoTrack:!1,maxAudioFramesDrift:1,forceKeyFrameOnDiscontinuity:!0,abrEwmaFastLive:3,abrEwmaSlowLive:9,abrEwmaFastVoD:3,abrEwmaSlowVoD:9,abrEwmaDefaultEstimate:5e5,abrEwmaDefaultEstimateMax:5e6,abrBandWidthFactor:.95,abrBandWidthUpFactor:.7,abrMaxWithRealBitrate:!1,maxStarvationDelay:4,maxLoadingDelay:4,minAutoBitrate:0,emeEnabled:!1,widevineLicenseUrl:void 0,drmSystems:{},drmSystemOptions:{},requestMediaKeySystemAccessFunc:ar,requireKeySystemAccessOnStart:!1,testBandwidth:!0,progressive:!1,lowLatencyMode:!0,cmcd:void 0,enableDateRangeMetadataCues:!0,enableEmsgMetadataCues:!0,enableEmsgKLVMetadata:!1,enableID3MetadataCues:!0,enableInterstitialPlayback:!0,interstitialAppendInPlace:!0,interstitialLiveLookAhead:10,useMediaCapabilities:!0,preserveManualLevelOnError:!1,certLoadPolicy:{default:{maxTimeToFirstByteMs:8e3,maxLoadTimeMs:2e4,timeoutRetry:null,errorRetry:null}},keyLoadPolicy:{default:{maxTimeToFirstByteMs:8e3,maxLoadTimeMs:2e4,timeoutRetry:{maxNumRetry:1,retryDelayMs:1e3,maxRetryDelayMs:2e4,backoff:"linear"},errorRetry:{maxNumRetry:8,retryDelayMs:1e3,maxRetryDelayMs:2e4,backoff:"linear"}}},manifestLoadPolicy:{default:{maxTimeToFirstByteMs:1/0,maxLoadTimeMs:2e4,timeoutRetry:{maxNumRetry:2,retryDelayMs:0,maxRetryDelayMs:0},errorRetry:{maxNumRetry:1,retryDelayMs:1e3,maxRetryDelayMs:8e3}}},playlistLoadPolicy:{default:{maxTimeToFirstByteMs:1e4,maxLoadTimeMs:2e4,timeoutRetry:{maxNumRetry:2,retryDelayMs:0,maxRetryDelayMs:0},errorRetry:{maxNumRetry:2,retryDelayMs:1e3,maxRetryDelayMs:8e3}}},fragLoadPolicy:{default:{maxTimeToFirstByteMs:1e4,maxLoadTimeMs:12e4,timeoutRetry:{maxNumRetry:4,retryDelayMs:0,maxRetryDelayMs:0},errorRetry:{maxNumRetry:6,retryDelayMs:1e3,maxRetryDelayMs:8e3}}},steeringManifestLoadPolicy:{default:{maxTimeToFirstByteMs:1e4,maxLoadTimeMs:2e4,timeoutRetry:{maxNumRetry:2,retryDelayMs:0,maxRetryDelayMs:0},errorRetry:{maxNumRetry:1,retryDelayMs:1e3,maxRetryDelayMs:8e3}}},interstitialAssetListLoadPolicy:{default:{maxTimeToFirstByteMs:1e4,maxLoadTimeMs:3e4,timeoutRetry:{maxNumRetry:0,retryDelayMs:0,maxRetryDelayMs:0},errorRetry:{maxNumRetry:0,retryDelayMs:1e3,maxRetryDelayMs:8e3}}},manifestLoadingTimeOut:1e4,manifestLoadingMaxRetry:1,manifestLoadingRetryDelay:1e3,manifestLoadingMaxRetryTimeout:64e3,levelLoadingTimeOut:1e4,levelLoadingMaxRetry:4,levelLoadingRetryDelay:1e3,levelLoadingMaxRetryTimeout:64e3,fragLoadingTimeOut:2e4,fragLoadingMaxRetry:6,fragLoadingRetryDelay:1e3,fragLoadingMaxRetryTimeout:64e3},{cueHandler:fa,enableWebVTT:!0,enableIMSC1:!0,enableCEA708Captions:!0,captionsTextTrack1Label:"English",captionsTextTrack1LanguageCode:"en",captionsTextTrack2Label:"Spanish",captionsTextTrack2LanguageCode:"es",captionsTextTrack3Label:"Unknown CC",captionsTextTrack3LanguageCode:"",captionsTextTrack4Label:"Unknown CC",captionsTextTrack4LanguageCode:"",renderTextTracksNatively:!0}),{},{subtitleStreamController:class extends Xr{constructor(t,e,r){super(t,e,r,"subtitle-stream-controller",u.SUBTITLE),this.currentTrackId=-1,this.tracksBuffered=[],this.mainDetails=null,this.registerListeners()}onHandlerDestroying(){this.unregisterListeners(),super.onHandlerDestroying(),this.mainDetails=null}registerListeners(){super.registerListeners();const{hls:t}=this;t.on(l.LEVEL_LOADED,this.onLevelLoaded,this),t.on(l.SUBTITLE_TRACKS_UPDATED,this.onSubtitleTracksUpdated,this),t.on(l.SUBTITLE_TRACK_SWITCH,this.onSubtitleTrackSwitch,this),t.on(l.SUBTITLE_TRACK_LOADED,this.onSubtitleTrackLoaded,this),t.on(l.SUBTITLE_FRAG_PROCESSED,this.onSubtitleFragProcessed,this),t.on(l.BUFFER_FLUSHING,this.onBufferFlushing,this)}unregisterListeners(){super.unregisterListeners();const{hls:t}=this;t.off(l.LEVEL_LOADED,this.onLevelLoaded,this),t.off(l.SUBTITLE_TRACKS_UPDATED,this.onSubtitleTracksUpdated,this),t.off(l.SUBTITLE_TRACK_SWITCH,this.onSubtitleTrackSwitch,this),t.off(l.SUBTITLE_TRACK_LOADED,this.onSubtitleTrackLoaded,this),t.off(l.SUBTITLE_FRAG_PROCESSED,this.onSubtitleFragProcessed,this),t.off(l.BUFFER_FLUSHING,this.onBufferFlushing,this)}startLoad(t,e){this.stopLoad(),this.state=zr.IDLE,this.setInterval(500),this.nextLoadPosition=this.lastCurrentTime=t+this.timelineOffset,this.startPosition=e?-1:t,this.tick()}onManifestLoading(){super.onManifestLoading(),this.mainDetails=null}onMediaDetaching(t,e){this.tracksBuffered=[],super.onMediaDetaching(t,e)}onLevelLoaded(t,e){this.mainDetails=e.details}onSubtitleFragProcessed(t,e){const{frag:r,success:n}=e;if(this.fragContextChanged(r)||(j(r)&&(this.fragPrevious=r),this.state=zr.IDLE),!n)return;const i=this.tracksBuffered[this.currentTrackId];if(!i)return;let s;const o=r.start;for(let t=0;t<i.length;t++)if(o>=i[t].start&&o<=i[t].end){s=i[t];break}const a=r.start+r.duration;s?s.end=a:(s={start:o,end:a},i.push(s)),this.fragmentTracker.fragBuffered(r),this.fragBufferedComplete(r,null),this.media&&this.tick()}onBufferFlushing(t,e){const{startOffset:r,endOffset:n}=e;if(0===r&&n!==Number.POSITIVE_INFINITY){const t=n-1;if(t<=0)return;e.endOffsetSubtitles=Math.max(0,t),this.tracksBuffered.forEach((e=>{for(let r=0;r<e.length;)if(e[r].end<=t)e.shift();else{if(!(e[r].start<t))break;e[r].start=t,r++}})),this.fragmentTracker.removeFragmentsInRange(r,t,u.SUBTITLE)}}onError(t,e){const r=e.frag;(null==r?void 0:r.type)===u.SUBTITLE&&(e.details===a.FRAG_GAP&&this.fragmentTracker.fragBuffered(r,!0),this.fragCurrent&&this.fragCurrent.abortRequests(),this.state!==zr.STOPPED&&(this.state=zr.IDLE))}onSubtitleTracksUpdated(t,{subtitleTracks:e}){this.levels&&Oi(this.levels,e)?this.levels=e.map((t=>new Ht(t))):(this.tracksBuffered=[],this.levels=e.map((t=>{const e=new Ht(t);return this.tracksBuffered[e.id]=[],e})),this.fragmentTracker.removeFragmentsInRange(0,Number.POSITIVE_INFINITY,u.SUBTITLE),this.fragPrevious=null,this.mediaBuffer=null)}onSubtitleTrackSwitch(t,e){var r;if(this.currentTrackId=e.id,null==(r=this.levels)||!r.length||-1===this.currentTrackId)return void this.clearInterval();const n=this.levels[this.currentTrackId];null!=n&&n.details?this.mediaBuffer=this.mediaBufferTimeRanges:this.mediaBuffer=null,n&&this.state!==zr.STOPPED&&this.setInterval(500)}onSubtitleTrackLoaded(t,e){var r;const{currentTrackId:n,levels:i}=this,{details:s,id:o}=e;if(!i)return void this.warn(`Subtitle tracks were reset while loading level ${o}`);const a=i[o];if(o>=i.length||!a)return;this.log(`Subtitle track ${o} loaded [${s.startSN},${s.endSN}]${s.lastPartSn?`[part-${s.lastPartSn}-${s.lastPartIndex}]`:""},duration:${s.totalduration}`),this.mediaBuffer=this.mediaBufferTimeRanges;let c=0;if(s.live||null!=(r=a.details)&&r.live){if(s.deltaUpdateFailed)return;const t=this.mainDetails;if(!t)return void(this.startFragRequested=!1);const e=t.fragments[0];var u;if(a.details)c=this.alignPlaylists(s,a.details,null==(u=this.levelLastLoaded)?void 0:u.details),0===c&&e&&(c=e.start,Dr(s,c));else s.hasProgramDateTime&&t.hasProgramDateTime?(Kr(s,t),c=s.fragmentStart):e&&(c=e.start,Dr(s,c));t&&!this.startFragRequested&&this.setStartPosition(t,c)}if(a.details=s,this.levelLastLoaded=a,o===n&&(this.hls.trigger(l.SUBTITLE_TRACK_UPDATED,{details:s,id:o,groupId:e.groupId}),this.tick(),s.live&&!this.fragCurrent&&this.media&&this.state===zr.IDLE)){re(null,s.fragments,this.media.currentTime,0)||(this.warn("Subtitle playlist not aligned with playback"),a.details=void 0)}}_handleFragmentLoadComplete(t){const{frag:e,payload:r}=t,n=e.decryptdata,i=this.hls;if(!this.fragContextChanged(e)&&r&&r.byteLength>0&&null!=n&&n.key&&n.iv&&Xe(n.method)){const t=performance.now();this.decrypter.decrypt(new Uint8Array(r),n.key.buffer,n.iv.buffer,Qe(n.method)).catch((t=>{throw i.trigger(l.ERROR,{type:o.MEDIA_ERROR,details:a.FRAG_DECRYPT_ERROR,fatal:!1,error:t,reason:t.message,frag:e}),t})).then((r=>{const n=performance.now();i.trigger(l.FRAG_DECRYPTED,{frag:e,payload:r,stats:{tstart:t,tdecrypt:n}})})).catch((t=>{this.warn(`${t.name}: ${t.message}`),this.state=zr.IDLE}))}}doTick(){if(this.media){if(this.state===zr.IDLE){const{currentTrackId:t,levels:e}=this,r=null==e?void 0:e[t];if(!r||!e.length||!r.details)return;if(this.waitForLive(r))return;const{config:n}=this,i=this.getLoadPosition(),s=Ne.bufferedInfo(this.tracksBuffered[this.currentTrackId]||[],i,n.maxBufferHole),{end:o,len:a}=s,l=r.details;if(a>this.hls.maxBufferLength+l.levelTargetDuration)return;const c=l.fragments,u=c.length,h=l.edge;let d=null;const f=this.fragPrevious;if(o<h){const t=n.maxFragLookUpTolerance,e=o>h-t?0:t;d=re(f,c,Math.max(c[0].start,o),e),!d&&f&&f.start<c[0].start&&(d=c[0])}else d=c[u-1];if(d=this.filterReplacedPrimary(d,r.details),!d)return;const p=c[d.sn-l.startSN-1];if(p&&p.cc===d.cc&&this.fragmentTracker.getState(p)===ge&&(d=p),this.fragmentTracker.getState(d)===ge){const t=this.mapToInitFragWhenRequired(d);t&&this.loadFragment(t,r,o)}}}else this.state=zr.IDLE}loadFragment(t,e,r){j(t)?super.loadFragment(t,e,r):this._loadInitSegment(t,e)}get mediaBufferTimeRanges(){return new mo(this.tracksBuffered[this.currentTrackId]||[])}},subtitleTrackController:class extends Ri{constructor(t){super(t,"subtitle-track-controller"),this.media=null,this.tracks=[],this.groupIds=null,this.tracksInGroup=[],this.trackId=-1,this.currentTrack=null,this.selectDefaultTrack=!0,this.queuedDefaultTrack=-1,this.useTextTrackPolling=!1,this.subtitlePollingInterval=-1,this._subtitleDisplay=!0,this.asyncPollTrackChange=()=>this.pollTrackChange(0),this.onTextTracksChanged=()=>{if(this.useTextTrackPolling||self.clearInterval(this.subtitlePollingInterval),!this.media||!this.hls.config.renderTextTracksNatively)return;let t=null;const e=Zs(this.media.textTracks);for(let r=0;r<e.length;r++)if("hidden"===e[r].mode)t=e[r];else if("showing"===e[r].mode){t=e[r];break}const r=this.findTrackForTextTrack(t);this.subtitleTrack!==r&&this.setSubtitleTrack(r)},this.registerListeners()}destroy(){this.unregisterListeners(),this.tracks.length=0,this.tracksInGroup.length=0,this.currentTrack=null,this.onTextTracksChanged=this.asyncPollTrackChange=null,super.destroy()}get subtitleDisplay(){return this._subtitleDisplay}set subtitleDisplay(t){this._subtitleDisplay=t,this.trackId>-1&&this.toggleTrackModes()}registerListeners(){const{hls:t}=this;t.on(l.MEDIA_ATTACHED,this.onMediaAttached,this),t.on(l.MEDIA_DETACHING,this.onMediaDetaching,this),t.on(l.MANIFEST_LOADING,this.onManifestLoading,this),t.on(l.MANIFEST_PARSED,this.onManifestParsed,this),t.on(l.LEVEL_LOADING,this.onLevelLoading,this),t.on(l.LEVEL_SWITCHING,this.onLevelSwitching,this),t.on(l.SUBTITLE_TRACK_LOADED,this.onSubtitleTrackLoaded,this),t.on(l.ERROR,this.onError,this)}unregisterListeners(){const{hls:t}=this;t.off(l.MEDIA_ATTACHED,this.onMediaAttached,this),t.off(l.MEDIA_DETACHING,this.onMediaDetaching,this),t.off(l.MANIFEST_LOADING,this.onManifestLoading,this),t.off(l.MANIFEST_PARSED,this.onManifestParsed,this),t.off(l.LEVEL_LOADING,this.onLevelLoading,this),t.off(l.LEVEL_SWITCHING,this.onLevelSwitching,this),t.off(l.SUBTITLE_TRACK_LOADED,this.onSubtitleTrackLoaded,this),t.off(l.ERROR,this.onError,this)}onMediaAttached(t,e){this.media=e.media,this.media&&(this.queuedDefaultTrack>-1&&(this.subtitleTrack=this.queuedDefaultTrack,this.queuedDefaultTrack=-1),this.useTextTrackPolling=!(this.media.textTracks&&"onchange"in this.media.textTracks),this.useTextTrackPolling?this.pollTrackChange(500):this.media.textTracks.addEventListener("change",this.asyncPollTrackChange))}pollTrackChange(t){self.clearInterval(this.subtitlePollingInterval),this.subtitlePollingInterval=self.setInterval(this.onTextTracksChanged,t)}onMediaDetaching(t,e){const r=this.media;if(!r)return;const n=!!e.transferMedia;if(self.clearInterval(this.subtitlePollingInterval),this.useTextTrackPolling||r.textTracks.removeEventListener("change",this.asyncPollTrackChange),this.trackId>-1&&(this.queuedDefaultTrack=this.trackId),this.subtitleTrack=-1,this.media=null,n)return;Zs(r.textTracks).forEach((t=>{Qs(t)}))}onManifestLoading(){this.tracks=[],this.groupIds=null,this.tracksInGroup=[],this.trackId=-1,this.currentTrack=null,this.selectDefaultTrack=!0}onManifestParsed(t,e){this.tracks=e.subtitleTracks}onSubtitleTrackLoaded(t,e){const{id:r,groupId:n,details:i}=e,s=this.tracksInGroup[r];if(!s||s.groupId!==n)return void this.warn(`Subtitle track with id:${r} and group:${n} not found in active group ${null==s?void 0:s.groupId}`);const o=s.details;s.details=e.details,this.log(`Subtitle track ${r} "${s.name}" lang:${s.lang} group:${n} loaded [${i.startSN}-${i.endSN}]`),r===this.trackId&&this.playlistLoaded(r,e,o)}onLevelLoading(t,e){this.switchLevel(e.level)}onLevelSwitching(t,e){this.switchLevel(e.level)}switchLevel(t){const e=this.hls.levels[t];if(!e)return;const r=e.subtitleGroups||null,n=this.groupIds;let i=this.currentTrack;if(!r||(null==n?void 0:n.length)!==(null==r?void 0:r.length)||null!=r&&r.some((t=>-1===(null==n?void 0:n.indexOf(t))))){this.groupIds=r,this.trackId=-1,this.currentTrack=null;const t=this.tracks.filter((t=>!r||-1!==r.indexOf(t.groupId)));if(t.length)this.selectDefaultTrack&&!t.some((t=>t.default))&&(this.selectDefaultTrack=!1),t.forEach(((t,e)=>{t.id=e}));else if(!i&&!this.tracksInGroup.length)return;this.tracksInGroup=t;const e=this.hls.config.subtitlePreference;if(!i&&e){this.selectDefaultTrack=!1;const r=Xt(e,t);if(r>-1)i=t[r];else{const t=Xt(e,this.tracks);i=this.tracks[t]}}let n=this.findTrackId(i);-1===n&&i&&(n=this.findTrackId(null));const s={subtitleTracks:t};this.log(`Updating subtitle tracks, ${t.length} track(s) found in "${null==r?void 0:r.join(",")}" group-id`),this.hls.trigger(l.SUBTITLE_TRACKS_UPDATED,s),-1!==n&&-1===this.trackId&&this.setSubtitleTrack(n)}}findTrackId(t){const e=this.tracksInGroup,r=this.selectDefaultTrack;for(let n=0;n<e.length;n++){const i=e[n];if((!r||i.default)&&(r||t)&&(!t||Qt(i,t)))return n}if(t){for(let r=0;r<e.length;r++){const n=e[r];if(Di(t.attrs,n.attrs,["LANGUAGE","ASSOC-LANGUAGE","CHARACTERISTICS"]))return r}for(let r=0;r<e.length;r++){const n=e[r];if(Di(t.attrs,n.attrs,["LANGUAGE"]))return r}}return-1}findTrackForTextTrack(t){if(t){const e=this.tracksInGroup;for(let r=0;r<e.length;r++){if(Ci(e[r],t))return r}}return-1}onError(t,e){!e.fatal&&e.context&&(e.context.type!==c.SUBTITLE_TRACK||e.context.id!==this.trackId||this.groupIds&&-1===this.groupIds.indexOf(e.context.groupId)||this.checkRetry(e))}get allSubtitleTracks(){return this.tracks}get subtitleTracks(){return this.tracksInGroup}get subtitleTrack(){return this.trackId}set subtitleTrack(t){this.selectDefaultTrack=!1,this.setSubtitleTrack(t)}setSubtitleOption(t){if(this.hls.config.subtitlePreference=t,t){if(-1===t.id)return this.setSubtitleTrack(-1),null;const e=this.allSubtitleTracks;if(this.selectDefaultTrack=!1,e.length){const r=this.currentTrack;if(r&&Qt(t,r))return r;const n=Xt(t,this.tracksInGroup);if(n>-1){const t=this.tracksInGroup[n];return this.setSubtitleTrack(n),t}if(r)return null;{const r=Xt(t,e);if(r>-1)return e[r]}}}return null}loadPlaylist(t){super.loadPlaylist(),this.shouldLoadPlaylist(this.currentTrack)&&this.scheduleLoading(this.currentTrack,t)}loadingPlaylist(t,e){super.loadingPlaylist(t,e);const r=t.id,n=t.groupId,i=this.getUrlWithDirectives(t.url,e),s=t.details,o=null==s?void 0:s.age;this.log(`Loading subtitle ${r} "${t.name}" lang:${t.lang} group:${n}${void 0!==(null==e?void 0:e.msn)?" at sn "+e.msn+" part "+e.part:""}${o&&s.live?" age "+o.toFixed(1)+(s.type?" "+s.type||0:""):""} ${i}`),this.hls.trigger(l.SUBTITLE_TRACK_LOADING,{url:i,id:r,groupId:n,deliveryDirectives:e||null,track:t})}toggleTrackModes(){const{media:t}=this;if(!t)return;const e=Zs(t.textTracks),r=this.currentTrack;let n;if(r&&(n=e.filter((t=>Ci(r,t)))[0],n||this.warn(`Unable to find subtitle TextTrack with name "${r.name}" and language "${r.lang}"`)),[].slice.call(e).forEach((t=>{"disabled"!==t.mode&&t!==n&&(t.mode="disabled")})),n){const t=this.subtitleDisplay?"showing":"hidden";n.mode!==t&&(n.mode=t)}}setSubtitleTrack(t){const e=this.tracksInGroup;if(!this.media)return void(this.queuedDefaultTrack=t);if(t<-1||t>=e.length||!n(t))return void this.warn(`Invalid subtitle track id: ${t}`);this.selectDefaultTrack=!1;const r=this.currentTrack,i=e[t]||null;if(this.trackId=t,this.currentTrack=i,this.toggleTrackModes(),!i)return void this.hls.trigger(l.SUBTITLE_TRACK_SWITCH,{id:t});const s=!!i.details&&!i.details.live;if(t===this.trackId&&i===r&&s)return;this.log(`Switching to subtitle-track ${t}`+(i?` "${i.name}" lang:${i.lang} group:${i.groupId}`:""));const{id:o,groupId:a="",name:c,type:u,url:h}=i;this.hls.trigger(l.SUBTITLE_TRACK_SWITCH,{id:o,groupId:a,name:c,type:u,url:h});const d=this.switchParams(i.url,null==r?void 0:r.details,i.details);this.loadPlaylist(d)}},timelineController:class{constructor(t){this.hls=void 0,this.media=null,this.config=void 0,this.enabled=!0,this.Cues=void 0,this.textTracks=[],this.tracks=[],this.initPTS=[],this.unparsedVttFrags=[],this.captionsTracks={},this.nonNativeCaptionsTracks={},this.cea608Parser1=void 0,this.cea608Parser2=void 0,this.lastCc=-1,this.lastSn=-1,this.lastPartIndex=-1,this.prevCC=-1,this.vttCCs={ccOffset:0,presentationOffset:0,0:{start:0,prevCC:-1,new:!0}},this.captionsProperties=void 0,this.hls=t,this.config=t.config,this.Cues=t.config.cueHandler,this.captionsProperties={textTrack1:{label:this.config.captionsTextTrack1Label,languageCode:this.config.captionsTextTrack1LanguageCode},textTrack2:{label:this.config.captionsTextTrack2Label,languageCode:this.config.captionsTextTrack2LanguageCode},textTrack3:{label:this.config.captionsTextTrack3Label,languageCode:this.config.captionsTextTrack3LanguageCode},textTrack4:{label:this.config.captionsTextTrack4Label,languageCode:this.config.captionsTextTrack4LanguageCode}},t.on(l.MEDIA_ATTACHING,this.onMediaAttaching,this),t.on(l.MEDIA_DETACHING,this.onMediaDetaching,this),t.on(l.MANIFEST_LOADING,this.onManifestLoading,this),t.on(l.MANIFEST_LOADED,this.onManifestLoaded,this),t.on(l.SUBTITLE_TRACKS_UPDATED,this.onSubtitleTracksUpdated,this),t.on(l.FRAG_LOADING,this.onFragLoading,this),t.on(l.FRAG_LOADED,this.onFragLoaded,this),t.on(l.FRAG_PARSING_USERDATA,this.onFragParsingUserdata,this),t.on(l.FRAG_DECRYPTED,this.onFragDecrypted,this),t.on(l.INIT_PTS_FOUND,this.onInitPtsFound,this),t.on(l.SUBTITLE_TRACKS_CLEARED,this.onSubtitleTracksCleared,this),t.on(l.BUFFER_FLUSHING,this.onBufferFlushing,this)}destroy(){const{hls:t}=this;t.off(l.MEDIA_ATTACHING,this.onMediaAttaching,this),t.off(l.MEDIA_DETACHING,this.onMediaDetaching,this),t.off(l.MANIFEST_LOADING,this.onManifestLoading,this),t.off(l.MANIFEST_LOADED,this.onManifestLoaded,this),t.off(l.SUBTITLE_TRACKS_UPDATED,this.onSubtitleTracksUpdated,this),t.off(l.FRAG_LOADING,this.onFragLoading,this),t.off(l.FRAG_LOADED,this.onFragLoaded,this),t.off(l.FRAG_PARSING_USERDATA,this.onFragParsingUserdata,this),t.off(l.FRAG_DECRYPTED,this.onFragDecrypted,this),t.off(l.INIT_PTS_FOUND,this.onInitPtsFound,this),t.off(l.SUBTITLE_TRACKS_CLEARED,this.onSubtitleTracksCleared,this),t.off(l.BUFFER_FLUSHING,this.onBufferFlushing,this),this.hls=this.config=this.media=null,this.cea608Parser1=this.cea608Parser2=void 0}initCea608Parsers(){const t=new ca(this,"textTrack1"),e=new ca(this,"textTrack2"),r=new ca(this,"textTrack3"),n=new ca(this,"textTrack4");this.cea608Parser1=new Do(1,t,e),this.cea608Parser2=new Do(3,r,n)}addCues(t,e,r,n,i){let s=!1;for(let t=i.length;t--;){const n=i[t],l=(o=n[0],a=n[1],c=e,u=r,Math.min(a,u)-Math.max(o,c));if(l>=0&&(n[0]=Math.min(n[0],e),n[1]=Math.max(n[1],r),s=!0,l/(r-e)>.5))return}var o,a,c,u;if(s||i.push([e,r]),this.config.renderTextTracksNatively){const i=this.captionsTracks[t];this.Cues.newCue(i,e,r,n)}else{const i=this.Cues.newCue(null,e,r,n);this.hls.trigger(l.CUES_PARSED,{type:"captions",cues:i,track:t})}}onInitPtsFound(t,{frag:e,id:r,initPTS:n,timescale:i,trackId:s}){const{unparsedVttFrags:o}=this;r===u.MAIN&&(this.initPTS[e.cc]={baseTime:n,timescale:i,trackId:s}),o.length&&(this.unparsedVttFrags=[],o.forEach((t=>{this.initPTS[t.frag.cc]?this.onFragLoaded(l.FRAG_LOADED,t):this.hls.trigger(l.SUBTITLE_FRAG_PROCESSED,{success:!1,frag:t.frag,error:new Error("Subtitle discontinuity domain does not match main")})})))}getExistingTrack(t,e){const{media:r}=this;if(r)for(let n=0;n<r.textTracks.length;n++){const i=r.textTracks[n];if(ha(i,{name:t,lang:e,characteristics:"transcribes-spoken-dialog,describes-music-and-sound"}))return i}return null}createCaptionsTrack(t){this.config.renderTextTracksNatively?this.createNativeTrack(t):this.createNonNativeTrack(t)}createNativeTrack(t){if(this.captionsTracks[t])return;const{captionsProperties:e,captionsTracks:r,media:n}=this,{label:i,languageCode:s}=e[t],o=this.getExistingTrack(i,s);if(o)r[t]=o,Qs(r[t]),zs(r[t],n);else{const e=this.createTextTrack("captions",i,s);e&&(e[t]=!0,r[t]=e)}}createNonNativeTrack(t){if(this.nonNativeCaptionsTracks[t])return;const e=this.captionsProperties[t];if(!e)return;const r={_id:t,label:e.label,kind:"captions",default:!!e.media&&!!e.media.default,closedCaptions:e.media};this.nonNativeCaptionsTracks[t]=r,this.hls.trigger(l.NON_NATIVE_TEXT_TRACKS_FOUND,{tracks:[r]})}createTextTrack(t,e,r){const n=this.media;if(n)return n.addTextTrack(t,e,r)}onMediaAttaching(t,e){this.media=e.media,e.mediaSource||this._cleanTracks()}onMediaDetaching(t,e){const r=!!e.transferMedia;if(this.media=null,r)return;const{captionsTracks:n}=this;Object.keys(n).forEach((t=>{Qs(n[t]),delete n[t]})),this.nonNativeCaptionsTracks={}}onManifestLoading(){this.lastCc=-1,this.lastSn=-1,this.lastPartIndex=-1,this.prevCC=-1,this.vttCCs={ccOffset:0,presentationOffset:0,0:{start:0,prevCC:-1,new:!0}},this._cleanTracks(),this.tracks=[],this.captionsTracks={},this.nonNativeCaptionsTracks={},this.textTracks=[],this.unparsedVttFrags=[],this.initPTS=[],this.cea608Parser1&&this.cea608Parser2&&(this.cea608Parser1.reset(),this.cea608Parser2.reset())}_cleanTracks(){const{media:t}=this;if(!t)return;const e=t.textTracks;if(e)for(let t=0;t<e.length;t++)Qs(e[t])}onSubtitleTracksUpdated(t,e){const r=e.subtitleTracks||[],n=r.some((t=>t.textCodec===Jo));if(this.config.enableWebVTT||n&&this.config.enableIMSC1){if(Oi(this.tracks,r))return void(this.tracks=r);if(this.textTracks=[],this.tracks=r,this.config.renderTextTracksNatively){const t=this.media,e=t?Zs(t.textTracks):null;if(this.tracks.forEach(((t,r)=>{let n;if(e){let r=null;for(let n=0;n<e.length;n++)if(e[n]&&ha(e[n],t)){r=e[n],e[n]=null;break}r&&(n=r)}if(n)Qs(n);else{const e=ua(t);n=this.createTextTrack(e,t.name,t.lang),n&&(n.mode="disabled")}n&&this.textTracks.push(n)})),null!=e&&e.length){const t=e.filter((t=>null!==t)).map((t=>t.label));t.length&&this.hls.logger.warn(`Media element contains unused subtitle tracks: ${t.join(", ")}. Replace media element for each source to clear TextTracks and captions menu.`)}}else if(this.tracks.length){const t=this.tracks.map((t=>({label:t.name,kind:t.type.toLowerCase(),default:t.default,subtitleTrack:t})));this.hls.trigger(l.NON_NATIVE_TEXT_TRACKS_FOUND,{tracks:t})}}}onManifestLoaded(t,e){this.config.enableCEA708Captions&&e.captions&&e.captions.forEach((t=>{const e=/(?:CC|SERVICE)([1-4])/.exec(t.instreamId);if(!e)return;const r=`textTrack${e[1]}`,n=this.captionsProperties[r];n&&(n.label=t.name,t.lang&&(n.languageCode=t.lang),n.media=t)}))}closedCaptionsForLevel(t){const e=this.hls.levels[t.level];return null==e?void 0:e.attrs["CLOSED-CAPTIONS"]}onFragLoading(t,e){if(this.enabled&&e.frag.type===u.MAIN){var r,n;const{cea608Parser1:t,cea608Parser2:i,lastSn:s}=this,{cc:o,sn:a}=e.frag,l=null!=(r=null==(n=e.part)?void 0:n.index)?r:-1;t&&i&&(a!==s+1||a===s&&l!==this.lastPartIndex+1||o!==this.lastCc)&&(t.reset(),i.reset()),this.lastCc=o,this.lastSn=a,this.lastPartIndex=l}}onFragLoaded(t,e){const{frag:r,payload:n}=e;if(r.type===u.SUBTITLE)if(n.byteLength){const t=r.decryptdata,i="stats"in e;if(null==t||!t.encrypted||i){const t=this.tracks[r.level],i=this.vttCCs;i[r.cc]||(i[r.cc]={start:r.start,prevCC:this.prevCC,new:!0},this.prevCC=r.cc),t&&t.textCodec===Jo?this._parseIMSC1(r,n):this._parseVTTs(e)}}else this.hls.trigger(l.SUBTITLE_FRAG_PROCESSED,{success:!1,frag:r,error:new Error("Empty subtitle payload")})}_parseIMSC1(t,e){const r=this.hls;ra(e,this.initPTS[t.cc],(e=>{this._appendCues(e,t.level),r.trigger(l.SUBTITLE_FRAG_PROCESSED,{success:!0,frag:t})}),(e=>{r.logger.log(`Failed to parse IMSC1: ${e}`),r.trigger(l.SUBTITLE_FRAG_PROCESSED,{success:!1,frag:t,error:e})}))}_parseVTTs(t){var e;const{frag:r,payload:n}=t,{initPTS:i,unparsedVttFrags:s}=this,o=i.length-1;if(!i[r.cc]&&-1===o)return void s.push(t);const a=this.hls;Qo(null!=(e=r.initSegment)&&e.data?lt(r.initSegment.data,new Uint8Array(n)).buffer:n,this.initPTS[r.cc],this.vttCCs,r.cc,r.start,(t=>{this._appendCues(t,r.level),a.trigger(l.SUBTITLE_FRAG_PROCESSED,{success:!0,frag:r})}),(e=>{const i="Missing initPTS for VTT MPEGTS"===e.message;i?s.push(t):this._fallbackToIMSC1(r,n),a.logger.log(`Failed to parse VTT cue: ${e}`),i&&o>r.cc||a.trigger(l.SUBTITLE_FRAG_PROCESSED,{success:!1,frag:r,error:e})}))}_fallbackToIMSC1(t,e){const r=this.tracks[t.level];r.textCodec||ra(e,this.initPTS[t.cc],(()=>{r.textCodec=Jo,this._parseIMSC1(t,e)}),(()=>{r.textCodec="wvtt"}))}_appendCues(t,e){const r=this.hls;if(this.config.renderTextTracksNatively){const r=this.textTracks[e];if(!r||"disabled"===r.mode)return;t.forEach((t=>Xs(r,t)))}else{const n=this.tracks[e];if(!n)return;const i=n.default?"default":"subtitles"+e;r.trigger(l.CUES_PARSED,{type:"subtitles",cues:t,track:i})}}onFragDecrypted(t,e){const{frag:r}=e;r.type===u.SUBTITLE&&this.onFragLoaded(l.FRAG_LOADED,e)}onSubtitleTracksCleared(){this.tracks=[],this.captionsTracks={}}onFragParsingUserdata(t,e){if(!this.enabled||!this.config.enableCEA708Captions)return;const{frag:r,samples:n}=e;if(r.type!==u.MAIN||"NONE"!==this.closedCaptionsForLevel(r))for(let t=0;t<n.length;t++){const e=n[t].bytes;if(e){this.cea608Parser1||this.initCea608Parsers();const r=this.extractCea608Data(e);this.cea608Parser1.addData(n[t].pts,r[0]),this.cea608Parser2.addData(n[t].pts,r[1])}}}onBufferFlushing(t,{startOffset:e,endOffset:r,endOffsetSubtitles:n,type:i}){const{media:s}=this;if(s&&!(s.currentTime<r)){if(!i||"video"===i){const{captionsTracks:t}=this;Object.keys(t).forEach((n=>Js(t[n],e,r)))}if(this.config.renderTextTracksNatively&&0===e&&void 0!==n){const{textTracks:t}=this;Object.keys(t).forEach((r=>Js(t[r],e,n)))}}}extractCea608Data(t){const e=[[],[]],r=31&t[0];let n=2;for(let i=0;i<r;i++){const r=t[n++],i=127&t[n++],s=127&t[n++];if(0===i&&0===s)continue;if(0!=(4&r)){const t=3&r;0!==t&&1!==t||(e[t].push(i),e[t].push(s))}}return e}},audioStreamController:class extends Xr{constructor(t,e,r){super(t,e,r,"audio-stream-controller",u.AUDIO),this.mainAnchor=null,this.mainFragLoading=null,this.audioOnly=!1,this.bufferedTrack=null,this.switchingTrack=null,this.trackId=-1,this.waitingData=null,this.mainDetails=null,this.flushing=!1,this.bufferFlushed=!1,this.cachedTrackLoadedData=null,this.registerListeners()}onHandlerDestroying(){this.unregisterListeners(),super.onHandlerDestroying(),this.resetItem()}resetItem(){this.mainDetails=this.mainAnchor=this.mainFragLoading=this.bufferedTrack=this.switchingTrack=this.waitingData=this.cachedTrackLoadedData=null}registerListeners(){super.registerListeners();const{hls:t}=this;t.on(l.LEVEL_LOADED,this.onLevelLoaded,this),t.on(l.AUDIO_TRACKS_UPDATED,this.onAudioTracksUpdated,this),t.on(l.AUDIO_TRACK_SWITCHING,this.onAudioTrackSwitching,this),t.on(l.AUDIO_TRACK_LOADED,this.onAudioTrackLoaded,this),t.on(l.BUFFER_RESET,this.onBufferReset,this),t.on(l.BUFFER_CREATED,this.onBufferCreated,this),t.on(l.BUFFER_FLUSHING,this.onBufferFlushing,this),t.on(l.BUFFER_FLUSHED,this.onBufferFlushed,this),t.on(l.INIT_PTS_FOUND,this.onInitPtsFound,this),t.on(l.FRAG_LOADING,this.onFragLoading,this),t.on(l.FRAG_BUFFERED,this.onFragBuffered,this)}unregisterListeners(){const{hls:t}=this;t&&(super.unregisterListeners(),t.off(l.LEVEL_LOADED,this.onLevelLoaded,this),t.off(l.AUDIO_TRACKS_UPDATED,this.onAudioTracksUpdated,this),t.off(l.AUDIO_TRACK_SWITCHING,this.onAudioTrackSwitching,this),t.off(l.AUDIO_TRACK_LOADED,this.onAudioTrackLoaded,this),t.off(l.BUFFER_RESET,this.onBufferReset,this),t.off(l.BUFFER_CREATED,this.onBufferCreated,this),t.off(l.BUFFER_FLUSHING,this.onBufferFlushing,this),t.off(l.BUFFER_FLUSHED,this.onBufferFlushed,this),t.off(l.INIT_PTS_FOUND,this.onInitPtsFound,this),t.off(l.FRAG_LOADING,this.onFragLoading,this),t.off(l.FRAG_BUFFERED,this.onFragBuffered,this))}onInitPtsFound(t,{frag:e,id:r,initPTS:n,timescale:i,trackId:s}){if(r===u.MAIN){const t=e.cc,r=this.fragCurrent;if(this.initPTS[t]={baseTime:n,timescale:i,trackId:s},this.log(`InitPTS for cc: ${t} found from main: ${n/i} (${n}/${i}) trackId: ${s}`),this.mainAnchor=e,this.state===zr.WAITING_INIT_PTS){const r=this.waitingData;(!r&&!this.loadingParts||r&&r.frag.cc!==t)&&this.syncWithAnchor(e,null==r?void 0:r.frag)}else!this.hls.hasEnoughToStart&&r&&r.cc!==t?(r.abortRequests(),this.syncWithAnchor(e,r)):this.state===zr.IDLE&&this.tick()}}getLoadPosition(){return!this.startFragRequested&&this.nextLoadPosition>=0?this.nextLoadPosition:super.getLoadPosition()}syncWithAnchor(t,e){var r;const n=(null==(r=this.mainFragLoading)?void 0:r.frag)||null;if(e&&(null==n?void 0:n.cc)===e.cc)return;const i=(n||t).cc,s=se(this.getLevelDetails(),i,this.getLoadPosition());s&&(this.log(`Syncing with main frag at ${s.start} cc ${s.cc}`),this.startFragRequested=!1,this.nextLoadPosition=s.start,this.resetLoadingState(),this.state===zr.IDLE&&this.doTickIdle())}startLoad(t,e){if(!this.levels)return this.startPosition=t,void(this.state=zr.STOPPED);const r=this.lastCurrentTime;this.stopLoad(),this.setInterval(100),r>0&&-1===t?(this.log(`Override startPosition with lastCurrentTime @${r.toFixed(3)}`),t=r,this.state=zr.IDLE):this.state=zr.WAITING_TRACK,this.nextLoadPosition=this.lastCurrentTime=t+this.timelineOffset,this.startPosition=e?-1:t,this.tick()}doTick(){switch(this.state){case zr.IDLE:this.doTickIdle();break;case zr.WAITING_TRACK:{const{levels:t,trackId:e}=this,r=null==t?void 0:t[e],n=null==r?void 0:r.details;if(n&&!this.waitForLive(r)){if(this.waitForCdnTuneIn(n))break;this.state=zr.WAITING_INIT_PTS}break}case zr.FRAG_LOADING_WAITING_RETRY:this.checkRetryDate();break;case zr.WAITING_INIT_PTS:{const t=this.waitingData;if(t){const{frag:e,part:r,cache:n,complete:i}=t,s=this.mainAnchor;if(void 0!==this.initPTS[e.cc]){this.waitingData=null,this.state=zr.FRAG_LOADING;const t={frag:e,part:r,payload:n.flush().buffer,networkDetails:null};this._handleFragmentLoadProgress(t),i&&super._handleFragmentLoadComplete(t)}else s&&s.cc!==t.frag.cc&&this.syncWithAnchor(s,t.frag)}else this.state=zr.IDLE}}this.onTickEnd()}resetLoadingState(){const t=this.waitingData;t&&(this.fragmentTracker.removeFragment(t.frag),this.waitingData=null),super.resetLoadingState()}onTickEnd(){const{media:t}=this;null!=t&&t.readyState&&(this.lastCurrentTime=t.currentTime)}doTickIdle(){var t;const{hls:e,levels:r,media:n,trackId:i}=this,s=e.config;if(!this.buffering||!n&&!this.primaryPrefetch&&(this.startFragRequested||!s.startFragPrefetch)||null==r||!r[i])return;const o=r[i],a=o.details;if(!a||this.waitForLive(o)||this.waitForCdnTuneIn(a))return this.state=zr.WAITING_TRACK,void(this.startFragRequested=!1);const c=this.mediaBuffer?this.mediaBuffer:this.media;this.bufferFlushed&&c&&(this.bufferFlushed=!1,this.afterBufferFlushed(c,B.AUDIO,u.AUDIO));const h=this.getFwdBufferInfo(c,u.AUDIO);if(null===h)return;if(!this.switchingTrack&&this._streamEnded(h,a))return e.trigger(l.BUFFER_EOS,{type:"audio"}),void(this.state=zr.ENDED);const d=h.len,f=e.maxBufferLength,p=a.fragments,g=p[0].start,m=this.getLoadPosition(),y=this.flushing?m:h.end;if(this.switchingTrack&&n){const t=m;a.PTSKnown&&t<g&&(h.end>g||h.nextStart)&&(this.log("Alt audio track ahead of main track, seek to start of alt audio track"),n.currentTime=g+.05)}if(d>=f&&!this.switchingTrack&&y<p[p.length-1].start)return;let v=this.getNextFragment(y,a);if(v&&this.isLoopLoading(v,y)&&(v=this.getNextFragmentLoopLoading(v,a,h,u.MAIN,f)),!v)return void(this.bufferFlushed=!0);let b=(null==(t=this.mainFragLoading)?void 0:t.frag)||null;if(!this.audioOnly&&this.startFragRequested&&b&&j(v)&&!v.endList&&(!a.live||!this.loadingParts&&y<this.hls.liveSyncPosition)&&(this.fragmentTracker.getState(b)===ve&&(this.mainFragLoading=b=null),b&&j(b))){if(v.start>b.end){const t=this.fragmentTracker.getFragAtPos(y,u.MAIN);t&&t.end>b.end&&(b=t,this.mainFragLoading={frag:t,targetBufferTime:null})}if(v.start>b.end)return}this.loadFragment(v,o,y)}onMediaDetaching(t,e){this.bufferFlushed=this.flushing=!1,super.onMediaDetaching(t,e)}onAudioTracksUpdated(t,{audioTracks:e}){this.resetTransmuxer(),this.levels=e.map((t=>new Ht(t)))}onAudioTrackSwitching(t,e){const r=!!e.url;this.trackId=e.id;const{fragCurrent:n}=this;n&&(n.abortRequests(),this.removeUnbufferedFrags(n.start)),this.resetLoadingState(),r?(this.switchingTrack=e,this.flushAudioIfNeeded(e),this.state!==zr.STOPPED&&(this.setInterval(100),this.state=zr.IDLE,this.tick())):(this.resetTransmuxer(),this.switchingTrack=null,this.bufferedTrack=e,this.clearInterval())}onManifestLoading(){super.onManifestLoading(),this.bufferFlushed=this.flushing=this.audioOnly=!1,this.resetItem(),this.trackId=-1}onLevelLoaded(t,e){this.mainDetails=e.details;const r=this.cachedTrackLoadedData;r&&(this.cachedTrackLoadedData=null,this.onAudioTrackLoaded(l.AUDIO_TRACK_LOADED,r))}onAudioTrackLoaded(t,e){var r;const{levels:n}=this,{details:i,id:s,groupId:o,track:a}=e;if(!n)return void this.warn(`Audio tracks reset while loading track ${s} "${a.name}" of "${o}"`);const c=this.mainDetails;if(!c||i.endCC>c.endCC||c.expired)return this.cachedTrackLoadedData=e,void(this.state!==zr.STOPPED&&(this.state=zr.WAITING_TRACK));this.cachedTrackLoadedData=null,this.log(`Audio track ${s} "${a.name}" of "${o}" loaded [${i.startSN},${i.endSN}]${i.lastPartSn?`[part-${i.lastPartSn}-${i.lastPartIndex}]`:""},duration:${i.totalduration}`);const u=n[s];let h=0;if(i.live||null!=(r=u.details)&&r.live){if(this.checkLiveUpdate(i),i.deltaUpdateFailed)return;var d;if(u.details)h=this.alignPlaylists(i,u.details,null==(d=this.levelLastLoaded)?void 0:d.details);i.alignedSliding||(Vr(i,c),i.alignedSliding||Kr(i,c),h=i.fragmentStart)}u.details=i,this.levelLastLoaded=u,this.startFragRequested||this.setStartPosition(c,h),this.hls.trigger(l.AUDIO_TRACK_UPDATED,{details:i,id:s,groupId:e.groupId}),this.state!==zr.WAITING_TRACK||this.waitForCdnTuneIn(i)||(this.state=zr.IDLE),this.tick()}_handleFragmentLoadProgress(t){var e;const r=t.frag,{part:n,payload:i}=t,{config:s,trackId:o,levels:a}=this;if(!a)return void this.warn(`Audio tracks were reset while fragment load was in progress. Fragment ${r.sn} of level ${r.level} will not be buffered`);const l=a[o];if(!l)return void this.warn("Audio track is undefined on fragment load progress");const c=l.details;if(!c)return this.warn("Audio track details undefined on fragment load progress"),void this.removeUnbufferedFrags(r.start);const h=s.defaultAudioCodec||l.audioCodec||"mp4a.40.2";let d=this.transmuxer;d||(d=this.transmuxer=new Ii(this.hls,u.AUDIO,this._handleTransmuxComplete.bind(this),this._handleTransmuxerFlush.bind(this)));const f=this.initPTS[r.cc],p=null==(e=r.initSegment)?void 0:e.data;if(void 0!==f){const t=!1,e=n?n.index:-1,s=-1!==e,o=new Ce(r.level,r.sn,r.stats.chunkCount,i.byteLength,e,s);d.push(i,p,h,"",r,n,c.totalduration,t,o,f)}else{this.log(`Unknown video PTS for cc ${r.cc}, waiting for video PTS before demuxing audio frag ${r.sn} of [${c.startSN} ,${c.endSN}],track ${o}`);const{cache:t}=this.waitingData=this.waitingData||{frag:r,part:n,cache:new Jr,complete:!1};t.push(new Uint8Array(i)),this.state!==zr.STOPPED&&(this.state=zr.WAITING_INIT_PTS)}}_handleFragmentLoadComplete(t){this.waitingData?this.waitingData.complete=!0:super._handleFragmentLoadComplete(t)}onBufferReset(){this.mediaBuffer=null}onBufferCreated(t,e){this.bufferFlushed=this.flushing=!1;const r=e.tracks.audio;r&&(this.mediaBuffer=r.buffer||null)}onFragLoading(t,e){!this.audioOnly&&e.frag.type===u.MAIN&&j(e.frag)&&(this.mainFragLoading=e,this.state===zr.IDLE&&this.tick())}onFragBuffered(t,e){const{frag:r,part:n}=e;if(r.type===u.AUDIO)if(this.fragContextChanged(r))this.warn(`Fragment ${r.sn}${n?" p: "+n.index:""} of level ${r.level} finished buffering, but was aborted. state: ${this.state}, audioSwitch: ${this.switchingTrack?this.switchingTrack.name:"false"}`);else{if(j(r)){this.fragPrevious=r;const t=this.switchingTrack;t&&(this.bufferedTrack=t,this.switchingTrack=null,this.hls.trigger(l.AUDIO_TRACK_SWITCHED,m({},t)))}this.fragBufferedComplete(r,n),this.media&&this.tick()}else this.audioOnly||r.type!==u.MAIN||r.elementaryStreams.video||r.elementaryStreams.audiovideo||(this.audioOnly=!0,this.mainFragLoading=null)}onError(t,e){var r;if(e.fatal)this.state=zr.ERROR;else switch(e.details){case a.FRAG_GAP:case a.FRAG_PARSING_ERROR:case a.FRAG_DECRYPT_ERROR:case a.FRAG_LOAD_ERROR:case a.FRAG_LOAD_TIMEOUT:case a.KEY_LOAD_ERROR:case a.KEY_LOAD_TIMEOUT:this.onFragmentOrKeyLoadError(u.AUDIO,e);break;case a.AUDIO_TRACK_LOAD_ERROR:case a.AUDIO_TRACK_LOAD_TIMEOUT:case a.LEVEL_PARSING_ERROR:e.levelRetry||this.state!==zr.WAITING_TRACK||(null==(r=e.context)?void 0:r.type)!==c.AUDIO_TRACK||(this.state=zr.IDLE);break;case a.BUFFER_ADD_CODEC_ERROR:case a.BUFFER_APPEND_ERROR:if("audio"!==e.parent)return;this.reduceLengthAndFlushBuffer(e)||this.resetLoadingState();break;case a.BUFFER_FULL_ERROR:if("audio"!==e.parent)return;this.reduceLengthAndFlushBuffer(e)&&(this.bufferedTrack=null,super.flushMainBuffer(0,Number.POSITIVE_INFINITY,"audio"));break;case a.INTERNAL_EXCEPTION:this.recoverWorkerError(e)}}onBufferFlushing(t,{type:e}){e!==B.VIDEO&&(this.flushing=!0)}onBufferFlushed(t,{type:e}){if(e!==B.VIDEO){this.flushing=!1,this.bufferFlushed=!0,this.state===zr.ENDED&&(this.state=zr.IDLE);const t=this.mediaBuffer||this.media;t&&(this.afterBufferFlushed(t,e,u.AUDIO),this.tick())}}_handleTransmuxComplete(t){var e;const r="audio",{hls:n}=this,{remuxResult:i,chunkMeta:s}=t,o=this.getCurrentContext(s);if(!o)return void this.resetWhenMissingContext(s);const{frag:a,part:c,level:u}=o,{details:h}=u,{audio:d,text:f,id3:g,initSegment:m}=i;if(!this.fragContextChanged(a)&&h){if(this.state=zr.PARSING,this.switchingTrack&&d&&this.completeAudioSwitch(this.switchingTrack),null!=m&&m.tracks){const t=a.initSegment||a;if(this.unhandledEncryptionError(m,a))return;this._bufferInitSegment(u,m.tracks,t,s),n.trigger(l.FRAG_PARSING_INIT_SEGMENT,{frag:t,id:r,tracks:m.tracks})}if(d){const{startPTS:t,endPTS:e,startDTS:r,endDTS:n}=d;c&&(c.elementaryStreams[B.AUDIO]={startPTS:t,endPTS:e,startDTS:r,endDTS:n}),a.setElementaryStreamInfo(B.AUDIO,t,e,r,n),this.bufferFragmentData(d,a,c,s)}if(null!=g&&null!=(e=g.samples)&&e.length){const t=p({id:r,frag:a,details:h},g);n.trigger(l.FRAG_PARSING_METADATA,t)}if(f){const t=p({id:r,frag:a,details:h},f);n.trigger(l.FRAG_PARSING_USERDATA,t)}}else this.fragmentTracker.removeFragment(a)}_bufferInitSegment(t,e,r,n){if(this.state!==zr.PARSING)return;if(e.video&&delete e.video,e.audiovideo&&delete e.audiovideo,!e.audio)return;const i=e.audio;i.id=u.AUDIO;const s=t.audioCodec;this.log(`Init audio buffer, container:${i.container}, codecs[level/parsed]=[${s}/${i.codec}]`),s&&1===s.split(",").length&&(i.levelCodec=s),this.hls.trigger(l.BUFFER_CODECS,e);const o=i.initSegment;if(null!=o&&o.byteLength){const t={type:"audio",frag:r,part:null,chunkMeta:n,parent:r.type,data:o};this.hls.trigger(l.BUFFER_APPENDING,t)}this.tickImmediate()}loadFragment(t,e,r){const n=this.fragmentTracker.getState(t);var i;if(this.switchingTrack||n===ge||n===ye)if(j(t))if(null!=(i=e.details)&&i.live&&!this.initPTS[t.cc]){this.log(`Waiting for video PTS in continuity counter ${t.cc} of live stream before loading audio fragment ${t.sn} of level ${this.trackId}`),this.state=zr.WAITING_INIT_PTS;const r=this.mainDetails;r&&r.fragmentStart!==e.details.fragmentStart&&Kr(e.details,r)}else super.loadFragment(t,e,r);else this._loadInitSegment(t,e);else this.clearTrackerIfNeeded(t)}flushAudioIfNeeded(t){if(this.media&&this.bufferedTrack){const{name:e,lang:r,assocLang:n,characteristics:i,audioCodec:s,channels:o}=this.bufferedTrack;Qt({name:e,lang:r,assocLang:n,characteristics:i,audioCodec:s,channels:o},t,Jt)||(te(t.url,this.hls)?(this.log("Switching audio track : flushing all audio"),super.flushMainBuffer(0,Number.POSITIVE_INFINITY,"audio"),this.bufferedTrack=null):this.bufferedTrack=t)}}completeAudioSwitch(t){const{hls:e}=this;this.flushAudioIfNeeded(t),this.bufferedTrack=t,this.switchingTrack=null,e.trigger(l.AUDIO_TRACK_SWITCHED,m({},t))}},audioTrackController:class extends Ri{constructor(t){super(t,"audio-track-controller"),this.tracks=[],this.groupIds=null,this.tracksInGroup=[],this.trackId=-1,this.currentTrack=null,this.selectDefaultTrack=!0,this.registerListeners()}registerListeners(){const{hls:t}=this;t.on(l.MANIFEST_LOADING,this.onManifestLoading,this),t.on(l.MANIFEST_PARSED,this.onManifestParsed,this),t.on(l.LEVEL_LOADING,this.onLevelLoading,this),t.on(l.LEVEL_SWITCHING,this.onLevelSwitching,this),t.on(l.AUDIO_TRACK_LOADED,this.onAudioTrackLoaded,this),t.on(l.ERROR,this.onError,this)}unregisterListeners(){const{hls:t}=this;t.off(l.MANIFEST_LOADING,this.onManifestLoading,this),t.off(l.MANIFEST_PARSED,this.onManifestParsed,this),t.off(l.LEVEL_LOADING,this.onLevelLoading,this),t.off(l.LEVEL_SWITCHING,this.onLevelSwitching,this),t.off(l.AUDIO_TRACK_LOADED,this.onAudioTrackLoaded,this),t.off(l.ERROR,this.onError,this)}destroy(){this.unregisterListeners(),this.tracks.length=0,this.tracksInGroup.length=0,this.currentTrack=null,super.destroy()}onManifestLoading(){this.tracks=[],this.tracksInGroup=[],this.groupIds=null,this.currentTrack=null,this.trackId=-1,this.selectDefaultTrack=!0}onManifestParsed(t,e){this.tracks=e.audioTracks||[]}onAudioTrackLoaded(t,e){const{id:r,groupId:n,details:i}=e,s=this.tracksInGroup[r];if(!s||s.groupId!==n)return void this.warn(`Audio track with id:${r} and group:${n} not found in active group ${null==s?void 0:s.groupId}`);const o=s.details;s.details=e.details,this.log(`Audio track ${r} "${s.name}" lang:${s.lang} group:${n} loaded [${i.startSN}-${i.endSN}]`),r===this.trackId&&this.playlistLoaded(r,e,o)}onLevelLoading(t,e){this.switchLevel(e.level)}onLevelSwitching(t,e){this.switchLevel(e.level)}switchLevel(t){const e=this.hls.levels[t];if(!e)return;const r=e.audioGroups||null,n=this.groupIds;let i=this.currentTrack;if(!r||(null==n?void 0:n.length)!==(null==r?void 0:r.length)||null!=r&&r.some((t=>-1===(null==n?void 0:n.indexOf(t))))){this.groupIds=r,this.trackId=-1,this.currentTrack=null;const t=this.tracks.filter((t=>!r||-1!==r.indexOf(t.groupId)));if(t.length)this.selectDefaultTrack&&!t.some((t=>t.default))&&(this.selectDefaultTrack=!1),t.forEach(((t,e)=>{t.id=e}));else if(!i&&!this.tracksInGroup.length)return;this.tracksInGroup=t;const e=this.hls.config.audioPreference;if(!i&&e){const r=Xt(e,t,Jt);if(r>-1)i=t[r];else{const t=Xt(e,this.tracks);i=this.tracks[t]}}let n=this.findTrackId(i);-1===n&&i&&(n=this.findTrackId(null));const c={audioTracks:t};this.log(`Updating audio tracks, ${t.length} track(s) found in group(s): ${null==r?void 0:r.join(",")}`),this.hls.trigger(l.AUDIO_TRACKS_UPDATED,c);const u=this.trackId;if(-1!==n&&-1===u)this.setAudioTrack(n);else if(t.length&&-1===u){var s;const e=new Error(`No audio track selected for current audio group-ID(s): ${null==(s=this.groupIds)?void 0:s.join(",")} track count: ${t.length}`);this.warn(e.message),this.hls.trigger(l.ERROR,{type:o.MEDIA_ERROR,details:a.AUDIO_TRACK_LOAD_ERROR,fatal:!0,error:e})}}}onError(t,e){!e.fatal&&e.context&&(e.context.type!==c.AUDIO_TRACK||e.context.id!==this.trackId||this.groupIds&&-1===this.groupIds.indexOf(e.context.groupId)||this.checkRetry(e))}get allAudioTracks(){return this.tracks}get audioTracks(){return this.tracksInGroup}get audioTrack(){return this.trackId}set audioTrack(t){this.selectDefaultTrack=!1,this.setAudioTrack(t)}setAudioOption(t){const e=this.hls;if(e.config.audioPreference=t,t){const r=this.allAudioTracks;if(this.selectDefaultTrack=!1,r.length){const n=this.currentTrack;if(n&&Qt(t,n,Jt))return n;const i=Xt(t,this.tracksInGroup,Jt);if(i>-1){const t=this.tracksInGroup[i];return this.setAudioTrack(i),t}if(n){let n=e.loadLevel;-1===n&&(n=e.firstAutoLevel);const i=function(t,e,r,n,i){const s=e[n],o=e.reduce(((t,e,r)=>{const n=e.uri;return(t[n]||(t[n]=[])).push(r),t}),{})[s.uri];o.length>1&&(n=Math.max.apply(Math,o));const a=s.videoRange,l=s.frameRate,c=s.codecSet.substring(0,4),u=Zt(e,n,(e=>{if(e.videoRange!==a||e.frameRate!==l||e.codecSet.substring(0,4)!==c)return!1;const n=e.audioGroups,s=r.filter((t=>!n||-1!==n.indexOf(t.groupId)));return Xt(t,s,i)>-1}));return u>-1?u:Zt(e,n,(e=>{const n=e.audioGroups,s=r.filter((t=>!n||-1!==n.indexOf(t.groupId)));return Xt(t,s,i)>-1}))}(t,e.levels,r,n,Jt);if(-1===i)return null;e.nextLoadLevel=i}if(t.channels||t.audioCodec){const e=Xt(t,r);if(e>-1)return r[e]}}}return null}setAudioTrack(t){const e=this.tracksInGroup;if(t<0||t>=e.length)return void this.warn(`Invalid audio track id: ${t}`);this.selectDefaultTrack=!1;const r=this.currentTrack,n=e[t],i=n.details&&!n.details.live;if(t===this.trackId&&n===r&&i)return;if(this.log(`Switching to audio-track ${t} "${n.name}" lang:${n.lang} group:${n.groupId} channels:${n.channels}`),this.trackId=t,this.currentTrack=n,this.hls.trigger(l.AUDIO_TRACK_SWITCHING,m({},n)),i)return;const s=this.switchParams(n.url,null==r?void 0:r.details,n.details);this.loadPlaylist(s)}findTrackId(t){const e=this.tracksInGroup;for(let r=0;r<e.length;r++){const n=e[r];if((!this.selectDefaultTrack||n.default)&&(!t||Qt(t,n,Jt)))return r}if(t){const{name:r,lang:n,assocLang:i,characteristics:s,audioCodec:o,channels:a}=t;for(let t=0;t<e.length;t++){if(Qt({name:r,lang:n,assocLang:i,characteristics:s,audioCodec:o,channels:a},e[t],Jt))return t}for(let r=0;r<e.length;r++){const n=e[r];if(Di(t.attrs,n.attrs,["LANGUAGE","ASSOC-LANGUAGE","CHARACTERISTICS"]))return r}for(let r=0;r<e.length;r++){const n=e[r];if(Di(t.attrs,n.attrs,["LANGUAGE"]))return r}}return-1}loadPlaylist(t){super.loadPlaylist();const e=this.currentTrack;this.shouldLoadPlaylist(e)&&te(e.url,this.hls)&&this.scheduleLoading(e,t)}loadingPlaylist(t,e){super.loadingPlaylist(t,e);const r=t.id,n=t.groupId,i=this.getUrlWithDirectives(t.url,e),s=t.details,o=null==s?void 0:s.age;this.log(`Loading audio-track ${r} "${t.name}" lang:${t.lang} group:${n}${void 0!==(null==e?void 0:e.msn)?" at sn "+e.msn+" part "+e.part:""}${o&&s.live?" age "+o.toFixed(1)+(s.type?" "+s.type||0:""):""} ${i}`),this.hls.trigger(l.AUDIO_TRACK_LOADING,{url:i,id:r,groupId:n,deliveryDirectives:e||null,track:t})}},emeController:Ys,cmcdController:class{constructor(t){this.hls=void 0,this.config=void 0,this.media=void 0,this.sid=void 0,this.cid=void 0,this.useHeaders=!1,this.includeKeys=void 0,this.initialized=!1,this.starved=!1,this.buffering=!0,this.audioBuffer=void 0,this.videoBuffer=void 0,this.onWaiting=()=>{this.initialized&&(this.starved=!0),this.buffering=!0},this.onPlaying=()=>{this.initialized||(this.initialized=!0),this.buffering=!1},this.applyPlaylistData=t=>{try{this.apply(t,{ot:Gi.MANIFEST,su:!this.initialized})}catch(t){this.hls.logger.warn("Could not generate manifest CMCD data.",t)}},this.applyFragmentData=t=>{try{const{frag:e,part:r}=t,n=this.hls.levels[e.level],i=this.getObjectType(e),s={d:1e3*(r||e).duration,ot:i};i!==Gi.VIDEO&&i!==Gi.AUDIO&&i!=Gi.MUXED||(s.br=n.bitrate/1e3,s.tb=this.getTopBandwidth(i)/1e3,s.bl=this.getBufferLength(i));const o=r?this.getNextPart(r):this.getNextFrag(e);null!=o&&o.url&&o.url!==e.url&&(s.nor=o.url),this.apply(t,s)}catch(t){this.hls.logger.warn("Could not generate segment CMCD data.",t)}},this.hls=t;const e=this.config=t.config,{cmcd:r}=e;null!=r&&(e.pLoader=this.createPlaylistLoader(),e.fLoader=this.createFragmentLoader(),this.sid=r.sessionId||t.sessionId,this.cid=r.contentId,this.useHeaders=!0===r.useHeaders,this.includeKeys=r.includeKeys,this.registerListeners())}registerListeners(){const t=this.hls;t.on(l.MEDIA_ATTACHED,this.onMediaAttached,this),t.on(l.MEDIA_DETACHED,this.onMediaDetached,this),t.on(l.BUFFER_CREATED,this.onBufferCreated,this)}unregisterListeners(){const t=this.hls;t.off(l.MEDIA_ATTACHED,this.onMediaAttached,this),t.off(l.MEDIA_DETACHED,this.onMediaDetached,this),t.off(l.BUFFER_CREATED,this.onBufferCreated,this)}destroy(){this.unregisterListeners(),this.onMediaDetached(),this.hls=this.config=this.audioBuffer=this.videoBuffer=null,this.onWaiting=this.onPlaying=this.media=null}onMediaAttached(t,e){this.media=e.media,this.media.addEventListener("waiting",this.onWaiting),this.media.addEventListener("playing",this.onPlaying)}onMediaDetached(){this.media&&(this.media.removeEventListener("waiting",this.onWaiting),this.media.removeEventListener("playing",this.onPlaying),this.media=null)}onBufferCreated(t,e){var r,n;this.audioBuffer=null==(r=e.tracks.audio)?void 0:r.buffer,this.videoBuffer=null==(n=e.tracks.video)?void 0:n.buffer}createData(){var t;return{v:1,sf:Hi.HLS,sid:this.sid,cid:this.cid,pr:null==(t=this.media)?void 0:t.playbackRate,mtp:this.hls.bandwidthEstimate/1e3}}apply(t,e={}){p(e,this.createData());const r=e.ot===Gi.INIT||e.ot===Gi.VIDEO||e.ot===Gi.MUXED;this.starved&&r&&(e.bs=!0,e.su=!0,this.starved=!1),null==e.su&&(e.su=this.buffering);const{includeKeys:n}=this;n&&(e=Object.keys(e).reduce(((t,r)=>(n.includes(r)&&(t[r]=e[r]),t)),{}));const i={baseUrl:t.url};this.useHeaders?(t.headers||(t.headers={}),Bs(t.headers,e,i)):t.url=Hs(t.url,e,i)}getNextFrag(t){var e;const r=null==(e=this.hls.levels[t.level])?void 0:e.details;if(r){const e=t.sn-r.startSN;return r.fragments[e+1]}}getNextPart(t){var e;const{index:r,fragment:n}=t,i=null==(e=this.hls.levels[n.level])||null==(e=e.details)?void 0:e.partList;if(i){const{sn:t}=n;for(let e=i.length-1;e>=0;e--){const n=i[e];if(n.index===r&&n.fragment.sn===t)return i[e+1]}}}getObjectType(t){const{type:e}=t;return"subtitle"===e?Gi.TIMED_TEXT:"initSegment"===t.sn?Gi.INIT:"audio"===e?Gi.AUDIO:"main"===e?this.hls.audioTracks.length?Gi.VIDEO:Gi.MUXED:void 0}getTopBandwidth(t){let e,r=0;const n=this.hls;if(t===Gi.AUDIO)e=n.audioTracks;else{const t=n.maxAutoLevel,r=t>-1?t+1:n.levels.length;e=n.levels.slice(0,r)}return e.forEach((t=>{t.bitrate>r&&(r=t.bitrate)})),r>0?r:NaN}getBufferLength(t){const e=this.media,r=t===Gi.AUDIO?this.audioBuffer:this.videoBuffer;if(!r||!e)return NaN;return 1e3*Ne.bufferInfo(r,e.currentTime,this.config.maxBufferHole).len}createPlaylistLoader(){const{pLoader:t}=this.config,e=this.applyPlaylistData,r=t||this.config.loader;return class{constructor(t){this.loader=void 0,this.loader=new r(t)}get stats(){return this.loader.stats}get context(){return this.loader.context}destroy(){this.loader.destroy()}abort(){this.loader.abort()}load(t,r,n){e(t),this.loader.load(t,r,n)}}}createFragmentLoader(){const{fLoader:t}=this.config,e=this.applyFragmentData,r=t||this.config.loader;return class{constructor(t){this.loader=void 0,this.loader=new r(t)}get stats(){return this.loader.stats}get context(){return this.loader.context}destroy(){this.loader.destroy()}abort(){this.loader.abort()}load(t,r,n){e(t),this.loader.load(t,r,n)}}}},contentSteeringController:class extends y{constructor(t){super("content-steering",t.logger),this.hls=void 0,this.loader=null,this.uri=null,this.pathwayId=".",this._pathwayPriority=null,this.timeToLoad=300,this.reloadTimer=-1,this.updated=0,this.started=!1,this.enabled=!0,this.levels=null,this.audioTracks=null,this.subtitleTracks=null,this.penalizedPathways={},this.hls=t,this.registerListeners()}registerListeners(){const t=this.hls;t.on(l.MANIFEST_LOADING,this.onManifestLoading,this),t.on(l.MANIFEST_LOADED,this.onManifestLoaded,this),t.on(l.MANIFEST_PARSED,this.onManifestParsed,this),t.on(l.ERROR,this.onError,this)}unregisterListeners(){const t=this.hls;t&&(t.off(l.MANIFEST_LOADING,this.onManifestLoading,this),t.off(l.MANIFEST_LOADED,this.onManifestLoaded,this),t.off(l.MANIFEST_PARSED,this.onManifestParsed,this),t.off(l.ERROR,this.onError,this))}pathways(){return(this.levels||[]).reduce(((t,e)=>(-1===t.indexOf(e.pathwayId)&&t.push(e.pathwayId),t)),[])}get pathwayPriority(){return this._pathwayPriority}set pathwayPriority(t){this.updatePathwayPriority(t)}startLoad(){if(this.started=!0,this.clearTimeout(),this.enabled&&this.uri){if(this.updated){const t=1e3*this.timeToLoad-(performance.now()-this.updated);if(t>0)return void this.scheduleRefresh(this.uri,t)}this.loadSteeringManifest(this.uri)}}stopLoad(){this.started=!1,this.loader&&(this.loader.destroy(),this.loader=null),this.clearTimeout()}clearTimeout(){-1!==this.reloadTimer&&(self.clearTimeout(this.reloadTimer),this.reloadTimer=-1)}destroy(){this.unregisterListeners(),this.stopLoad(),this.hls=null,this.levels=this.audioTracks=this.subtitleTracks=null}removeLevel(t){const e=this.levels;e&&(this.levels=e.filter((e=>e!==t)))}onManifestLoading(){this.stopLoad(),this.enabled=!0,this.timeToLoad=300,this.updated=0,this.uri=null,this.pathwayId=".",this.levels=this.audioTracks=this.subtitleTracks=null}onManifestLoaded(t,e){const{contentSteering:r}=e;null!==r&&(this.pathwayId=r.pathwayId,this.uri=r.uri,this.started&&this.startLoad())}onManifestParsed(t,e){this.audioTracks=e.audioTracks,this.subtitleTracks=e.subtitleTracks}onError(t,e){const{errorAction:r}=e;if((null==r?void 0:r.action)===de.SendAlternateToPenaltyBox&&r.flags===fe.MoveAllAlternatesMatchingHost){const t=this.levels;let n=this._pathwayPriority,i=this.pathwayId;if(e.context){const{groupId:r,pathwayId:n,type:s}=e.context;r&&t?i=this.getPathwayForGroupId(r,s,i):n&&(i=n)}i in this.penalizedPathways||(this.penalizedPathways[i]=performance.now()),!n&&t&&(n=this.pathways()),n&&n.length>1&&(this.updatePathwayPriority(n),r.resolved=this.pathwayId!==i),e.details!==a.BUFFER_APPEND_ERROR||e.fatal?r.resolved||this.warn(`Could not resolve ${e.details} ("${e.error.message}") with content-steering for Pathway: ${i} levels: ${t?t.length:t} priorities: ${Yt(n)} penalized: ${Yt(this.penalizedPathways)}`):r.resolved=!0}}filterParsedLevels(t){this.levels=t;let e=this.getLevelsForPathway(this.pathwayId);if(0===e.length){const r=t[0].pathwayId;this.log(`No levels found in Pathway ${this.pathwayId}. Setting initial Pathway to "${r}"`),e=this.getLevelsForPathway(r),this.pathwayId=r}return e.length!==t.length&&this.log(`Found ${e.length}/${t.length} levels in Pathway "${this.pathwayId}"`),e}getLevelsForPathway(t){return null===this.levels?[]:this.levels.filter((e=>t===e.pathwayId))}updatePathwayPriority(t){let e;this._pathwayPriority=t;const r=this.penalizedPathways,n=performance.now();Object.keys(r).forEach((t=>{n-r[t]>3e5&&delete r[t]}));for(let n=0;n<t.length;n++){const i=t[n];if(i in r)continue;if(i===this.pathwayId)return;const s=this.hls.nextLoadLevel,o=this.hls.levels[s];if(e=this.getLevelsForPathway(i),e.length>0){this.log(`Setting Pathway to "${i}"`),this.pathwayId=i,Ur(e),this.hls.trigger(l.LEVELS_UPDATED,{levels:e});const t=this.hls.levels[s];o&&t&&this.levels&&(t.attrs["STABLE-VARIANT-ID"]!==o.attrs["STABLE-VARIANT-ID"]&&t.bitrate!==o.bitrate&&this.log(`Unstable Pathways change from bitrate ${o.bitrate} to ${t.bitrate}`),this.hls.nextLoadLevel=s);break}}}getPathwayForGroupId(t,e,r){const n=this.getLevelsForPathway(r).concat(this.levels||[]);for(let r=0;r<n.length;r++)if(e===c.AUDIO_TRACK&&n[r].hasAudioGroup(t)||e===c.SUBTITLE_TRACK&&n[r].hasSubtitleGroup(t))return n[r].pathwayId;return r}clonePathways(t){const e=this.levels;if(!e)return;const r={},n={};t.forEach((t=>{const{ID:i,"BASE-ID":s,"URI-REPLACEMENT":o}=t;if(e.some((t=>t.pathwayId===i)))return;const a=this.getLevelsForPathway(s).map((t=>{const e=new Ve(t.attrs);e["PATHWAY-ID"]=i;const s=e.AUDIO&&`${e.AUDIO}_clone_${i}`,a=e.SUBTITLES&&`${e.SUBTITLES}_clone_${i}`;s&&(r[e.AUDIO]=s,e.AUDIO=s),a&&(n[e.SUBTITLES]=a,e.SUBTITLES=a);const l=Ks(t.uri,e["STABLE-VARIANT-ID"],"PER-VARIANT-URIS",o),c=new Ht({attrs:e,audioCodec:t.audioCodec,bitrate:t.bitrate,height:t.height,name:t.name,url:l,videoCodec:t.videoCodec,width:t.width});if(t.audioGroups)for(let e=1;e<t.audioGroups.length;e++)c.addGroupId("audio",`${t.audioGroups[e]}_clone_${i}`);if(t.subtitleGroups)for(let e=1;e<t.subtitleGroups.length;e++)c.addGroupId("text",`${t.subtitleGroups[e]}_clone_${i}`);return c}));e.push(...a),Vs(this.audioTracks,r,o,i),Vs(this.subtitleTracks,n,o,i)}))}loadSteeringManifest(t){const e=this.hls.config,r=e.loader;let n;this.loader&&this.loader.destroy(),this.loader=new r(e);try{n=new self.URL(t)}catch(e){return this.enabled=!1,void this.log(`Failed to parse Steering Manifest URI: ${t}`)}if("data:"!==n.protocol){const t=0|(this.hls.bandwidthEstimate||e.abrEwmaDefaultEstimate);n.searchParams.set("_HLS_pathway",this.pathwayId),n.searchParams.set("_HLS_throughput",""+t)}const i={responseType:"json",url:n.href},s=e.steeringManifestLoadPolicy.default,o=s.errorRetry||s.timeoutRetry||{},a={loadPolicy:s,timeout:s.maxLoadTimeMs,maxRetry:o.maxNumRetry||0,retryDelay:o.retryDelayMs||0,maxRetryDelay:o.maxRetryDelayMs||0},c={onSuccess:(t,e,r,i)=>{this.log(`Loaded steering manifest: "${n}"`);const s=t.data;if(1!==(null==s?void 0:s.VERSION))return void this.log(`Steering VERSION ${s.VERSION} not supported!`);this.updated=performance.now(),this.timeToLoad=s.TTL;const{"RELOAD-URI":o,"PATHWAY-CLONES":a,"PATHWAY-PRIORITY":c}=s;if(o)try{this.uri=new self.URL(o,n).href}catch(t){return this.enabled=!1,void this.log(`Failed to parse Steering Manifest RELOAD-URI: ${o}`)}this.scheduleRefresh(this.uri||r.url),a&&this.clonePathways(a);const u={steeringManifest:s,url:n.toString()};this.hls.trigger(l.STEERING_MANIFEST_LOADED,u),c&&this.updatePathwayPriority(c)},onError:(t,e,r,n)=>{if(this.log(`Error loading steering manifest: ${t.code} ${t.text} (${e.url})`),this.stopLoad(),410===t.code)return this.enabled=!1,void this.log(`Steering manifest ${e.url} no longer available`);let i=1e3*this.timeToLoad;if(429!==t.code)this.scheduleRefresh(this.uri||e.url,i);else{const t=this.loader;if("function"==typeof(null==t?void 0:t.getResponseHeader)){const e=t.getResponseHeader("Retry-After");e&&(i=1e3*parseFloat(e))}this.log(`Steering manifest ${e.url} rate limited`)}},onTimeout:(t,e,r)=>{this.log(`Timeout loading steering manifest (${e.url})`),this.scheduleRefresh(this.uri||e.url)}};this.log(`Requesting steering manifest: ${n}`),this.loader.load(i,a,c)}scheduleRefresh(t,e=1e3*this.timeToLoad){this.clearTimeout(),this.reloadTimer=self.setTimeout((()=>{var e;const r=null==(e=this.hls)?void 0:e.media;!r||r.ended?this.scheduleRefresh(t,1e3*this.timeToLoad):this.loadSteeringManifest(t)}),e)}},interstitialsController:class extends y{constructor(t,e){super("interstitials",t.logger),this.HlsPlayerClass=void 0,this.hls=void 0,this.assetListLoader=void 0,this.mediaSelection=null,this.altSelection=null,this.media=null,this.detachedData=null,this.requiredTracks=null,this.manager=null,this.playerQueue=[],this.bufferedPos=-1,this.timelinePos=-1,this.schedule=void 0,this.playingItem=null,this.bufferingItem=null,this.waitingItem=null,this.endedItem=null,this.playingAsset=null,this.endedAsset=null,this.bufferingAsset=null,this.shouldPlay=!1,this.onPlay=()=>{this.shouldPlay=!0},this.onPause=()=>{this.shouldPlay=!1},this.onSeeking=()=>{const t=this.currentTime;if(void 0===t||this.playbackDisabled||!this.schedule)return;const e=t-this.timelinePos;if(Math.abs(e)<1/7056e5)return;const r=e<=-.01;this.timelinePos=t,this.bufferedPos=t;const n=this.playingItem;if(!n)return void this.checkBuffer();if(r){this.schedule.resetErrorsInRange(t,t-e)&&this.updateSchedule(!0)}if(this.checkBuffer(),r&&t<n.start||t>=n.end){var i;const e=this.findItemIndex(n);let s=this.schedule.findItemIndexAtTime(t);if(-1===s&&(s=e+(r?-1:1),this.log(`seeked ${r?"back ":""}to position not covered by schedule ${t} (resolving from ${e} to ${s})`)),!this.isInterstitial(n)&&null!=(i=this.media)&&i.paused&&(this.shouldPlay=!1),!r&&s>e){const t=this.schedule.findJumpRestrictedIndex(e+1,s);if(t>e)return void this.setSchedulePosition(t)}return void this.setSchedulePosition(s)}const s=this.playingAsset;if(!s){if(this.playingLastItem&&this.isInterstitial(n)){const e=n.event.assetList[0];e&&(this.endedItem=this.playingItem,this.playingItem=null,this.setScheduleToAssetAtTime(t,e))}return}const o=s.timelineStart,a=s.duration||0;var l;(r&&t<o||t>=o+a)&&(null!=(l=n.event)&&l.appendInPlace&&(this.clearInterstitial(n.event,n),this.flushFrontBuffer(t)),this.setScheduleToAssetAtTime(t,s))},this.onTimeupdate=()=>{const t=this.currentTime;if(void 0===t||this.playbackDisabled)return;if(!(t>this.timelinePos))return;this.timelinePos=t,t>this.bufferedPos&&this.checkBuffer();const e=this.playingItem;if(!e||this.playingLastItem)return;if(t>=e.end){this.timelinePos=e.end;const t=this.findItemIndex(e);this.setSchedulePosition(t+1)}const r=this.playingAsset;if(!r)return;t>=r.timelineStart+(r.duration||0)&&this.setScheduleToAssetAtTime(t,r)},this.onScheduleUpdate=(t,e)=>{const r=this.schedule;if(!r)return;const n=this.playingItem,i=r.events||[],s=r.items||[],o=r.durations,a=t.map((t=>t.identifier)),c=!(!i.length&&!a.length);(c||e)&&this.log(`INTERSTITIALS_UPDATED (${i.length}): ${i}\nSchedule: ${s.map((t=>ho(t)))} pos: ${this.timelinePos}`),a.length&&this.log(`Removed events ${a}`);let u=null,h=null;n&&(u=this.updateItem(n,this.timelinePos),this.itemsMatch(n,u)?this.playingItem=u:this.waitingItem=this.endedItem=null),this.waitingItem=this.updateItem(this.waitingItem),this.endedItem=this.updateItem(this.endedItem);const d=this.bufferingItem;if(d&&(h=this.updateItem(d,this.bufferedPos),this.itemsMatch(d,h)?this.bufferingItem=h:d.event&&(this.bufferingItem=this.playingItem,this.clearInterstitial(d.event,null))),t.forEach((t=>{t.assetList.forEach((t=>{this.clearAssetPlayer(t.identifier,null)}))})),this.playerQueue.forEach((t=>{if(t.interstitial.appendInPlace){const e=t.assetItem.timelineStart,r=t.timelineOffset-e;if(r)try{t.timelineOffset=e}catch(n){Math.abs(r)>eo&&this.warn(`${n} ("${t.assetId}" ${t.timelineOffset}->${e})`)}}})),c||e){if(this.hls.trigger(l.INTERSTITIALS_UPDATED,{events:i.slice(0),schedule:s.slice(0),durations:o,removedIds:a}),this.isInterstitial(n)&&a.includes(n.event.identifier))return this.warn(`Interstitial "${n.event.identifier}" removed while playing`),void this.primaryFallback(n.event);n&&this.trimInPlace(u,n),d&&h!==u&&this.trimInPlace(h,d),this.checkBuffer()}},this.hls=t,this.HlsPlayerClass=e,this.assetListLoader=new fo(t),this.schedule=new uo(this.onScheduleUpdate,t.logger),this.registerListeners()}registerListeners(){const t=this.hls;t&&(t.on(l.MEDIA_ATTACHING,this.onMediaAttaching,this),t.on(l.MEDIA_ATTACHED,this.onMediaAttached,this),t.on(l.MEDIA_DETACHING,this.onMediaDetaching,this),t.on(l.MANIFEST_LOADING,this.onManifestLoading,this),t.on(l.LEVEL_UPDATED,this.onLevelUpdated,this),t.on(l.AUDIO_TRACK_SWITCHING,this.onAudioTrackSwitching,this),t.on(l.AUDIO_TRACK_UPDATED,this.onAudioTrackUpdated,this),t.on(l.SUBTITLE_TRACK_SWITCH,this.onSubtitleTrackSwitch,this),t.on(l.SUBTITLE_TRACK_UPDATED,this.onSubtitleTrackUpdated,this),t.on(l.EVENT_CUE_ENTER,this.onInterstitialCueEnter,this),t.on(l.ASSET_LIST_LOADED,this.onAssetListLoaded,this),t.on(l.BUFFER_APPENDED,this.onBufferAppended,this),t.on(l.BUFFER_FLUSHED,this.onBufferFlushed,this),t.on(l.BUFFERED_TO_END,this.onBufferedToEnd,this),t.on(l.MEDIA_ENDED,this.onMediaEnded,this),t.on(l.ERROR,this.onError,this),t.on(l.DESTROYING,this.onDestroying,this))}unregisterListeners(){const t=this.hls;t&&(t.off(l.MEDIA_ATTACHING,this.onMediaAttaching,this),t.off(l.MEDIA_ATTACHED,this.onMediaAttached,this),t.off(l.MEDIA_DETACHING,this.onMediaDetaching,this),t.off(l.MANIFEST_LOADING,this.onManifestLoading,this),t.off(l.LEVEL_UPDATED,this.onLevelUpdated,this),t.off(l.AUDIO_TRACK_SWITCHING,this.onAudioTrackSwitching,this),t.off(l.AUDIO_TRACK_UPDATED,this.onAudioTrackUpdated,this),t.off(l.SUBTITLE_TRACK_SWITCH,this.onSubtitleTrackSwitch,this),t.off(l.SUBTITLE_TRACK_UPDATED,this.onSubtitleTrackUpdated,this),t.off(l.EVENT_CUE_ENTER,this.onInterstitialCueEnter,this),t.off(l.ASSET_LIST_LOADED,this.onAssetListLoaded,this),t.off(l.BUFFER_CODECS,this.onBufferCodecs,this),t.off(l.BUFFER_APPENDED,this.onBufferAppended,this),t.off(l.BUFFER_FLUSHED,this.onBufferFlushed,this),t.off(l.BUFFERED_TO_END,this.onBufferedToEnd,this),t.off(l.MEDIA_ENDED,this.onMediaEnded,this),t.off(l.ERROR,this.onError,this),t.off(l.DESTROYING,this.onDestroying,this))}startLoad(){this.resumeBuffering()}stopLoad(){this.pauseBuffering()}resumeBuffering(){var t;null==(t=this.getBufferingPlayer())||t.resumeBuffering()}pauseBuffering(){var t;null==(t=this.getBufferingPlayer())||t.pauseBuffering()}destroy(){this.unregisterListeners(),this.stopLoad(),this.assetListLoader&&this.assetListLoader.destroy(),this.emptyPlayerQueue(),this.clearScheduleState(),this.schedule&&this.schedule.destroy(),this.media=this.detachedData=this.mediaSelection=this.requiredTracks=this.altSelection=this.schedule=this.manager=null,this.hls=this.HlsPlayerClass=this.log=null,this.assetListLoader=null,this.onPlay=this.onPause=this.onSeeking=this.onTimeupdate=null,this.onScheduleUpdate=null}onDestroying(){const t=this.primaryMedia||this.media;t&&this.removeMediaListeners(t)}removeMediaListeners(t){qr(t,"play",this.onPlay),qr(t,"pause",this.onPause),qr(t,"seeking",this.onSeeking),qr(t,"timeupdate",this.onTimeupdate)}onMediaAttaching(t,e){const r=this.media=e.media;Yr(r,"seeking",this.onSeeking),Yr(r,"timeupdate",this.onTimeupdate),Yr(r,"play",this.onPlay),Yr(r,"pause",this.onPause)}onMediaAttached(t,e){const r=this.effectivePlayingItem,n=this.detachedData;if(this.detachedData=null,null===r)this.checkStart();else if(!n){this.clearScheduleState();const t=this.findItemIndex(r);this.setSchedulePosition(t)}}clearScheduleState(){this.log("clear schedule state"),this.playingItem=this.bufferingItem=this.waitingItem=this.endedItem=this.playingAsset=this.endedAsset=this.bufferingAsset=null}onMediaDetaching(t,e){const r=!!e.transferMedia,n=this.media;if(this.media=null,!r&&(n&&this.removeMediaListeners(n),this.detachedData)){const t=this.getBufferingPlayer();t&&(this.log(`Removing schedule state for detachedData and ${t}`),this.playingAsset=this.endedAsset=this.bufferingAsset=this.bufferingItem=this.waitingItem=this.detachedData=null,t.detachMedia()),this.shouldPlay=!1}}get interstitialsManager(){if(!this.hls)return null;if(this.manager)return this.manager;const t=this,e=()=>t.bufferingItem||t.waitingItem,r=e=>e?t.getAssetPlayer(e.identifier):e,n=(e,n,s,o,a)=>{if(e){let l=e[n].start;const c=e.event;if(c){if("playout"===n||c.timelineOccupancy!==ro.Point){const t=r(s);(null==t?void 0:t.interstitial)===c&&(l+=t.assetItem.startOffset+t[a])}}else{l+=("bufferedPos"===o?i():t[o])-e.start}return l}return 0},i=()=>{const e=t.bufferedPos;return e===Number.MAX_VALUE?s("primary"):Math.max(e,0)},s=e=>{var r,n;return null!=(r=t.primaryDetails)&&r.live?t.primaryDetails.edge:(null==(n=t.schedule)?void 0:n.durations[e])||0},o=(e,i)=>{var s,o;const a=t.effectivePlayingItem;if(null!=a&&null!=(s=a.event)&&s.restrictions.skip||!t.schedule)return;t.log(`seek to ${e} "${i}"`);const l=t.effectivePlayingItem,c=t.schedule.findItemIndexAtTime(e,i),u=null==(o=t.schedule.items)?void 0:o[c],h=t.getBufferingPlayer(),d=null==h?void 0:h.interstitial,f=null==d?void 0:d.appendInPlace,p=l&&t.itemsMatch(l,u);if(l&&(f||p)){const s=r(t.playingAsset),o=(null==s?void 0:s.media)||t.primaryMedia;if(o){const r="primary"===i?o.currentTime:n(l,i,t.playingAsset,"timelinePos","currentTime"),a=e-r,c=(f?r:o.currentTime)+a;if(c>=0&&(!s||f||c<=s.duration))return void(o.currentTime=c)}}if(u){let r=e;if("primary"!==i){const t=e-u[i].start;r=u.start+t}const n=!t.isInterstitial(u);if(t.isInterstitial(l)&&!l.event.appendInPlace||!n&&!u.event.appendInPlace){if(l){const s=t.findItemIndex(l);if(c>s){const e=t.schedule.findJumpRestrictedIndex(s+1,c);if(e>s)return void t.setSchedulePosition(e)}let o=0;if(n)t.timelinePos=r,t.checkBuffer();else{const t=u.event.assetList,r=e-(u[i]||u).start;for(let e=t.length;e--;){const n=t[e];if(n.duration&&r>=n.startOffset&&r<n.startOffset+n.duration){o=e;break}}}t.setSchedulePosition(c,o)}}else{const e=t.media||(f?null==h?void 0:h.media:null);e&&(e.currentTime=r)}}},a=()=>{const r=t.effectivePlayingItem;if(t.isInterstitial(r))return r;const n=e();return t.isInterstitial(n)?n:null},l={get bufferedEnd(){const r=e(),i=t.bufferingItem;var s;return i&&i===r&&(n(i,"playout",t.bufferingAsset,"bufferedPos","bufferedEnd")-i.playout.start||(null==(s=t.bufferingAsset)?void 0:s.startOffset))||0},get currentTime(){const e=a(),r=t.effectivePlayingItem;return r&&r===e?n(r,"playout",t.effectivePlayingAsset,"timelinePos","currentTime")-r.playout.start:0},set currentTime(e){const r=a(),n=t.effectivePlayingItem;n&&n===r&&o(e+n.playout.start,"playout")},get duration(){const t=a();return t?t.playout.end-t.playout.start:0},get assetPlayers(){var e;const r=null==(e=a())?void 0:e.event.assetList;return r?r.map((e=>t.getAssetPlayer(e.identifier))):[]},get playingIndex(){var e;const r=null==(e=a())?void 0:e.event;return r&&t.effectivePlayingAsset?r.findAssetIndex(t.effectivePlayingAsset):-1},get scheduleItem(){return a()}};return this.manager={get events(){var e;return(null==(e=t.schedule)||null==(e=e.events)?void 0:e.slice(0))||[]},get schedule(){var e;return(null==(e=t.schedule)||null==(e=e.items)?void 0:e.slice(0))||[]},get interstitialPlayer(){return a()?l:null},get playerQueue(){return t.playerQueue.slice(0)},get bufferingAsset(){return t.bufferingAsset},get bufferingItem(){return e()},get bufferingIndex(){const r=e();return t.findItemIndex(r)},get playingAsset(){return t.effectivePlayingAsset},get playingItem(){return t.effectivePlayingItem},get playingIndex(){const e=t.effectivePlayingItem;return t.findItemIndex(e)},primary:{get bufferedEnd(){return i()},get currentTime(){const e=t.timelinePos;return e>0?e:0},set currentTime(t){o(t,"primary")},get duration(){return s("primary")},get seekableStart(){var e;return(null==(e=t.primaryDetails)?void 0:e.fragmentStart)||0}},integrated:{get bufferedEnd(){return n(e(),"integrated",t.bufferingAsset,"bufferedPos","bufferedEnd")},get currentTime(){return n(t.effectivePlayingItem,"integrated",t.effectivePlayingAsset,"timelinePos","currentTime")},set currentTime(t){o(t,"integrated")},get duration(){return s("integrated")},get seekableStart(){var e;return((e,r)=>{var n;if(0!==e&&"primary"!==r&&null!=(n=t.schedule)&&n.length){var i;const n=t.schedule.findItemIndexAtTime(e),s=null==(i=t.schedule.items)?void 0:i[n];if(s)return e+(s[r].start-s.start)}return e})((null==(e=t.primaryDetails)?void 0:e.fragmentStart)||0,"integrated")}},skip:()=>{const e=t.effectivePlayingItem,r=null==e?void 0:e.event;if(r&&!r.restrictions.skip){const n=t.findItemIndex(e);if(r.appendInPlace){const t=e.playout.start+e.event.duration;o(t+.001,"playout")}else t.advanceAfterAssetEnded(r,n,1/0)}}}}get effectivePlayingItem(){return this.waitingItem||this.playingItem||this.endedItem}get effectivePlayingAsset(){return this.playingAsset||this.endedAsset}get playingLastItem(){var t;const e=this.playingItem,r=null==(t=this.schedule)?void 0:t.items;return!!(this.playbackStarted&&e&&r)&&this.findItemIndex(e)===r.length-1}get playbackStarted(){return null!==this.effectivePlayingItem}get currentTime(){var t,e;if(null===this.mediaSelection)return;const r=this.waitingItem||this.playingItem;if(this.isInterstitial(r)&&!r.event.appendInPlace)return;let i=this.media;!i&&null!=(t=this.bufferingItem)&&null!=(t=t.event)&&t.appendInPlace&&(i=this.primaryMedia);const s=null==(e=i)?void 0:e.currentTime;return void 0!==s&&n(s)?s:void 0}get primaryMedia(){var t;return this.media||(null==(t=this.detachedData)?void 0:t.media)||null}isInterstitial(t){return!(null==t||!t.event)}retreiveMediaSource(t,e){const r=this.getAssetPlayer(t);r&&this.transferMediaFromPlayer(r,e)}transferMediaFromPlayer(t,e){const r=t.interstitial.appendInPlace,n=t.media;if(r&&n===this.primaryMedia){if(this.bufferingAsset=null,(!e||this.isInterstitial(e)&&!e.event.appendInPlace)&&e&&n)return void(this.detachedData={media:n});const r=t.transferMedia();this.log(`transfer MediaSource from ${t} ${Yt(r)}`),this.detachedData=r}else e&&n&&(this.shouldPlay||(this.shouldPlay=!n.paused))}transferMediaTo(t,e){var r,n;if(t.media===e)return;let i=null;const s=this.hls,o=t!==s,a=o&&t.interstitial.appendInPlace,l=null==(r=this.detachedData)?void 0:r.mediaSource;let c;if(s.media)a&&(i=s.transferMedia(),this.detachedData=i),c="Primary";else if(l){const t=this.getBufferingPlayer();t?(i=t.transferMedia(),c=`${t}`):c="detached MediaSource"}else c="detached media";if(!i)if(l)i=this.detachedData,this.log(`using detachedData: MediaSource ${Yt(i)}`);else if(!this.detachedData||s.media===e){const t=this.playerQueue;t.length>1&&t.forEach((t=>{if(o&&t.interstitial.appendInPlace!==a){const e=t.interstitial;this.clearInterstitial(t.interstitial,null),e.appendInPlace=!1,e.appendInPlace&&this.warn(`Could not change append strategy for queued assets ${e}`)}})),this.hls.detachMedia(),this.detachedData={media:e}}const u=i&&"mediaSource"in i&&"closed"!==(null==(n=i.mediaSource)?void 0:n.readyState),h=u&&i?i:e;this.log(`${u?"transfering MediaSource":"attaching media"} to ${o?t:"Primary"} from ${c} (media.currentTime: ${e.currentTime})`);const d=this.schedule;if(h===i&&d){const e=o&&t.assetId===d.assetIdAtEnd;h.overrides={duration:d.duration,endOfStream:!o||e,cueRemoval:!o}}t.attachMedia(h)}onInterstitialCueEnter(){this.onTimeupdate()}checkStart(){const t=this.schedule,e=null==t?void 0:t.events;if(!e||this.playbackDisabled||!this.media)return;-1===this.bufferedPos&&(this.bufferedPos=0);const r=this.timelinePos,n=this.effectivePlayingItem;if(-1===r){const r=this.hls.startPosition;if(this.log(go("checkStart",r)),this.timelinePos=r,e.length&&e[0].cue.pre){const r=t.findEventIndex(e[0].identifier);this.setSchedulePosition(r)}else if(r>=0||!this.primaryLive){const e=this.timelinePos=r>0?r:0,n=t.findItemIndexAtTime(e);this.setSchedulePosition(n)}}else if(n&&!this.playingItem){const e=t.findItemIndex(n);this.setSchedulePosition(e)}}advanceAssetBuffering(t,e){const r=t.event,n=r.findAssetIndex(e),i=ao(r,n);if(r.isAssetPastPlayoutLimit(i)){if(this.schedule){var s;const e=null==(s=this.schedule.items)?void 0:s[this.findItemIndex(t)+1];e&&this.bufferedToItem(e)}}else this.bufferedToEvent(t,i)}advanceAfterAssetEnded(t,e,r){const n=ao(t,r);if(t.isAssetPastPlayoutLimit(n)){if(this.schedule){const r=this.schedule.items;if(r){const n=e+1;if(n>=r.length)return void this.setSchedulePosition(-1);const i=t.resumeTime;this.timelinePos<i&&(this.log(go("advanceAfterAssetEnded",i)),this.timelinePos=i,t.appendInPlace&&this.advanceInPlace(i),this.checkBuffer(this.bufferedPos<i)),this.setSchedulePosition(n)}}}else{if(t.appendInPlace){const e=t.assetList[n];e&&this.advanceInPlace(e.timelineStart)}this.setSchedulePosition(e,n)}}setScheduleToAssetAtTime(t,e){const r=this.schedule;if(!r)return;const n=e.parentIdentifier,i=r.getEvent(n);if(i){const e=r.findEventIndex(n),s=r.findAssetIndex(i,t);this.advanceAfterAssetEnded(i,e,s-1)}}setSchedulePosition(t,e){var r;const n=null==(r=this.schedule)?void 0:r.items;if(!n||this.playbackDisabled)return;const i=t>=0?n[t]:null;this.log(`setSchedulePosition ${t}, ${e} (${i?ho(i):i}) pos: ${this.timelinePos}`);const s=this.waitingItem||this.playingItem,o=this.playingLastItem;if(this.isInterstitial(s)){const r=s.event,u=this.playingAsset,h=null==u?void 0:u.identifier,d=h?this.getAssetPlayer(h):null;if(d&&h&&(!this.eventItemsMatch(s,i)||void 0!==e&&h!==r.assetList[e].identifier)){var a;const e=r.findAssetIndex(u);if(this.log(`INTERSTITIAL_ASSET_ENDED ${e+1}/${r.assetList.length} ${lo(u)}`),this.endedAsset=u,this.playingAsset=null,this.hls.trigger(l.INTERSTITIAL_ASSET_ENDED,{asset:u,assetListIndex:e,event:r,schedule:n.slice(0),scheduleIndex:t,player:d}),s!==this.playingItem)return void(this.itemsMatch(s,this.playingItem)&&!this.playingAsset&&this.advanceAfterAssetEnded(r,this.findItemIndex(this.playingItem),e));this.retreiveMediaSource(h,i),!d.media||null!=(a=this.detachedData)&&a.mediaSource||d.detachMedia()}if(!this.eventItemsMatch(s,i)&&(this.endedItem=s,this.playingItem=null,this.log(`INTERSTITIAL_ENDED ${r} ${ho(s)}`),r.hasPlayed=!0,this.hls.trigger(l.INTERSTITIAL_ENDED,{event:r,schedule:n.slice(0),scheduleIndex:t}),r.cue.once)){var c;this.updateSchedule();const t=null==(c=this.schedule)?void 0:c.items;if(i&&t){const r=this.findItemIndex(i);this.advanceSchedule(r,t,e,s,o)}return}}this.advanceSchedule(t,n,e,s,o)}advanceSchedule(t,e,r,n,i){const s=this.schedule;if(!s)return;const o=e[t]||null,a=this.primaryMedia,c=this.playerQueue;if(c.length&&c.forEach((e=>{const r=e.interstitial,n=s.findEventIndex(r.identifier);(n<t||n>t+1)&&this.clearInterstitial(r,o)})),this.isInterstitial(o)){this.timelinePos=Math.min(Math.max(this.timelinePos,o.start),o.end);const i=o.event;if(void 0===r){const e=ao(i,(r=s.findAssetIndex(i,this.timelinePos))-1);if(i.isAssetPastPlayoutLimit(e)||i.appendInPlace&&this.timelinePos===o.end)return void this.advanceAfterAssetEnded(i,t,r);r=e}const c=this.waitingItem;this.assetsBuffered(o,a)||this.setBufferingItem(o);let u=this.preloadAssets(i,r);if(this.eventItemsMatch(o,c||n)||(this.waitingItem=o,this.log(`INTERSTITIAL_STARTED ${ho(o)} ${i.appendInPlace?"append in place":""}`),this.hls.trigger(l.INTERSTITIAL_STARTED,{event:i,schedule:e.slice(0),scheduleIndex:t})),!i.assetListLoaded)return void this.log(`Waiting for ASSET-LIST to complete loading ${i}`);if(i.assetListLoader&&(i.assetListLoader.destroy(),i.assetListLoader=void 0),!a)return void this.log(`Waiting for attachMedia to start Interstitial ${i}`);this.waitingItem=this.endedItem=null,this.playingItem=o;const h=i.assetList[r];if(!h)return void this.advanceAfterAssetEnded(i,t,r||0);if(u||(u=this.getAssetPlayer(h.identifier)),null===u||u.destroyed){const t=i.assetList.length;this.warn(`asset ${r+1}/${t} player destroyed ${i}`),u=this.createAssetPlayer(i,h,r),u.loadSource()}if(!this.eventItemsMatch(o,this.bufferingItem)&&i.appendInPlace&&this.isAssetBuffered(h))return;this.startAssetPlayer(u,r,e,t,a),this.shouldPlay&&po(u.media)}else o?(this.resumePrimary(o,t,n),this.shouldPlay&&po(this.hls.media)):i&&this.isInterstitial(n)&&(this.endedItem=null,this.playingItem=n,n.event.appendInPlace||this.attachPrimary(s.durations.primary,null))}get playbackDisabled(){return!1===this.hls.config.enableInterstitialPlayback}get primaryDetails(){var t;return null==(t=this.mediaSelection)?void 0:t.main.details}get primaryLive(){var t;return!(null==(t=this.primaryDetails)||!t.live)}resumePrimary(t,e,r){var n,i;if(this.playingItem=t,this.playingAsset=this.endedAsset=null,this.waitingItem=this.endedItem=null,this.bufferedToItem(t),this.log(`resuming ${ho(t)}`),null==(n=this.detachedData)||!n.mediaSource){let r=this.timelinePos;(r<t.start||r>=t.end)&&(r=this.getPrimaryResumption(t,e),this.log(go("resumePrimary",r)),this.timelinePos=r),this.attachPrimary(r,t)}if(!r)return;const s=null==(i=this.schedule)?void 0:i.items;s&&(this.log(`INTERSTITIALS_PRIMARY_RESUMED ${ho(t)}`),this.hls.trigger(l.INTERSTITIALS_PRIMARY_RESUMED,{schedule:s.slice(0),scheduleIndex:e}),this.checkBuffer())}getPrimaryResumption(t,e){const r=t.start;if(this.primaryLive){const t=this.primaryDetails;if(0===e)return this.hls.startPosition;if(t&&(r<t.fragmentStart||r>t.edge))return this.hls.liveSyncPosition||-1}return r}isAssetBuffered(t){const e=this.getAssetPlayer(t.identifier);if(null!=e&&e.hls)return e.hls.bufferedToEnd;return Ne.bufferInfo(this.primaryMedia,this.timelinePos,0).end+1>=t.timelineStart+(t.duration||0)}attachPrimary(t,e,r){e?this.setBufferingItem(e):this.bufferingItem=this.playingItem,this.bufferingAsset=null;const n=this.primaryMedia;if(!n)return;const i=this.hls;i.media?this.checkBuffer():(this.transferMediaTo(i,n),r&&this.startLoadingPrimaryAt(t,r)),r||(this.log(go("attachPrimary",t)),this.timelinePos=t,this.startLoadingPrimaryAt(t,r))}startLoadingPrimaryAt(t,e){var r;const n=this.hls;!n.loadingEnabled||!n.media||Math.abs(((null==(r=n.mainForwardBufferInfo)?void 0:r.start)||n.media.currentTime)-t)>.5?n.startLoad(t,e):n.bufferingEnabled||n.resumeBuffering()}onManifestLoading(){var t;this.stopLoad(),null==(t=this.schedule)||t.reset(),this.emptyPlayerQueue(),this.clearScheduleState(),this.shouldPlay=!1,this.bufferedPos=this.timelinePos=-1,this.mediaSelection=this.altSelection=this.manager=this.requiredTracks=null,this.hls.off(l.BUFFER_CODECS,this.onBufferCodecs,this),this.hls.on(l.BUFFER_CODECS,this.onBufferCodecs,this)}onLevelUpdated(t,e){if(-1===e.level||!this.schedule)return;const r=this.hls.levels[e.level],n=m(m({},this.mediaSelection||this.altSelection),{},{main:r});this.mediaSelection=n,this.schedule.parseInterstitialDateRanges(n,this.hls.config.interstitialAppendInPlace),!this.effectivePlayingItem&&this.schedule.items&&this.checkStart()}onAudioTrackUpdated(t,e){const r=this.hls.audioTracks[e.id],n=this.mediaSelection;if(!n)return void(this.altSelection=m(m({},this.altSelection),{},{audio:r}));const i=m(m({},n),{},{audio:r});this.mediaSelection=i}onSubtitleTrackUpdated(t,e){const r=this.hls.subtitleTracks[e.id],n=this.mediaSelection;if(!n)return void(this.altSelection=m(m({},this.altSelection),{},{subtitles:r}));const i=m(m({},n),{},{subtitles:r});this.mediaSelection=i}onAudioTrackSwitching(t,e){const r=zt(e);this.playerQueue.forEach((({hls:t})=>t&&(t.setAudioOption(e)||t.setAudioOption(r))))}onSubtitleTrackSwitch(t,e){const r=zt(e);this.playerQueue.forEach((({hls:t})=>t&&(t.setSubtitleOption(e)||-1!==e.id&&t.setSubtitleOption(r))))}onBufferCodecs(t,e){const r=e.tracks;r&&(this.requiredTracks=r)}onBufferAppended(t,e){this.checkBuffer()}onBufferFlushed(t,e){const r=this.playingItem;if(r&&!this.itemsMatch(r,this.bufferingItem)&&!this.isInterstitial(r)){const t=this.timelinePos;this.bufferedPos=t,this.checkBuffer()}}onBufferedToEnd(t){if(!this.schedule)return;const e=this.schedule.events;if(this.bufferedPos<Number.MAX_VALUE&&e){for(let t=0;t<e.length;t++){const n=e[t];if(n.cue.post){var r;const t=this.schedule.findEventIndex(n.identifier),e=null==(r=this.schedule.items)?void 0:r[t];this.isInterstitial(e)&&this.eventItemsMatch(e,this.bufferingItem)&&this.bufferedToItem(e,0);break}}this.bufferedPos=Number.MAX_VALUE}}onMediaEnded(t){const e=this.playingItem;if(!this.playingLastItem&&e){const t=this.findItemIndex(e);this.setSchedulePosition(t+1)}else this.shouldPlay=!1}updateItem(t,e){var r;const n=null==(r=this.schedule)?void 0:r.items;if(t&&n){return n[this.findItemIndex(t,e)]||null}return null}trimInPlace(t,e){if(this.isInterstitial(t)&&t.event.appendInPlace&&e.end-t.end>.25){t.event.assetList.forEach(((e,r)=>{t.event.isAssetPastPlayoutLimit(r)&&this.clearAssetPlayer(e.identifier,null)}));const r=t.end+.25,n=Ne.bufferInfo(this.primaryMedia,r,0);if(n.end>r||(n.nextStart||0)>r){this.log(`trim buffered interstitial ${ho(t)} (was ${ho(e)})`);const n=!0;this.attachPrimary(r,null,n),this.flushFrontBuffer(r)}}}itemsMatch(t,e){return!!e&&(t===e||t.event&&e.event&&this.eventItemsMatch(t,e)||!t.event&&!e.event&&this.findItemIndex(t)===this.findItemIndex(e))}eventItemsMatch(t,e){var r;return!!e&&(t===e||t.event.identifier===(null==(r=e.event)?void 0:r.identifier))}findItemIndex(t,e){return t&&this.schedule?this.schedule.findItemIndex(t,e):-1}updateSchedule(t=!1){var e;const r=this.mediaSelection;r&&(null==(e=this.schedule)||e.updateSchedule(r,[],t))}checkBuffer(t){var e;const r=null==(e=this.schedule)?void 0:e.items;if(!r)return;const n=Ne.bufferInfo(this.primaryMedia,this.timelinePos,0);t&&(this.bufferedPos=this.timelinePos),t||(t=n.len<1),this.updateBufferedPos(n.end,r,t)}updateBufferedPos(t,e,r){const n=this.schedule,i=this.bufferingItem;if(this.bufferedPos>t||!n)return;if(1===e.length&&this.itemsMatch(e[0],i))return void(this.bufferedPos=t);const s=this.playingItem,o=this.findItemIndex(s);let a=n.findItemIndexAtTime(t);if(this.bufferedPos<t){var l;const r=this.findItemIndex(i),n=Math.min(r+1,e.length-1),s=e[n];if((-1===a&&i&&t>=i.end||null!=(l=s.event)&&l.appendInPlace&&t+.01>=s.start)&&(a=n),this.isInterstitial(i)){const t=i.event;if(n-o>1&&!1===t.appendInPlace)return;if(0===t.assetList.length&&t.assetListLoader)return}if(this.bufferedPos=t,a>r&&a>o)this.bufferedToItem(s);else{const e=this.primaryDetails;this.primaryLive&&e&&t>e.edge-e.targetduration&&s.start<e.edge+this.hls.config.interstitialLiveLookAhead&&this.isInterstitial(s)&&this.preloadAssets(s.event,0)}}else r&&s&&!this.itemsMatch(s,i)&&(a===o?this.bufferedToItem(s):a===o+1&&this.bufferedToItem(e[a]))}assetsBuffered(t,e){return 0!==t.event.assetList.length&&!t.event.assetList.some((t=>{const r=this.getAssetPlayer(t.identifier);return!(null!=r&&r.bufferedInPlaceToEnd(e))}))}setBufferingItem(t){const e=this.bufferingItem,r=this.schedule;if(!this.itemsMatch(t,e)&&r){const{items:n,events:i}=r;if(!n||!i)return e;const s=this.isInterstitial(t),o=this.getBufferingPlayer();this.bufferingItem=t,this.bufferedPos=Math.max(t.start,Math.min(t.end,this.timelinePos));const a=o?o.remaining:e?e.end-this.timelinePos:0;if(this.log(`INTERSTITIALS_BUFFERED_TO_BOUNDARY ${ho(t)}`+(e?` (${a.toFixed(2)} remaining)`:"")),!this.playbackDisabled)if(s){const e=r.findAssetIndex(t.event,this.bufferedPos);t.event.assetList.forEach(((t,r)=>{const n=this.getAssetPlayer(t.identifier);n&&(r===e&&n.loadSource(),n.resumeBuffering())}))}else this.hls.resumeBuffering(),this.playerQueue.forEach((t=>t.pauseBuffering()));this.hls.trigger(l.INTERSTITIALS_BUFFERED_TO_BOUNDARY,{events:i.slice(0),schedule:n.slice(0),bufferingIndex:this.findItemIndex(t),playingIndex:this.findItemIndex(this.playingItem)})}else this.bufferingItem!==t&&(this.bufferingItem=t);return e}bufferedToItem(t,e=0){const r=this.setBufferingItem(t);if(!this.playbackDisabled)if(this.isInterstitial(t))this.bufferedToEvent(t,e);else if(null!==r){this.bufferingAsset=null;const e=this.detachedData;if(e)if(e.mediaSource){const e=!0;this.attachPrimary(t.start,t,e)}else this.preloadPrimary(t);else this.preloadPrimary(t)}}preloadPrimary(t){const e=this.findItemIndex(t),r=this.getPrimaryResumption(t,e);this.startLoadingPrimaryAt(r)}bufferedToEvent(t,e){const r=t.event,n=0===r.assetList.length&&!r.assetListLoader,i=r.cue.once;if(n||!i){const t=this.preloadAssets(r,e);if(null!=t&&t.interstitial.appendInPlace){const e=this.primaryMedia;e&&this.bufferAssetPlayer(t,e)}}}preloadAssets(t,e){const r=t.assetUrl,n=t.assetList.length,i=0===n&&!t.assetListLoader,s=t.cue.once;if(i){const i=t.timelineStart;if(t.appendInPlace){var o;const e=this.playingItem;this.isInterstitial(e)||(null==e||null==(o=e.nextEvent)?void 0:o.identifier)!==t.identifier||this.flushFrontBuffer(i+.25)}let s,a=0;if(!this.playingItem&&this.primaryLive&&(a=this.hls.startPosition,-1===a&&(a=this.hls.liveSyncPosition||0)),a&&!t.cue.pre&&!t.cue.post){const t=a-i;t>0&&(s=Math.round(1e3*t)/1e3)}if(this.log(`Load interstitial asset ${e+1}/${r?1:n} ${t}${s?` live-start: ${a} start-offset: ${s}`:""}`),r)return this.createAsset(t,0,0,i,t.duration,r);const l=this.assetListLoader.loadAssetList(t,s);l&&(t.assetListLoader=l)}else if(!s&&n){for(let r=e;r<n;r++){const e=t.assetList[r],n=this.getAssetPlayerQueueIndex(e.identifier);-1!==n&&!this.playerQueue[n].destroyed||e.error||this.createAssetPlayer(t,e,r)}const r=t.assetList[e];if(r){const t=this.getAssetPlayer(r.identifier);return t&&t.loadSource(),t}}return null}flushFrontBuffer(t){const e=this.requiredTracks;if(!e)return;this.log(`Removing front buffer starting at ${t}`);Object.keys(e).forEach((e=>{this.hls.trigger(l.BUFFER_FLUSHING,{startOffset:t,endOffset:1/0,type:e})}))}getAssetPlayerQueueIndex(t){const e=this.playerQueue;for(let r=0;r<e.length;r++)if(t===e[r].assetId)return r;return-1}getAssetPlayer(t){const e=this.getAssetPlayerQueueIndex(t);return this.playerQueue[e]||null}getBufferingPlayer(){const{playerQueue:t,primaryMedia:e}=this;if(e)for(let r=0;r<t.length;r++)if(t[r].media===e)return t[r];return null}createAsset(t,e,r,n,i,s){const o={parentIdentifier:t.identifier,identifier:no(t,s,e),duration:i,startOffset:r,timelineStart:n,uri:s};return this.createAssetPlayer(t,o,e)}createAssetPlayer(t,e,r){const n=this.hls,i=n.userConfig;let s=i.videoPreference;const c=n.loadLevelObj||n.levels[n.currentLevel];(s||c)&&(s=p({},s),c.videoCodec&&(s.videoCodec=c.videoCodec),c.videoRange&&(s.allowedVideoRanges=[c.videoRange]));const u=n.audioTracks[n.audioTrack],h=n.subtitleTracks[n.subtitleTrack];let d=0;if(this.primaryLive||t.appendInPlace){const t=this.timelinePos-e.timelineStart;if(t>1){const r=e.duration;r&&t<r&&(d=t)}}const f=e.identifier,g=m(m({},i),{},{maxMaxBufferLength:Math.min(180,n.config.maxMaxBufferLength),autoStartLoad:!0,startFragPrefetch:!0,primarySessionId:n.sessionId,assetPlayerId:f,abrEwmaDefaultEstimate:n.bandwidthEstimate,interstitialsController:void 0,startPosition:d,liveDurationInfinity:!1,testBandwidth:!1,videoPreference:s,audioPreference:u||i.audioPreference,subtitlePreference:h||i.subtitlePreference});t.appendInPlace&&(t.appendInPlaceStarted=!0,e.timelineStart&&(g.timelineOffset=e.timelineStart));const y=g.cmcd;null!=y&&y.sessionId&&y.contentId&&(g.cmcd=p({},y,{contentId:to(e.uri)})),this.getAssetPlayer(f)&&this.warn(`Duplicate date range identifier ${t} and asset ${f}`);const v=new co(this.HlsPlayerClass,g,t,e);this.playerQueue.push(v),t.assetList[r]=e;let b=!0;const E=n=>{if(n.live){var i;const e=new Error(`Interstitials MUST be VOD assets ${t}`),n={fatal:!0,type:o.OTHER_ERROR,details:a.INTERSTITIAL_ASSET_ITEM_ERROR,error:e},s=(null==(i=this.schedule)?void 0:i.findEventIndex(t.identifier))||-1;return void this.handleAssetItemError(n,t,s,r,e.message)}const s=n.edge-n.fragmentStart,l=e.duration;(b||null===l||s>l)&&(b=!1,this.log(`Interstitial asset "${f}" duration change ${l} > ${s}`),e.duration=s,this.updateSchedule())};v.on(l.LEVEL_UPDATED,((t,{details:e})=>E(e))),v.on(l.LEVEL_PTS_UPDATED,((t,{details:e})=>E(e))),v.on(l.EVENT_CUE_ENTER,(()=>this.onInterstitialCueEnter()));const A=(t,e)=>{const r=this.getAssetPlayer(f);if(r&&e.tracks){r.off(l.BUFFER_CODECS,A),r.tracks=e.tracks;const t=this.primaryMedia;this.bufferingAsset===r.assetItem&&t&&!r.media&&this.bufferAssetPlayer(r,t)}};v.on(l.BUFFER_CODECS,A);v.on(l.BUFFERED_TO_END,(()=>{var r;const n=this.getAssetPlayer(f);if(this.log(`buffered to end of asset ${n}`),!n||!this.schedule)return;const i=this.schedule.findEventIndex(t.identifier),s=null==(r=this.schedule.items)?void 0:r[i];this.isInterstitial(s)&&this.advanceAssetBuffering(s,e)}));const w=e=>()=>{if(!this.getAssetPlayer(f)||!this.schedule)return;this.shouldPlay=!0;const r=this.schedule.findEventIndex(t.identifier);this.advanceAfterAssetEnded(t,r,e)};return v.once(l.MEDIA_ENDED,w(r)),v.once(l.PLAYOUT_LIMIT_REACHED,w(1/0)),v.on(l.ERROR,((e,n)=>{if(!this.schedule)return;const i=this.getAssetPlayer(f);if(n.details===a.BUFFER_STALLED_ERROR)return null!=i&&i.appendInPlace?void this.handleInPlaceStall(t):(this.onTimeupdate(),void this.checkBuffer(!0));this.handleAssetItemError(n,t,this.schedule.findEventIndex(t.identifier),r,`Asset player error ${n.error} ${t}`)})),v.on(l.DESTROYING,(()=>{if(!this.getAssetPlayer(f)||!this.schedule)return;const e=new Error(`Asset player destroyed unexpectedly ${f}`),n={fatal:!0,type:o.OTHER_ERROR,details:a.INTERSTITIAL_ASSET_ITEM_ERROR,error:e};this.handleAssetItemError(n,t,this.schedule.findEventIndex(t.identifier),r,e.message)})),this.log(`INTERSTITIAL_ASSET_PLAYER_CREATED ${lo(e)}`),this.hls.trigger(l.INTERSTITIAL_ASSET_PLAYER_CREATED,{asset:e,assetListIndex:r,event:t,player:v}),v}clearInterstitial(t,e){t.assetList.forEach((t=>{this.clearAssetPlayer(t.identifier,e)})),t.reset()}resetAssetPlayer(t){const e=this.getAssetPlayerQueueIndex(t);if(-1!==e){this.log(`reset asset player "${t}" after error`);const r=this.playerQueue[e];this.transferMediaFromPlayer(r,null),r.resetDetails()}}clearAssetPlayer(t,e){const r=this.getAssetPlayerQueueIndex(t);if(-1!==r){const t=this.playerQueue[r];this.log(`clear ${t} toSegment: ${e?ho(e):e}`),this.transferMediaFromPlayer(t,e),this.playerQueue.splice(r,1),t.destroy()}}emptyPlayerQueue(){let t;for(;t=this.playerQueue.pop();)t.destroy();this.playerQueue=[]}startAssetPlayer(t,e,r,n,i){const{interstitial:s,assetItem:o,assetId:a}=t,c=s.assetList.length,u=this.playingAsset;this.endedAsset=null,this.playingAsset=o,u&&u.identifier===a||(u&&(this.clearAssetPlayer(u.identifier,r[n]),delete u.error),this.log(`INTERSTITIAL_ASSET_STARTED ${e+1}/${c} ${lo(o)}`),this.hls.trigger(l.INTERSTITIAL_ASSET_STARTED,{asset:o,assetListIndex:e,event:s,schedule:r.slice(0),scheduleIndex:n,player:t})),this.bufferAssetPlayer(t,i)}bufferAssetPlayer(t,e){var r,n;if(!this.schedule)return;const{interstitial:i,assetItem:s}=t,l=this.schedule.findEventIndex(i.identifier),c=null==(r=this.schedule.items)?void 0:r[l];if(!c)return;t.loadSource(),this.setBufferingItem(c),this.bufferingAsset=s;const u=this.getBufferingPlayer();if(u===t)return;const h=i.appendInPlace;if(h&&!1===(null==u?void 0:u.interstitial.appendInPlace))return;const d=(null==u?void 0:u.tracks)||(null==(n=this.detachedData)?void 0:n.tracks)||this.requiredTracks;if(h&&s!==this.playingAsset){if(!t.tracks)return void this.log(`Waiting for track info before buffering ${t}`);if(d&&!L(d,t.tracks)){const e=new Error(`Asset ${lo(s)} SourceBuffer tracks ('${Object.keys(t.tracks)}') are not compatible with primary content tracks ('${Object.keys(d)}')`),r={fatal:!0,type:o.OTHER_ERROR,details:a.INTERSTITIAL_ASSET_ITEM_ERROR,error:e},n=i.findAssetIndex(s);return void this.handleAssetItemError(r,i,l,n,e.message)}}this.transferMediaTo(t,e)}handleInPlaceStall(t){const e=this.schedule,r=this.primaryMedia;if(!e||!r)return;const n=r.currentTime,i=e.findAssetIndex(t,n),s=t.assetList[i];if(s){const o=this.getAssetPlayer(s.identifier);if(o){const a=o.currentTime||n-s.timelineStart,l=o.duration-a;if(this.warn(`Stalled at ${a} of ${a+l} in ${o} ${t} (media.currentTime: ${n})`),a&&(l/r.playbackRate<.5||o.bufferedInPlaceToEnd(r))&&o.hls){const r=e.findEventIndex(t.identifier);this.advanceAfterAssetEnded(t,r,i)}}}}advanceInPlace(t){const e=this.primaryMedia;e&&e.currentTime<t&&(e.currentTime=t)}handleAssetItemError(t,e,r,n,i){if(t.details===a.BUFFER_STALLED_ERROR)return;const s=e.assetList[n]||null;if(this.warn(`INTERSTITIAL_ASSET_ERROR ${s?lo(s):s} ${t.error}`),!this.schedule)return;const o=(null==s?void 0:s.identifier)||"",c=this.getAssetPlayerQueueIndex(o),u=this.playerQueue[c]||null,h=this.schedule.items,d=p({},t,{fatal:!1,errorAction:pe(!0),asset:s,assetListIndex:n,event:e,schedule:h,scheduleIndex:r,player:u});if(this.hls.trigger(l.INTERSTITIAL_ASSET_ERROR,d),!t.fatal)return;const f=this.playingAsset,g=this.bufferingAsset,m=new Error(i);if(s&&(this.clearAssetPlayer(o,null),s.error=m),e.assetList.some((t=>!t.error)))for(let t=n;t<e.assetList.length;t++)this.resetAssetPlayer(e.assetList[t].identifier);else e.error=m;this.updateSchedule(!0),e.error?this.primaryFallback(e):f&&f.identifier===o?this.advanceAfterAssetEnded(e,r,n):g&&g.identifier===o&&this.isInterstitial(this.bufferingItem)&&this.advanceAssetBuffering(this.bufferingItem,g)}primaryFallback(t){const e=t.timelineStart,r=this.effectivePlayingItem;if(r){this.log(`Fallback to primary from event "${t.identifier}" start: ${e} pos: ${this.timelinePos} playing: ${ho(r)} error: ${t.error}`);let n=this.timelinePos;-1===n&&(n=this.hls.startPosition);const i=this.updateItem(r,n);if(this.itemsMatch(r,i)&&this.clearInterstitial(t,null),t.appendInPlace&&(this.attachPrimary(e,null),this.flushFrontBuffer(e)),!this.schedule)return;const s=this.schedule.findItemIndexAtTime(n);this.setSchedulePosition(s)}else this.checkStart()}onAssetListLoaded(t,e){var r,n;const i=e.event,s=i.identifier,o=e.assetListResponse.ASSETS;if(null==(r=this.schedule)||!r.hasEvent(s))return;const a=i.timelineStart,l=i.duration;let c=0;o.forEach(((t,e)=>{const r=parseFloat(t.DURATION);this.createAsset(i,e,c,a+c,r,t.URI),c+=r})),i.duration=c,this.log(`Loaded asset-list with duration: ${c} (was: ${l}) ${i}`);const u=this.waitingItem,h=(null==u?void 0:u.event.identifier)===s;this.updateSchedule();const d=null==(n=this.bufferingItem)?void 0:n.event;if(h){var f;const t=this.schedule.findEventIndex(s),e=null==(f=this.schedule.items)?void 0:f[t];if(e){if(!this.playingItem&&this.timelinePos>e.end){if(this.schedule.findItemIndexAtTime(this.timelinePos)!==t)return i.error=new Error(`Interstitial no longer within playback range ${this.timelinePos} ${i}`),this.updateSchedule(!0),void this.primaryFallback(i)}this.setBufferingItem(e)}this.setSchedulePosition(t)}else if((null==d?void 0:d.identifier)===s){const t=i.assetList[0];if(t){const e=this.getAssetPlayer(t.identifier);if(d.appendInPlace){const t=this.primaryMedia;e&&t&&this.bufferAssetPlayer(e,t)}else e&&e.loadSource()}}}onError(t,e){if(this.schedule)switch(e.details){case a.ASSET_LIST_PARSING_ERROR:case a.ASSET_LIST_LOAD_ERROR:case a.ASSET_LIST_LOAD_TIMEOUT:{const t=e.interstitial;t&&(this.updateSchedule(!0),this.primaryFallback(t));break}case a.BUFFER_STALLED_ERROR:{const t=this.endedItem||this.waitingItem||this.playingItem;if(this.isInterstitial(t)&&t.event.appendInPlace)return void this.handleInPlaceStall(t.event);this.log(`Primary player stall @${this.timelinePos} bufferedPos: ${this.bufferedPos}`),this.onTimeupdate(),this.checkBuffer(!0);break}}}}});function Aa(t){return t&&"object"==typeof t?Array.isArray(t)?t.map(Aa):Object.keys(t).reduce(((e,r)=>(e[r]=Aa(t[r]),e)),{}):t}function wa(t,e){const r=t.loader;if(r!==ga&&r!==ba)e.log("[config]: Custom loader detected, cannot enable progressive streaming"),t.progressive=!1;else{(function(){if(self.fetch&&self.AbortController&&self.ReadableStream&&self.Request)try{return new self.ReadableStream({}),!0}catch(t){}return!1})()&&(t.loader=ga,t.progressive=!0,t.enableSoftwareAES=!0,e.log("[config]: Progressive streaming enabled, using FetchLoader"))}}class Ta extends De{constructor(t,e){super("gap-controller",t.logger),this.hls=void 0,this.fragmentTracker=void 0,this.media=null,this.mediaSource=void 0,this.nudgeRetry=0,this.stallReported=!1,this.stalled=null,this.moved=!1,this.seeking=!1,this.buffered={},this.lastCurrentTime=0,this.ended=0,this.waiting=0,this.onMediaPlaying=()=>{this.ended=0,this.waiting=0},this.onMediaWaiting=()=>{var t;null!=(t=this.media)&&t.seeking||(this.waiting=self.performance.now(),this.tick())},this.onMediaEnded=()=>{var t;this.hls&&(this.ended=(null==(t=this.media)?void 0:t.currentTime)||1,this.hls.trigger(l.MEDIA_ENDED,{stalled:!1}))},this.hls=t,this.fragmentTracker=e,this.registerListeners()}registerListeners(){const{hls:t}=this;t&&(t.on(l.MEDIA_ATTACHED,this.onMediaAttached,this),t.on(l.MEDIA_DETACHING,this.onMediaDetaching,this),t.on(l.BUFFER_APPENDED,this.onBufferAppended,this))}unregisterListeners(){const{hls:t}=this;t&&(t.off(l.MEDIA_ATTACHED,this.onMediaAttached,this),t.off(l.MEDIA_DETACHING,this.onMediaDetaching,this),t.off(l.BUFFER_APPENDED,this.onBufferAppended,this))}destroy(){super.destroy(),this.unregisterListeners(),this.media=this.hls=this.fragmentTracker=null,this.mediaSource=void 0}onMediaAttached(t,e){this.setInterval(100),this.mediaSource=e.mediaSource;const r=this.media=e.media;Yr(r,"playing",this.onMediaPlaying),Yr(r,"waiting",this.onMediaWaiting),Yr(r,"ended",this.onMediaEnded)}onMediaDetaching(t,e){this.clearInterval();const{media:r}=this;r&&(qr(r,"playing",this.onMediaPlaying),qr(r,"waiting",this.onMediaWaiting),qr(r,"ended",this.onMediaEnded),this.media=null),this.mediaSource=void 0}onBufferAppended(t,e){this.buffered=e.timeRanges}get hasBuffered(){return Object.keys(this.buffered).length>0}tick(){var t;if(null==(t=this.media)||!t.readyState||!this.hasBuffered)return;const e=this.media.currentTime;this.poll(e,this.lastCurrentTime),this.lastCurrentTime=e}poll(t,e){var r,n;const i=null==(r=this.hls)?void 0:r.config;if(!i)return;const s=this.media;if(!s)return;const{seeking:o}=s,a=this.seeking&&!o,c=!this.seeking&&o,u=s.paused&&!o||s.ended||0===s.playbackRate;if(this.seeking=o,t!==e)return e&&(this.ended=0),this.moved=!0,o||(this.nudgeRetry=0,i.nudgeOnVideoHole&&!u&&t>e&&this.nudgeOnVideoHole(t,e)),void(0===this.waiting&&this.stallResolved(t));if(c||a)return void(a&&this.stallResolved(t));if(u)return this.nudgeRetry=0,this.stallResolved(t),void(!this.ended&&s.ended&&this.hls&&(this.ended=t||1,this.hls.trigger(l.MEDIA_ENDED,{stalled:!1})));if(!Ne.getBuffered(s).length)return void(this.nudgeRetry=0);const h=Ne.bufferInfo(s,t,0),d=h.nextStart||0,f=this.fragmentTracker;if(o&&f&&this.hls){const e=Sa(this.hls.inFlightFragments,t),r=h.len>2,n=!d||e||d-t>2&&!f.getPartialFragment(t);if(r||n)return;this.moved=!1}const p=null==(n=this.hls)?void 0:n.latestLevelDetails;if(!this.moved&&null!==this.stalled&&f){if(!(h.len>0)&&!d)return;const e=Math.max(d,h.start||0)-t,r=!(null==p||!p.live)?2*p.targetduration:2,n=_a(t,f);if(e>0&&(e<=r||n))return void(s.paused||this._trySkipBufferHole(n))}const g=i.detectStallWithCurrentTimeMs,m=self.performance.now(),y=this.waiting;let v=this.stalled;if(null===v){if(!(y>0&&m-y<g))return void(this.stalled=m);v=this.stalled=y}const b=m-v;if(!o&&(b>=g||y)&&this.hls){var E;if("ended"===(null==(E=this.mediaSource)?void 0:E.readyState)&&(null==p||!p.live)&&Math.abs(t-((null==p?void 0:p.edge)||0))<1){if(this.ended)return;return this.ended=t||1,void this.hls.trigger(l.MEDIA_ENDED,{stalled:!0})}if(this._reportStall(h),!this.media||!this.hls)return}const A=Ne.bufferInfo(s,t,i.maxBufferHole);this._tryFixBufferStall(A,b,t)}stallResolved(t){const e=this.stalled;if(e&&this.hls&&(this.stalled=null,this.stallReported)){const r=self.performance.now()-e;this.log(`playback not stuck anymore @${t}, after ${Math.round(r)}ms`),this.stallReported=!1,this.waiting=0,this.hls.trigger(l.STALL_RESOLVED,{})}}nudgeOnVideoHole(t,e){var r;const n=this.buffered.video;if(this.hls&&this.media&&this.fragmentTracker&&null!=(r=this.buffered.audio)&&r.length&&n&&n.length>1&&t>n.end(0)){const r=Ne.bufferedInfo(Ne.timeRangesToArray(this.buffered.audio),t,0);if(r.len>1&&e>=r.start){const r=Ne.timeRangesToArray(n),i=Ne.bufferedInfo(r,e,0).bufferedIndex;if(i>-1&&i<r.length-1){const e=Ne.bufferedInfo(r,t,0).bufferedIndex,n=r[i].end,s=r[i+1].start;if((-1===e||e>i)&&s-n<1&&t-n<2){const r=new Error(`nudging playhead to flush pipeline after video hole. currentTime: ${t} hole: ${n} -> ${s} buffered index: ${e}`);this.warn(r.message),this.media.currentTime+=1e-6;let i=_a(t,this.fragmentTracker);i&&"fragment"in i?i=i.fragment:i||(i=void 0);const c=Ne.bufferInfo(this.media,t,0);this.hls.trigger(l.ERROR,{type:o.MEDIA_ERROR,details:a.BUFFER_SEEK_OVER_HOLE,fatal:!1,error:r,reason:r.message,frag:i,buffer:c.len,bufferInfo:c})}}}}}_tryFixBufferStall(t,e,r){var n,i;const{fragmentTracker:s,media:o}=this,a=null==(n=this.hls)?void 0:n.config;if(!o||!s||!a)return;const l=null==(i=this.hls)?void 0:i.latestLevelDetails,c=_a(r,s);if(c||null!=l&&l.live&&r<l.fragmentStart){if(this._trySkipBufferHole(c)||!this.media)return}const u=t.buffered,h=this.adjacentTraversal(t,r);(u&&u.length>1&&t.len>a.maxBufferHole||t.nextStart&&(t.nextStart-r<a.maxBufferHole||h))&&(e>1e3*a.highBufferWatchdogPeriod||this.waiting)&&(this.warn("Trying to nudge playhead over buffer-hole"),this._tryNudgeBuffer(t))}adjacentTraversal(t,e){const r=this.fragmentTracker,n=t.nextStart;if(r&&n){const t=r.getFragAtPos(e,u.MAIN),i=r.getFragAtPos(n,u.MAIN);if(t&&i)return i.sn-t.sn<2}return!1}_reportStall(t){const{hls:e,media:r,stallReported:n,stalled:i}=this;if(!n&&null!==i&&r&&e){this.stallReported=!0;const n=new Error(`Playback stalling at @${r.currentTime} due to low buffer (${Yt(t)})`);this.warn(n.message),e.trigger(l.ERROR,{type:o.MEDIA_ERROR,details:a.BUFFER_STALLED_ERROR,fatal:!1,error:n,buffer:t.len,bufferInfo:t,stalled:{start:i}})}}_trySkipBufferHole(t){var e;const{fragmentTracker:r,media:n}=this,i=null==(e=this.hls)?void 0:e.config;if(!n||!r||!i)return 0;const s=n.currentTime,c=Ne.bufferInfo(n,s,0),h=s<c.start?c.start:c.nextStart;if(h&&this.hls){const e=c.len<=i.maxBufferHole,f=c.len>0&&c.len<1&&n.readyState<3,p=h-s;if(p>0&&(e||f)){if(p>i.maxBufferHole){let e=!1;if(0===s){const t=r.getAppendedFrag(0,u.MAIN);t&&h<t.end&&(e=!0)}if(!e&&t){var d;if(null==(d=this.hls.loadLevelObj)||!d.details)return 0;if(Sa(this.hls.inFlightFragments,h))return 0;let e=!1,n=t.end;for(;n<h;){const t=_a(n,r);if(!t){e=!0;break}n+=t.duration}if(e)return 0}}const e=Math.max(h+.05,s+.1);if(this.warn(`skipping hole, adjusting currentTime from ${s} to ${e}`),this.moved=!0,n.currentTime=e,null==t||!t.gap){const r=new Error(`fragment loaded with buffer holes, seeking from ${s} to ${e}`),n={type:o.MEDIA_ERROR,details:a.BUFFER_SEEK_OVER_HOLE,fatal:!1,error:r,reason:r.message,buffer:c.len,bufferInfo:c};t&&("fragment"in t?n.part=t:n.frag=t),this.hls.trigger(l.ERROR,n)}return e}}return 0}_tryNudgeBuffer(t){const{hls:e,media:r,nudgeRetry:n}=this,i=null==e?void 0:e.config;if(!r||!i)return 0;const s=r.currentTime;if(this.nudgeRetry++,n<i.nudgeMaxRetry){const c=s+(n+1)*i.nudgeOffset,u=new Error(`Nudging 'currentTime' from ${s} to ${c}`);this.warn(u.message),r.currentTime=c,e.trigger(l.ERROR,{type:o.MEDIA_ERROR,details:a.BUFFER_NUDGE_ON_STALL,error:u,fatal:!1,buffer:t.len,bufferInfo:t})}else{const r=new Error(`Playhead still not moving while enough data buffered @${s} after ${i.nudgeMaxRetry} nudges`);this.error(r.message),e.trigger(l.ERROR,{type:o.MEDIA_ERROR,details:a.BUFFER_STALLED_ERROR,error:r,fatal:!0,buffer:t.len,bufferInfo:t})}}}function Sa(t,e){const r=La(t.main);if(r&&r.start<=e)return r;const n=La(t.audio);return n&&n.start<=e?n:null}function La(t){if(!t)return null;switch(t.state){case zr.IDLE:case zr.STOPPED:case zr.ENDED:case zr.ERROR:return null}return t.frag}function _a(t,e){return e.getAppendedFrag(t,u.MAIN)||e.getPartialFragment(t)}function xa(){if("undefined"!=typeof self)return self.VTTCue||self.TextTrackCue}function ka(t,e,r,n,i){let s=new t(e,r,"");try{s.value=n,i&&(s.type=i)}catch(o){s=new t(e,r,Yt(i?m({type:i},n):n))}return s}const Pa=(()=>{const t=xa();try{t&&new t(0,Number.POSITIVE_INFINITY,"")}catch(t){return Number.MAX_VALUE}return Number.POSITIVE_INFINITY})();class Ia{constructor(t){this.hls=void 0,this.id3Track=null,this.media=null,this.dateRangeCuesAppended={},this.removeCues=!0,this.assetCue=void 0,this.onEventCueEnter=()=>{this.hls&&this.hls.trigger(l.EVENT_CUE_ENTER,{})},this.hls=t,this._registerListeners()}destroy(){this._unregisterListeners(),this.id3Track=null,this.media=null,this.dateRangeCuesAppended={},this.hls=this.onEventCueEnter=null}_registerListeners(){const{hls:t}=this;t&&(t.on(l.MEDIA_ATTACHING,this.onMediaAttaching,this),t.on(l.MEDIA_ATTACHED,this.onMediaAttached,this),t.on(l.MEDIA_DETACHING,this.onMediaDetaching,this),t.on(l.MANIFEST_LOADING,this.onManifestLoading,this),t.on(l.FRAG_PARSING_METADATA,this.onFragParsingMetadata,this),t.on(l.BUFFER_FLUSHING,this.onBufferFlushing,this),t.on(l.LEVEL_UPDATED,this.onLevelUpdated,this),t.on(l.LEVEL_PTS_UPDATED,this.onLevelPtsUpdated,this))}_unregisterListeners(){const{hls:t}=this;t&&(t.off(l.MEDIA_ATTACHING,this.onMediaAttaching,this),t.off(l.MEDIA_ATTACHED,this.onMediaAttached,this),t.off(l.MEDIA_DETACHING,this.onMediaDetaching,this),t.off(l.MANIFEST_LOADING,this.onManifestLoading,this),t.off(l.FRAG_PARSING_METADATA,this.onFragParsingMetadata,this),t.off(l.BUFFER_FLUSHING,this.onBufferFlushing,this),t.off(l.LEVEL_UPDATED,this.onLevelUpdated,this),t.off(l.LEVEL_PTS_UPDATED,this.onLevelPtsUpdated,this))}onMediaAttaching(t,e){var r;this.media=e.media,!1===(null==(r=e.overrides)?void 0:r.cueRemoval)&&(this.removeCues=!1)}onMediaAttached(){var t;const e=null==(t=this.hls)?void 0:t.latestLevelDetails;e&&this.updateDateRangeCues(e)}onMediaDetaching(t,e){this.media=null;!!e.transferMedia||(this.id3Track&&(this.removeCues&&Qs(this.id3Track,this.onEventCueEnter),this.id3Track=null),this.dateRangeCuesAppended={})}onManifestLoading(){this.dateRangeCuesAppended={}}createTrack(t){const e=this.getID3Track(t.textTracks);return e.mode="hidden",e}getID3Track(t){if(this.media){for(let e=0;e<t.length;e++){const r=t[e];if("metadata"===r.kind&&"id3"===r.label)return zs(r,this.media),r}return this.media.addTextTrack("metadata","id3")}}onFragParsingMetadata(t,e){if(!this.media||!this.hls)return;const{enableEmsgMetadataCues:r,enableID3MetadataCues:n}=this.hls.config;if(!r&&!n)return;const{samples:i}=e;this.id3Track||(this.id3Track=this.createTrack(this.media));const s=xa();if(s)for(let t=0;t<i.length;t++){const e=i[t].type;if(e===Pn.emsg&&!r||!n)continue;const o=Ln(i[t].data),a=i[t].pts;let l=a+i[t].duration;l>Pa&&(l=Pa);l-a<=0&&(l=a+.25);for(let t=0;t<o.length;t++){const r=o[t];if(!_n(r)){this.updateId3CueEnds(a,e);const t=ka(s,a,l,r,e);t&&this.id3Track.addCue(t)}}}}updateId3CueEnds(t,e){var r;const n=null==(r=this.id3Track)?void 0:r.cues;if(n)for(let r=n.length;r--;){const i=n[r];i.type===e&&i.startTime<t&&i.endTime===Pa&&(i.endTime=t)}}onBufferFlushing(t,{startOffset:e,endOffset:r,type:n}){const{id3Track:i,hls:s}=this;if(!s)return;const{config:{enableEmsgMetadataCues:o,enableID3MetadataCues:a}}=s;if(i&&(o||a)){let t;t="audio"===n?t=>t.type===Pn.audioId3&&a:"video"===n?t=>t.type===Pn.emsg&&o:t=>t.type===Pn.audioId3&&a||t.type===Pn.emsg&&o,Js(i,e,r,t)}}onLevelUpdated(t,{details:e}){this.updateDateRangeCues(e,!0)}onLevelPtsUpdated(t,e){Math.abs(e.drift)>.01&&this.updateDateRangeCues(e.details)}updateDateRangeCues(t,e){if(!this.hls||!this.media)return;const{assetPlayerId:r,timelineOffset:i,enableDateRangeMetadataCues:s,interstitialsController:o}=this.hls.config;if(!s)return;const a=xa();if(r&&i&&!o){const{fragmentStart:e,fragmentEnd:n}=t;let i=this.assetCue;i?(i.startTime=e,i.endTime=n):a&&(i=this.assetCue=ka(a,e,n,{assetPlayerId:this.hls.config.assetPlayerId},"hlsjs.interstitial.asset"),i&&(i.id=r,this.id3Track||(this.id3Track=this.createTrack(this.media)),this.id3Track.addCue(i),i.addEventListener("enter",this.onEventCueEnter)))}if(!t.hasProgramDateTime)return;const{id3Track:l}=this,{dateRanges:c}=t,u=Object.keys(c);let h=this.dateRangeCuesAppended;var d;if(l&&e)if(null!=(d=l.cues)&&d.length){const t=Object.keys(h).filter((t=>!u.includes(t)));for(let e=t.length;e--;){var f;const r=t[e],n=null==(f=h[r])?void 0:f.cues;delete h[r],n&&Object.keys(n).forEach((t=>{const e=n[t];if(e){e.removeEventListener("enter",this.onEventCueEnter);try{l.removeCue(e)}catch(t){}}}))}}else h=this.dateRangeCuesAppended={};const p=t.fragments[t.fragments.length-1];if(0!==u.length&&n(null==p?void 0:p.programDateTime)){this.id3Track||(this.id3Track=this.createTrack(this.media));for(let t=0;t<u.length;t++){const e=u[t],r=c[e],n=r.startTime,i=h[e],s=(null==i?void 0:i.cues)||{};let l=(null==i?void 0:i.durationKnown)||!1,d=Pa;const{duration:f,endDate:p}=r;if(p&&null!==f)d=n+f,l=!0;else if(r.endOnNext&&!l){const t=u.reduce(((t,e)=>{if(e!==r.id){const n=c[e];if(n.class===r.class&&n.startDate>r.startDate&&(!t||r.startDate<t.startDate))return n}return t}),null);t&&(d=t.startTime,l=!0)}const m=Object.keys(r.attr);for(let t=0;t<m.length;t++){const c=m[t];if("ID"===(g=c)||"CLASS"===g||"CUE"===g||"START-DATE"===g||"DURATION"===g||"END-DATE"===g||"END-ON-NEXT"===g)continue;const u=s[c];if(u)!l||null!=i&&i.durationKnown?Math.abs(u.startTime-n)>.01&&(u.startTime=n,u.endTime=d):u.endTime=d;else if(a){let t=r.attr[c];Ke(c)&&(t=k(t));const i=ka(a,n,d,{key:c,data:t},Pn.dateRange);i&&(i.id=e,this.id3Track.addCue(i),s[c]=i,o&&("X-ASSET-LIST"!==c&&"X-ASSET-URL"!==c||i.addEventListener("enter",this.onEventCueEnter)))}}h[e]={cues:s,dateRange:r,durationKnown:l}}var g}}}class Ra{constructor(t){this.hls=void 0,this.config=void 0,this.media=null,this.currentTime=0,this.stallCount=0,this._latency=null,this._targetLatencyUpdated=!1,this.onTimeupdate=()=>{const{media:t}=this,e=this.levelDetails;if(!t||!e)return;this.currentTime=t.currentTime;const r=this.computeLatency();if(null===r)return;this._latency=r;const{lowLatencyMode:n,maxLiveSyncPlaybackRate:i}=this.config;if(!n||1===i||!e.live)return;const s=this.targetLatency;if(null===s)return;const o=r-s;if(o<Math.min(this.maxLatency,s+e.targetduration)&&o>.05&&this.forwardBufferLength>1){const e=Math.min(2,Math.max(1,i)),r=Math.round(2/(1+Math.exp(-.75*o-this.edgeStalled))*20)/20,n=Math.min(e,Math.max(1,r));this.changeMediaPlaybackRate(t,n)}else 1!==t.playbackRate&&0!==t.playbackRate&&this.changeMediaPlaybackRate(t,1)},this.hls=t,this.config=t.config,this.registerListeners()}get levelDetails(){var t;return(null==(t=this.hls)?void 0:t.latestLevelDetails)||null}get latency(){return this._latency||0}get maxLatency(){const{config:t}=this;if(void 0!==t.liveMaxLatencyDuration)return t.liveMaxLatencyDuration;const e=this.levelDetails;return e?t.liveMaxLatencyDurationCount*e.targetduration:0}get targetLatency(){const t=this.levelDetails;if(null===t||null===this.hls)return null;const{holdBack:e,partHoldBack:r,targetduration:n}=t,{liveSyncDuration:i,liveSyncDurationCount:s,lowLatencyMode:o}=this.config,a=this.hls.userConfig;let l=o&&r||e;(this._targetLatencyUpdated||a.liveSyncDuration||a.liveSyncDurationCount||0===l)&&(l=void 0!==i?i:s*n);const c=n;return l+Math.min(this.stallCount*this.config.liveSyncOnStallIncrease,c)}set targetLatency(t){this.stallCount=0,this.config.liveSyncDuration=t,this._targetLatencyUpdated=!0}get liveSyncPosition(){const t=this.estimateLiveEdge(),e=this.targetLatency;if(null===t||null===e)return null;const r=this.levelDetails;if(null===r)return null;const n=r.edge,i=t-e-this.edgeStalled,s=n-r.totalduration,o=n-(this.config.lowLatencyMode&&r.partTarget||r.targetduration);return Math.min(Math.max(s,i),o)}get drift(){const t=this.levelDetails;return null===t?1:t.drift}get edgeStalled(){const t=this.levelDetails;if(null===t)return 0;const e=3*(this.config.lowLatencyMode&&t.partTarget||t.targetduration);return Math.max(t.age-e,0)}get forwardBufferLength(){const{media:t}=this,e=this.levelDetails;if(!t||!e)return 0;const r=t.buffered.length;return(r?t.buffered.end(r-1):e.edge)-this.currentTime}destroy(){this.unregisterListeners(),this.onMediaDetaching(),this.hls=null}registerListeners(){const{hls:t}=this;t&&(t.on(l.MEDIA_ATTACHED,this.onMediaAttached,this),t.on(l.MEDIA_DETACHING,this.onMediaDetaching,this),t.on(l.MANIFEST_LOADING,this.onManifestLoading,this),t.on(l.LEVEL_UPDATED,this.onLevelUpdated,this),t.on(l.ERROR,this.onError,this))}unregisterListeners(){const{hls:t}=this;t&&(t.off(l.MEDIA_ATTACHED,this.onMediaAttached,this),t.off(l.MEDIA_DETACHING,this.onMediaDetaching,this),t.off(l.MANIFEST_LOADING,this.onManifestLoading,this),t.off(l.LEVEL_UPDATED,this.onLevelUpdated,this),t.off(l.ERROR,this.onError,this))}onMediaAttached(t,e){this.media=e.media,this.media.addEventListener("timeupdate",this.onTimeupdate)}onMediaDetaching(){this.media&&(this.media.removeEventListener("timeupdate",this.onTimeupdate),this.media=null)}onManifestLoading(){this._latency=null,this.stallCount=0}onLevelUpdated(t,{details:e}){e.advanced&&this.onTimeupdate(),!e.live&&this.media&&this.media.removeEventListener("timeupdate",this.onTimeupdate)}onError(t,e){var r;e.details===a.BUFFER_STALLED_ERROR&&(this.stallCount++,this.hls&&null!=(r=this.levelDetails)&&r.live&&this.hls.logger.warn("[latency-controller]: Stall detected, adjusting target latency"))}changeMediaPlaybackRate(t,e){var r,n;t.playbackRate!==e&&(null==(r=this.hls)||r.logger.debug(`[latency-controller]: latency=${this.latency.toFixed(3)}, targetLatency=${null==(n=this.targetLatency)?void 0:n.toFixed(3)}, forwardBufferLength=${this.forwardBufferLength.toFixed(3)}: adjusting playback rate from ${t.playbackRate} to ${e}`),t.playbackRate=e)}estimateLiveEdge(){const t=this.levelDetails;return null===t?null:t.edge+t.age}computeLatency(){const t=this.estimateLiveEdge();return null===t?null:t-this.currentTime}}class Oa extends Ri{constructor(t,e){super(t,"level-controller"),this._levels=[],this._firstLevel=-1,this._maxAutoLevel=-1,this._startLevel=void 0,this.currentLevel=null,this.currentLevelIndex=-1,this.manualLevelIndex=-1,this.steering=void 0,this.onParsedComplete=void 0,this.steering=e,this._registerListeners()}_registerListeners(){const{hls:t}=this;t.on(l.MANIFEST_LOADING,this.onManifestLoading,this),t.on(l.MANIFEST_LOADED,this.onManifestLoaded,this),t.on(l.LEVEL_LOADED,this.onLevelLoaded,this),t.on(l.LEVELS_UPDATED,this.onLevelsUpdated,this),t.on(l.FRAG_BUFFERED,this.onFragBuffered,this),t.on(l.ERROR,this.onError,this)}_unregisterListeners(){const{hls:t}=this;t.off(l.MANIFEST_LOADING,this.onManifestLoading,this),t.off(l.MANIFEST_LOADED,this.onManifestLoaded,this),t.off(l.LEVEL_LOADED,this.onLevelLoaded,this),t.off(l.LEVELS_UPDATED,this.onLevelsUpdated,this),t.off(l.FRAG_BUFFERED,this.onFragBuffered,this),t.off(l.ERROR,this.onError,this)}destroy(){this._unregisterListeners(),this.steering=null,this.resetLevels(),super.destroy()}stopLoad(){this._levels.forEach((t=>{t.loadError=0,t.fragmentError=0})),super.stopLoad()}resetLevels(){this._startLevel=void 0,this.manualLevelIndex=-1,this.currentLevelIndex=-1,this.currentLevel=null,this._levels=[],this._maxAutoLevel=-1}onManifestLoading(t,e){this.resetLevels()}onManifestLoaded(t,e){const r=this.hls.config.preferManagedMediaSource,n=[],i={},s={};let o=!1,a=!1,l=!1;e.levels.forEach((t=>{const e=t.attrs;let{audioCodec:c,videoCodec:u}=t;c&&(t.audioCodec=c=Lt(c,r)||void 0),u&&(u=t.videoCodec=function(t){const e=t.split(",");for(let t=0;t<e.length;t++){const r=e[t].split(".");r.length>2&&"avc1"===r[0]&&(e[t]=`avc1.${parseInt(r[1]).toString(16)}${("000"+parseInt(r[2]).toString(16)).slice(-4)}`)}return e.join(",")}(u));const{width:h,height:d,unknownCodecs:f}=t;let p=f?f.length:0;if(f)for(let e=p;e--;){const r=f[e];this.isAudioSupported(r)?(t.audioCodec=c=c?`${c},${r}`:r,p--,mt.audio[c.substring(0,4)]=2):this.isVideoSupported(r)&&(t.videoCodec=u=u?`${u},${r}`:r,p--,mt.video[u.substring(0,4)]=2)}if(o||(o=!(!h||!d)),a||(a=!!u),l||(l=!!c),p||c&&!this.isAudioSupported(c)||u&&!this.isVideoSupported(u))return void this.log(`Some or all CODECS not supported "${e.CODECS}"`);const{CODECS:g,"FRAME-RATE":m,"HDCP-LEVEL":y,"PATHWAY-ID":v,RESOLUTION:b,"VIDEO-RANGE":E}=e,A=`${`${v||"."}-`}${t.bitrate}-${b}-${m}-${g}-${E}-${y}`;if(i[A])if(i[A].uri===t.url||t.attrs["PATHWAY-ID"])i[A].addGroupId("audio",e.AUDIO),i[A].addGroupId("text",e.SUBTITLES);else{const e=s[A]+=1;t.attrs["PATHWAY-ID"]=new Array(e+1).join(".");const r=this.createLevel(t);i[A]=r,n.push(r)}else{const e=this.createLevel(t);i[A]=e,s[A]=1,n.push(e)}})),this.filterAndSortMediaOptions(n,e,o,a,l)}createLevel(t){const e=new Ht(t),r=t.supplemental;if(null!=r&&r.videoCodec&&!this.isVideoSupported(r.videoCodec)){const t=new Error(`SUPPLEMENTAL-CODECS not supported "${r.videoCodec}"`);this.log(t.message),e.supportedResult=Dt(t,[])}return e}isAudioSupported(t){return vt(t,"audio",this.hls.config.preferManagedMediaSource)}isVideoSupported(t){return vt(t,"video",this.hls.config.preferManagedMediaSource)}filterAndSortMediaOptions(t,e,r,n,i){let s=[],c=[],u=t;if((r||n)&&i&&(u=u.filter((({videoCodec:t,videoRange:e,width:r,height:n})=>{return(!!t||!(!r||!n))&&(!!(i=e)&&Bt.indexOf(i)>-1);var i}))),0===u.length)return void Promise.resolve().then((()=>{if(this.hls){let t="no level with compatible codecs found in manifest",r=t;e.levels.length&&(r=`one or more CODECS in variant not supported: ${Yt(e.levels.map((t=>t.attrs.CODECS)).filter(((t,e,r)=>r.indexOf(t)===e)))}`,this.warn(r),t+=` (${r})`);const n=new Error(t);this.hls.trigger(l.ERROR,{type:o.MEDIA_ERROR,details:a.MANIFEST_INCOMPATIBLE_CODECS_ERROR,fatal:!0,url:e.url,error:n,reason:r})}}));e.audioTracks&&(s=e.audioTracks.filter((t=>!t.audioCodec||this.isAudioSupported(t.audioCodec))),Da(s)),e.subtitles&&(c=e.subtitles,Da(c));const h=u.slice(0);u.sort(((t,e)=>{if(t.attrs["HDCP-LEVEL"]!==e.attrs["HDCP-LEVEL"])return(t.attrs["HDCP-LEVEL"]||"")>(e.attrs["HDCP-LEVEL"]||"")?1:-1;if(r&&t.height!==e.height)return t.height-e.height;if(t.frameRate!==e.frameRate)return t.frameRate-e.frameRate;if(t.videoRange!==e.videoRange)return Bt.indexOf(t.videoRange)-Bt.indexOf(e.videoRange);if(t.videoCodec!==e.videoCodec){const r=At(t.videoCodec),n=At(e.videoCodec);if(r!==n)return n-r}if(t.uri===e.uri&&t.codecSet!==e.codecSet){const r=wt(t.codecSet),n=wt(e.codecSet);if(r!==n)return n-r}return t.averageBitrate!==e.averageBitrate?t.averageBitrate-e.averageBitrate:0}));let d=h[0];if(this.steering&&(u=this.steering.filterParsedLevels(u),u.length!==h.length))for(let t=0;t<h.length;t++)if(h[t].pathwayId===u[0].pathwayId){d=h[t];break}this._levels=u;for(let t=0;t<u.length;t++)if(u[t]===d){var f;this._firstLevel=t;const e=d.bitrate,r=this.hls.bandwidthEstimate;if(this.log(`manifest loaded, ${u.length} level(s) found, first bitrate: ${e}`),void 0===(null==(f=this.hls.userConfig)?void 0:f.abrEwmaDefaultEstimate)){const t=Math.min(e,this.hls.config.abrEwmaDefaultEstimateMax);t>r&&r===this.hls.abrEwmaDefaultEstimate&&(this.hls.bandwidthEstimate=t)}break}const p=i&&!n,g=this.hls.config,m=!(!g.audioStreamController||!g.audioTrackController),y={levels:u,audioTracks:s,subtitleTracks:c,sessionData:e.sessionData,sessionKeys:e.sessionKeys,firstLevel:this._firstLevel,stats:e.stats,audio:i,video:n,altAudio:m&&!p&&s.some((t=>!!t.url))};this.hls.trigger(l.MANIFEST_PARSED,y)}get levels(){return 0===this._levels.length?null:this._levels}get loadLevelObj(){return this.currentLevel}get level(){return this.currentLevelIndex}set level(t){const e=this._levels;if(0===e.length)return;if(t<0||t>=e.length){const r=new Error("invalid level idx"),n=t<0;if(this.hls.trigger(l.ERROR,{type:o.OTHER_ERROR,details:a.LEVEL_SWITCH_ERROR,level:t,fatal:n,error:r,reason:r.message}),n)return;t=Math.min(t,e.length-1)}const r=this.currentLevelIndex,n=this.currentLevel,i=n?n.attrs["PATHWAY-ID"]:void 0,s=e[t],c=s.attrs["PATHWAY-ID"];if(this.currentLevelIndex=t,this.currentLevel=s,r===t&&n&&i===c)return;this.log(`Switching to level ${t} (${s.height?s.height+"p ":""}${s.videoRange?s.videoRange+" ":""}${s.codecSet?s.codecSet+" ":""}@${s.bitrate})${c?" with Pathway "+c:""} from level ${r}${i?" with Pathway "+i:""}`);const u={level:t,attrs:s.attrs,details:s.details,bitrate:s.bitrate,averageBitrate:s.averageBitrate,maxBitrate:s.maxBitrate,realBitrate:s.realBitrate,width:s.width,height:s.height,codecSet:s.codecSet,audioCodec:s.audioCodec,videoCodec:s.videoCodec,audioGroups:s.audioGroups,subtitleGroups:s.subtitleGroups,loaded:s.loaded,loadError:s.loadError,fragmentError:s.fragmentError,name:s.name,id:s.id,uri:s.uri,url:s.url,urlId:0,audioGroupIds:s.audioGroupIds,textGroupIds:s.textGroupIds};this.hls.trigger(l.LEVEL_SWITCHING,u);const h=s.details;if(!h||h.live){const t=this.switchParams(s.uri,null==n?void 0:n.details,h);this.loadPlaylist(t)}}get manualLevel(){return this.manualLevelIndex}set manualLevel(t){this.manualLevelIndex=t,void 0===this._startLevel&&(this._startLevel=t),-1!==t&&(this.level=t)}get firstLevel(){return this._firstLevel}set firstLevel(t){this._firstLevel=t}get startLevel(){if(void 0===this._startLevel){const t=this.hls.config.startLevel;return void 0!==t?t:this.hls.firstAutoLevel}return this._startLevel}set startLevel(t){this._startLevel=t}get pathways(){return this.steering?this.steering.pathways():[]}get pathwayPriority(){return this.steering?this.steering.pathwayPriority:null}set pathwayPriority(t){if(this.steering){const e=this.steering.pathways(),r=t.filter((t=>-1!==e.indexOf(t)));if(t.length<1)return void this.warn(`pathwayPriority ${t} should contain at least one pathway from list: ${e}`);this.steering.pathwayPriority=r}}onError(t,e){!e.fatal&&e.context&&e.context.type===c.LEVEL&&e.context.level===this.level&&this.checkRetry(e)}onFragBuffered(t,{frag:e}){if(void 0!==e&&e.type===u.MAIN){const t=e.elementaryStreams;if(!Object.keys(t).some((e=>!!t[e])))return;const r=this._levels[e.level];null!=r&&r.loadError&&(this.log(`Resetting level error count of ${r.loadError} on frag buffered`),r.loadError=0)}}onLevelLoaded(t,e){var r;const{level:n,details:i}=e,s=e.levelInfo;var o;if(!s)return this.warn(`Invalid level index ${n}`),void(null!=(o=e.deliveryDirectives)&&o.skip&&(i.deltaUpdateFailed=!0));if(s===this.currentLevel||e.withoutMultiVariant){0===s.fragmentError&&(s.loadError=0);let t=s.details;t===e.details&&t.advanced&&(t=void 0),this.playlistLoaded(n,e,t)}else null!=(r=e.deliveryDirectives)&&r.skip&&(i.deltaUpdateFailed=!0)}loadPlaylist(t){super.loadPlaylist(),this.shouldLoadPlaylist(this.currentLevel)&&this.scheduleLoading(this.currentLevel,t)}loadingPlaylist(t,e){super.loadingPlaylist(t,e);const r=this.getUrlWithDirectives(t.uri,e),n=this.currentLevelIndex,i=t.attrs["PATHWAY-ID"],s=t.details,o=null==s?void 0:s.age;this.log(`Loading level index ${n}${void 0!==(null==e?void 0:e.msn)?" at sn "+e.msn+" part "+e.part:""}${i?" Pathway "+i:""}${o&&s.live?" age "+o.toFixed(1)+(s.type?" "+s.type||0:""):""} ${r}`),this.hls.trigger(l.LEVEL_LOADING,{url:r,level:n,levelInfo:t,pathwayId:t.attrs["PATHWAY-ID"],id:0,deliveryDirectives:e||null})}get nextLoadLevel(){return-1!==this.manualLevelIndex?this.manualLevelIndex:this.hls.nextAutoLevel}set nextLoadLevel(t){this.level=t,-1===this.manualLevelIndex&&(this.hls.nextAutoLevel=t)}removeLevel(t){var e;if(1===this._levels.length)return;const r=this._levels.filter(((e,r)=>r!==t||(this.steering&&this.steering.removeLevel(e),e===this.currentLevel&&(this.currentLevel=null,this.currentLevelIndex=-1,e.details&&e.details.fragments.forEach((t=>t.level=-1))),!1)));Ur(r),this._levels=r,this.currentLevelIndex>-1&&null!=(e=this.currentLevel)&&e.details&&(this.currentLevelIndex=this.currentLevel.details.fragments[0].level),this.manualLevelIndex>-1&&(this.manualLevelIndex=this.currentLevelIndex);const n=r.length-1;this._firstLevel=Math.min(this._firstLevel,n),this._startLevel&&(this._startLevel=Math.min(this._startLevel,n)),this.hls.trigger(l.LEVELS_UPDATED,{levels:r})}onLevelsUpdated(t,{levels:e}){this._levels=e}checkMaxAutoUpdated(){const{autoLevelCapping:t,maxAutoLevel:e,maxHdcpLevel:r}=this.hls;this._maxAutoLevel!==e&&(this._maxAutoLevel=e,this.hls.trigger(l.MAX_AUTO_LEVEL_UPDATED,{autoLevelCapping:t,levels:this.levels,maxAutoLevel:e,minAutoLevel:this.hls.minAutoLevel,maxHdcpLevel:r}))}}function Da(t){const e={};t.forEach((t=>{const r=t.groupId||"";t.id=e[r]=e[r]||0,e[r]++}))}function Ca(){return self.SourceBuffer||self.WebKitSourceBuffer}function Ma(){if(!S())return!1;const t=Ca();return!t||t.prototype&&"function"==typeof t.prototype.appendBuffer&&"function"==typeof t.prototype.remove}class Na extends Xr{constructor(t,e,r){super(t,e,r,"stream-controller",u.MAIN),this.audioCodecSwap=!1,this.level=-1,this._forceStartLoad=!1,this._hasEnoughToStart=!1,this.altAudio=0,this.audioOnly=!1,this.fragPlaying=null,this.fragLastKbps=0,this.couldBacktrack=!1,this.backtrackFragment=null,this.audioCodecSwitch=!1,this.videoBuffer=null,this.onMediaPlaying=()=>{this.tick()},this.onMediaSeeked=()=>{const t=this.media,e=t?t.currentTime:null;if(null===e||!n(e))return;if(this.log(`Media seeked to ${e.toFixed(3)}`),!this.getBufferedFrag(e))return;const r=this.getFwdBufferInfoAtPos(t,e,u.MAIN,0);null!==r&&0!==r.len?this.tick():this.warn(`Main forward buffer length at ${e} on "seeked" event ${r?r.len:"empty"})`)},this.registerListeners()}registerListeners(){super.registerListeners();const{hls:t}=this;t.on(l.MANIFEST_PARSED,this.onManifestParsed,this),t.on(l.LEVEL_LOADING,this.onLevelLoading,this),t.on(l.LEVEL_LOADED,this.onLevelLoaded,this),t.on(l.FRAG_LOAD_EMERGENCY_ABORTED,this.onFragLoadEmergencyAborted,this),t.on(l.AUDIO_TRACK_SWITCHING,this.onAudioTrackSwitching,this),t.on(l.AUDIO_TRACK_SWITCHED,this.onAudioTrackSwitched,this),t.on(l.BUFFER_CREATED,this.onBufferCreated,this),t.on(l.BUFFER_FLUSHED,this.onBufferFlushed,this),t.on(l.LEVELS_UPDATED,this.onLevelsUpdated,this),t.on(l.FRAG_BUFFERED,this.onFragBuffered,this)}unregisterListeners(){super.unregisterListeners();const{hls:t}=this;t.off(l.MANIFEST_PARSED,this.onManifestParsed,this),t.off(l.LEVEL_LOADED,this.onLevelLoaded,this),t.off(l.FRAG_LOAD_EMERGENCY_ABORTED,this.onFragLoadEmergencyAborted,this),t.off(l.AUDIO_TRACK_SWITCHING,this.onAudioTrackSwitching,this),t.off(l.AUDIO_TRACK_SWITCHED,this.onAudioTrackSwitched,this),t.off(l.BUFFER_CREATED,this.onBufferCreated,this),t.off(l.BUFFER_FLUSHED,this.onBufferFlushed,this),t.off(l.LEVELS_UPDATED,this.onLevelsUpdated,this),t.off(l.FRAG_BUFFERED,this.onFragBuffered,this)}onHandlerDestroying(){this.onMediaPlaying=this.onMediaSeeked=null,this.unregisterListeners(),super.onHandlerDestroying()}startLoad(t,e){if(this.levels){const{lastCurrentTime:r,hls:n}=this;if(this.stopLoad(),this.setInterval(100),this.level=-1,!this.startFragRequested){let t=n.startLevel;-1===t&&(n.config.testBandwidth&&this.levels.length>1?(t=0,this.bitrateTest=!0):t=n.firstAutoLevel),n.nextLoadLevel=t,this.level=n.loadLevel,this._hasEnoughToStart=!!e}r>0&&-1===t&&!e&&(this.log(`Override startPosition with lastCurrentTime @${r.toFixed(3)}`),t=r),this.state=zr.IDLE,this.nextLoadPosition=this.lastCurrentTime=t+this.timelineOffset,this.startPosition=e?-1:t,this.tick()}else this._forceStartLoad=!0,this.state=zr.STOPPED}stopLoad(){this._forceStartLoad=!1,super.stopLoad()}doTick(){switch(this.state){case zr.WAITING_LEVEL:{const{levels:t,level:e}=this,r=null==t?void 0:t[e],n=null==r?void 0:r.details;if(n&&(!n.live||this.levelLastLoaded===r&&!this.waitForLive(r))){if(this.waitForCdnTuneIn(n))break;this.state=zr.IDLE;break}if(this.hls.nextLoadLevel!==this.level){this.state=zr.IDLE;break}break}case zr.FRAG_LOADING_WAITING_RETRY:this.checkRetryDate()}this.state===zr.IDLE&&this.doTickIdle(),this.onTickEnd()}onTickEnd(){var t;super.onTickEnd(),null!=(t=this.media)&&t.readyState&&!1===this.media.seeking&&(this.lastCurrentTime=this.media.currentTime),this.checkFragmentChanged()}doTickIdle(){const{hls:t,levelLastLoaded:e,levels:r,media:n}=this;if(null===e||!n&&!this.primaryPrefetch&&(this.startFragRequested||!t.config.startFragPrefetch))return;if(this.altAudio&&this.audioOnly)return;const i=this.buffering?t.nextLoadLevel:t.loadLevel;if(null==r||!r[i])return;const s=r[i],o=this.getMainFwdBufferInfo();if(null===o)return;const a=this.getLevelDetails();if(a&&this._streamEnded(o,a)){const t={};return 2===this.altAudio&&(t.type="video"),this.hls.trigger(l.BUFFER_EOS,t),void(this.state=zr.ENDED)}if(!this.buffering)return;t.loadLevel!==i&&-1===t.manualLevel&&this.log(`Adapting to level ${i} from level ${this.level}`),this.level=t.nextLoadLevel=i;const c=s.details;if(!c||this.state===zr.WAITING_LEVEL||this.waitForLive(s))return this.level=i,this.state=zr.WAITING_LEVEL,void(this.startFragRequested=!1);const h=o.len,d=this.getMaxBufferLength(s.maxBitrate);if(h>=d)return;this.backtrackFragment&&this.backtrackFragment.start>o.end&&(this.backtrackFragment=null);const f=this.backtrackFragment?this.backtrackFragment.start:o.end;let p=this.getNextFragment(f,c);if(this.couldBacktrack&&!this.fragPrevious&&p&&j(p)&&this.fragmentTracker.getState(p)!==ve){var g;const t=(null!=(g=this.backtrackFragment)?g:p).sn-c.startSN,e=c.fragments[t-1];e&&p.cc===e.cc&&(p=e,this.fragmentTracker.removeFragment(e))}else this.backtrackFragment&&o.len&&(this.backtrackFragment=null);if(p&&this.isLoopLoading(p,f)){if(!p.gap){const t=this.audioOnly&&!this.altAudio?B.AUDIO:B.VIDEO,e=(t===B.VIDEO?this.videoBuffer:this.mediaBuffer)||this.media;e&&this.afterBufferFlushed(e,t,u.MAIN)}p=this.getNextFragmentLoopLoading(p,c,o,u.MAIN,d)}p&&(!p.initSegment||p.initSegment.data||this.bitrateTest||(p=p.initSegment),this.loadFragment(p,s,f))}loadFragment(t,e,r){const n=this.fragmentTracker.getState(t);n===ge||n===ye?j(t)?this.bitrateTest?(this.log(`Fragment ${t.sn} of level ${t.level} is being downloaded to test bitrate and will not be buffered`),this._loadBitrateTestFrag(t,e)):super.loadFragment(t,e,r):this._loadInitSegment(t,e):this.clearTrackerIfNeeded(t)}getBufferedFrag(t){return this.fragmentTracker.getBufferedFrag(t,u.MAIN)}followingBufferedFrag(t){return t?this.getBufferedFrag(t.end+.5):null}immediateLevelSwitch(){this.abortCurrentFrag(),this.flushMainBuffer(0,Number.POSITIVE_INFINITY)}nextLevelSwitch(){const{levels:t,media:e}=this;if(null!=e&&e.readyState){let r;const n=this.getAppendedFrag(e.currentTime);n&&n.start>1&&this.flushMainBuffer(0,n.start-1);const i=this.getLevelDetails();if(null!=i&&i.live){const t=this.getMainFwdBufferInfo();if(!t||t.len<2*i.targetduration)return}if(!e.paused&&t){const e=t[this.hls.nextLoadLevel],n=this.fragLastKbps;r=n&&this.fragCurrent?this.fragCurrent.duration*e.maxBitrate/(1e3*n)+1:0}else r=0;const s=this.getBufferedFrag(e.currentTime+r);if(s){const t=this.followingBufferedFrag(s);if(t){this.abortCurrentFrag();const e=t.maxStartPTS?t.maxStartPTS:t.start,r=t.duration,n=Math.max(s.end,e+Math.min(Math.max(r-this.config.maxFragLookUpTolerance,r*(this.couldBacktrack?.5:.125)),r*(this.couldBacktrack?.75:.25)));this.flushMainBuffer(n,Number.POSITIVE_INFINITY)}}}}abortCurrentFrag(){const t=this.fragCurrent;switch(this.fragCurrent=null,this.backtrackFragment=null,t&&(t.abortRequests(),this.fragmentTracker.removeFragment(t)),this.state){case zr.KEY_LOADING:case zr.FRAG_LOADING:case zr.FRAG_LOADING_WAITING_RETRY:case zr.PARSING:case zr.PARSED:this.state=zr.IDLE}this.nextLoadPosition=this.getLoadPosition()}flushMainBuffer(t,e){super.flushMainBuffer(t,e,2===this.altAudio?"video":null)}onMediaAttached(t,e){super.onMediaAttached(t,e);const r=e.media;Yr(r,"playing",this.onMediaPlaying),Yr(r,"seeked",this.onMediaSeeked)}onMediaDetaching(t,e){const{media:r}=this;r&&(qr(r,"playing",this.onMediaPlaying),qr(r,"seeked",this.onMediaSeeked)),this.videoBuffer=null,this.fragPlaying=null,super.onMediaDetaching(t,e);!!e.transferMedia||(this._hasEnoughToStart=!1)}onManifestLoading(){super.onManifestLoading(),this.log("Trigger BUFFER_RESET"),this.hls.trigger(l.BUFFER_RESET,void 0),this.couldBacktrack=!1,this.fragLastKbps=0,this.fragPlaying=this.backtrackFragment=null,this.altAudio=0,this.audioOnly=!1}onManifestParsed(t,e){let r=!1,n=!1;for(let t=0;t<e.levels.length;t++){const i=e.levels[t].audioCodec;i&&(r=r||-1!==i.indexOf("mp4a.40.2"),n=n||-1!==i.indexOf("mp4a.40.5"))}this.audioCodecSwitch=r&&n&&!function(){var t;const e=Ca();return"function"==typeof(null==e||null==(t=e.prototype)?void 0:t.changeType)}(),this.audioCodecSwitch&&this.log("Both AAC/HE-AAC audio found in levels; declaring level codec as HE-AAC"),this.levels=e.levels,this.startFragRequested=!1}onLevelLoading(t,e){const{levels:r}=this;if(!r||this.state!==zr.IDLE)return;const n=e.levelInfo;(!n.details||n.details.live&&(this.levelLastLoaded!==n||n.details.expired)||this.waitForCdnTuneIn(n.details))&&(this.state=zr.WAITING_LEVEL)}onLevelLoaded(t,e){var r;const{levels:n,startFragRequested:i}=this,s=e.level,o=e.details,a=o.totalduration;if(!n)return void this.warn(`Levels were reset while loading level ${s}`);this.log(`Level ${s} loaded [${o.startSN},${o.endSN}]${o.lastPartSn?`[part-${o.lastPartSn}-${o.lastPartIndex}]`:""}, cc [${o.startCC}, ${o.endCC}] duration:${a}`);const c=e.levelInfo,u=this.fragCurrent;!u||this.state!==zr.FRAG_LOADING&&this.state!==zr.FRAG_LOADING_WAITING_RETRY||u.level!==e.level&&u.loader&&this.abortCurrentFrag();let h=0;if(o.live||null!=(r=c.details)&&r.live){var d;if(this.checkLiveUpdate(o),o.deltaUpdateFailed)return;h=this.alignPlaylists(o,c.details,null==(d=this.levelLastLoaded)?void 0:d.details)}if(c.details=o,this.levelLastLoaded=c,i||this.setStartPosition(o,h),this.hls.trigger(l.LEVEL_UPDATED,{details:o,level:s}),this.state===zr.WAITING_LEVEL){if(this.waitForCdnTuneIn(o))return;this.state=zr.IDLE}i&&o.live&&this.synchronizeToLiveEdge(o),this.tick()}synchronizeToLiveEdge(t){const{config:e,media:r}=this;if(!r)return;const n=this.hls.liveSyncPosition,i=this.getLoadPosition(),s=t.fragmentStart,o=t.edge,a=i>=s-e.maxFragLookUpTolerance&&i<=o;if(null!==n&&r.duration>n&&(i<n||!a)){const s=void 0!==e.liveMaxLatencyDuration?e.liveMaxLatencyDuration:e.liveMaxLatencyDurationCount*t.targetduration;if((!a&&r.readyState<4||i<o-s)&&(this._hasEnoughToStart||(this.nextLoadPosition=n),r.readyState))if(this.warn(`Playback: ${i.toFixed(3)} is located too far from the end of live sliding playlist: ${o}, reset currentTime to : ${n.toFixed(3)}`),"buffered"===this.config.liveSyncMode){var l;const t=Ne.bufferInfo(r,n,0);if(null==(l=t.buffered)||!l.length)return void(r.currentTime=n);if(t.start<=i)return void(r.currentTime=n);const{nextStart:e}=Ne.bufferedInfo(t.buffered,i,0);e&&(r.currentTime=e)}else r.currentTime=n}}_handleFragmentLoadProgress(t){var e;const r=t.frag,{part:n,payload:i}=t,{levels:s}=this;if(!s)return void this.warn(`Levels were reset while fragment load was in progress. Fragment ${r.sn} of level ${r.level} will not be buffered`);const o=s[r.level];if(!o)return void this.warn(`Level ${r.level} not found on progress`);const a=o.details;if(!a)return this.warn(`Dropping fragment ${r.sn} of level ${r.level} after level details were reset`),void this.fragmentTracker.removeFragment(r);const l=o.videoCodec,c=a.PTSKnown||!a.live,h=null==(e=r.initSegment)?void 0:e.data,d=this._getAudioCodec(o),f=this.transmuxer=this.transmuxer||new Ii(this.hls,u.MAIN,this._handleTransmuxComplete.bind(this),this._handleTransmuxerFlush.bind(this)),p=n?n.index:-1,g=-1!==p,m=new Ce(r.level,r.sn,r.stats.chunkCount,i.byteLength,p,g),y=this.initPTS[r.cc];f.push(i,h,d,l,r,n,a.totalduration,c,m,y)}onAudioTrackSwitching(t,e){const r=this.hls,n=2===this.altAudio;if(te(e.url,r))this.altAudio=1;else{if(this.mediaBuffer!==this.media){this.log("Switching on main audio, use media.buffered to schedule main fragment loading"),this.mediaBuffer=this.media;const t=this.fragCurrent;t&&(this.log("Switching to main audio track, cancel main fragment load"),t.abortRequests(),this.fragmentTracker.removeFragment(t)),this.resetTransmuxer(),this.resetLoadingState()}else this.audioOnly&&this.resetTransmuxer();if(n)return this.fragmentTracker.removeAllFragments(),r.once(l.BUFFER_FLUSHED,(()=>{this.hls&&this.hls.trigger(l.AUDIO_TRACK_SWITCHED,e)})),void r.trigger(l.BUFFER_FLUSHING,{startOffset:0,endOffset:Number.POSITIVE_INFINITY,type:null});r.trigger(l.AUDIO_TRACK_SWITCHED,e)}}onAudioTrackSwitched(t,e){const r=te(e.url,this.hls);if(r){const t=this.videoBuffer;t&&this.mediaBuffer!==t&&(this.log("Switching on alternate audio, use video.buffered to schedule main fragment loading"),this.mediaBuffer=t)}this.altAudio=r?2:0,this.tick()}onBufferCreated(t,e){const r=e.tracks;let n,i,s=!1;for(const t in r){const e=r[t];if("main"===e.id){if(i=t,n=e,"video"===t){const e=r[t];e&&(this.videoBuffer=e.buffer)}}else s=!0}s&&n?(this.log(`Alternate track found, use ${i}.buffered to schedule main fragment loading`),this.mediaBuffer=n.buffer):this.mediaBuffer=this.media}onFragBuffered(t,e){const{frag:r,part:n}=e,i=r.type===u.MAIN;if(i){if(this.fragContextChanged(r))return this.warn(`Fragment ${r.sn}${n?" p: "+n.index:""} of level ${r.level} finished buffering, but was aborted. state: ${this.state}`),void(this.state===zr.PARSED&&(this.state=zr.IDLE));const t=n?n.stats:r.stats;this.fragLastKbps=Math.round(8*t.total/(t.buffering.end-t.loading.first)),j(r)&&(this.fragPrevious=r),this.fragBufferedComplete(r,n)}const s=this.media;s&&(!this._hasEnoughToStart&&Ne.getBuffered(s).length&&(this._hasEnoughToStart=!0,this.seekToStartPos()),i&&this.tick())}get hasEnoughToStart(){return this._hasEnoughToStart}onError(t,e){var r;if(e.fatal)this.state=zr.ERROR;else switch(e.details){case a.FRAG_GAP:case a.FRAG_PARSING_ERROR:case a.FRAG_DECRYPT_ERROR:case a.FRAG_LOAD_ERROR:case a.FRAG_LOAD_TIMEOUT:case a.KEY_LOAD_ERROR:case a.KEY_LOAD_TIMEOUT:this.onFragmentOrKeyLoadError(u.MAIN,e);break;case a.LEVEL_LOAD_ERROR:case a.LEVEL_LOAD_TIMEOUT:case a.LEVEL_PARSING_ERROR:e.levelRetry||this.state!==zr.WAITING_LEVEL||(null==(r=e.context)?void 0:r.type)!==c.LEVEL||(this.state=zr.IDLE);break;case a.BUFFER_ADD_CODEC_ERROR:case a.BUFFER_APPEND_ERROR:if("main"!==e.parent)return;this.reduceLengthAndFlushBuffer(e)&&this.resetLoadingState();break;case a.BUFFER_FULL_ERROR:if("main"!==e.parent)return;if(this.reduceLengthAndFlushBuffer(e)){!this.config.interstitialsController&&this.config.assetPlayerId?this._hasEnoughToStart=!0:this.flushMainBuffer(0,Number.POSITIVE_INFINITY)}break;case a.INTERNAL_EXCEPTION:this.recoverWorkerError(e)}}onFragLoadEmergencyAborted(){this.state=zr.IDLE,this._hasEnoughToStart||(this.startFragRequested=!1,this.nextLoadPosition=this.lastCurrentTime),this.tickImmediate()}onBufferFlushed(t,{type:e}){if(e!==B.AUDIO||!this.altAudio){const t=(e===B.VIDEO?this.videoBuffer:this.mediaBuffer)||this.media;t&&(this.afterBufferFlushed(t,e,u.MAIN),this.tick())}}onLevelsUpdated(t,e){this.level>-1&&this.fragCurrent&&(this.level=this.fragCurrent.level,-1===this.level&&this.resetWhenMissingContext(this.fragCurrent)),this.levels=e.levels}swapAudioCodec(){this.audioCodecSwap=!this.audioCodecSwap}seekToStartPos(){const{media:t}=this;if(!t)return;const e=t.currentTime;let r=this.startPosition;if(r>=0&&e<r){if(t.seeking)return void this.log(`could not seek to ${r}, already seeking at ${e}`);const n=this.timelineOffset;n&&r&&(r+=n);const i=this.getLevelDetails(),s=Ne.getBuffered(t),o=s.length?s.start(0):0,a=o-r,l=Math.max(this.config.maxBufferHole,this.config.maxFragLookUpTolerance);(this.config.startOnSegmentBoundary||a>0&&(a<l||this.loadingParts&&a<2*((null==i?void 0:i.partTarget)||0)))&&(this.log(`adjusting start position by ${a} to match buffer start`),r+=a,this.startPosition=r),e<r&&(this.log(`seek to target start position ${r} from current time ${e} buffer start ${o}`),t.currentTime=r)}}_getAudioCodec(t){let e=this.config.defaultAudioCodec||t.audioCodec;return this.audioCodecSwap&&e&&(this.log("Swapping audio codec"),e=-1!==e.indexOf("mp4a.40.5")?"mp4a.40.2":"mp4a.40.5"),e}_loadBitrateTestFrag(t,e){t.bitrateTest=!0,this._doFragLoad(t,e).then((t=>{const{hls:r}=this,n=null==t?void 0:t.frag;if(!n||this.fragContextChanged(n))return;e.fragmentError=0,this.state=zr.IDLE,this.startFragRequested=!1,this.bitrateTest=!1;const i=n.stats;i.parsing.start=i.parsing.end=i.buffering.start=i.buffering.end=self.performance.now(),r.trigger(l.FRAG_LOADED,t),n.bitrateTest=!1})).catch((e=>{this.state!==zr.STOPPED&&this.state!==zr.ERROR&&(this.warn(e),this.resetFragmentLoading(t))}))}_handleTransmuxComplete(t){const e=this.playlistType,{hls:r}=this,{remuxResult:i,chunkMeta:s}=t,o=this.getCurrentContext(s);if(!o)return void this.resetWhenMissingContext(s);const{frag:a,part:c,level:u}=o,{video:h,text:d,id3:f,initSegment:p}=i,{details:g}=u,m=this.altAudio?void 0:i.audio;if(this.fragContextChanged(a))this.fragmentTracker.removeFragment(a);else{if(this.state=zr.PARSING,p){const t=p.tracks;if(t){const n=a.initSegment||a;if(this.unhandledEncryptionError(p,a))return;this._bufferInitSegment(u,t,n,s),r.trigger(l.FRAG_PARSING_INIT_SEGMENT,{frag:n,id:e,tracks:t})}const i=p.initPTS,o=p.timescale,c=this.initPTS[a.cc];if(n(i)&&(!c||c.baseTime!==i||c.timescale!==o)){const t=p.trackId;this.initPTS[a.cc]={baseTime:i,timescale:o,trackId:t},r.trigger(l.INIT_PTS_FOUND,{frag:a,id:e,initPTS:i,timescale:o,trackId:t})}}if(h&&g){m&&"audiovideo"===h.type&&this.logMuxedErr(a);const t=g.fragments[a.sn-1-g.startSN],e=a.sn===g.startSN,r=!t||a.cc>t.cc;if(!1!==i.independent){const{startPTS:t,endPTS:n,startDTS:i,endDTS:o}=h;if(c)c.elementaryStreams[h.type]={startPTS:t,endPTS:n,startDTS:i,endDTS:o};else if(h.firstKeyFrame&&h.independent&&1===s.id&&!r&&(this.couldBacktrack=!0),h.dropped&&h.independent){const i=this.getMainFwdBufferInfo(),s=(i?i.end:this.getLoadPosition())+this.config.maxBufferHole,l=h.firstKeyFramePTS?h.firstKeyFramePTS:t;if(!e&&s<l-this.config.maxBufferHole&&!r)return void this.backtrack(a);r&&(a.gap=!0),a.setElementaryStreamInfo(h.type,a.start,n,a.start,o,!0)}else e&&t-(g.appliedTimelineOffset||0)>2&&(a.gap=!0);a.setElementaryStreamInfo(h.type,t,n,i,o),this.backtrackFragment&&(this.backtrackFragment=a),this.bufferFragmentData(h,a,c,s,e||r)}else{if(!e&&!r)return void this.backtrack(a);a.gap=!0}}if(m){const{startPTS:t,endPTS:e,startDTS:r,endDTS:n}=m;c&&(c.elementaryStreams[B.AUDIO]={startPTS:t,endPTS:e,startDTS:r,endDTS:n}),a.setElementaryStreamInfo(B.AUDIO,t,e,r,n),this.bufferFragmentData(m,a,c,s)}if(g&&null!=f&&f.samples.length){const t={id:e,frag:a,details:g,samples:f.samples};r.trigger(l.FRAG_PARSING_METADATA,t)}if(g&&d){const t={id:e,frag:a,details:g,samples:d.samples};r.trigger(l.FRAG_PARSING_USERDATA,t)}}}logMuxedErr(t){this.warn(`${j(t)?"Media":"Init"} segment with muxed audiovideo where only video expected: ${t.url}`)}_bufferInitSegment(t,e,r,n){if(this.state!==zr.PARSING)return;this.audioOnly=!!e.audio&&!e.video,this.altAudio&&!this.audioOnly&&(delete e.audio,e.audiovideo&&this.logMuxedErr(r));const{audio:i,video:s,audiovideo:o}=e;if(i){const r=t.audioCodec;let n=_t(i.codec,r);"mp4a"===n&&(n="mp4a.40.5");const s=navigator.userAgent.toLowerCase();if(this.audioCodecSwitch){n&&(n=-1!==n.indexOf("mp4a.40.5")?"mp4a.40.2":"mp4a.40.5");const t=i.metadata;t&&"channelCount"in t&&1!==(t.channelCount||1)&&-1===s.indexOf("firefox")&&(n="mp4a.40.5")}n&&-1!==n.indexOf("mp4a.40.5")&&-1!==s.indexOf("android")&&"audio/mpeg"!==i.container&&(n="mp4a.40.2",this.log(`Android: force audio codec to ${n}`)),r&&r!==n&&this.log(`Swapping manifest audio codec "${r}" for "${n}"`),i.levelCodec=n,i.id=u.MAIN,this.log(`Init audio buffer, container:${i.container}, codecs[selected/level/parsed]=[${n||""}/${r||""}/${i.codec}]`),delete e.audiovideo}if(s){s.levelCodec=t.videoCodec,s.id=u.MAIN;const r=s.codec;if(4===(null==r?void 0:r.length))switch(r){case"hvc1":case"hev1":s.codec="hvc1.1.6.L120.90";break;case"av01":s.codec="av01.0.04M.08";break;case"avc1":s.codec="avc1.42e01e"}this.log(`Init video buffer, container:${s.container}, codecs[level/parsed]=[${t.videoCodec||""}/${r}]${s.codec!==r?" parsed-corrected="+s.codec:""}${s.supplemental?" supplemental="+s.supplemental:""}`),delete e.audiovideo}o&&(this.log(`Init audiovideo buffer, container:${o.container}, codecs[level/parsed]=[${t.codecs}/${o.codec}]`),delete e.video,delete e.audio);const a=Object.keys(e);if(a.length){if(this.hls.trigger(l.BUFFER_CODECS,e),!this.hls)return;a.forEach((t=>{const i=e[t].initSegment;null!=i&&i.byteLength&&this.hls.trigger(l.BUFFER_APPENDING,{type:t,data:i,frag:r,part:null,chunkMeta:n,parent:r.type})}))}this.tickImmediate()}getMainFwdBufferInfo(){const t=this.mediaBuffer&&2===this.altAudio?this.mediaBuffer:this.media;return this.getFwdBufferInfo(t,u.MAIN)}get maxBufferLength(){const{levels:t,level:e}=this,r=null==t?void 0:t[e];return r?this.getMaxBufferLength(r.maxBitrate):this.config.maxBufferLength}backtrack(t){this.couldBacktrack=!0,this.backtrackFragment=t,this.resetTransmuxer(),this.flushBufferGap(t),this.fragmentTracker.removeFragment(t),this.fragPrevious=null,this.nextLoadPosition=t.start,this.state=zr.IDLE}checkFragmentChanged(){const t=this.media;let e=null;if(t&&t.readyState>1&&!1===t.seeking){const r=t.currentTime;if(Ne.isBuffered(t,r)?e=this.getAppendedFrag(r):Ne.isBuffered(t,r+.1)&&(e=this.getAppendedFrag(r+.1)),e){this.backtrackFragment=null;const t=this.fragPlaying,r=e.level;t&&e.sn===t.sn&&t.level===r||(this.fragPlaying=e,this.hls.trigger(l.FRAG_CHANGED,{frag:e}),t&&t.level===r||this.hls.trigger(l.LEVEL_SWITCHED,{level:r}))}}}get nextLevel(){const t=this.nextBufferedFrag;return t?t.level:-1}get currentFrag(){var t;if(this.fragPlaying)return this.fragPlaying;const e=(null==(t=this.media)?void 0:t.currentTime)||this.lastCurrentTime;return n(e)?this.getAppendedFrag(e):null}get currentProgramDateTime(){var t;const e=(null==(t=this.media)?void 0:t.currentTime)||this.lastCurrentTime;if(n(e)){const t=this.getLevelDetails(),r=this.currentFrag||(t?re(null,t.fragments,e):null);if(r){const t=r.programDateTime;if(null!==t){const n=t+1e3*(e-r.start);return new Date(n)}}}return null}get currentLevel(){const t=this.currentFrag;return t?t.level:-1}get nextBufferedFrag(){const t=this.currentFrag;return t?this.followingBufferedFrag(t):null}get forceStartLoad(){return this._forceStartLoad}}class Fa extends y{constructor(t,e){super("key-loader",e),this.config=void 0,this.keyIdToKeyInfo={},this.emeController=null,this.config=t}abort(t){for(const r in this.keyIdToKeyInfo){const n=this.keyIdToKeyInfo[r].loader;if(n){var e;if(t&&t!==(null==(e=n.context)?void 0:e.frag.type))return;n.abort()}}}detach(){for(const t in this.keyIdToKeyInfo){const e=this.keyIdToKeyInfo[t];(e.mediaKeySessionContext||e.decryptdata.isCommonEncryption)&&delete this.keyIdToKeyInfo[t]}}destroy(){this.detach();for(const t in this.keyIdToKeyInfo){const e=this.keyIdToKeyInfo[t].loader;e&&e.destroy()}this.keyIdToKeyInfo={}}createKeyLoadError(t,e=a.KEY_LOAD_ERROR,r,n,i){return new Oe({type:o.NETWORK_ERROR,details:e,fatal:!1,frag:t,response:i,error:r,networkDetails:n})}loadClear(t,e,r){if(this.emeController&&this.config.emeEnabled&&!this.emeController.getSelectedKeySystemFormats().length){if(e.length)for(let n=0,i=e.length;n<i;n++){const s=e[n];if(t.cc<=s.cc&&(!j(t)||!j(s)||t.sn<s.sn)||!r&&n==i-1)return this.emeController.selectKeySystemFormat(s).then((t=>{if(!this.emeController)return;s.setKeyFormat(t);const e=ir(t);return e?this.emeController.getKeySystemAccess([e]):void 0}))}if(this.config.requireKeySystemAccessOnStart){const t=or(this.config);if(t.length)return this.emeController.getKeySystemAccess(t)}}return null}load(t){return!t.decryptdata&&t.encrypted&&this.emeController&&this.config.emeEnabled?this.emeController.selectKeySystemFormat(t).then((e=>this.loadInternal(t,e))):this.loadInternal(t)}loadInternal(t,e){var r,n;e&&t.setKeyFormat(e);const i=t.decryptdata;if(!i){const r=new Error(e?`Expected frag.decryptdata to be defined after setting format ${e}`:"Missing decryption data on fragment in onKeyLoading");return Promise.reject(this.createKeyLoadError(t,a.KEY_LOAD_ERROR,r))}const s=i.uri;if(!s)return Promise.reject(this.createKeyLoadError(t,a.KEY_LOAD_ERROR,new Error(`Invalid key URI: "${s}"`)));const o=Ua(i);let l=this.keyIdToKeyInfo[o];if(null!=(r=l)&&r.decryptdata.key)return i.key=l.decryptdata.key,Promise.resolve({frag:t,keyInfo:l});if(null!=(n=l)&&n.keyLoadPromise){var c;switch(null==(c=l.mediaKeySessionContext)?void 0:c.keyStatus){case"usable":case"usable-in-future":return l.keyLoadPromise.then((e=>{const{keyInfo:r}=e;return i.key=r.decryptdata.key,{frag:t,keyInfo:r}}))}}switch(this.log(`Loading key ${x(i.keyId||[])} from ${t.type} ${t.level}`),l=this.keyIdToKeyInfo[o]={decryptdata:i,keyLoadPromise:null,loader:null,mediaKeySessionContext:null},i.method){case"SAMPLE-AES":case"SAMPLE-AES-CENC":case"SAMPLE-AES-CTR":return"identity"===i.keyFormat?this.loadKeyHTTP(l,t):this.loadKeyEME(l,t);case"AES-128":case"AES-256":case"AES-256-CTR":return this.loadKeyHTTP(l,t);default:return Promise.reject(this.createKeyLoadError(t,a.KEY_LOAD_ERROR,new Error(`Key supplied with unsupported METHOD: "${i.method}"`)))}}loadKeyEME(t,e){const r={frag:e,keyInfo:t};if(this.emeController&&this.config.emeEnabled){const n=this.emeController.loadKey(r);return(t.keyLoadPromise=n.then((e=>(t.mediaKeySessionContext=e,r)))).catch((r=>{throw t.keyLoadPromise=null,r.data&&(r.data.frag=e),r}))}return Promise.resolve(r)}loadKeyHTTP(t,e){const r=this.config,n=new(0,r.loader)(r);return e.keyLoader=t.loader=n,t.keyLoadPromise=new Promise(((i,s)=>{const o={keyInfo:t,frag:e,responseType:"arraybuffer",url:t.decryptdata.uri},l=r.keyLoadPolicy.default,c={loadPolicy:l,timeout:l.maxLoadTimeMs,maxRetry:0,retryDelay:0,maxRetryDelay:0},u={onSuccess:(t,e,r,n)=>{const{frag:o,keyInfo:l,url:c}=r,u=Ua(l.decryptdata)||c;if(!o.decryptdata||l!==this.keyIdToKeyInfo[u])return s(this.createKeyLoadError(o,a.KEY_LOAD_ERROR,new Error("after key load, decryptdata unset or changed"),n));l.decryptdata.key=o.decryptdata.key=new Uint8Array(t.data),o.keyLoader=null,l.loader=null,i({frag:o,keyInfo:l})},onError:(t,r,n,i)=>{this.resetLoader(r),s(this.createKeyLoadError(e,a.KEY_LOAD_ERROR,new Error(`HTTP Error ${t.code} loading key ${t.text}`),n,m({url:o.url,data:void 0},t)))},onTimeout:(t,r,n)=>{this.resetLoader(r),s(this.createKeyLoadError(e,a.KEY_LOAD_TIMEOUT,new Error("key loading timed out"),n))},onAbort:(t,r,n)=>{this.resetLoader(r),s(this.createKeyLoadError(e,a.INTERNAL_ABORTED,new Error("key loading aborted"),n))}};n.load(o,c,u)}))}resetLoader(t){const{frag:e,keyInfo:r,url:n}=t,i=r.loader;e.keyLoader===i&&(e.keyLoader=null,r.loader=null);const s=Ua(r.decryptdata)||n;delete this.keyIdToKeyInfo[s],i&&i.destroy()}}function Ua(t){const e=t.keyId;return e?x(e):t.uri}function Ba(t){const{type:e}=t;switch(e){case c.AUDIO_TRACK:return u.AUDIO;case c.SUBTITLE_TRACK:return u.SUBTITLE;default:return u.MAIN}}function $a(t,e){let r=t.url;return void 0!==r&&0!==r.indexOf("data:")||(r=e.url),r}class ja{constructor(t){this.hls=void 0,this.loaders=Object.create(null),this.variableList=null,this.onManifestLoaded=this.checkAutostartLoad,this.hls=t,this.registerListeners()}startLoad(t){}stopLoad(){this.destroyInternalLoaders()}registerListeners(){const{hls:t}=this;t.on(l.MANIFEST_LOADING,this.onManifestLoading,this),t.on(l.LEVEL_LOADING,this.onLevelLoading,this),t.on(l.AUDIO_TRACK_LOADING,this.onAudioTrackLoading,this),t.on(l.SUBTITLE_TRACK_LOADING,this.onSubtitleTrackLoading,this),t.on(l.LEVELS_UPDATED,this.onLevelsUpdated,this)}unregisterListeners(){const{hls:t}=this;t.off(l.MANIFEST_LOADING,this.onManifestLoading,this),t.off(l.LEVEL_LOADING,this.onLevelLoading,this),t.off(l.AUDIO_TRACK_LOADING,this.onAudioTrackLoading,this),t.off(l.SUBTITLE_TRACK_LOADING,this.onSubtitleTrackLoading,this),t.off(l.LEVELS_UPDATED,this.onLevelsUpdated,this)}createInternalLoader(t){const e=this.hls.config,r=e.pLoader,n=e.loader,i=new(r||n)(e);return this.loaders[t.type]=i,i}getInternalLoader(t){return this.loaders[t.type]}resetInternalLoader(t){this.loaders[t]&&delete this.loaders[t]}destroyInternalLoaders(){for(const t in this.loaders){const e=this.loaders[t];e&&e.destroy(),this.resetInternalLoader(t)}}destroy(){this.variableList=null,this.unregisterListeners(),this.destroyInternalLoaders()}onManifestLoading(t,e){const{url:r}=e;this.variableList=null,this.load({id:null,level:0,responseType:"text",type:c.MANIFEST,url:r,deliveryDirectives:null,levelOrTrack:null})}onLevelLoading(t,e){const{id:r,level:n,pathwayId:i,url:s,deliveryDirectives:o,levelInfo:a}=e;this.load({id:r,level:n,pathwayId:i,responseType:"text",type:c.LEVEL,url:s,deliveryDirectives:o,levelOrTrack:a})}onAudioTrackLoading(t,e){const{id:r,groupId:n,url:i,deliveryDirectives:s,track:o}=e;this.load({id:r,groupId:n,level:null,responseType:"text",type:c.AUDIO_TRACK,url:i,deliveryDirectives:s,levelOrTrack:o})}onSubtitleTrackLoading(t,e){const{id:r,groupId:n,url:i,deliveryDirectives:s,track:o}=e;this.load({id:r,groupId:n,level:null,responseType:"text",type:c.SUBTITLE_TRACK,url:i,deliveryDirectives:s,levelOrTrack:o})}onLevelsUpdated(t,e){const r=this.loaders[c.LEVEL];if(r){const t=r.context;t&&!e.levels.some((e=>e===t.levelOrTrack))&&(r.abort(),delete this.loaders[c.LEVEL])}}load(t){var e;const r=this.hls.config;let i,s=this.getInternalLoader(t);if(s){const e=this.hls.logger,r=s.context;if(r&&r.levelOrTrack===t.levelOrTrack&&(r.url===t.url||r.deliveryDirectives&&!t.deliveryDirectives))return void(r.url===t.url?e.log(`[playlist-loader]: ignore ${t.url} ongoing request`):e.log(`[playlist-loader]: ignore ${t.url} in favor of ${r.url}`));e.log(`[playlist-loader]: aborting previous loader for type: ${t.type}`),s.abort()}if(i=t.type===c.MANIFEST?r.manifestLoadPolicy.default:p({},r.playlistLoadPolicy.default,{timeoutRetry:null,errorRetry:null}),s=this.createInternalLoader(t),n(null==(e=t.deliveryDirectives)?void 0:e.part)){let e;if(t.type===c.LEVEL&&null!==t.level?e=this.hls.levels[t.level].details:t.type===c.AUDIO_TRACK&&null!==t.id?e=this.hls.audioTracks[t.id].details:t.type===c.SUBTITLE_TRACK&&null!==t.id&&(e=this.hls.subtitleTracks[t.id].details),e){const t=e.partTarget,r=e.targetduration;if(t&&r){const e=1e3*Math.max(3*t,.8*r);i=p({},i,{maxTimeToFirstByteMs:Math.min(e,i.maxTimeToFirstByteMs),maxLoadTimeMs:Math.min(e,i.maxTimeToFirstByteMs)})}}}const o=i.errorRetry||i.timeoutRetry||{},a={loadPolicy:i,timeout:i.maxLoadTimeMs,maxRetry:o.maxNumRetry||0,retryDelay:o.retryDelayMs||0,maxRetryDelay:o.maxRetryDelayMs||0},l={onSuccess:(t,e,r,n)=>{const i=this.getInternalLoader(r);this.resetInternalLoader(r.type);const s=t.data;0===s.indexOf("#EXTM3U")?(e.parsing.start=performance.now(),mr.isMediaPlaylist(s)||r.type!==c.MANIFEST?this.handleTrackOrLevelPlaylist(t,e,r,n||null,i):this.handleMasterPlaylist(t,e,r,n)):this.handleManifestParsingError(t,r,new Error("no EXTM3U delimiter"),n||null,e)},onError:(t,e,r,n)=>{this.handleNetworkError(e,r,!1,t,n)},onTimeout:(t,e,r)=>{this.handleNetworkError(e,r,!0,void 0,t)}};s.load(t,a,l)}checkAutostartLoad(){if(!this.hls)return;const{config:{autoStartLoad:t,startPosition:e},forceStartLoad:r}=this.hls;(t||r)&&(this.hls.logger.log(`${t?"auto":"force"} startLoad with configured startPosition ${e}`),this.hls.startLoad(e))}handleMasterPlaylist(t,e,r,n){const i=this.hls,s=t.data,o=$a(t,r),a=mr.parseMasterPlaylist(s,o);if(a.playlistParsingError)return void this.handleManifestParsingError(t,r,a.playlistParsingError,n,e);const{contentSteering:c,levels:u,sessionData:h,sessionKeys:d,startTimeOffset:f,variableList:p}=a;this.variableList=p;const{AUDIO:g=[],SUBTITLES:m,"CLOSED-CAPTIONS":y}=mr.parseMasterPlaylistMedia(s,o,a);if(g.length){g.some((t=>!t.url))||!u[0].audioCodec||u[0].attrs.AUDIO||(this.hls.logger.log("[playlist-loader]: audio codec signaled in quality level, but no embedded audio track signaled, create one"),g.unshift({type:"main",name:"main",groupId:"main",default:!1,autoselect:!1,forced:!1,id:-1,attrs:new Ve({}),bitrate:0,url:""}))}i.trigger(l.MANIFEST_LOADED,{levels:u,audioTracks:g,subtitles:m,captions:y,contentSteering:c,url:o,stats:e,networkDetails:n,sessionData:h,sessionKeys:d,startTimeOffset:f,variableList:p})}handleTrackOrLevelPlaylist(t,e,r,i,s){const o=this.hls,{id:a,level:u,type:h}=r,d=$a(t,r),f=n(u)?u:n(a)?a:0,p=Ba(r),g=mr.parseLevelPlaylist(t.data,d,f,p,0,this.variableList);if(h===c.MANIFEST){const t={attrs:new Ve({}),bitrate:0,details:g,name:"",url:d};g.requestScheduled=e.loading.start+Cr(g,0),o.trigger(l.MANIFEST_LOADED,{levels:[t],audioTracks:[],url:d,stats:e,networkDetails:i,sessionData:null,sessionKeys:null,contentSteering:null,startTimeOffset:null,variableList:null})}e.parsing.end=performance.now(),r.levelDetails=g,this.handlePlaylistLoaded(g,t,e,r,i,s)}handleManifestParsingError(t,e,r,n,i){this.hls.trigger(l.ERROR,{type:o.NETWORK_ERROR,details:a.MANIFEST_PARSING_ERROR,fatal:e.type===c.MANIFEST,url:t.url,err:r,error:r,reason:r.message,response:t,context:e,networkDetails:n,stats:i})}handleNetworkError(t,e,r=!1,n,i){let s=`A network ${r?"timeout":"error"+(n?" (status "+n.code+")":"")} occurred while loading ${t.type}`;t.type===c.LEVEL?s+=`: ${t.level} id: ${t.id}`:t.type!==c.AUDIO_TRACK&&t.type!==c.SUBTITLE_TRACK||(s+=` id: ${t.id} group-id: "${t.groupId}"`);const u=new Error(s);this.hls.logger.warn(`[playlist-loader]: ${s}`);let h=a.UNKNOWN,d=!1;const f=this.getInternalLoader(t);switch(t.type){case c.MANIFEST:h=r?a.MANIFEST_LOAD_TIMEOUT:a.MANIFEST_LOAD_ERROR,d=!0;break;case c.LEVEL:h=r?a.LEVEL_LOAD_TIMEOUT:a.LEVEL_LOAD_ERROR,d=!1;break;case c.AUDIO_TRACK:h=r?a.AUDIO_TRACK_LOAD_TIMEOUT:a.AUDIO_TRACK_LOAD_ERROR,d=!1;break;case c.SUBTITLE_TRACK:h=r?a.SUBTITLE_TRACK_LOAD_TIMEOUT:a.SUBTITLE_LOAD_ERROR,d=!1}f&&this.resetInternalLoader(t.type);const p={type:o.NETWORK_ERROR,details:h,fatal:d,url:t.url,loader:f,context:t,error:u,networkDetails:e,stats:i};if(n){const r=(null==e?void 0:e.url)||t.url;p.response=m({url:r,data:void 0},n)}this.hls.trigger(l.ERROR,p)}handlePlaylistLoaded(t,e,r,n,i,s){const h=this.hls,{type:d,level:f,id:p,groupId:g,deliveryDirectives:m}=n,y=$a(e,n),v=Ba(n),b="number"==typeof n.level&&v===u.MAIN?f:void 0;if(!t.fragments.length){const s=t.playlistParsingError=new Error("No Segments found in Playlist");return void h.trigger(l.ERROR,{type:o.NETWORK_ERROR,details:a.LEVEL_EMPTY_ERROR,fatal:!1,url:y,error:s,reason:s.message,response:e,context:n,level:b,parent:v,networkDetails:i,stats:r})}t.targetduration||(t.playlistParsingError=new Error("Missing Target Duration"));const E=t.playlistParsingError;if(E){if(this.hls.logger.warn(`${E} ${t.url}`),!h.config.ignorePlaylistParsingErrors)return void h.trigger(l.ERROR,{type:o.NETWORK_ERROR,details:a.LEVEL_PARSING_ERROR,fatal:!1,url:y,error:E,reason:E.message,response:e,context:n,level:b,parent:v,networkDetails:i,stats:r});t.playlistParsingError=null}switch(t.live&&s&&(s.getCacheAge&&(t.ageHeader=s.getCacheAge()||0),s.getCacheAge&&!isNaN(t.ageHeader)||(t.ageHeader=0)),d){case c.MANIFEST:case c.LEVEL:h.trigger(l.LEVEL_LOADED,{details:t,levelInfo:n.levelOrTrack||h.levels[0],level:b||0,id:p||0,stats:r,networkDetails:i,deliveryDirectives:m,withoutMultiVariant:d===c.MANIFEST});break;case c.AUDIO_TRACK:h.trigger(l.AUDIO_TRACK_LOADED,{details:t,track:n.levelOrTrack,id:p||0,groupId:g||"",stats:r,networkDetails:i,deliveryDirectives:m});break;case c.SUBTITLE_TRACK:h.trigger(l.SUBTITLE_TRACK_LOADED,{details:t,track:n.levelOrTrack,id:p||0,groupId:g||"",stats:r,networkDetails:i,deliveryDirectives:m})}}}class Ga{static get version(){return nn}static isMSESupported(){return Ma()}static isSupported(){return function(){if(!Ma())return!1;const t=S();return"function"==typeof(null==t?void 0:t.isTypeSupported)&&(["avc1.42E01E,mp4a.40.2","av01.0.01M.08","vp09.00.50.08"].some((e=>t.isTypeSupported(Et(e,"video"))))||["mp4a.40.2","fLaC"].some((e=>t.isTypeSupported(Et(e,"audio")))))}()}static getMediaSource(){return S()}static get Events(){return l}static get MetadataSchema(){return Pn}static get ErrorTypes(){return o}static get ErrorDetails(){return a}static get DefaultConfig(){return Ga.defaultConfig?Ga.defaultConfig:Ea}static set DefaultConfig(t){Ga.defaultConfig=t}constructor(t={}){this.config=void 0,this.userConfig=void 0,this.logger=void 0,this.coreComponents=void 0,this.networkControllers=void 0,this._emitter=new rn,this._autoLevelCapping=-1,this._maxHdcpLevel=null,this.abrController=void 0,this.bufferController=void 0,this.capLevelController=void 0,this.latencyController=void 0,this.levelController=void 0,this.streamController=void 0,this.audioStreamController=void 0,this.subtititleStreamController=void 0,this.audioTrackController=void 0,this.subtitleTrackController=void 0,this.interstitialsController=void 0,this.gapController=void 0,this.emeController=void 0,this.cmcdController=void 0,this._media=null,this._url=null,this._sessionId=void 0,this.triggeringException=void 0,this.started=!1;const e=this.logger=function(t,e,r){const n=E();if("object"==typeof console&&!0===t||"object"==typeof t){const i=["debug","log","info","warn","error"];i.forEach((e=>{n[e]=A(e,t,r)}));try{n.log(`Debug logs enabled for "${e}" in hls.js version 1.6.11`)}catch(t){return E()}i.forEach((e=>{w[e]=A(e,t)}))}else p(w,n);return n}(t.debug||!1,"Hls instance",t.assetPlayerId),r=this.config=function(t,e,r){if((e.liveSyncDurationCount||e.liveMaxLatencyDurationCount)&&(e.liveSyncDuration||e.liveMaxLatencyDuration))throw new Error("Illegal hls.js config: don't mix up liveSyncDurationCount/liveMaxLatencyDurationCount and liveSyncDuration/liveMaxLatencyDuration");if(void 0!==e.liveMaxLatencyDurationCount&&(void 0===e.liveSyncDurationCount||e.liveMaxLatencyDurationCount<=e.liveSyncDurationCount))throw new Error('Illegal hls.js config: "liveMaxLatencyDurationCount" must be greater than "liveSyncDurationCount"');if(void 0!==e.liveMaxLatencyDuration&&(void 0===e.liveSyncDuration||e.liveMaxLatencyDuration<=e.liveSyncDuration))throw new Error('Illegal hls.js config: "liveMaxLatencyDuration" must be greater than "liveSyncDuration"');const n=Aa(t),i=["TimeOut","MaxRetry","RetryDelay","MaxRetryTimeout"];return["manifest","level","frag"].forEach((t=>{const s=`${"level"===t?"playlist":t}LoadPolicy`,o=void 0===e[s],a=[];i.forEach((r=>{const i=`${t}Loading${r}`,l=e[i];if(void 0!==l&&o){a.push(i);const t=n[s].default;switch(e[s]={default:t},r){case"TimeOut":t.maxLoadTimeMs=l,t.maxTimeToFirstByteMs=l;break;case"MaxRetry":t.errorRetry.maxNumRetry=l,t.timeoutRetry.maxNumRetry=l;break;case"RetryDelay":t.errorRetry.retryDelayMs=l,t.timeoutRetry.retryDelayMs=l;break;case"MaxRetryTimeout":t.errorRetry.maxRetryDelayMs=l,t.timeoutRetry.maxRetryDelayMs=l}}})),a.length&&r.warn(`hls.js config: "${a.join('", "')}" setting(s) are deprecated, use "${s}": ${Yt(e[s])}`)})),m(m({},n),e)}(Ga.DefaultConfig,t,e);this.userConfig=t,r.progressive&&wa(r,e);const{abrController:n,bufferController:i,capLevelController:s,errorController:o,fpsController:a}=r,c=new o(this),u=this.abrController=new n(this),h=new be(this),d=r.interstitialsController,f=d?this.interstitialsController=new d(this,Ga):null,g=this.bufferController=new i(this,h),y=this.capLevelController=new s(this),v=new a(this),b=new ja(this),T=r.contentSteeringController,S=T?new T(this):null,L=this.levelController=new Oa(this,S),_=new Ia(this),x=new Fa(this.config,this.logger),k=this.streamController=new Na(this,h,x),P=this.gapController=new Ta(this,h);y.setStreamController(k),v.setStreamController(k);const I=[b,L,k];f&&I.splice(1,0,f),S&&I.splice(1,0,S),this.networkControllers=I;const R=[u,g,P,y,v,_,h];this.audioTrackController=this.createController(r.audioTrackController,I);const O=r.audioStreamController;O&&I.push(this.audioStreamController=new O(this,h,x)),this.subtitleTrackController=this.createController(r.subtitleTrackController,I);const D=r.subtitleStreamController;D&&I.push(this.subtititleStreamController=new D(this,h,x)),this.createController(r.timelineController,R),x.emeController=this.emeController=this.createController(r.emeController,R),this.cmcdController=this.createController(r.cmcdController,R),this.latencyController=this.createController(Ra,R),this.coreComponents=R,I.push(c);const C=c.onErrorOut;"function"==typeof C&&this.on(l.ERROR,C,c),this.on(l.MANIFEST_LOADED,b.onManifestLoaded,b)}createController(t,e){if(t){const r=new t(this);return e&&e.push(r),r}return null}on(t,e,r=this){this._emitter.on(t,e,r)}once(t,e,r=this){this._emitter.once(t,e,r)}removeAllListeners(t){this._emitter.removeAllListeners(t)}off(t,e,r=this,n){this._emitter.off(t,e,r,n)}listeners(t){return this._emitter.listeners(t)}emit(t,e,r){return this._emitter.emit(t,e,r)}trigger(t,e){if(this.config.debug)return this.emit(t,t,e);try{return this.emit(t,t,e)}catch(e){if(this.logger.error("An internal error happened while handling event "+t+'. Error message: "'+e.message+'". Here is a stacktrace:',e),!this.triggeringException){this.triggeringException=!0;const r=t===l.ERROR;this.trigger(l.ERROR,{type:o.OTHER_ERROR,details:a.INTERNAL_EXCEPTION,fatal:r,event:t,error:e}),this.triggeringException=!1}}return!1}listenerCount(t){return this._emitter.listenerCount(t)}destroy(){this.logger.log("destroy"),this.trigger(l.DESTROYING,void 0),this.detachMedia(),this.removeAllListeners(),this._autoLevelCapping=-1,this._url=null,this.networkControllers.forEach((t=>t.destroy())),this.networkControllers.length=0,this.coreComponents.forEach((t=>t.destroy())),this.coreComponents.length=0;const t=this.config;t.xhrSetup=t.fetchSetup=void 0,this.userConfig=null}attachMedia(t){if(!t||"media"in t&&!t.media){const e=new Error(`attachMedia failed: invalid argument (${t})`);return void this.trigger(l.ERROR,{type:o.OTHER_ERROR,details:a.ATTACH_MEDIA_ERROR,fatal:!0,error:e})}this.logger.log("attachMedia"),this._media&&(this.logger.warn("media must be detached before attaching"),this.detachMedia());const e="media"in t,r=e?t.media:t,n=e?t:{media:r};this._media=r,this.trigger(l.MEDIA_ATTACHING,n)}detachMedia(){this.logger.log("detachMedia"),this.trigger(l.MEDIA_DETACHING,{}),this._media=null}transferMedia(){this._media=null;const t=this.bufferController.transferMedia();return this.trigger(l.MEDIA_DETACHING,{transferMedia:t}),t}loadSource(t){this.stopLoad();const e=this.media,r=this._url,n=this._url=F.buildAbsoluteURL(self.location.href,t,{alwaysNormalize:!0});this._autoLevelCapping=-1,this._maxHdcpLevel=null,this.logger.log(`loadSource:${n}`),e&&r&&(r!==n||this.bufferController.hasSourceTypes())&&(this.detachMedia(),this.attachMedia(e)),this.trigger(l.MANIFEST_LOADING,{url:t})}get url(){return this._url}get hasEnoughToStart(){return this.streamController.hasEnoughToStart}get startPosition(){return this.streamController.startPositionValue}startLoad(t=-1,e){this.logger.log(`startLoad(${t+(e?", <skip seek to start>":"")})`),this.started=!0,this.resumeBuffering();for(let r=0;r<this.networkControllers.length&&(this.networkControllers[r].startLoad(t,e),this.started&&this.networkControllers);r++);}stopLoad(){this.logger.log("stopLoad"),this.started=!1;for(let t=0;t<this.networkControllers.length&&(this.networkControllers[t].stopLoad(),!this.started&&this.networkControllers);t++);}get loadingEnabled(){return this.started}get bufferingEnabled(){return this.streamController.bufferingEnabled}resumeBuffering(){this.bufferingEnabled||(this.logger.log("resume buffering"),this.networkControllers.forEach((t=>{t.resumeBuffering&&t.resumeBuffering()})))}pauseBuffering(){this.bufferingEnabled&&(this.logger.log("pause buffering"),this.networkControllers.forEach((t=>{t.pauseBuffering&&t.pauseBuffering()})))}get inFlightFragments(){const t={[u.MAIN]:this.streamController.inFlightFrag};return this.audioStreamController&&(t[u.AUDIO]=this.audioStreamController.inFlightFrag),this.subtititleStreamController&&(t[u.SUBTITLE]=this.subtititleStreamController.inFlightFrag),t}swapAudioCodec(){this.logger.log("swapAudioCodec"),this.streamController.swapAudioCodec()}recoverMediaError(){this.logger.log("recoverMediaError");const t=this._media,e=null==t?void 0:t.currentTime;this.detachMedia(),t&&(this.attachMedia(t),e&&this.startLoad(e))}removeLevel(t){this.levelController.removeLevel(t)}get sessionId(){let t=this._sessionId;return t||(t=this._sessionId=function(){try{return crypto.randomUUID()}catch(t){try{const t=URL.createObjectURL(new Blob),e=t.toString();return URL.revokeObjectURL(t),e.slice(e.lastIndexOf("/")+1)}catch(t){let e=(new Date).getTime();return"xxxxxxxx-xxxx-4xxx-yxxx-xxxxxxxxxxxx".replace(/[xy]/g,(t=>{const r=(e+16*Math.random())%16|0;return e=Math.floor(e/16),("x"==t?r:3&r|8).toString(16)}))}}}()),t}get levels(){const t=this.levelController.levels;return t||[]}get latestLevelDetails(){return this.streamController.getLevelDetails()||null}get loadLevelObj(){return this.levelController.loadLevelObj}get currentLevel(){return this.streamController.currentLevel}set currentLevel(t){this.logger.log(`set currentLevel:${t}`),this.levelController.manualLevel=t,this.streamController.immediateLevelSwitch()}get nextLevel(){return this.streamController.nextLevel}set nextLevel(t){this.logger.log(`set nextLevel:${t}`),this.levelController.manualLevel=t,this.streamController.nextLevelSwitch()}get loadLevel(){return this.levelController.level}set loadLevel(t){this.logger.log(`set loadLevel:${t}`),this.levelController.manualLevel=t}get nextLoadLevel(){return this.levelController.nextLoadLevel}set nextLoadLevel(t){this.levelController.nextLoadLevel=t}get firstLevel(){return Math.max(this.levelController.firstLevel,this.minAutoLevel)}set firstLevel(t){this.logger.log(`set firstLevel:${t}`),this.levelController.firstLevel=t}get startLevel(){const t=this.levelController.startLevel;return-1===t&&this.abrController.forcedAutoLevel>-1?this.abrController.forcedAutoLevel:t}set startLevel(t){this.logger.log(`set startLevel:${t}`),-1!==t&&(t=Math.max(t,this.minAutoLevel)),this.levelController.startLevel=t}get capLevelToPlayerSize(){return this.config.capLevelToPlayerSize}set capLevelToPlayerSize(t){const e=!!t;e!==this.config.capLevelToPlayerSize&&(e?this.capLevelController.startCapping():(this.capLevelController.stopCapping(),this.autoLevelCapping=-1,this.streamController.nextLevelSwitch()),this.config.capLevelToPlayerSize=e)}get autoLevelCapping(){return this._autoLevelCapping}get bandwidthEstimate(){const{bwEstimator:t}=this.abrController;return t?t.getEstimate():NaN}set bandwidthEstimate(t){this.abrController.resetEstimator(t)}get abrEwmaDefaultEstimate(){const{bwEstimator:t}=this.abrController;return t?t.defaultEstimate:NaN}get ttfbEstimate(){const{bwEstimator:t}=this.abrController;return t?t.getEstimateTTFB():NaN}set autoLevelCapping(t){this._autoLevelCapping!==t&&(this.logger.log(`set autoLevelCapping:${t}`),this._autoLevelCapping=t,this.levelController.checkMaxAutoUpdated())}get maxHdcpLevel(){return this._maxHdcpLevel}set maxHdcpLevel(t){(function(t){return Ut.indexOf(t)>-1})(t)&&this._maxHdcpLevel!==t&&(this._maxHdcpLevel=t,this.levelController.checkMaxAutoUpdated())}get autoLevelEnabled(){return-1===this.levelController.manualLevel}get manualLevel(){return this.levelController.manualLevel}get minAutoLevel(){const{levels:t,config:{minAutoBitrate:e}}=this;if(!t)return 0;const r=t.length;for(let n=0;n<r;n++)if(t[n].maxBitrate>=e)return n;return 0}get maxAutoLevel(){const{levels:t,autoLevelCapping:e,maxHdcpLevel:r}=this;let n;if(n=-1===e&&null!=t&&t.length?t.length-1:e,r)for(let e=n;e--;){const n=t[e].attrs["HDCP-LEVEL"];if(n&&n<=r)return e}return n}get firstAutoLevel(){return this.abrController.firstAutoLevel}get nextAutoLevel(){return this.abrController.nextAutoLevel}set nextAutoLevel(t){this.abrController.nextAutoLevel=t}get playingDate(){return this.streamController.currentProgramDateTime}get mainForwardBufferInfo(){return this.streamController.getMainFwdBufferInfo()}get maxBufferLength(){return this.streamController.maxBufferLength}setAudioOption(t){var e;return(null==(e=this.audioTrackController)?void 0:e.setAudioOption(t))||null}setSubtitleOption(t){var e;return(null==(e=this.subtitleTrackController)?void 0:e.setSubtitleOption(t))||null}get allAudioTracks(){const t=this.audioTrackController;return t?t.allAudioTracks:[]}get audioTracks(){const t=this.audioTrackController;return t?t.audioTracks:[]}get audioTrack(){const t=this.audioTrackController;return t?t.audioTrack:-1}set audioTrack(t){const e=this.audioTrackController;e&&(e.audioTrack=t)}get allSubtitleTracks(){const t=this.subtitleTrackController;return t?t.allSubtitleTracks:[]}get subtitleTracks(){const t=this.subtitleTrackController;return t?t.subtitleTracks:[]}get subtitleTrack(){const t=this.subtitleTrackController;return t?t.subtitleTrack:-1}get media(){return this._media}set subtitleTrack(t){const e=this.subtitleTrackController;e&&(e.subtitleTrack=t)}get subtitleDisplay(){const t=this.subtitleTrackController;return!!t&&t.subtitleDisplay}set subtitleDisplay(t){const e=this.subtitleTrackController;e&&(e.subtitleDisplay=t)}get lowLatencyMode(){return this.config.lowLatencyMode}set lowLatencyMode(t){this.config.lowLatencyMode=t}get liveSyncPosition(){return this.latencyController.liveSyncPosition}get latency(){return this.latencyController.latency}get maxLatency(){return this.latencyController.maxLatency}get targetLatency(){return this.latencyController.targetLatency}set targetLatency(t){this.latencyController.targetLatency=t}get drift(){return this.latencyController.drift}get forceStartLoad(){return this.streamController.forceStartLoad}get pathways(){return this.levelController.pathways}get pathwayPriority(){return this.levelController.pathwayPriority}set pathwayPriority(t){this.levelController.pathwayPriority=t}get bufferedToEnd(){var t;return!(null==(t=this.bufferController)||!t.bufferedToEnd)}get interstitialsManager(){var t;return(null==(t=this.interstitialsController)?void 0:t.interstitialsManager)||null}getMediaDecodingInfo(t,e=this.allAudioTracks){return Mt(t,Wt(e),navigator.mediaCapabilities)}}Ga.defaultConfig=void 0}},i={};function s(t){var e=i[t];if(void 0!==e)return e.exports;var r=i[t]={id:t,loaded:!1,exports:{}};return n[t].call(r.exports,r,r.exports,s),r.loaded=!0,r.exports}s.m=n,t=[],s.O=(e,r,n,i)=>{if(!r){var o=1/0;for(u=0;u<t.length;u++){for(var[r,n,i]=t[u],a=!0,l=0;l<r.length;l++)(!1&i||o>=i)&&Object.keys(s.O).every((t=>s.O[t](r[l])))?r.splice(l--,1):(a=!1,i<o&&(o=i));if(a){t.splice(u--,1);var c=n();void 0!==c&&(e=c)}}return e}i=i||0;for(var u=t.length;u>0&&t[u-1][2]>i;u--)t[u]=t[u-1];t[u]=[r,n,i]},s.n=t=>{var e=t&&t.__esModule?()=>t.default:()=>t;return s.d(e,{a:e}),e},s.d=(t,e)=>{for(var r in e)s.o(e,r)&&!s.o(t,r)&&Object.defineProperty(t,r,{enumerable:!0,get:e[r]})},s.f={},s.e=t=>Promise.all(Object.keys(s.f).reduce(((e,r)=>(s.f[r](t,e),e)),[])),s.u=t=>"dist/js/"+{65:"single-print",812:"npm.swiper",873:"chapter-index",894:"npm.@lottiefiles",1196:"interview",1393:"film",2568:"print",2693:"opening",2797:"event",3252:"tree-migration",3543:"gallery",3774:"film-series-single",4041:"npm.animejs",4094:"valemon-the-bear",4268:"events",4279:"studies-on-light",4371:"essay-template",4484:"npm.earcut",5146:"prelude",5237:"london-exhibition",5724:"npm.@pixi",5927:"npm.dom7",6022:"chapter",6059:"audio-story",6343:"film-series-landing",6628:"breathing-with-the-forest",6721:"soundtrack",7575:"film-series-engage",7962:"home",8772:"op-ed",8911:"npm.url",9200:"npm.@vimeo",9229:"npm.gsap",9344:"practice",9952:"podcasts"}[t]+".js?id="+{65:"b229892b3ae9a8d8",812:"6dd4fea9ff9b7bd9",873:"8e72d6ead064570f",894:"64aea4319a6c9ce0",1196:"f6a40d2fbea302d2",1393:"ffb1a777fffea118",2568:"2283bf798e06df59",2693:"2d377733b3c1e9f5",2797:"3154aee6c60ca0f0",3252:"7672feaa06ca0a35",3543:"56a02ab3065d4bd6",3774:"478b8194e88c8060",4041:"073491cbf3fb75c0",4094:"2b83732fc2ee4ce3",4268:"40505d48e971d874",4279:"77b200107bbd00bc",4371:"5c47e0e3d086ee6f",4484:"56e94295a1b88fd1",5146:"7037076bab0a7d78",5237:"c45fd90e736c5ad4",5724:"1e6bdb00e756399f",5927:"c3fbc2f06cfe169c",6022:"c2d8260bd3f91746",6059:"5e50015b08b758fa",6343:"fbbfeeb36a566e6e",6628:"e7c9a848c9ae4e66",6721:"32b078494313700d",7575:"39212c3055cd2217",7962:"faff61dfac42a81e",8772:"52c6a3e3c2b10655",8911:"709684793360f620",9200:"858b08666a8cdfc2",9229:"12198e1cd35fc888",9344:"81d69aed4c95a351",9952:"808633e22f5f2f12"}[t],s.miniCssF=t=>({161:"dist/css/_gallery",490:"dist/css/_print",719:"dist/css/_fallen",1011:"dist/css/_film",1014:"dist/css/_tree-migration",1081:"dist/css/editor",1130:"dist/css/_practice",2143:"dist/css/custom-stories",2833:"dist/css/_studies-on-light",3190:"dist/css/_podcasts",3222:"dist/css/_essay",3331:"dist/css/_single-print",3684:"dist/css/_home",4590:"dist/css/_interview",4994:"dist/css/_breathing-with-the-forest",5167:"dist/css/_event",5962:"dist/css/_op-ed",6200:"dist/css/_valemon-the-bear",6369:"dist/css/_soundtrack-page",6396:"dist/css/_home-old",6864:"dist/css/_film-series-single",7427:"dist/css/_london-exhibition",7523:"dist/css/_vol3",7597:"dist/css/_film-series-landing",7921:"dist/css/main",8363:"dist/css/admin-style",8385:"dist/css/_film-series-engage",8413:"dist/css/_audio-story",8502:"dist/css/_events",9858:"dist/css/_pollinators"}[t]+".css"),s.g=function(){if("object"==typeof globalThis)return globalThis;try{return this||new Function("return this")()}catch(t){if("object"==typeof window)return window}}(),s.o=(t,e)=>Object.prototype.hasOwnProperty.call(t,e),e={},r="alfred:",s.l=(t,n,i,o)=>{if(e[t])e[t].push(n);else{var a,l;if(void 0!==i)for(var c=document.getElementsByTagName("script"),u=0;u<c.length;u++){var h=c[u];if(h.getAttribute("src")==t||h.getAttribute("data-webpack")==r+i){a=h;break}}a||(l=!0,(a=document.createElement("script")).charset="utf-8",a.timeout=120,s.nc&&a.setAttribute("nonce",s.nc),a.setAttribute("data-webpack",r+i),a.src=t),e[t]=[n];var d=(r,n)=>{a.onerror=a.onload=null,clearTimeout(f);var i=e[t];if(delete e[t],a.parentNode&&a.parentNode.removeChild(a),i&&i.forEach((t=>t(n))),r)return r(n)},f=setTimeout(d.bind(null,void 0,{type:"timeout",target:a}),12e4);a.onerror=d.bind(null,a.onerror),a.onload=d.bind(null,a.onload),l&&document.head.appendChild(a)}},s.r=t=>{"undefined"!=typeof Symbol&&Symbol.toStringTag&&Object.defineProperty(t,Symbol.toStringTag,{value:"Module"}),Object.defineProperty(t,"__esModule",{value:!0})},s.nmd=t=>(t.paths=[],t.children||(t.children=[]),t),s.p="/app/themes/emergence/",(()=>{var t={2212:0,7921:0,6200:0,4994:0,9858:0,1014:0,2143:0,8363:0,1081:0,6369:0,3190:0,3331:0,490:0,8413:0,1130:0,3684:0,6396:0,4590:0,1011:0,161:0,5167:0,8502:0,3222:0,5962:0,2833:0,8385:0,6864:0,7597:0,7427:0,719:0,7523:0};s.f.j=(e,r)=>{var n=s.o(t,e)?t[e]:void 0;if(0!==n)if(n)r.push(n[2]);else if(/^(1(0(11|14|81)|130|61)|3(190|222|331|684)|4((|5)90|994)|6(200|369|396|864)|7(19|427|523|597|921)|8(363|385|413|502)|2143|2833|5167|5962|9858)$/.test(e))t[e]=0;else{var i=new Promise(((r,i)=>n=t[e]=[r,i]));r.push(n[2]=i);var o=s.p+s.u(e),a=new Error;s.l(o,(r=>{if(s.o(t,e)&&(0!==(n=t[e])&&(t[e]=void 0),n)){var i=r&&("load"===r.type?"missing":r.type),o=r&&r.target&&r.target.src;a.message="Loading chunk "+e+" failed.\n("+i+": "+o+")",a.name="ChunkLoadError",a.type=i,a.request=o,n[1](a)}}),"chunk-"+e,e)}},s.O.j=e=>0===t[e];var e=(e,r)=>{var n,i,[o,a,l]=r,c=0;if(o.some((e=>0!==t[e]))){for(n in a)s.o(a,n)&&(s.m[n]=a[n]);if(l)var u=l(s)}for(e&&e(r);c<o.length;c++)i=o[c],s.o(t,i)&&t[i]&&t[i][0](),t[i]=0;return s.O(u)},r=self.webpackChunkalfred=self.webpackChunkalfred||[];r.forEach(e.bind(null,0)),r.push=e.bind(null,r.push.bind(r))})(),s.O(void 0,[7921,6200,4994,9858,1014,2143,8363,1081,6369,3190,3331,490,8413,1130,3684,6396,4590,1011,161,5167,8502,3222,5962,2833,8385,6864,7597,7427,719,7523],(()=>s(3193))),s.O(void 0,[7921,6200,4994,9858,1014,2143,8363,1081,6369,3190,3331,490,8413,1130,3684,6396,4590,1011,161,5167,8502,3222,5962,2833,8385,6864,7597,7427,719,7523],(()=>s(6900))),s.O(void 0,[7921,6200,4994,9858,1014,2143,8363,1081,6369,3190,3331,490,8413,1130,3684,6396,4590,1011,161,5167,8502,3222,5962,2833,8385,6864,7597,7427,719,7523],(()=>s(8665))),s.O(void 0,[7921,6200,4994,9858,1014,2143,8363,1081,6369,3190,3331,490,8413,1130,3684,6396,4590,1011,161,5167,8502,3222,5962,2833,8385,6864,7597,7427,719,7523],(()=>s(221))),s.O(void 0,[7921,6200,4994,9858,1014,2143,8363,1081,6369,3190,3331,490,8413,1130,3684,6396,4590,1011,161,5167,8502,3222,5962,2833,8385,6864,7597,7427,719,7523],(()=>s(1363))),s.O(void 0,[7921,6200,4994,9858,1014,2143,8363,1081,6369,3190,3331,490,8413,1130,3684,6396,4590,1011,161,5167,8502,3222,5962,2833,8385,6864,7597,7427,719,7523],(()=>s(1781))),s.O(void 0,[7921,6200,4994,9858,1014,2143,8363,1081,6369,3190,3331,490,8413,1130,3684,6396,4590,1011,161,5167,8502,3222,5962,2833,8385,6864,7597,7427,719,7523],(()=>s(138))),s.O(void 0,[7921,6200,4994,9858,1014,2143,8363,1081,6369,3190,3331,490,8413,1130,3684,6396,4590,1011,161,5167,8502,3222,5962,2833,8385,6864,7597,7427,719,7523],(()=>s(6608))),s.O(void 0,[7921,6200,4994,9858,1014,2143,8363,1081,6369,3190,3331,490,8413,1130,3684,6396,4590,1011,161,5167,8502,3222,5962,2833,8385,6864,7597,7427,719,7523],(()=>s(5172))),s.O(void 0,[7921,6200,4994,9858,1014,2143,8363,1081,6369,3190,3331,490,8413,1130,3684,6396,4590,1011,161,5167,8502,3222,5962,2833,8385,6864,7597,7427,719,7523],(()=>s(204))),s.O(void 0,[7921,6200,4994,9858,1014,2143,8363,1081,6369,3190,3331,490,8413,1130,3684,6396,4590,1011,161,5167,8502,3222,5962,2833,8385,6864,7597,7427,719,7523],(()=>s(175))),s.O(void 0,[7921,6200,4994,9858,1014,2143,8363,1081,6369,3190,3331,490,8413,1130,3684,6396,4590,1011,161,5167,8502,3222,5962,2833,8385,6864,7597,7427,719,7523],(()=>s(4470))),s.O(void 0,[7921,6200,4994,9858,1014,2143,8363,1081,6369,3190,3331,490,8413,1130,3684,6396,4590,1011,161,5167,8502,3222,5962,2833,8385,6864,7597,7427,719,7523],(()=>s(4768))),s.O(void 0,[7921,6200,4994,9858,1014,2143,8363,1081,6369,3190,3331,490,8413,1130,3684,6396,4590,1011,161,5167,8502,3222,5962,2833,8385,6864,7597,7427,719,7523],(()=>s(601))),s.O(void 0,[7921,6200,4994,9858,1014,2143,8363,1081,6369,3190,3331,490,8413,1130,3684,6396,4590,1011,161,5167,8502,3222,5962,2833,8385,6864,7597,7427,719,7523],(()=>s(3739))),s.O(void 0,[7921,6200,4994,9858,1014,2143,8363,1081,6369,3190,3331,490,8413,1130,3684,6396,4590,1011,161,5167,8502,3222,5962,2833,8385,6864,7597,7427,719,7523],(()=>s(9855))),s.O(void 0,[7921,6200,4994,9858,1014,2143,8363,1081,6369,3190,3331,490,8413,1130,3684,6396,4590,1011,161,5167,8502,3222,5962,2833,8385,6864,7597,7427,719,7523],(()=>s(6398))),s.O(void 0,[7921,6200,4994,9858,1014,2143,8363,1081,6369,3190,3331,490,8413,1130,3684,6396,4590,1011,161,5167,8502,3222,5962,2833,8385,6864,7597,7427,719,7523],(()=>s(5966))),s.O(void 0,[7921,6200,4994,9858,1014,2143,8363,1081,6369,3190,3331,490,8413,1130,3684,6396,4590,1011,161,5167,8502,3222,5962,2833,8385,6864,7597,7427,719,7523],(()=>s(3168))),s.O(void 0,[7921,6200,4994,9858,1014,2143,8363,1081,6369,3190,3331,490,8413,1130,3684,6396,4590,1011,161,5167,8502,3222,5962,2833,8385,6864,7597,7427,719,7523],(()=>s(6111))),s.O(void 0,[7921,6200,4994,9858,1014,2143,8363,1081,6369,3190,3331,490,8413,1130,3684,6396,4590,1011,161,5167,8502,3222,5962,2833,8385,6864,7597,7427,719,7523],(()=>s(1261))),s.O(void 0,[7921,6200,4994,9858,1014,2143,8363,1081,6369,3190,3331,490,8413,1130,3684,6396,4590,1011,161,5167,8502,3222,5962,2833,8385,6864,7597,7427,719,7523],(()=>s(7183))),s.O(void 0,[7921,6200,4994,9858,1014,2143,8363,1081,6369,3190,3331,490,8413,1130,3684,6396,4590,1011,161,5167,8502,3222,5962,2833,8385,6864,7597,7427,719,7523],(()=>s(599))),s.O(void 0,[7921,6200,4994,9858,1014,2143,8363,1081,6369,3190,3331,490,8413,1130,3684,6396,4590,1011,161,5167,8502,3222,5962,2833,8385,6864,7597,7427,719,7523],(()=>s(5190))),s.O(void 0,[7921,6200,4994,9858,1014,2143,8363,1081,6369,3190,3331,490,8413,1130,3684,6396,4590,1011,161,5167,8502,3222,5962,2833,8385,6864,7597,7427,719,7523],(()=>s(9545))),s.O(void 0,[7921,6200,4994,9858,1014,2143,8363,1081,6369,3190,3331,490,8413,1130,3684,6396,4590,1011,161,5167,8502,3222,5962,2833,8385,6864,7597,7427,719,7523],(()=>s(3810))),s.O(void 0,[7921,6200,4994,9858,1014,2143,8363,1081,6369,3190,3331,490,8413,1130,3684,6396,4590,1011,161,5167,8502,3222,5962,2833,8385,6864,7597,7427,719,7523],(()=>s(441))),s.O(void 0,[7921,6200,4994,9858,1014,2143,8363,1081,6369,3190,3331,490,8413,1130,3684,6396,4590,1011,161,5167,8502,3222,5962,2833,8385,6864,7597,7427,719,7523],(()=>s(2072))),s.O(void 0,[7921,6200,4994,9858,1014,2143,8363,1081,6369,3190,3331,490,8413,1130,3684,6396,4590,1011,161,5167,8502,3222,5962,2833,8385,6864,7597,7427,719,7523],(()=>s(5666))),s.O(void 0,[7921,6200,4994,9858,1014,2143,8363,1081,6369,3190,3331,490,8413,1130,3684,6396,4590,1011,161,5167,8502,3222,5962,2833,8385,6864,7597,7427,719,7523],(()=>s(5464)));var o=s.O(void 0,[7921,6200,4994,9858,1014,2143,8363,1081,6369,3190,3331,490,8413,1130,3684,6396,4590,1011,161,5167,8502,3222,5962,2833,8385,6864,7597,7427,719,7523],(()=>s(6344)));o=s.O(o)})();
//# sourceMappingURL=main.js.map